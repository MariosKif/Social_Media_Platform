import{r as Mj,a as ES}from"./index._OACqPSs.js";/* empty css                       */var E_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ij(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var bS={exports:{}},$d={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var b_;function Oj(){if(b_)return $d;b_=1;var n=Mj(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,i=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function o(a,l,u){var h,c={},d=null,f=null;u!==void 0&&(d=""+u),l.key!==void 0&&(d=""+l.key),l.ref!==void 0&&(f=l.ref);for(h in l)r.call(l,h)&&!s.hasOwnProperty(h)&&(c[h]=l[h]);if(a&&a.defaultProps)for(h in l=a.defaultProps,l)c[h]===void 0&&(c[h]=l[h]);return{$$typeof:e,type:a,key:d,ref:f,props:c,_owner:i.current}}return $d.Fragment=t,$d.jsx=o,$d.jsxs=o,$d}var T_;function _j(){return T_||(T_=1,bS.exports=Oj()),bS.exports}var Pj=_j(),A_={},Gd,N_;function yr(){if(N_)return Gd;N_=1;var n=function(e){return e&&e.Math===Math&&e};return Gd=n(typeof globalThis=="object"&&globalThis)||n(typeof window=="object"&&window)||n(typeof self=="object"&&self)||n(typeof E_=="object"&&E_)||n(typeof Gd=="object"&&Gd)||(function(){return this})()||Function("return this")(),Gd}var TS={},AS,M_;function Mr(){return M_||(M_=1,AS=function(n){try{return!!n()}catch{return!0}}),AS}var NS,I_;function ao(){if(I_)return NS;I_=1;var n=Mr();return NS=!n(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),NS}var MS,O_;function Jy(){if(O_)return MS;O_=1;var n=Mr();return MS=!n(function(){var e=(function(){}).bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),MS}var IS,__;function lo(){if(__)return IS;__=1;var n=Jy(),e=Function.prototype.call;return IS=n?e.bind(e):function(){return e.apply(e,arguments)},IS}var OS={},P_;function xj(){if(P_)return OS;P_=1;var n={}.propertyIsEnumerable,e=Object.getOwnPropertyDescriptor,t=e&&!n.call({1:2},1);return OS.f=t?function(i){var s=e(this,i);return!!s&&s.enumerable}:n,OS}var _S,x_;function eC(){return x_||(x_=1,_S=function(n,e){return{enumerable:!(n&1),configurable:!(n&2),writable:!(n&4),value:e}}),_S}var PS,L_;function qn(){if(L_)return PS;L_=1;var n=Jy(),e=Function.prototype,t=e.call,r=n&&e.bind.bind(t,t);return PS=n?r:function(i){return function(){return t.apply(i,arguments)}},PS}var xS,H_;function Dh(){if(H_)return xS;H_=1;var n=qn(),e=n({}.toString),t=n("".slice);return xS=function(r){return t(e(r),8,-1)},xS}var LS,D_;function Lj(){if(D_)return LS;D_=1;var n=qn(),e=Mr(),t=Dh(),r=Object,i=n("".split);return LS=e(function(){return!r("z").propertyIsEnumerable(0)})?function(s){return t(s)==="String"?i(s,""):r(s)}:r,LS}var HS,F_;function QN(){return F_||(F_=1,HS=function(n){return n==null}),HS}var DS,k_;function gg(){if(k_)return DS;k_=1;var n=QN(),e=TypeError;return DS=function(t){if(n(t))throw new e("Can't call method on "+t);return t},DS}var FS,V_;function tC(){if(V_)return FS;V_=1;var n=Lj(),e=gg();return FS=function(t){return n(e(t))},FS}var kS,U_;function jr(){if(U_)return kS;U_=1;var n=typeof document=="object"&&document.all;return kS=typeof n>"u"&&n!==void 0?function(e){return typeof e=="function"||e===n}:function(e){return typeof e=="function"},kS}var VS,B_;function bs(){if(B_)return VS;B_=1;var n=jr();return VS=function(e){return typeof e=="object"?e!==null:n(e)},VS}var US,W_;function Nd(){if(W_)return US;W_=1;var n=yr(),e=jr(),t=function(r){return e(r)?r:void 0};return US=function(r,i){return arguments.length<2?t(n[r]):n[r]&&n[r][i]},US}var BS,$_;function nC(){if($_)return BS;$_=1;var n=qn();return BS=n({}.isPrototypeOf),BS}var WS,G_;function rC(){if(G_)return WS;G_=1;var n=yr(),e=n.navigator,t=e&&e.userAgent;return WS=t?String(t):"",WS}var $S,j_;function Hj(){if(j_)return $S;j_=1;var n=yr(),e=rC(),t=n.process,r=n.Deno,i=t&&t.versions||r&&r.version,s=i&&i.v8,o,a;return s&&(o=s.split("."),a=o[0]>0&&o[0]<4?1:+(o[0]+o[1])),!a&&e&&(o=e.match(/Edge\/(\d+)/),(!o||o[1]>=74)&&(o=e.match(/Chrome\/(\d+)/),o&&(a=+o[1]))),$S=a,$S}var GS,z_;function ZN(){if(z_)return GS;z_=1;var n=Hj(),e=Mr(),t=yr(),r=t.String;return GS=!!Object.getOwnPropertySymbols&&!e(function(){var i=Symbol("symbol detection");return!r(i)||!(Object(i)instanceof Symbol)||!Symbol.sham&&n&&n<41}),GS}var jS,Y_;function fk(){if(Y_)return jS;Y_=1;var n=ZN();return jS=n&&!Symbol.sham&&typeof Symbol.iterator=="symbol",jS}var zS,K_;function JN(){if(K_)return zS;K_=1;var n=Nd(),e=jr(),t=nC(),r=fk(),i=Object;return zS=r?function(s){return typeof s=="symbol"}:function(s){var o=n("Symbol");return e(o)&&t(o.prototype,i(s))},zS}var YS,q_;function iC(){if(q_)return YS;q_=1;var n=String;return YS=function(e){try{return n(e)}catch{return"Object"}},YS}var KS,X_;function pg(){if(X_)return KS;X_=1;var n=jr(),e=iC(),t=TypeError;return KS=function(r){if(n(r))return r;throw new t(e(r)+" is not a function")},KS}var qS,Q_;function sC(){if(Q_)return qS;Q_=1;var n=pg(),e=QN();return qS=function(t,r){var i=t[r];return e(i)?void 0:n(i)},qS}var XS,Z_;function Dj(){if(Z_)return XS;Z_=1;var n=lo(),e=jr(),t=bs(),r=TypeError;return XS=function(i,s){var o,a;if(s==="string"&&e(o=i.toString)&&!t(a=n(o,i))||e(o=i.valueOf)&&!t(a=n(o,i))||s!=="string"&&e(o=i.toString)&&!t(a=n(o,i)))return a;throw new r("Can't convert object to primitive value")},XS}var QS={exports:{}},ZS,J_;function eM(){return J_||(J_=1,ZS=!1),ZS}var JS,eP;function tM(){if(eP)return JS;eP=1;var n=yr(),e=Object.defineProperty;return JS=function(t,r){try{e(n,t,{value:r,configurable:!0,writable:!0})}catch{n[t]=r}return r},JS}var tP;function nM(){if(tP)return QS.exports;tP=1;var n=eM(),e=yr(),t=tM(),r="__core-js_shared__",i=QS.exports=e[r]||t(r,{});return(i.versions||(i.versions=[])).push({version:"3.47.0",mode:n?"pure":"global",copyright:"Â© 2014-2025 Denis Pushkarev (zloirock.ru), 2025 CoreJS Company (core-js.io)",license:"https://github.com/zloirock/core-js/blob/v3.47.0/LICENSE",source:"https://github.com/zloirock/core-js"}),QS.exports}var eR,nP;function mk(){if(nP)return eR;nP=1;var n=nM();return eR=function(e,t){return n[e]||(n[e]=t||{})},eR}var tR,rP;function wg(){if(rP)return tR;rP=1;var n=gg(),e=Object;return tR=function(t){return e(n(t))},tR}var nR,iP;function uo(){if(iP)return nR;iP=1;var n=qn(),e=wg(),t=n({}.hasOwnProperty);return nR=Object.hasOwn||function(i,s){return t(e(i),s)},nR}var rR,sP;function rM(){if(sP)return rR;sP=1;var n=qn(),e=0,t=Math.random(),r=n(1.1.toString);return rR=function(i){return"Symbol("+(i===void 0?"":i)+")_"+r(++e+t,36)},rR}var iR,oP;function lu(){if(oP)return iR;oP=1;var n=yr(),e=mk(),t=uo(),r=rM(),i=ZN(),s=fk(),o=n.Symbol,a=e("wks"),l=s?o.for||o:o&&o.withoutSetter||r;return iR=function(u){return t(a,u)||(a[u]=i&&t(o,u)?o[u]:l("Symbol."+u)),a[u]},iR}var sR,aP;function Fj(){if(aP)return sR;aP=1;var n=lo(),e=bs(),t=JN(),r=sC(),i=Dj(),s=lu(),o=TypeError,a=s("toPrimitive");return sR=function(l,u){if(!e(l)||t(l))return l;var h=r(l,a),c;if(h){if(u===void 0&&(u="default"),c=n(h,l,u),!e(c)||t(c))return c;throw new o("Can't convert object to primitive value")}return u===void 0&&(u="number"),i(l,u)},sR}var oR,lP;function gk(){if(lP)return oR;lP=1;var n=Fj(),e=JN();return oR=function(t){var r=n(t,"string");return e(r)?r:r+""},oR}var aR,uP;function iM(){if(uP)return aR;uP=1;var n=yr(),e=bs(),t=n.document,r=e(t)&&e(t.createElement);return aR=function(i){return r?t.createElement(i):{}},aR}var lR,hP;function pk(){if(hP)return lR;hP=1;var n=ao(),e=Mr(),t=iM();return lR=!n&&!e(function(){return Object.defineProperty(t("div"),"a",{get:function(){return 7}}).a!==7}),lR}var cP;function wk(){if(cP)return TS;cP=1;var n=ao(),e=lo(),t=xj(),r=eC(),i=tC(),s=gk(),o=uo(),a=pk(),l=Object.getOwnPropertyDescriptor;return TS.f=n?l:function(h,c){if(h=i(h),c=s(c),a)try{return l(h,c)}catch{}if(o(h,c))return r(!e(t.f,h,c),h[c])},TS}var uR={},hR,dP;function vk(){if(dP)return hR;dP=1;var n=ao(),e=Mr();return hR=n&&e(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),hR}var cR,fP;function nl(){if(fP)return cR;fP=1;var n=bs(),e=String,t=TypeError;return cR=function(r){if(n(r))return r;throw new t(e(r)+" is not an object")},cR}var mP;function Fh(){if(mP)return uR;mP=1;var n=ao(),e=pk(),t=vk(),r=nl(),i=gk(),s=TypeError,o=Object.defineProperty,a=Object.getOwnPropertyDescriptor,l="enumerable",u="configurable",h="writable";return uR.f=n?t?function(d,f,g){if(r(d),f=i(f),r(g),typeof d=="function"&&f==="prototype"&&"value"in g&&h in g&&!g[h]){var p=a(d,f);p&&p[h]&&(d[f]=g.value,g={configurable:u in g?g[u]:p[u],enumerable:l in g?g[l]:p[l],writable:!1})}return o(d,f,g)}:o:function(d,f,g){if(r(d),f=i(f),r(g),e)try{return o(d,f,g)}catch{}if("get"in g||"set"in g)throw new s("Accessors not supported");return"value"in g&&(d[f]=g.value),d},uR}var dR,gP;function vg(){if(gP)return dR;gP=1;var n=ao(),e=Fh(),t=eC();return dR=n?function(r,i,s){return e.f(r,i,t(1,s))}:function(r,i,s){return r[i]=s,r},dR}var fR={exports:{}},mR,pP;function kj(){if(pP)return mR;pP=1;var n=ao(),e=uo(),t=Function.prototype,r=n&&Object.getOwnPropertyDescriptor,i=e(t,"name"),s=i&&(function(){}).name==="something",o=i&&(!n||n&&r(t,"name").configurable);return mR={EXISTS:i,PROPER:s,CONFIGURABLE:o},mR}var gR,wP;function Vj(){if(wP)return gR;wP=1;var n=qn(),e=jr(),t=nM(),r=n(Function.toString);return e(t.inspectSource)||(t.inspectSource=function(i){return r(i)}),gR=t.inspectSource,gR}var pR,vP;function Uj(){if(vP)return pR;vP=1;var n=yr(),e=jr(),t=n.WeakMap;return pR=e(t)&&/native code/.test(String(t)),pR}var wR,yP;function yk(){if(yP)return wR;yP=1;var n=mk(),e=rM(),t=n("keys");return wR=function(r){return t[r]||(t[r]=e(r))},wR}var vR,CP;function sM(){return CP||(CP=1,vR={}),vR}var yR,SP;function Ck(){if(SP)return yR;SP=1;var n=Uj(),e=yr(),t=bs(),r=vg(),i=uo(),s=nM(),o=yk(),a=sM(),l="Object already initialized",u=e.TypeError,h=e.WeakMap,c,d,f,g=function(S){return f(S)?d(S):c(S,{})},p=function(S){return function(R){var A;if(!t(R)||(A=d(R)).type!==S)throw new u("Incompatible receiver, "+S+" required");return A}};if(n||s.state){var v=s.state||(s.state=new h);v.get=v.get,v.has=v.has,v.set=v.set,c=function(S,R){if(v.has(S))throw new u(l);return R.facade=S,v.set(S,R),R},d=function(S){return v.get(S)||{}},f=function(S){return v.has(S)}}else{var y=o("state");a[y]=!0,c=function(S,R){if(i(S,y))throw new u(l);return R.facade=S,r(S,y,R),R},d=function(S){return i(S,y)?S[y]:{}},f=function(S){return i(S,y)}}return yR={set:c,get:d,has:f,enforce:g,getterFor:p},yR}var RP;function Bj(){if(RP)return fR.exports;RP=1;var n=qn(),e=Mr(),t=jr(),r=uo(),i=ao(),s=kj().CONFIGURABLE,o=Vj(),a=Ck(),l=a.enforce,u=a.get,h=String,c=Object.defineProperty,d=n("".slice),f=n("".replace),g=n([].join),p=i&&!e(function(){return c(function(){},"length",{value:8}).length!==8}),v=String(String).split("String"),y=fR.exports=function(S,R,A){d(h(R),0,7)==="Symbol("&&(R="["+f(h(R),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),A&&A.getter&&(R="get "+R),A&&A.setter&&(R="set "+R),(!r(S,"name")||s&&S.name!==R)&&(i?c(S,"name",{value:R,configurable:!0}):S.name=R),p&&A&&r(A,"arity")&&S.length!==A.arity&&c(S,"length",{value:A.arity});try{A&&r(A,"constructor")&&A.constructor?i&&c(S,"prototype",{writable:!1}):S.prototype&&(S.prototype=void 0)}catch{}var O=l(S);return r(O,"source")||(O.source=g(v,typeof R=="string"?R:"")),S};return Function.prototype.toString=y(function(){return t(this)&&u(this).source||o(this)},"toString"),fR.exports}var CR,EP;function Wj(){if(EP)return CR;EP=1;var n=jr(),e=Fh(),t=Bj(),r=tM();return CR=function(i,s,o,a){a||(a={});var l=a.enumerable,u=a.name!==void 0?a.name:s;if(n(o)&&t(o,u,a),a.global)l?i[s]=o:r(s,o);else{try{a.unsafe?i[s]&&(l=!0):delete i[s]}catch{}l?i[s]=o:e.f(i,s,{value:o,enumerable:!1,configurable:!a.nonConfigurable,writable:!a.nonWritable})}return i},CR}var SR={},RR,bP;function $j(){if(bP)return RR;bP=1;var n=Math.ceil,e=Math.floor;return RR=Math.trunc||function(r){var i=+r;return(i>0?e:n)(i)},RR}var ER,TP;function yg(){if(TP)return ER;TP=1;var n=$j();return ER=function(e){var t=+e;return t!==t||t===0?0:n(t)},ER}var bR,AP;function Gj(){if(AP)return bR;AP=1;var n=yg(),e=Math.max,t=Math.min;return bR=function(r,i){var s=n(r);return s<0?e(s+i,0):t(s,i)},bR}var TR,NP;function jj(){if(NP)return TR;NP=1;var n=yg(),e=Math.min;return TR=function(t){var r=n(t);return r>0?e(r,9007199254740991):0},TR}var AR,MP;function Cg(){if(MP)return AR;MP=1;var n=jj();return AR=function(e){return n(e.length)},AR}var NR,IP;function zj(){if(IP)return NR;IP=1;var n=tC(),e=Gj(),t=Cg(),r=function(i){return function(s,o,a){var l=n(s),u=t(l);if(u===0)return!i&&-1;var h=e(a,u),c;if(i&&o!==o){for(;u>h;)if(c=l[h++],c!==c)return!0}else for(;u>h;h++)if((i||h in l)&&l[h]===o)return i||h||0;return!i&&-1}};return NR={includes:r(!0),indexOf:r(!1)},NR}var MR,OP;function Sk(){if(OP)return MR;OP=1;var n=qn(),e=uo(),t=tC(),r=zj().indexOf,i=sM(),s=n([].push);return MR=function(o,a){var l=t(o),u=0,h=[],c;for(c in l)!e(i,c)&&e(l,c)&&s(h,c);for(;a.length>u;)e(l,c=a[u++])&&(~r(h,c)||s(h,c));return h},MR}var IR,_P;function oM(){return _P||(_P=1,IR=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),IR}var PP;function Yj(){if(PP)return SR;PP=1;var n=Sk(),e=oM(),t=e.concat("length","prototype");return SR.f=Object.getOwnPropertyNames||function(i){return n(i,t)},SR}var OR={},xP;function Kj(){return xP||(xP=1,OR.f=Object.getOwnPropertySymbols),OR}var _R,LP;function qj(){if(LP)return _R;LP=1;var n=Nd(),e=qn(),t=Yj(),r=Kj(),i=nl(),s=e([].concat);return _R=n("Reflect","ownKeys")||function(a){var l=t.f(i(a)),u=r.f;return u?s(l,u(a)):l},_R}var PR,HP;function Rk(){if(HP)return PR;HP=1;var n=uo(),e=qj(),t=wk(),r=Fh();return PR=function(i,s,o){for(var a=e(s),l=r.f,u=t.f,h=0;h<a.length;h++){var c=a[h];!n(i,c)&&!(o&&n(o,c))&&l(i,c,u(s,c))}},PR}var xR,DP;function Xj(){if(DP)return xR;DP=1;var n=Mr(),e=jr(),t=/#|\.prototype\./,r=function(l,u){var h=s[i(l)];return h===a?!0:h===o?!1:e(u)?n(u):!!u},i=r.normalize=function(l){return String(l).replace(t,".").toLowerCase()},s=r.data={},o=r.NATIVE="N",a=r.POLYFILL="P";return xR=r,xR}var LR,FP;function Ir(){if(FP)return LR;FP=1;var n=yr(),e=wk().f,t=vg(),r=Wj(),i=tM(),s=Rk(),o=Xj();return LR=function(a,l){var u=a.target,h=a.global,c=a.stat,d,f,g,p,v,y;if(h?f=n:c?f=n[u]||i(u,{}):f=n[u]&&n[u].prototype,f)for(g in l){if(v=l[g],a.dontCallGetSet?(y=e(f,g),p=y&&y.value):p=f[g],d=o(h?g:u+(c?".":"#")+g,a.forced),!d&&p!==void 0){if(typeof v==typeof p)continue;s(v,p)}(a.sham||p&&p.sham)&&t(v,"sham",!0),r(f,g,v,a)}},LR}var HR,kP;function oC(){if(kP)return HR;kP=1;var n=Jy(),e=Function.prototype,t=e.apply,r=e.call;return HR=typeof Reflect=="object"&&Reflect.apply||(n?r.bind(t):function(){return r.apply(t,arguments)}),HR}var DR,VP;function Ek(){if(VP)return DR;VP=1;var n=qn(),e=pg();return DR=function(t,r,i){try{return n(e(Object.getOwnPropertyDescriptor(t,r)[i]))}catch{}},DR}var FR,UP;function Qj(){if(UP)return FR;UP=1;var n=bs();return FR=function(e){return n(e)||e===null},FR}var kR,BP;function Zj(){if(BP)return kR;BP=1;var n=Qj(),e=String,t=TypeError;return kR=function(r){if(n(r))return r;throw new t("Can't set "+e(r)+" as a prototype")},kR}var VR,WP;function bk(){if(WP)return VR;WP=1;var n=Ek(),e=bs(),t=gg(),r=Zj();return VR=Object.setPrototypeOf||("__proto__"in{}?(function(){var i=!1,s={},o;try{o=n(Object.prototype,"__proto__","set"),o(s,[]),i=s instanceof Array}catch{}return function(l,u){return t(l),r(u),e(l)&&(i?o(l,u):l.__proto__=u),l}})():void 0),VR}var UR,$P;function Jj(){if($P)return UR;$P=1;var n=Fh().f;return UR=function(e,t,r){r in e||n(e,r,{configurable:!0,get:function(){return t[r]},set:function(i){t[r]=i}})},UR}var BR,GP;function ez(){if(GP)return BR;GP=1;var n=jr(),e=bs(),t=bk();return BR=function(r,i,s){var o,a;return t&&n(o=i.constructor)&&o!==s&&e(a=o.prototype)&&a!==s.prototype&&t(r,a),r},BR}var WR,jP;function tz(){if(jP)return WR;jP=1;var n=lu(),e=n("toStringTag"),t={};return t[e]="z",WR=String(t)==="[object z]",WR}var $R,zP;function Tk(){if(zP)return $R;zP=1;var n=tz(),e=jr(),t=Dh(),r=lu(),i=r("toStringTag"),s=Object,o=t((function(){return arguments})())==="Arguments",a=function(l,u){try{return l[u]}catch{}};return $R=n?t:function(l){var u,h,c;return l===void 0?"Undefined":l===null?"Null":typeof(h=a(u=s(l),i))=="string"?h:o?t(u):(c=t(u))==="Object"&&e(u.callee)?"Arguments":c},$R}var GR,YP;function aC(){if(YP)return GR;YP=1;var n=Tk(),e=String;return GR=function(t){if(n(t)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return e(t)},GR}var jR,KP;function nz(){if(KP)return jR;KP=1;var n=aC();return jR=function(e,t){return e===void 0?arguments.length<2?"":t:n(e)},jR}var zR,qP;function rz(){if(qP)return zR;qP=1;var n=bs(),e=vg();return zR=function(t,r){n(r)&&"cause"in r&&e(t,"cause",r.cause)},zR}var YR,XP;function iz(){if(XP)return YR;XP=1;var n=qn(),e=Error,t=n("".replace),r=(function(o){return String(new e(o).stack)})("zxcasd"),i=/\n\s*at [^:]*:[^\n]*/,s=i.test(r);return YR=function(o,a){if(s&&typeof o=="string"&&!e.prepareStackTrace)for(;a--;)o=t(o,i,"");return o},YR}var KR,QP;function sz(){if(QP)return KR;QP=1;var n=Mr(),e=eC();return KR=!n(function(){var t=new Error("a");return"stack"in t?(Object.defineProperty(t,"stack",e(1,7)),t.stack!==7):!0}),KR}var qR,ZP;function oz(){if(ZP)return qR;ZP=1;var n=vg(),e=iz(),t=sz(),r=Error.captureStackTrace;return qR=function(i,s,o,a){t&&(r?r(i,s):n(i,"stack",e(o,a)))},qR}var XR,JP;function az(){if(JP)return XR;JP=1;var n=Nd(),e=uo(),t=vg(),r=nC(),i=bk(),s=Rk(),o=Jj(),a=ez(),l=nz(),u=rz(),h=oz(),c=ao(),d=eM();return XR=function(f,g,p,v){var y="stackTraceLimit",S=v?2:1,R=f.split("."),A=R[R.length-1],O=n.apply(null,R);if(O){var V=O.prototype;if(!d&&e(V,"cause")&&delete V.cause,!p)return O;var B=n("Error"),Y=g(function(q,G){var Z=l(v?G:q,void 0),ee=v?new O(q):new O;return Z!==void 0&&t(ee,"message",Z),h(ee,Y,ee.stack,2),this&&r(V,this)&&a(ee,this,Y),arguments.length>S&&u(ee,arguments[S]),ee});if(Y.prototype=V,A!=="Error"?i?i(Y,B):s(Y,B,{name:!0}):c&&y in O&&(o(Y,O,y),o(Y,O,"prepareStackTrace")),s(Y,O),!d)try{V.name!==A&&t(V,"name",A),V.constructor=Y}catch{}return Y}},XR}var ex;function lz(){if(ex)return A_;ex=1;var n=Ir(),e=yr(),t=oC(),r=az(),i="WebAssembly",s=e[i],o=new Error("e",{cause:7}).cause!==7,a=function(u,h){var c={};c[u]=r(u,h,o),n({global:!0,constructor:!0,arity:1,forced:o},c)},l=function(u,h){if(s&&s[u]){var c={};c[u]=r(i+"."+u,h,o),n({target:i,stat:!0,constructor:!0,arity:1,forced:o},c)}};return a("Error",function(u){return function(c){return t(u,this,arguments)}}),a("EvalError",function(u){return function(c){return t(u,this,arguments)}}),a("RangeError",function(u){return function(c){return t(u,this,arguments)}}),a("ReferenceError",function(u){return function(c){return t(u,this,arguments)}}),a("SyntaxError",function(u){return function(c){return t(u,this,arguments)}}),a("TypeError",function(u){return function(c){return t(u,this,arguments)}}),a("URIError",function(u){return function(c){return t(u,this,arguments)}}),l("CompileError",function(u){return function(c){return t(u,this,arguments)}}),l("LinkError",function(u){return function(c){return t(u,this,arguments)}}),l("RuntimeError",function(u){return function(c){return t(u,this,arguments)}}),A_}lz();var tx={},QR,nx;function Ak(){if(nx)return QR;nx=1;var n=Dh();return QR=Array.isArray||function(t){return n(t)==="Array"},QR}var ZR,rx;function Nk(){if(rx)return ZR;rx=1;var n=ao(),e=Ak(),t=TypeError,r=Object.getOwnPropertyDescriptor,i=n&&!(function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(s){return s instanceof TypeError}})();return ZR=i?function(s,o){if(e(s)&&!r(s,"length").writable)throw new t("Cannot set read only .length");return s.length=o}:function(s,o){return s.length=o},ZR}var JR,ix;function Mk(){if(ix)return JR;ix=1;var n=TypeError,e=9007199254740991;return JR=function(t){if(t>e)throw n("Maximum allowed index exceeded");return t},JR}var sx;function uz(){if(sx)return tx;sx=1;var n=Ir(),e=wg(),t=Cg(),r=Nk(),i=Mk(),s=Mr(),o=s(function(){return[].push.call({length:4294967296},1)!==4294967297}),a=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(u){return u instanceof TypeError}},l=o||!a();return n({target:"Array",proto:!0,arity:1,forced:l},{push:function(h){var c=e(this),d=t(c),f=arguments.length;i(d+f);for(var g=0;g<f;g++)c[d]=arguments[g],d++;return r(c,d),d}}),tx}uz();var ox={},eE,ax;function oa(){if(ax)return eE;ax=1;var n=qn(),e=Set.prototype;return eE={Set,add:n(e.add),has:n(e.has),remove:n(e.delete),proto:e},eE}var tE,lx;function kh(){if(lx)return tE;lx=1;var n=oa().has;return tE=function(e){return n(e),e},tE}var nE,ux;function Vh(){if(ux)return nE;ux=1;var n=lo();return nE=function(e,t,r){for(var i=r?e:e.iterator,s=e.next,o,a;!(o=n(s,i)).done;)if(a=t(o.value),a!==void 0)return a},nE}var rE,hx;function Sg(){if(hx)return rE;hx=1;var n=qn(),e=Vh(),t=oa(),r=t.Set,i=t.proto,s=n(i.forEach),o=n(i.keys),a=o(new r).next;return rE=function(l,u,h){return h?e({iterator:o(l),next:a},u):s(l,u)},rE}var iE,cx;function aM(){if(cx)return iE;cx=1;var n=oa(),e=Sg(),t=n.Set,r=n.add;return iE=function(i){var s=new t;return e(i,function(o){r(s,o)}),s},iE}var sE,dx;function Rg(){if(dx)return sE;dx=1;var n=Ek(),e=oa();return sE=n(e.proto,"size","get")||function(t){return t.size},sE}var oE,fx;function hz(){return fx||(fx=1,oE=function(n){return{iterator:n,next:n.next,done:!1}}),oE}var aE,mx;function Uh(){if(mx)return aE;mx=1;var n=pg(),e=nl(),t=lo(),r=yg(),i=hz(),s="Invalid size",o=RangeError,a=TypeError,l=Math.max,u=function(h,c){this.set=h,this.size=l(c,0),this.has=n(h.has),this.keys=n(h.keys)};return u.prototype={getIterator:function(){return i(e(t(this.keys,this.set)))},includes:function(h){return t(this.has,this.set,h)}},aE=function(h){e(h);var c=+h.size;if(c!==c)throw new a(s);var d=r(c);if(d<0)throw new o(s);return new u(h,d)},aE}var lE,gx;function cz(){if(gx)return lE;gx=1;var n=kh(),e=oa(),t=aM(),r=Rg(),i=Uh(),s=Sg(),o=Vh(),a=e.has,l=e.remove;return lE=function(h){var c=n(this),d=i(h),f=t(c);return r(c)<=d.size?s(c,function(g){d.includes(g)&&l(f,g)}):o(d.getIterator(),function(g){a(f,g)&&l(f,g)}),f},lE}var uE,px;function Bh(){if(px)return uE;px=1;var n=Nd(),e=function(r){return{size:r,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},t=function(r){return{size:r,has:function(){return!0},keys:function(){throw new Error("e")}}};return uE=function(r,i){var s=n("Set");try{new s()[r](e(0));try{return new s()[r](e(-1)),!1}catch{if(!i)return!0;try{return new s()[r](t(-1/0)),!1}catch{var o=new s([1,2]);return i(o[r](t(1/0)))}}}catch{return!1}},uE}var wx;function dz(){if(wx)return ox;wx=1;var n=Ir(),e=cz(),t=Mr(),r=Bh(),i=!r("difference",function(o){return o.size===0}),s=i||t(function(){var o={size:1,has:function(){return!0},keys:function(){var l=0;return{next:function(){var u=l++>1;return a.has(1)&&a.clear(),{done:u,value:2}}}}},a=new Set([1,2,3,4]);return a.difference(o).size!==3});return n({target:"Set",proto:!0,real:!0,forced:s},{difference:e}),ox}dz();var vx={},hE,yx;function fz(){if(yx)return hE;yx=1;var n=kh(),e=oa(),t=Rg(),r=Uh(),i=Sg(),s=Vh(),o=e.Set,a=e.add,l=e.has;return hE=function(h){var c=n(this),d=r(h),f=new o;return t(c)>d.size?s(d.getIterator(),function(g){l(c,g)&&a(f,g)}):i(c,function(g){d.includes(g)&&a(f,g)}),f},hE}var Cx;function mz(){if(Cx)return vx;Cx=1;var n=Ir(),e=Mr(),t=fz(),r=Bh(),i=!r("intersection",function(s){return s.size===2&&s.has(1)&&s.has(2)})||e(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});return n({target:"Set",proto:!0,real:!0,forced:i},{intersection:t}),vx}mz();var Sx={},cE,Rx;function lM(){if(Rx)return cE;Rx=1;var n=lo(),e=nl(),t=sC();return cE=function(r,i,s){var o,a;e(r);try{if(o=t(r,"return"),!o){if(i==="throw")throw s;return s}o=n(o,r)}catch(l){a=!0,o=l}if(i==="throw")throw s;if(a)throw o;return e(o),s},cE}var dE,Ex;function gz(){if(Ex)return dE;Ex=1;var n=kh(),e=oa().has,t=Rg(),r=Uh(),i=Sg(),s=Vh(),o=lM();return dE=function(l){var u=n(this),h=r(l);if(t(u)<=h.size)return i(u,function(d){if(h.includes(d))return!1},!0)!==!1;var c=h.getIterator();return s(c,function(d){if(e(u,d))return o(c,"normal",!1)})!==!1},dE}var bx;function pz(){if(bx)return Sx;bx=1;var n=Ir(),e=gz(),t=Bh(),r=!t("isDisjointFrom",function(i){return!i});return n({target:"Set",proto:!0,real:!0,forced:r},{isDisjointFrom:e}),Sx}pz();var Tx={},fE,Ax;function wz(){if(Ax)return fE;Ax=1;var n=kh(),e=Rg(),t=Sg(),r=Uh();return fE=function(s){var o=n(this),a=r(s);return e(o)>a.size?!1:t(o,function(l){if(!a.includes(l))return!1},!0)!==!1},fE}var Nx;function vz(){if(Nx)return Tx;Nx=1;var n=Ir(),e=wz(),t=Bh(),r=!t("isSubsetOf",function(i){return i});return n({target:"Set",proto:!0,real:!0,forced:r},{isSubsetOf:e}),Tx}vz();var Mx={},mE,Ix;function yz(){if(Ix)return mE;Ix=1;var n=kh(),e=oa().has,t=Rg(),r=Uh(),i=Vh(),s=lM();return mE=function(a){var l=n(this),u=r(a);if(t(l)<u.size)return!1;var h=u.getIterator();return i(h,function(c){if(!e(l,c))return s(h,"normal",!1)})!==!1},mE}var Ox;function Cz(){if(Ox)return Mx;Ox=1;var n=Ir(),e=yz(),t=Bh(),r=!t("isSupersetOf",function(i){return!i});return n({target:"Set",proto:!0,real:!0,forced:r},{isSupersetOf:e}),Mx}Cz();var _x={},gE,Px;function Sz(){if(Px)return gE;Px=1;var n=kh(),e=oa(),t=aM(),r=Uh(),i=Vh(),s=e.add,o=e.has,a=e.remove;return gE=function(u){var h=n(this),c=r(u).getIterator(),d=t(h);return i(c,function(f){o(h,f)?a(d,f):s(d,f)}),d},gE}var pE,xx;function Ik(){return xx||(xx=1,pE=function(n){try{var e=new Set,t={size:0,has:function(){return!0},keys:function(){return Object.defineProperty({},"next",{get:function(){return e.clear(),e.add(4),function(){return{done:!0}}}})}},r=e[n](t);return r.size===1&&r.values().next().value===4}catch{return!1}}),pE}var Lx;function Rz(){if(Lx)return _x;Lx=1;var n=Ir(),e=Sz(),t=Ik(),r=Bh(),i=!r("symmetricDifference")||!t("symmetricDifference");return n({target:"Set",proto:!0,real:!0,forced:i},{symmetricDifference:e}),_x}Rz();var Hx={},wE,Dx;function Ez(){if(Dx)return wE;Dx=1;var n=kh(),e=oa().add,t=aM(),r=Uh(),i=Vh();return wE=function(o){var a=n(this),l=r(o).getIterator(),u=t(a);return i(l,function(h){e(u,h)}),u},wE}var Fx;function bz(){if(Fx)return Hx;Fx=1;var n=Ir(),e=Ez(),t=Ik(),r=Bh(),i=!r("union")||!t("union");return n({target:"Set",proto:!0,real:!0,forced:i},{union:e}),Hx}bz();var kx={},Vx={},vE,Ux;function Tz(){if(Ux)return vE;Ux=1;var n=Dh(),e=qn();return vE=function(t){if(n(t)==="Function")return e(t)},vE}var yE,Bx;function Ok(){if(Bx)return yE;Bx=1;var n=Tz(),e=pg(),t=Jy(),r=n(n.bind);return yE=function(i,s){return e(i),s===void 0?i:t?r(i,s):function(){return i.apply(s,arguments)}},yE}var CE,Wx;function _k(){if(Wx)return CE;Wx=1;var n=Nd();return CE=n("document","documentElement"),CE}var SE,$x;function uM(){if($x)return SE;$x=1;var n=qn();return SE=n([].slice),SE}var RE,Gx;function Pk(){if(Gx)return RE;Gx=1;var n=TypeError;return RE=function(e,t){if(e<t)throw new n("Not enough arguments");return e},RE}var EE,jx;function Az(){if(jx)return EE;jx=1;var n=rC();return EE=/(?:ipad|iphone|ipod).*applewebkit/i.test(n),EE}var bE,zx;function xk(){if(zx)return bE;zx=1;var n=yr(),e=rC(),t=Dh(),r=function(i){return e.slice(0,i.length)===i};return bE=(function(){return r("Bun/")?"BUN":r("Cloudflare-Workers")?"CLOUDFLARE":r("Deno/")?"DENO":r("Node.js/")?"NODE":n.Bun&&typeof Bun.version=="string"?"BUN":n.Deno&&typeof Deno.version=="object"?"DENO":t(n.process)==="process"?"NODE":n.window&&n.document?"BROWSER":"REST"})(),bE}var TE,Yx;function Nz(){if(Yx)return TE;Yx=1;var n=xk();return TE=n==="NODE",TE}var AE,Kx;function Lk(){if(Kx)return AE;Kx=1;var n=yr(),e=oC(),t=Ok(),r=jr(),i=uo(),s=Mr(),o=_k(),a=uM(),l=iM(),u=Pk(),h=Az(),c=Nz(),d=n.setImmediate,f=n.clearImmediate,g=n.process,p=n.Dispatch,v=n.Function,y=n.MessageChannel,S=n.String,R=0,A={},O="onreadystatechange",V,B,Y,q;s(function(){V=n.location});var G=function(re){if(i(A,re)){var ae=A[re];delete A[re],ae()}},Z=function(re){return function(){G(re)}},ee=function(re){G(re.data)},ne=function(re){n.postMessage(S(re),V.protocol+"//"+V.host)};return(!d||!f)&&(d=function(ae){u(arguments.length,1);var ze=r(ae)?ae:v(ae),Le=a(arguments,1);return A[++R]=function(){e(ze,void 0,Le)},B(R),R},f=function(ae){delete A[ae]},c?B=function(re){g.nextTick(Z(re))}:p&&p.now?B=function(re){p.now(Z(re))}:y&&!h?(Y=new y,q=Y.port2,Y.port1.onmessage=ee,B=t(q.postMessage,q)):n.addEventListener&&r(n.postMessage)&&!n.importScripts&&V&&V.protocol!=="file:"&&!s(ne)?(B=ne,n.addEventListener("message",ee,!1)):O in l("script")?B=function(re){o.appendChild(l("script"))[O]=function(){o.removeChild(this),G(re)}}:B=function(re){setTimeout(Z(re),0)}),AE={set:d,clear:f},AE}var qx;function Mz(){if(qx)return Vx;qx=1;var n=Ir(),e=yr(),t=Lk().clear;return n({global:!0,bind:!0,enumerable:!0,forced:e.clearImmediate!==t},{clearImmediate:t}),Vx}var Xx={},NE,Qx;function Iz(){if(Qx)return NE;Qx=1;var n=yr(),e=oC(),t=jr(),r=xk(),i=rC(),s=uM(),o=Pk(),a=n.Function,l=/MSIE .\./.test(i)||r==="BUN"&&(function(){var u=n.Bun.version.split(".");return u.length<3||u[0]==="0"&&(u[1]<3||u[1]==="3"&&u[2]==="0")})();return NE=function(u,h){var c=h?2:1;return l?function(d,f){var g=o(arguments.length,1)>c,p=t(d)?d:a(d),v=g?s(arguments,c):[],y=g?function(){e(p,this,v)}:p;return h?u(y,f):u(y)}:u},NE}var Zx;function Oz(){if(Zx)return Xx;Zx=1;var n=Ir(),e=yr(),t=Lk().set,r=Iz(),i=e.setImmediate?r(t,!1):t;return n({global:!0,bind:!0,enumerable:!0,forced:e.setImmediate!==i},{setImmediate:i}),Xx}var Jx;function _z(){return Jx||(Jx=1,Mz(),Oz()),kx}_z();/*! @license DOMPurify 2.5.8 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.5.8/LICENSE */function Ll(n){"@babel/helpers - typeof";return Ll=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ll(n)}function mA(n,e){return mA=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},mA(n,e)}function Pz(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Kw(n,e,t){return Pz()?Kw=Reflect.construct:Kw=function(i,s,o){var a=[null];a.push.apply(a,s);var l=Function.bind.apply(i,a),u=new l;return o&&mA(u,o.prototype),u},Kw.apply(null,arguments)}function Us(n){return xz(n)||Lz(n)||Hz(n)||Dz()}function xz(n){if(Array.isArray(n))return gA(n)}function Lz(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function Hz(n,e){if(n){if(typeof n=="string")return gA(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return gA(n,e)}}function gA(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function Dz(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Fz=Object.hasOwnProperty,e1=Object.setPrototypeOf,kz=Object.isFrozen,Vz=Object.getPrototypeOf,Uz=Object.getOwnPropertyDescriptor,ni=Object.freeze,ws=Object.seal,Bz=Object.create,Hk=typeof Reflect<"u"&&Reflect,_v=Hk.apply,pA=Hk.construct;_v||(_v=function(e,t,r){return e.apply(t,r)});ni||(ni=function(e){return e});ws||(ws=function(e){return e});pA||(pA=function(e,t){return Kw(e,Us(t))});var Wz=vs(Array.prototype.forEach),t1=vs(Array.prototype.pop),jd=vs(Array.prototype.push),qw=vs(String.prototype.toLowerCase),ME=vs(String.prototype.toString),n1=vs(String.prototype.match),Os=vs(String.prototype.replace),$z=vs(String.prototype.indexOf),Gz=vs(String.prototype.trim),Rr=vs(RegExp.prototype.test),IE=jz(TypeError);function vs(n){return function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return _v(n,e,r)}}function jz(n){return function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return pA(n,t)}}function ft(n,e,t){var r;t=(r=t)!==null&&r!==void 0?r:qw,e1&&e1(n,null);for(var i=e.length;i--;){var s=e[i];if(typeof s=="string"){var o=t(s);o!==s&&(kz(e)||(e[i]=o),s=o)}n[s]=!0}return n}function pu(n){var e=Bz(null),t;for(t in n)_v(Fz,n,[t])===!0&&(e[t]=n[t]);return e}function Zg(n,e){for(;n!==null;){var t=Uz(n,e);if(t){if(t.get)return vs(t.get);if(typeof t.value=="function")return vs(t.value)}n=Vz(n)}function r(i){return console.warn("fallback value for",i),null}return r}var r1=ni(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),OE=ni(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),_E=ni(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),zz=ni(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),PE=ni(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),Yz=ni(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),i1=ni(["#text"]),s1=ni(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),xE=ni(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),o1=ni(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Jg=ni(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Kz=ws(/\{\{[\w\W]*|[\w\W]*\}\}/gm),qz=ws(/<%[\w\W]*|[\w\W]*%>/gm),Xz=ws(/\${[\w\W]*}/gm),Qz=ws(/^data-[\-\w.\u00B7-\uFFFF]+$/),Zz=ws(/^aria-[\-\w]+$/),Jz=ws(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),eY=ws(/^(?:\w+script|data):/i),tY=ws(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),nY=ws(/^html$/i),rY=ws(/^[a-z][.\w]*(-[.\w]+)+$/i),iY=function(){return typeof window>"u"?null:window},sY=function(e,t){if(Ll(e)!=="object"||typeof e.createPolicy!="function")return null;var r=null,i="data-tt-policy-suffix";t.currentScript&&t.currentScript.hasAttribute(i)&&(r=t.currentScript.getAttribute(i));var s="dompurify"+(r?"#"+r:"");try{return e.createPolicy(s,{createHTML:function(a){return a},createScriptURL:function(a){return a}})}catch{return console.warn("TrustedTypes policy "+s+" could not be created."),null}};function Dk(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:iY(),e=function(k){return Dk(k)};if(e.version="2.5.8",e.removed=[],!n||!n.document||n.document.nodeType!==9)return e.isSupported=!1,e;var t=n.document,r=n.document,i=n.DocumentFragment,s=n.HTMLTemplateElement,o=n.Node,a=n.Element,l=n.NodeFilter,u=n.NamedNodeMap,h=u===void 0?n.NamedNodeMap||n.MozNamedAttrMap:u,c=n.HTMLFormElement,d=n.DOMParser,f=n.trustedTypes,g=a.prototype,p=Zg(g,"cloneNode"),v=Zg(g,"nextSibling"),y=Zg(g,"childNodes"),S=Zg(g,"parentNode");if(typeof s=="function"){var R=r.createElement("template");R.content&&R.content.ownerDocument&&(r=R.content.ownerDocument)}var A=sY(f,t),O=A?A.createHTML(""):"",V=r,B=V.implementation,Y=V.createNodeIterator,q=V.createDocumentFragment,G=V.getElementsByTagName,Z=t.importNode,ee={};try{ee=pu(r).documentMode?r.documentMode:{}}catch{}var ne={};e.isSupported=typeof S=="function"&&B&&B.createHTMLDocument!==void 0&&ee!==9;var re=Kz,ae=qz,ze=Xz,Le=Qz,Se=Zz,ye=eY,We=tY,w=rY,C=Jz,b=null,P=ft({},[].concat(Us(r1),Us(OE),Us(_E),Us(PE),Us(i1))),H=null,W=ft({},[].concat(Us(s1),Us(xE),Us(o1),Us(Jg))),J=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),te=null,ce=null,ge=!0,oe=!0,Ue=!1,$e=!0,X=!1,Ze=!0,it=!1,vt=!1,qe=!1,He=!1,T=!1,I=!1,x=!0,j=!1,D="user-content-",K=!0,U=!1,F={},z=null,$=ft({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),Q=null,de=ft({},["audio","video","img","source","image","track"]),Re=null,De=ft({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),st="http://www.w3.org/1998/Math/MathML",Ct="http://www.w3.org/2000/svg",dt="http://www.w3.org/1999/xhtml",Ye=dt,Et=!1,wn=null,Xh=ft({},[st,Ct,dt],ME),Is,Bd=["application/xhtml+xml","text/html"],zi="text/html",cn,Qn=null,Cr=r.createElement("form"),on=function(k){return k instanceof RegExp||k instanceof Function},yS=function(k){Qn&&Qn===k||((!k||Ll(k)!=="object")&&(k={}),k=pu(k),Is=Bd.indexOf(k.PARSER_MEDIA_TYPE)===-1?Is=zi:Is=k.PARSER_MEDIA_TYPE,cn=Is==="application/xhtml+xml"?ME:qw,b="ALLOWED_TAGS"in k?ft({},k.ALLOWED_TAGS,cn):P,H="ALLOWED_ATTR"in k?ft({},k.ALLOWED_ATTR,cn):W,wn="ALLOWED_NAMESPACES"in k?ft({},k.ALLOWED_NAMESPACES,ME):Xh,Re="ADD_URI_SAFE_ATTR"in k?ft(pu(De),k.ADD_URI_SAFE_ATTR,cn):De,Q="ADD_DATA_URI_TAGS"in k?ft(pu(de),k.ADD_DATA_URI_TAGS,cn):de,z="FORBID_CONTENTS"in k?ft({},k.FORBID_CONTENTS,cn):$,te="FORBID_TAGS"in k?ft({},k.FORBID_TAGS,cn):{},ce="FORBID_ATTR"in k?ft({},k.FORBID_ATTR,cn):{},F="USE_PROFILES"in k?k.USE_PROFILES:!1,ge=k.ALLOW_ARIA_ATTR!==!1,oe=k.ALLOW_DATA_ATTR!==!1,Ue=k.ALLOW_UNKNOWN_PROTOCOLS||!1,$e=k.ALLOW_SELF_CLOSE_IN_ATTR!==!1,X=k.SAFE_FOR_TEMPLATES||!1,Ze=k.SAFE_FOR_XML!==!1,it=k.WHOLE_DOCUMENT||!1,He=k.RETURN_DOM||!1,T=k.RETURN_DOM_FRAGMENT||!1,I=k.RETURN_TRUSTED_TYPE||!1,qe=k.FORCE_BODY||!1,x=k.SANITIZE_DOM!==!1,j=k.SANITIZE_NAMED_PROPS||!1,K=k.KEEP_CONTENT!==!1,U=k.IN_PLACE||!1,C=k.ALLOWED_URI_REGEXP||C,Ye=k.NAMESPACE||dt,J=k.CUSTOM_ELEMENT_HANDLING||{},k.CUSTOM_ELEMENT_HANDLING&&on(k.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(J.tagNameCheck=k.CUSTOM_ELEMENT_HANDLING.tagNameCheck),k.CUSTOM_ELEMENT_HANDLING&&on(k.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(J.attributeNameCheck=k.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),k.CUSTOM_ELEMENT_HANDLING&&typeof k.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(J.allowCustomizedBuiltInElements=k.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),X&&(oe=!1),T&&(He=!0),F&&(b=ft({},Us(i1)),H=[],F.html===!0&&(ft(b,r1),ft(H,s1)),F.svg===!0&&(ft(b,OE),ft(H,xE),ft(H,Jg)),F.svgFilters===!0&&(ft(b,_E),ft(H,xE),ft(H,Jg)),F.mathMl===!0&&(ft(b,PE),ft(H,o1),ft(H,Jg))),k.ADD_TAGS&&(b===P&&(b=pu(b)),ft(b,k.ADD_TAGS,cn)),k.ADD_ATTR&&(H===W&&(H=pu(H)),ft(H,k.ADD_ATTR,cn)),k.ADD_URI_SAFE_ATTR&&ft(Re,k.ADD_URI_SAFE_ATTR,cn),k.FORBID_CONTENTS&&(z===$&&(z=pu(z)),ft(z,k.FORBID_CONTENTS,cn)),K&&(b["#text"]=!0),it&&ft(b,["html","head","body"]),b.table&&(ft(b,["tbody"]),delete te.tbody),ni&&ni(k),Qn=k)},m_=ft({},["mi","mo","mn","ms","mtext"]),g_=ft({},["annotation-xml"]),Tj=ft({},["title","style","font","a","script"]),Xg=ft({},OE);ft(Xg,_E),ft(Xg,zz);var CS=ft({},PE);ft(CS,Yz);var Aj=function(k){var he=S(k);(!he||!he.tagName)&&(he={namespaceURI:Ye,tagName:"template"});var Ce=qw(k.tagName),Lt=qw(he.tagName);return wn[k.namespaceURI]?k.namespaceURI===Ct?he.namespaceURI===dt?Ce==="svg":he.namespaceURI===st?Ce==="svg"&&(Lt==="annotation-xml"||m_[Lt]):!!Xg[Ce]:k.namespaceURI===st?he.namespaceURI===dt?Ce==="math":he.namespaceURI===Ct?Ce==="math"&&g_[Lt]:!!CS[Ce]:k.namespaceURI===dt?he.namespaceURI===Ct&&!g_[Lt]||he.namespaceURI===st&&!m_[Lt]?!1:!CS[Ce]&&(Tj[Ce]||!Xg[Ce]):!!(Is==="application/xhtml+xml"&&wn[k.namespaceURI]):!1},Yi=function(k){jd(e.removed,{element:k});try{k.parentNode.removeChild(k)}catch{try{k.outerHTML=O}catch{k.remove()}}},Qg=function(k,he){try{jd(e.removed,{attribute:he.getAttributeNode(k),from:he})}catch{jd(e.removed,{attribute:null,from:he})}if(he.removeAttribute(k),k==="is"&&!H[k])if(He||T)try{Yi(he)}catch{}else try{he.setAttribute(k,"")}catch{}},p_=function(k){var he,Ce;if(qe)k="<remove></remove>"+k;else{var Lt=n1(k,/^[\r\n\t ]+/);Ce=Lt&&Lt[0]}Is==="application/xhtml+xml"&&Ye===dt&&(k='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+k+"</body></html>");var ii=A?A.createHTML(k):k;if(Ye===dt)try{he=new d().parseFromString(ii,Is)}catch{}if(!he||!he.documentElement){he=B.createDocument(Ye,"template",null);try{he.documentElement.innerHTML=Et?O:ii}catch{}}var _r=he.body||he.documentElement;return k&&Ce&&_r.insertBefore(r.createTextNode(Ce),_r.childNodes[0]||null),Ye===dt?G.call(he,it?"html":"body")[0]:it?he.documentElement:_r},w_=function(k){return Y.call(k.ownerDocument||k,k,l.SHOW_ELEMENT|l.SHOW_COMMENT|l.SHOW_TEXT|l.SHOW_PROCESSING_INSTRUCTION|l.SHOW_CDATA_SECTION,null,!1)},SS=function(k){return k instanceof c&&(typeof k.nodeName!="string"||typeof k.textContent!="string"||typeof k.removeChild!="function"||!(k.attributes instanceof h)||typeof k.removeAttribute!="function"||typeof k.setAttribute!="function"||typeof k.namespaceURI!="string"||typeof k.insertBefore!="function"||typeof k.hasChildNodes!="function")},Wd=function(k){return Ll(o)==="object"?k instanceof o:k&&Ll(k)==="object"&&typeof k.nodeType=="number"&&typeof k.nodeName=="string"},da=function(k,he,Ce){ne[k]&&Wz(ne[k],function(Lt){Lt.call(e,he,Ce,Qn)})},v_=function(k){var he;if(da("beforeSanitizeElements",k,null),SS(k)||Rr(/[\u0080-\uFFFF]/,k.nodeName))return Yi(k),!0;var Ce=cn(k.nodeName);if(da("uponSanitizeElement",k,{tagName:Ce,allowedTags:b}),k.hasChildNodes()&&!Wd(k.firstElementChild)&&(!Wd(k.content)||!Wd(k.content.firstElementChild))&&Rr(/<[/\w]/g,k.innerHTML)&&Rr(/<[/\w]/g,k.textContent)||Ce==="select"&&Rr(/<template/i,k.innerHTML)||k.nodeType===7||Ze&&k.nodeType===8&&Rr(/<[/\w]/g,k.data))return Yi(k),!0;if(!b[Ce]||te[Ce]){if(!te[Ce]&&C_(Ce)&&(J.tagNameCheck instanceof RegExp&&Rr(J.tagNameCheck,Ce)||J.tagNameCheck instanceof Function&&J.tagNameCheck(Ce)))return!1;if(K&&!z[Ce]){var Lt=S(k)||k.parentNode,ii=y(k)||k.childNodes;if(ii&&Lt)for(var _r=ii.length,Sr=_r-1;Sr>=0;--Sr){var gu=p(ii[Sr],!0);gu.__removalCount=(k.__removalCount||0)+1,Lt.insertBefore(gu,v(k))}}return Yi(k),!0}return k instanceof a&&!Aj(k)||(Ce==="noscript"||Ce==="noembed"||Ce==="noframes")&&Rr(/<\/no(script|embed|frames)/i,k.innerHTML)?(Yi(k),!0):(X&&k.nodeType===3&&(he=k.textContent,he=Os(he,re," "),he=Os(he,ae," "),he=Os(he,ze," "),k.textContent!==he&&(jd(e.removed,{element:k.cloneNode()}),k.textContent=he)),da("afterSanitizeElements",k,null),!1)},y_=function(k,he,Ce){if(x&&(he==="id"||he==="name")&&(Ce in r||Ce in Cr))return!1;if(!(oe&&!ce[he]&&Rr(Le,he))){if(!(ge&&Rr(Se,he))){if(!H[he]||ce[he]){if(!(C_(k)&&(J.tagNameCheck instanceof RegExp&&Rr(J.tagNameCheck,k)||J.tagNameCheck instanceof Function&&J.tagNameCheck(k))&&(J.attributeNameCheck instanceof RegExp&&Rr(J.attributeNameCheck,he)||J.attributeNameCheck instanceof Function&&J.attributeNameCheck(he))||he==="is"&&J.allowCustomizedBuiltInElements&&(J.tagNameCheck instanceof RegExp&&Rr(J.tagNameCheck,Ce)||J.tagNameCheck instanceof Function&&J.tagNameCheck(Ce))))return!1}else if(!Re[he]){if(!Rr(C,Os(Ce,We,""))){if(!((he==="src"||he==="xlink:href"||he==="href")&&k!=="script"&&$z(Ce,"data:")===0&&Q[k])){if(!(Ue&&!Rr(ye,Os(Ce,We,"")))){if(Ce)return!1}}}}}}return!0},C_=function(k){return k!=="annotation-xml"&&n1(k,w)},S_=function(k){var he,Ce,Lt,ii;da("beforeSanitizeAttributes",k,null);var _r=k.attributes;if(!(!_r||SS(k))){var Sr={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:H};for(ii=_r.length;ii--;){he=_r[ii];var gu=he,Zn=gu.name,RS=gu.namespaceURI;if(Ce=Zn==="value"?he.value:Gz(he.value),Lt=cn(Zn),Sr.attrName=Lt,Sr.attrValue=Ce,Sr.keepAttr=!0,Sr.forceKeepAttr=void 0,da("uponSanitizeAttribute",k,Sr),Ce=Sr.attrValue,!Sr.forceKeepAttr&&(Qg(Zn,k),!!Sr.keepAttr)){if(!$e&&Rr(/\/>/i,Ce)){Qg(Zn,k);continue}X&&(Ce=Os(Ce,re," "),Ce=Os(Ce,ae," "),Ce=Os(Ce,ze," "));var R_=cn(k.nodeName);if(y_(R_,Lt,Ce)){if(j&&(Lt==="id"||Lt==="name")&&(Qg(Zn,k),Ce=D+Ce),Ze&&Rr(/((--!?|])>)|<\/(style|title)/i,Ce)){Qg(Zn,k);continue}if(A&&Ll(f)==="object"&&typeof f.getAttributeType=="function"&&!RS)switch(f.getAttributeType(R_,Lt)){case"TrustedHTML":{Ce=A.createHTML(Ce);break}case"TrustedScriptURL":{Ce=A.createScriptURL(Ce);break}}try{RS?k.setAttributeNS(RS,Zn,Ce):k.setAttribute(Zn,Ce),SS(k)?Yi(k):t1(e.removed)}catch{}}}}da("afterSanitizeAttributes",k,null)}},Nj=function Fe(k){var he,Ce=w_(k);for(da("beforeSanitizeShadowDOM",k,null);he=Ce.nextNode();)da("uponSanitizeShadowNode",he,null),v_(he),S_(he),he.content instanceof i&&Fe(he.content);da("afterSanitizeShadowDOM",k,null)};return e.sanitize=function(Fe){var k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},he,Ce,Lt,ii,_r;if(Et=!Fe,Et&&(Fe="<!-->"),typeof Fe!="string"&&!Wd(Fe))if(typeof Fe.toString=="function"){if(Fe=Fe.toString(),typeof Fe!="string")throw IE("dirty is not a string, aborting")}else throw IE("toString is not a function");if(!e.isSupported){if(Ll(n.toStaticHTML)==="object"||typeof n.toStaticHTML=="function"){if(typeof Fe=="string")return n.toStaticHTML(Fe);if(Wd(Fe))return n.toStaticHTML(Fe.outerHTML)}return Fe}if(vt||yS(k),e.removed=[],typeof Fe=="string"&&(U=!1),U){if(Fe.nodeName){var Sr=cn(Fe.nodeName);if(!b[Sr]||te[Sr])throw IE("root node is forbidden and cannot be sanitized in-place")}}else if(Fe instanceof o)he=p_("<!---->"),Ce=he.ownerDocument.importNode(Fe,!0),Ce.nodeType===1&&Ce.nodeName==="BODY"||Ce.nodeName==="HTML"?he=Ce:he.appendChild(Ce);else{if(!He&&!X&&!it&&Fe.indexOf("<")===-1)return A&&I?A.createHTML(Fe):Fe;if(he=p_(Fe),!he)return He?null:I?O:""}he&&qe&&Yi(he.firstChild);for(var gu=w_(U?Fe:he);Lt=gu.nextNode();)Lt.nodeType===3&&Lt===ii||(v_(Lt),S_(Lt),Lt.content instanceof i&&Nj(Lt.content),ii=Lt);if(ii=null,U)return Fe;if(He){if(T)for(_r=q.call(he.ownerDocument);he.firstChild;)_r.appendChild(he.firstChild);else _r=he;return(H.shadowroot||H.shadowrootmod)&&(_r=Z.call(t,_r,!0)),_r}var Zn=it?he.outerHTML:he.innerHTML;return it&&b["!doctype"]&&he.ownerDocument&&he.ownerDocument.doctype&&he.ownerDocument.doctype.name&&Rr(nY,he.ownerDocument.doctype.name)&&(Zn="<!DOCTYPE "+he.ownerDocument.doctype.name+`>
`+Zn),X&&(Zn=Os(Zn,re," "),Zn=Os(Zn,ae," "),Zn=Os(Zn,ze," ")),A&&I?A.createHTML(Zn):Zn},e.setConfig=function(Fe){yS(Fe),vt=!0},e.clearConfig=function(){Qn=null,vt=!1},e.isValidAttribute=function(Fe,k,he){Qn||yS({});var Ce=cn(Fe),Lt=cn(k);return y_(Ce,Lt,he)},e.addHook=function(Fe,k){typeof k=="function"&&(ne[Fe]=ne[Fe]||[],jd(ne[Fe],k))},e.removeHook=function(Fe){if(ne[Fe])return t1(ne[Fe])},e.removeHooks=function(Fe){ne[Fe]&&(ne[Fe]=[])},e.removeAllHooks=function(){ne={}},e}var oY=Dk();//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var Fk;function se(){return Fk.apply(null,arguments)}function aY(n){Fk=n}function ro(n){return n instanceof Array||Object.prototype.toString.call(n)==="[object Array]"}function Ch(n){return n!=null&&Object.prototype.toString.call(n)==="[object Object]"}function Pt(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function hM(n){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(n).length===0;var e;for(e in n)if(Pt(n,e))return!1;return!0}function di(n){return n===void 0}function Qa(n){return typeof n=="number"||Object.prototype.toString.call(n)==="[object Number]"}function Eg(n){return n instanceof Date||Object.prototype.toString.call(n)==="[object Date]"}function kk(n,e){var t=[],r,i=n.length;for(r=0;r<i;++r)t.push(e(n[r],r));return t}function Ul(n,e){for(var t in e)Pt(e,t)&&(n[t]=e[t]);return Pt(e,"toString")&&(n.toString=e.toString),Pt(e,"valueOf")&&(n.valueOf=e.valueOf),n}function aa(n,e,t,r){return aV(n,e,t,r,!0).utc()}function lY(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function lt(n){return n._pf==null&&(n._pf=lY()),n._pf}var wA;Array.prototype.some?wA=Array.prototype.some:wA=function(n){var e=Object(this),t=e.length>>>0,r;for(r=0;r<t;r++)if(r in e&&n.call(this,e[r],r,e))return!0;return!1};function cM(n){var e=null,t=!1,r=n._d&&!isNaN(n._d.getTime());if(r&&(e=lt(n),t=wA.call(e.parsedDateParts,function(i){return i!=null}),r=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&t),n._strict&&(r=r&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(n))n._isValid=r;else return r;return n._isValid}function lC(n){var e=aa(NaN);return n!=null?Ul(lt(e),n):lt(e).userInvalidated=!0,e}var a1=se.momentProperties=[],LE=!1;function dM(n,e){var t,r,i,s=a1.length;if(di(e._isAMomentObject)||(n._isAMomentObject=e._isAMomentObject),di(e._i)||(n._i=e._i),di(e._f)||(n._f=e._f),di(e._l)||(n._l=e._l),di(e._strict)||(n._strict=e._strict),di(e._tzm)||(n._tzm=e._tzm),di(e._isUTC)||(n._isUTC=e._isUTC),di(e._offset)||(n._offset=e._offset),di(e._pf)||(n._pf=lt(e)),di(e._locale)||(n._locale=e._locale),s>0)for(t=0;t<s;t++)r=a1[t],i=e[r],di(i)||(n[r]=i);return n}function bg(n){dM(this,n),this._d=new Date(n._d!=null?n._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),LE===!1&&(LE=!0,se.updateOffset(this),LE=!1)}function io(n){return n instanceof bg||n!=null&&n._isAMomentObject!=null}function Vk(n){se.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+n)}function Ts(n,e){var t=!0;return Ul(function(){if(se.deprecationHandler!=null&&se.deprecationHandler(null,n),t){var r=[],i,s,o,a=arguments.length;for(s=0;s<a;s++){if(i="",typeof arguments[s]=="object"){i+=`
[`+s+"] ";for(o in arguments[0])Pt(arguments[0],o)&&(i+=o+": "+arguments[0][o]+", ");i=i.slice(0,-2)}else i=arguments[s];r.push(i)}Vk(n+`
Arguments: `+Array.prototype.slice.call(r).join("")+`
`+new Error().stack),t=!1}return e.apply(this,arguments)},e)}var l1={};function Uk(n,e){se.deprecationHandler!=null&&se.deprecationHandler(n,e),l1[n]||(Vk(e),l1[n]=!0)}se.suppressDeprecationWarnings=!1;se.deprecationHandler=null;function la(n){return typeof Function<"u"&&n instanceof Function||Object.prototype.toString.call(n)==="[object Function]"}function uY(n){var e,t;for(t in n)Pt(n,t)&&(e=n[t],la(e)?this[t]=e:this["_"+t]=e);this._config=n,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function vA(n,e){var t=Ul({},n),r;for(r in e)Pt(e,r)&&(Ch(n[r])&&Ch(e[r])?(t[r]={},Ul(t[r],n[r]),Ul(t[r],e[r])):e[r]!=null?t[r]=e[r]:delete t[r]);for(r in n)Pt(n,r)&&!Pt(e,r)&&Ch(n[r])&&(t[r]=Ul({},t[r]));return t}function fM(n){n!=null&&this.set(n)}var yA;Object.keys?yA=Object.keys:yA=function(n){var e,t=[];for(e in n)Pt(n,e)&&t.push(e);return t};var hY={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function cY(n,e,t){var r=this._calendar[n]||this._calendar.sameElse;return la(r)?r.call(e,t):r}function na(n,e,t){var r=""+Math.abs(n),i=e-r.length,s=n>=0;return(s?t?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+r}var mM=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,ep=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,HE={},id={};function Be(n,e,t,r){var i=r;typeof r=="string"&&(i=function(){return this[r]()}),n&&(id[n]=i),e&&(id[e[0]]=function(){return na(i.apply(this,arguments),e[1],e[2])}),t&&(id[t]=function(){return this.localeData().ordinal(i.apply(this,arguments),n)})}function dY(n){return n.match(/\[[\s\S]/)?n.replace(/^\[|\]$/g,""):n.replace(/\\/g,"")}function fY(n){var e=n.match(mM),t,r;for(t=0,r=e.length;t<r;t++)id[e[t]]?e[t]=id[e[t]]:e[t]=dY(e[t]);return function(i){var s="",o;for(o=0;o<r;o++)s+=la(e[o])?e[o].call(i,n):e[o];return s}}function Xw(n,e){return n.isValid()?(e=Bk(e,n.localeData()),HE[e]=HE[e]||fY(e),HE[e](n)):n.localeData().invalidDate()}function Bk(n,e){var t=5;function r(i){return e.longDateFormat(i)||i}for(ep.lastIndex=0;t>=0&&ep.test(n);)n=n.replace(ep,r),ep.lastIndex=0,t-=1;return n}var mY={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function gY(n){var e=this._longDateFormat[n],t=this._longDateFormat[n.toUpperCase()];return e||!t?e:(this._longDateFormat[n]=t.match(mM).map(function(r){return r==="MMMM"||r==="MM"||r==="DD"||r==="dddd"?r.slice(1):r}).join(""),this._longDateFormat[n])}var pY="Invalid date";function wY(){return this._invalidDate}var vY="%d",yY=/\d{1,2}/;function CY(n){return this._ordinal.replace("%d",n)}var SY={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function RY(n,e,t,r){var i=this._relativeTime[t];return la(i)?i(n,e,t,r):i.replace(/%d/i,n)}function EY(n,e){var t=this._relativeTime[n>0?"future":"past"];return la(t)?t(e):t.replace(/%s/i,e)}var u1={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function As(n){return typeof n=="string"?u1[n]||u1[n.toLowerCase()]:void 0}function gM(n){var e={},t,r;for(r in n)Pt(n,r)&&(t=As(r),t&&(e[t]=n[r]));return e}var bY={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function TY(n){var e=[],t;for(t in n)Pt(n,t)&&e.push({unit:t,priority:bY[t]});return e.sort(function(r,i){return r.priority-i.priority}),e}var Wk=/\d/,ji=/\d\d/,$k=/\d{3}/,pM=/\d{4}/,uC=/[+-]?\d{6}/,hn=/\d\d?/,Gk=/\d\d\d\d?/,jk=/\d\d\d\d\d\d?/,hC=/\d{1,3}/,wM=/\d{1,4}/,cC=/[+-]?\d{1,6}/,Md=/\d+/,dC=/[+-]?\d+/,AY=/Z|[+-]\d\d:?\d\d/gi,fC=/Z|[+-]\d\d(?::?\d\d)?/gi,NY=/[+-]?\d+(\.\d{1,3})?/,Tg=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Id=/^[1-9]\d?/,vM=/^([1-9]\d|\d)/,Pv;Pv={};function Me(n,e,t){Pv[n]=la(e)?e:function(r,i){return r&&t?t:e}}function MY(n,e){return Pt(Pv,n)?Pv[n](e._strict,e._locale):new RegExp(IY(n))}function IY(n){return Ya(n.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,r,i,s){return t||r||i||s}))}function Ya(n){return n.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function hs(n){return n<0?Math.ceil(n)||0:Math.floor(n)}function Rt(n){var e=+n,t=0;return e!==0&&isFinite(e)&&(t=hs(e)),t}var CA={};function Zt(n,e){var t,r=e,i;for(typeof n=="string"&&(n=[n]),Qa(e)&&(r=function(s,o){o[e]=Rt(s)}),i=n.length,t=0;t<i;t++)CA[n[t]]=r}function Ag(n,e){Zt(n,function(t,r,i,s){i._w=i._w||{},e(t,i._w,i,s)})}function OY(n,e,t){e!=null&&Pt(CA,n)&&CA[n](e,t._a,t,n)}function mC(n){return n%4===0&&n%100!==0||n%400===0}var Wr=0,Va=1,zo=2,sr=3,Zs=4,Ua=5,hh=6,_Y=7,PY=8;Be("Y",0,0,function(){var n=this.year();return n<=9999?na(n,4):"+"+n});Be(0,["YY",2],0,function(){return this.year()%100});Be(0,["YYYY",4],0,"year");Be(0,["YYYYY",5],0,"year");Be(0,["YYYYYY",6,!0],0,"year");Me("Y",dC);Me("YY",hn,ji);Me("YYYY",wM,pM);Me("YYYYY",cC,uC);Me("YYYYYY",cC,uC);Zt(["YYYYY","YYYYYY"],Wr);Zt("YYYY",function(n,e){e[Wr]=n.length===2?se.parseTwoDigitYear(n):Rt(n)});Zt("YY",function(n,e){e[Wr]=se.parseTwoDigitYear(n)});Zt("Y",function(n,e){e[Wr]=parseInt(n,10)});function im(n){return mC(n)?366:365}se.parseTwoDigitYear=function(n){return Rt(n)+(Rt(n)>68?1900:2e3)};var zk=Od("FullYear",!0);function xY(){return mC(this.year())}function Od(n,e){return function(t){return t!=null?(Yk(this,n,t),se.updateOffset(this,e),this):Vm(this,n)}}function Vm(n,e){if(!n.isValid())return NaN;var t=n._d,r=n._isUTC;switch(e){case"Milliseconds":return r?t.getUTCMilliseconds():t.getMilliseconds();case"Seconds":return r?t.getUTCSeconds():t.getSeconds();case"Minutes":return r?t.getUTCMinutes():t.getMinutes();case"Hours":return r?t.getUTCHours():t.getHours();case"Date":return r?t.getUTCDate():t.getDate();case"Day":return r?t.getUTCDay():t.getDay();case"Month":return r?t.getUTCMonth():t.getMonth();case"FullYear":return r?t.getUTCFullYear():t.getFullYear();default:return NaN}}function Yk(n,e,t){var r,i,s,o,a;if(!(!n.isValid()||isNaN(t))){switch(r=n._d,i=n._isUTC,e){case"Milliseconds":return void(i?r.setUTCMilliseconds(t):r.setMilliseconds(t));case"Seconds":return void(i?r.setUTCSeconds(t):r.setSeconds(t));case"Minutes":return void(i?r.setUTCMinutes(t):r.setMinutes(t));case"Hours":return void(i?r.setUTCHours(t):r.setHours(t));case"Date":return void(i?r.setUTCDate(t):r.setDate(t));case"FullYear":break;default:return}s=t,o=n.month(),a=n.date(),a=a===29&&o===1&&!mC(s)?28:a,i?r.setUTCFullYear(s,o,a):r.setFullYear(s,o,a)}}function LY(n){return n=As(n),la(this[n])?this[n]():this}function HY(n,e){if(typeof n=="object"){n=gM(n);var t=TY(n),r,i=t.length;for(r=0;r<i;r++)this[t[r].unit](n[t[r].unit])}else if(n=As(n),la(this[n]))return this[n](e);return this}function DY(n,e){return(n%e+e)%e}var Un;Array.prototype.indexOf?Un=Array.prototype.indexOf:Un=function(n){var e;for(e=0;e<this.length;++e)if(this[e]===n)return e;return-1};function yM(n,e){if(isNaN(n)||isNaN(e))return NaN;var t=DY(e,12);return n+=(e-t)/12,t===1?mC(n)?29:28:31-t%7%2}Be("M",["MM",2],"Mo",function(){return this.month()+1});Be("MMM",0,0,function(n){return this.localeData().monthsShort(this,n)});Be("MMMM",0,0,function(n){return this.localeData().months(this,n)});Me("M",hn,Id);Me("MM",hn,ji);Me("MMM",function(n,e){return e.monthsShortRegex(n)});Me("MMMM",function(n,e){return e.monthsRegex(n)});Zt(["M","MM"],function(n,e){e[Va]=Rt(n)-1});Zt(["MMM","MMMM"],function(n,e,t,r){var i=t._locale.monthsParse(n,r,t._strict);i!=null?e[Va]=i:lt(t).invalidMonth=n});var FY="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),Kk="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),qk=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,kY=Tg,VY=Tg;function UY(n,e){return n?ro(this._months)?this._months[n.month()]:this._months[(this._months.isFormat||qk).test(e)?"format":"standalone"][n.month()]:ro(this._months)?this._months:this._months.standalone}function BY(n,e){return n?ro(this._monthsShort)?this._monthsShort[n.month()]:this._monthsShort[qk.test(e)?"format":"standalone"][n.month()]:ro(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function WY(n,e,t){var r,i,s,o=n.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)s=aa([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(s,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(s,"").toLocaleLowerCase();return t?e==="MMM"?(i=Un.call(this._shortMonthsParse,o),i!==-1?i:null):(i=Un.call(this._longMonthsParse,o),i!==-1?i:null):e==="MMM"?(i=Un.call(this._shortMonthsParse,o),i!==-1?i:(i=Un.call(this._longMonthsParse,o),i!==-1?i:null)):(i=Un.call(this._longMonthsParse,o),i!==-1?i:(i=Un.call(this._shortMonthsParse,o),i!==-1?i:null))}function $Y(n,e,t){var r,i,s;if(this._monthsParseExact)return WY.call(this,n,e,t);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(i=aa([2e3,r]),t&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!t&&!this._monthsParse[r]&&(s="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[r]=new RegExp(s.replace(".",""),"i")),t&&e==="MMMM"&&this._longMonthsParse[r].test(n))return r;if(t&&e==="MMM"&&this._shortMonthsParse[r].test(n))return r;if(!t&&this._monthsParse[r].test(n))return r}}function Xk(n,e){if(!n.isValid())return n;if(typeof e=="string"){if(/^\d+$/.test(e))e=Rt(e);else if(e=n.localeData().monthsParse(e),!Qa(e))return n}var t=e,r=n.date();return r=r<29?r:Math.min(r,yM(n.year(),t)),n._isUTC?n._d.setUTCMonth(t,r):n._d.setMonth(t,r),n}function Qk(n){return n!=null?(Xk(this,n),se.updateOffset(this,!0),this):Vm(this,"Month")}function GY(){return yM(this.year(),this.month())}function jY(n){return this._monthsParseExact?(Pt(this,"_monthsRegex")||Zk.call(this),n?this._monthsShortStrictRegex:this._monthsShortRegex):(Pt(this,"_monthsShortRegex")||(this._monthsShortRegex=kY),this._monthsShortStrictRegex&&n?this._monthsShortStrictRegex:this._monthsShortRegex)}function zY(n){return this._monthsParseExact?(Pt(this,"_monthsRegex")||Zk.call(this),n?this._monthsStrictRegex:this._monthsRegex):(Pt(this,"_monthsRegex")||(this._monthsRegex=VY),this._monthsStrictRegex&&n?this._monthsStrictRegex:this._monthsRegex)}function Zk(){function n(l,u){return u.length-l.length}var e=[],t=[],r=[],i,s,o,a;for(i=0;i<12;i++)s=aa([2e3,i]),o=Ya(this.monthsShort(s,"")),a=Ya(this.months(s,"")),e.push(o),t.push(a),r.push(a),r.push(o);e.sort(n),t.sort(n),r.sort(n),this._monthsRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+t.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}function YY(n,e,t,r,i,s,o){var a;return n<100&&n>=0?(a=new Date(n+400,e,t,r,i,s,o),isFinite(a.getFullYear())&&a.setFullYear(n)):a=new Date(n,e,t,r,i,s,o),a}function Um(n){var e,t;return n<100&&n>=0?(t=Array.prototype.slice.call(arguments),t[0]=n+400,e=new Date(Date.UTC.apply(null,t)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(n)):e=new Date(Date.UTC.apply(null,arguments)),e}function xv(n,e,t){var r=7+e-t,i=(7+Um(n,0,r).getUTCDay()-e)%7;return-i+r-1}function Jk(n,e,t,r,i){var s=(7+t-r)%7,o=xv(n,r,i),a=1+7*(e-1)+s+o,l,u;return a<=0?(l=n-1,u=im(l)+a):a>im(n)?(l=n+1,u=a-im(n)):(l=n,u=a),{year:l,dayOfYear:u}}function Bm(n,e,t){var r=xv(n.year(),e,t),i=Math.floor((n.dayOfYear()-r-1)/7)+1,s,o;return i<1?(o=n.year()-1,s=i+Ka(o,e,t)):i>Ka(n.year(),e,t)?(s=i-Ka(n.year(),e,t),o=n.year()+1):(o=n.year(),s=i),{week:s,year:o}}function Ka(n,e,t){var r=xv(n,e,t),i=xv(n+1,e,t);return(im(n)-r+i)/7}Be("w",["ww",2],"wo","week");Be("W",["WW",2],"Wo","isoWeek");Me("w",hn,Id);Me("ww",hn,ji);Me("W",hn,Id);Me("WW",hn,ji);Ag(["w","ww","W","WW"],function(n,e,t,r){e[r.substr(0,1)]=Rt(n)});function KY(n){return Bm(n,this._week.dow,this._week.doy).week}var qY={dow:0,doy:6};function XY(){return this._week.dow}function QY(){return this._week.doy}function ZY(n){var e=this.localeData().week(this);return n==null?e:this.add((n-e)*7,"d")}function JY(n){var e=Bm(this,1,4).week;return n==null?e:this.add((n-e)*7,"d")}Be("d",0,"do","day");Be("dd",0,0,function(n){return this.localeData().weekdaysMin(this,n)});Be("ddd",0,0,function(n){return this.localeData().weekdaysShort(this,n)});Be("dddd",0,0,function(n){return this.localeData().weekdays(this,n)});Be("e",0,0,"weekday");Be("E",0,0,"isoWeekday");Me("d",hn);Me("e",hn);Me("E",hn);Me("dd",function(n,e){return e.weekdaysMinRegex(n)});Me("ddd",function(n,e){return e.weekdaysShortRegex(n)});Me("dddd",function(n,e){return e.weekdaysRegex(n)});Ag(["dd","ddd","dddd"],function(n,e,t,r){var i=t._locale.weekdaysParse(n,r,t._strict);i!=null?e.d=i:lt(t).invalidWeekday=n});Ag(["d","e","E"],function(n,e,t,r){e[r]=Rt(n)});function eK(n,e){return typeof n!="string"?n:isNaN(n)?(n=e.weekdaysParse(n),typeof n=="number"?n:null):parseInt(n,10)}function tK(n,e){return typeof n=="string"?e.weekdaysParse(n)%7||7:isNaN(n)?null:n}function CM(n,e){return n.slice(e,7).concat(n.slice(0,e))}var nK="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),eV="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),rK="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),iK=Tg,sK=Tg,oK=Tg;function aK(n,e){var t=ro(this._weekdays)?this._weekdays:this._weekdays[n&&n!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return n===!0?CM(t,this._week.dow):n?t[n.day()]:t}function lK(n){return n===!0?CM(this._weekdaysShort,this._week.dow):n?this._weekdaysShort[n.day()]:this._weekdaysShort}function uK(n){return n===!0?CM(this._weekdaysMin,this._week.dow):n?this._weekdaysMin[n.day()]:this._weekdaysMin}function hK(n,e,t){var r,i,s,o=n.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)s=aa([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(s,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(s,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(s,"").toLocaleLowerCase();return t?e==="dddd"?(i=Un.call(this._weekdaysParse,o),i!==-1?i:null):e==="ddd"?(i=Un.call(this._shortWeekdaysParse,o),i!==-1?i:null):(i=Un.call(this._minWeekdaysParse,o),i!==-1?i:null):e==="dddd"?(i=Un.call(this._weekdaysParse,o),i!==-1||(i=Un.call(this._shortWeekdaysParse,o),i!==-1)?i:(i=Un.call(this._minWeekdaysParse,o),i!==-1?i:null)):e==="ddd"?(i=Un.call(this._shortWeekdaysParse,o),i!==-1||(i=Un.call(this._weekdaysParse,o),i!==-1)?i:(i=Un.call(this._minWeekdaysParse,o),i!==-1?i:null)):(i=Un.call(this._minWeekdaysParse,o),i!==-1||(i=Un.call(this._weekdaysParse,o),i!==-1)?i:(i=Un.call(this._shortWeekdaysParse,o),i!==-1?i:null))}function cK(n,e,t){var r,i,s;if(this._weekdaysParseExact)return hK.call(this,n,e,t);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(i=aa([2e3,1]).day(r),t&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[r]||(s="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[r]=new RegExp(s.replace(".",""),"i")),t&&e==="dddd"&&this._fullWeekdaysParse[r].test(n))return r;if(t&&e==="ddd"&&this._shortWeekdaysParse[r].test(n))return r;if(t&&e==="dd"&&this._minWeekdaysParse[r].test(n))return r;if(!t&&this._weekdaysParse[r].test(n))return r}}function dK(n){if(!this.isValid())return n!=null?this:NaN;var e=Vm(this,"Day");return n!=null?(n=eK(n,this.localeData()),this.add(n-e,"d")):e}function fK(n){if(!this.isValid())return n!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return n==null?e:this.add(n-e,"d")}function mK(n){if(!this.isValid())return n!=null?this:NaN;if(n!=null){var e=tK(n,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function gK(n){return this._weekdaysParseExact?(Pt(this,"_weekdaysRegex")||SM.call(this),n?this._weekdaysStrictRegex:this._weekdaysRegex):(Pt(this,"_weekdaysRegex")||(this._weekdaysRegex=iK),this._weekdaysStrictRegex&&n?this._weekdaysStrictRegex:this._weekdaysRegex)}function pK(n){return this._weekdaysParseExact?(Pt(this,"_weekdaysRegex")||SM.call(this),n?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(Pt(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=sK),this._weekdaysShortStrictRegex&&n?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function wK(n){return this._weekdaysParseExact?(Pt(this,"_weekdaysRegex")||SM.call(this),n?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(Pt(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=oK),this._weekdaysMinStrictRegex&&n?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function SM(){function n(h,c){return c.length-h.length}var e=[],t=[],r=[],i=[],s,o,a,l,u;for(s=0;s<7;s++)o=aa([2e3,1]).day(s),a=Ya(this.weekdaysMin(o,"")),l=Ya(this.weekdaysShort(o,"")),u=Ya(this.weekdays(o,"")),e.push(a),t.push(l),r.push(u),i.push(a),i.push(l),i.push(u);e.sort(n),t.sort(n),r.sort(n),i.sort(n),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+t.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function RM(){return this.hours()%12||12}function vK(){return this.hours()||24}Be("H",["HH",2],0,"hour");Be("h",["hh",2],0,RM);Be("k",["kk",2],0,vK);Be("hmm",0,0,function(){return""+RM.apply(this)+na(this.minutes(),2)});Be("hmmss",0,0,function(){return""+RM.apply(this)+na(this.minutes(),2)+na(this.seconds(),2)});Be("Hmm",0,0,function(){return""+this.hours()+na(this.minutes(),2)});Be("Hmmss",0,0,function(){return""+this.hours()+na(this.minutes(),2)+na(this.seconds(),2)});function tV(n,e){Be(n,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}tV("a",!0);tV("A",!1);function nV(n,e){return e._meridiemParse}Me("a",nV);Me("A",nV);Me("H",hn,vM);Me("h",hn,Id);Me("k",hn,Id);Me("HH",hn,ji);Me("hh",hn,ji);Me("kk",hn,ji);Me("hmm",Gk);Me("hmmss",jk);Me("Hmm",Gk);Me("Hmmss",jk);Zt(["H","HH"],sr);Zt(["k","kk"],function(n,e,t){var r=Rt(n);e[sr]=r===24?0:r});Zt(["a","A"],function(n,e,t){t._isPm=t._locale.isPM(n),t._meridiem=n});Zt(["h","hh"],function(n,e,t){e[sr]=Rt(n),lt(t).bigHour=!0});Zt("hmm",function(n,e,t){var r=n.length-2;e[sr]=Rt(n.substr(0,r)),e[Zs]=Rt(n.substr(r)),lt(t).bigHour=!0});Zt("hmmss",function(n,e,t){var r=n.length-4,i=n.length-2;e[sr]=Rt(n.substr(0,r)),e[Zs]=Rt(n.substr(r,2)),e[Ua]=Rt(n.substr(i)),lt(t).bigHour=!0});Zt("Hmm",function(n,e,t){var r=n.length-2;e[sr]=Rt(n.substr(0,r)),e[Zs]=Rt(n.substr(r))});Zt("Hmmss",function(n,e,t){var r=n.length-4,i=n.length-2;e[sr]=Rt(n.substr(0,r)),e[Zs]=Rt(n.substr(r,2)),e[Ua]=Rt(n.substr(i))});function yK(n){return(n+"").toLowerCase().charAt(0)==="p"}var CK=/[ap]\.?m?\.?/i,SK=Od("Hours",!0);function RK(n,e,t){return n>11?t?"pm":"PM":t?"am":"AM"}var rV={calendar:hY,longDateFormat:mY,invalidDate:pY,ordinal:vY,dayOfMonthOrdinalParse:yY,relativeTime:SY,months:FY,monthsShort:Kk,week:qY,weekdays:nK,weekdaysMin:rK,weekdaysShort:eV,meridiemParse:CK},mn={},zd={},Wm;function EK(n,e){var t,r=Math.min(n.length,e.length);for(t=0;t<r;t+=1)if(n[t]!==e[t])return t;return r}function h1(n){return n&&n.toLowerCase().replace("_","-")}function bK(n){for(var e=0,t,r,i,s;e<n.length;){for(s=h1(n[e]).split("-"),t=s.length,r=h1(n[e+1]),r=r?r.split("-"):null;t>0;){if(i=gC(s.slice(0,t).join("-")),i)return i;if(r&&r.length>=t&&EK(s,r)>=t-1)break;t--}e++}return Wm}function TK(n){return!!(n&&n.match("^[^/\\\\]*$"))}function gC(n){var e=null,t;if(mn[n]===void 0&&typeof module<"u"&&module&&module.exports&&TK(n))try{e=Wm._abbr,t=require,t("./locale/"+n),Kl(e)}catch{mn[n]=null}return mn[n]}function Kl(n,e){var t;return n&&(di(e)?t=rl(n):t=EM(n,e),t?Wm=t:typeof console<"u"&&console.warn&&console.warn("Locale "+n+" not found. Did you forget to load it?")),Wm._abbr}function EM(n,e){if(e!==null){var t,r=rV;if(e.abbr=n,mn[n]!=null)Uk("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),r=mn[n]._config;else if(e.parentLocale!=null)if(mn[e.parentLocale]!=null)r=mn[e.parentLocale]._config;else if(t=gC(e.parentLocale),t!=null)r=t._config;else return zd[e.parentLocale]||(zd[e.parentLocale]=[]),zd[e.parentLocale].push({name:n,config:e}),null;return mn[n]=new fM(vA(r,e)),zd[n]&&zd[n].forEach(function(i){EM(i.name,i.config)}),Kl(n),mn[n]}else return delete mn[n],null}function AK(n,e){if(e!=null){var t,r,i=rV;mn[n]!=null&&mn[n].parentLocale!=null?mn[n].set(vA(mn[n]._config,e)):(r=gC(n),r!=null&&(i=r._config),e=vA(i,e),r==null&&(e.abbr=n),t=new fM(e),t.parentLocale=mn[n],mn[n]=t),Kl(n)}else mn[n]!=null&&(mn[n].parentLocale!=null?(mn[n]=mn[n].parentLocale,n===Kl()&&Kl(n)):mn[n]!=null&&delete mn[n]);return mn[n]}function rl(n){var e;if(n&&n._locale&&n._locale._abbr&&(n=n._locale._abbr),!n)return Wm;if(!ro(n)){if(e=gC(n),e)return e;n=[n]}return bK(n)}function NK(){return yA(mn)}function bM(n){var e,t=n._a;return t&&lt(n).overflow===-2&&(e=t[Va]<0||t[Va]>11?Va:t[zo]<1||t[zo]>yM(t[Wr],t[Va])?zo:t[sr]<0||t[sr]>24||t[sr]===24&&(t[Zs]!==0||t[Ua]!==0||t[hh]!==0)?sr:t[Zs]<0||t[Zs]>59?Zs:t[Ua]<0||t[Ua]>59?Ua:t[hh]<0||t[hh]>999?hh:-1,lt(n)._overflowDayOfYear&&(e<Wr||e>zo)&&(e=zo),lt(n)._overflowWeeks&&e===-1&&(e=_Y),lt(n)._overflowWeekday&&e===-1&&(e=PY),lt(n).overflow=e),n}var MK=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,IK=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,OK=/Z|[+-]\d\d(?::?\d\d)?/,tp=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],DE=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],_K=/^\/?Date\((-?\d+)/i,PK=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,xK={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function iV(n){var e,t,r=n._i,i=MK.exec(r)||IK.exec(r),s,o,a,l,u=tp.length,h=DE.length;if(i){for(lt(n).iso=!0,e=0,t=u;e<t;e++)if(tp[e][1].exec(i[1])){o=tp[e][0],s=tp[e][2]!==!1;break}if(o==null){n._isValid=!1;return}if(i[3]){for(e=0,t=h;e<t;e++)if(DE[e][1].exec(i[3])){a=(i[2]||" ")+DE[e][0];break}if(a==null){n._isValid=!1;return}}if(!s&&a!=null){n._isValid=!1;return}if(i[4])if(OK.exec(i[4]))l="Z";else{n._isValid=!1;return}n._f=o+(a||"")+(l||""),AM(n)}else n._isValid=!1}function LK(n,e,t,r,i,s){var o=[HK(n),Kk.indexOf(e),parseInt(t,10),parseInt(r,10),parseInt(i,10)];return s&&o.push(parseInt(s,10)),o}function HK(n){var e=parseInt(n,10);return e<=49?2e3+e:e<=999?1900+e:e}function DK(n){return n.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function FK(n,e,t){if(n){var r=eV.indexOf(n),i=new Date(e[0],e[1],e[2]).getDay();if(r!==i)return lt(t).weekdayMismatch=!0,t._isValid=!1,!1}return!0}function kK(n,e,t){if(n)return xK[n];if(e)return 0;var r=parseInt(t,10),i=r%100,s=(r-i)/100;return s*60+i}function sV(n){var e=PK.exec(DK(n._i)),t;if(e){if(t=LK(e[4],e[3],e[2],e[5],e[6],e[7]),!FK(e[1],t,n))return;n._a=t,n._tzm=kK(e[8],e[9],e[10]),n._d=Um.apply(null,n._a),n._d.setUTCMinutes(n._d.getUTCMinutes()-n._tzm),lt(n).rfc2822=!0}else n._isValid=!1}function VK(n){var e=_K.exec(n._i);if(e!==null){n._d=new Date(+e[1]);return}if(iV(n),n._isValid===!1)delete n._isValid;else return;if(sV(n),n._isValid===!1)delete n._isValid;else return;n._strict?n._isValid=!1:se.createFromInputFallback(n)}se.createFromInputFallback=Ts("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(n){n._d=new Date(n._i+(n._useUTC?" UTC":""))});function kc(n,e,t){return n??e??t}function UK(n){var e=new Date(se.now());return n._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function TM(n){var e,t,r=[],i,s,o;if(!n._d){for(i=UK(n),n._w&&n._a[zo]==null&&n._a[Va]==null&&BK(n),n._dayOfYear!=null&&(o=kc(n._a[Wr],i[Wr]),(n._dayOfYear>im(o)||n._dayOfYear===0)&&(lt(n)._overflowDayOfYear=!0),t=Um(o,0,n._dayOfYear),n._a[Va]=t.getUTCMonth(),n._a[zo]=t.getUTCDate()),e=0;e<3&&n._a[e]==null;++e)n._a[e]=r[e]=i[e];for(;e<7;e++)n._a[e]=r[e]=n._a[e]==null?e===2?1:0:n._a[e];n._a[sr]===24&&n._a[Zs]===0&&n._a[Ua]===0&&n._a[hh]===0&&(n._nextDay=!0,n._a[sr]=0),n._d=(n._useUTC?Um:YY).apply(null,r),s=n._useUTC?n._d.getUTCDay():n._d.getDay(),n._tzm!=null&&n._d.setUTCMinutes(n._d.getUTCMinutes()-n._tzm),n._nextDay&&(n._a[sr]=24),n._w&&typeof n._w.d<"u"&&n._w.d!==s&&(lt(n).weekdayMismatch=!0)}}function BK(n){var e,t,r,i,s,o,a,l,u;e=n._w,e.GG!=null||e.W!=null||e.E!=null?(s=1,o=4,t=kc(e.GG,n._a[Wr],Bm(un(),1,4).year),r=kc(e.W,1),i=kc(e.E,1),(i<1||i>7)&&(l=!0)):(s=n._locale._week.dow,o=n._locale._week.doy,u=Bm(un(),s,o),t=kc(e.gg,n._a[Wr],u.year),r=kc(e.w,u.week),e.d!=null?(i=e.d,(i<0||i>6)&&(l=!0)):e.e!=null?(i=e.e+s,(e.e<0||e.e>6)&&(l=!0)):i=s),r<1||r>Ka(t,s,o)?lt(n)._overflowWeeks=!0:l!=null?lt(n)._overflowWeekday=!0:(a=Jk(t,r,i,s,o),n._a[Wr]=a.year,n._dayOfYear=a.dayOfYear)}se.ISO_8601=function(){};se.RFC_2822=function(){};function AM(n){if(n._f===se.ISO_8601){iV(n);return}if(n._f===se.RFC_2822){sV(n);return}n._a=[],lt(n).empty=!0;var e=""+n._i,t,r,i,s,o,a=e.length,l=0,u,h;for(i=Bk(n._f,n._locale).match(mM)||[],h=i.length,t=0;t<h;t++)s=i[t],r=(e.match(MY(s,n))||[])[0],r&&(o=e.substr(0,e.indexOf(r)),o.length>0&&lt(n).unusedInput.push(o),e=e.slice(e.indexOf(r)+r.length),l+=r.length),id[s]?(r?lt(n).empty=!1:lt(n).unusedTokens.push(s),OY(s,r,n)):n._strict&&!r&&lt(n).unusedTokens.push(s);lt(n).charsLeftOver=a-l,e.length>0&&lt(n).unusedInput.push(e),n._a[sr]<=12&&lt(n).bigHour===!0&&n._a[sr]>0&&(lt(n).bigHour=void 0),lt(n).parsedDateParts=n._a.slice(0),lt(n).meridiem=n._meridiem,n._a[sr]=WK(n._locale,n._a[sr],n._meridiem),u=lt(n).era,u!==null&&(n._a[Wr]=n._locale.erasConvertYear(u,n._a[Wr])),TM(n),bM(n)}function WK(n,e,t){var r;return t==null?e:n.meridiemHour!=null?n.meridiemHour(e,t):(n.isPM!=null&&(r=n.isPM(t),r&&e<12&&(e+=12),!r&&e===12&&(e=0)),e)}function $K(n){var e,t,r,i,s,o,a=!1,l=n._f.length;if(l===0){lt(n).invalidFormat=!0,n._d=new Date(NaN);return}for(i=0;i<l;i++)s=0,o=!1,e=dM({},n),n._useUTC!=null&&(e._useUTC=n._useUTC),e._f=n._f[i],AM(e),cM(e)&&(o=!0),s+=lt(e).charsLeftOver,s+=lt(e).unusedTokens.length*10,lt(e).score=s,a?s<r&&(r=s,t=e):(r==null||s<r||o)&&(r=s,t=e,o&&(a=!0));Ul(n,t||e)}function GK(n){if(!n._d){var e=gM(n._i),t=e.day===void 0?e.date:e.day;n._a=kk([e.year,e.month,t,e.hour,e.minute,e.second,e.millisecond],function(r){return r&&parseInt(r,10)}),TM(n)}}function jK(n){var e=new bg(bM(oV(n)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function oV(n){var e=n._i,t=n._f;return n._locale=n._locale||rl(n._l),e===null||t===void 0&&e===""?lC({nullInput:!0}):(typeof e=="string"&&(n._i=e=n._locale.preparse(e)),io(e)?new bg(bM(e)):(Eg(e)?n._d=e:ro(t)?$K(n):t?AM(n):zK(n),cM(n)||(n._d=null),n))}function zK(n){var e=n._i;di(e)?n._d=new Date(se.now()):Eg(e)?n._d=new Date(e.valueOf()):typeof e=="string"?VK(n):ro(e)?(n._a=kk(e.slice(0),function(t){return parseInt(t,10)}),TM(n)):Ch(e)?GK(n):Qa(e)?n._d=new Date(e):se.createFromInputFallback(n)}function aV(n,e,t,r,i){var s={};return(e===!0||e===!1)&&(r=e,e=void 0),(t===!0||t===!1)&&(r=t,t=void 0),(Ch(n)&&hM(n)||ro(n)&&n.length===0)&&(n=void 0),s._isAMomentObject=!0,s._useUTC=s._isUTC=i,s._l=t,s._i=n,s._f=e,s._strict=r,jK(s)}function un(n,e,t,r){return aV(n,e,t,r,!1)}var YK=Ts("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var n=un.apply(null,arguments);return this.isValid()&&n.isValid()?n<this?this:n:lC()}),KK=Ts("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var n=un.apply(null,arguments);return this.isValid()&&n.isValid()?n>this?this:n:lC()});function lV(n,e){var t,r;if(e.length===1&&ro(e[0])&&(e=e[0]),!e.length)return un();for(t=e[0],r=1;r<e.length;++r)(!e[r].isValid()||e[r][n](t))&&(t=e[r]);return t}function qK(){var n=[].slice.call(arguments,0);return lV("isBefore",n)}function XK(){var n=[].slice.call(arguments,0);return lV("isAfter",n)}var QK=function(){return Date.now?Date.now():+new Date},Yd=["year","quarter","month","week","day","hour","minute","second","millisecond"];function ZK(n){var e,t=!1,r,i=Yd.length;for(e in n)if(Pt(n,e)&&!(Un.call(Yd,e)!==-1&&(n[e]==null||!isNaN(n[e]))))return!1;for(r=0;r<i;++r)if(n[Yd[r]]){if(t)return!1;parseFloat(n[Yd[r]])!==Rt(n[Yd[r]])&&(t=!0)}return!0}function JK(){return this._isValid}function eq(){return ho(NaN)}function pC(n){var e=gM(n),t=e.year||0,r=e.quarter||0,i=e.month||0,s=e.week||e.isoWeek||0,o=e.day||0,a=e.hour||0,l=e.minute||0,u=e.second||0,h=e.millisecond||0;this._isValid=ZK(e),this._milliseconds=+h+u*1e3+l*6e4+a*1e3*60*60,this._days=+o+s*7,this._months=+i+r*3+t*12,this._data={},this._locale=rl(),this._bubble()}function Qw(n){return n instanceof pC}function SA(n){return n<0?Math.round(-1*n)*-1:Math.round(n)}function tq(n,e,t){var r=Math.min(n.length,e.length),i=Math.abs(n.length-e.length),s=0,o;for(o=0;o<r;o++)Rt(n[o])!==Rt(e[o])&&s++;return s+i}function uV(n,e){Be(n,0,0,function(){var t=this.utcOffset(),r="+";return t<0&&(t=-t,r="-"),r+na(~~(t/60),2)+e+na(~~t%60,2)})}uV("Z",":");uV("ZZ","");Me("Z",fC);Me("ZZ",fC);Zt(["Z","ZZ"],function(n,e,t){t._useUTC=!0,t._tzm=NM(fC,n)});var nq=/([\+\-]|\d\d)/gi;function NM(n,e){var t=(e||"").match(n),r,i,s;return t===null?null:(r=t[t.length-1]||[],i=(r+"").match(nq)||["-",0,0],s=+(i[1]*60)+Rt(i[2]),s===0?0:i[0]==="+"?s:-s)}function MM(n,e){var t,r;return e._isUTC?(t=e.clone(),r=(io(n)||Eg(n)?n.valueOf():un(n).valueOf())-t.valueOf(),t._d.setTime(t._d.valueOf()+r),se.updateOffset(t,!1),t):un(n).local()}function RA(n){return-Math.round(n._d.getTimezoneOffset())}se.updateOffset=function(){};function rq(n,e,t){var r=this._offset||0,i;if(!this.isValid())return n!=null?this:NaN;if(n!=null){if(typeof n=="string"){if(n=NM(fC,n),n===null)return this}else Math.abs(n)<16&&!t&&(n=n*60);return!this._isUTC&&e&&(i=RA(this)),this._offset=n,this._isUTC=!0,i!=null&&this.add(i,"m"),r!==n&&(!e||this._changeInProgress?dV(this,ho(n-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,se.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?r:RA(this)}function iq(n,e){return n!=null?(typeof n!="string"&&(n=-n),this.utcOffset(n,e),this):-this.utcOffset()}function sq(n){return this.utcOffset(0,n)}function oq(n){return this._isUTC&&(this.utcOffset(0,n),this._isUTC=!1,n&&this.subtract(RA(this),"m")),this}function aq(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var n=NM(AY,this._i);n!=null?this.utcOffset(n):this.utcOffset(0,!0)}return this}function lq(n){return this.isValid()?(n=n?un(n).utcOffset():0,(this.utcOffset()-n)%60===0):!1}function uq(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function hq(){if(!di(this._isDSTShifted))return this._isDSTShifted;var n={},e;return dM(n,this),n=oV(n),n._a?(e=n._isUTC?aa(n._a):un(n._a),this._isDSTShifted=this.isValid()&&tq(n._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function cq(){return this.isValid()?!this._isUTC:!1}function dq(){return this.isValid()?this._isUTC:!1}function hV(){return this.isValid()?this._isUTC&&this._offset===0:!1}var fq=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,mq=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function ho(n,e){var t=n,r=null,i,s,o;return Qw(n)?t={ms:n._milliseconds,d:n._days,M:n._months}:Qa(n)||!isNaN(+n)?(t={},e?t[e]=+n:t.milliseconds=+n):(r=fq.exec(n))?(i=r[1]==="-"?-1:1,t={y:0,d:Rt(r[zo])*i,h:Rt(r[sr])*i,m:Rt(r[Zs])*i,s:Rt(r[Ua])*i,ms:Rt(SA(r[hh]*1e3))*i}):(r=mq.exec(n))?(i=r[1]==="-"?-1:1,t={y:wu(r[2],i),M:wu(r[3],i),w:wu(r[4],i),d:wu(r[5],i),h:wu(r[6],i),m:wu(r[7],i),s:wu(r[8],i)}):t==null?t={}:typeof t=="object"&&("from"in t||"to"in t)&&(o=gq(un(t.from),un(t.to)),t={},t.ms=o.milliseconds,t.M=o.months),s=new pC(t),Qw(n)&&Pt(n,"_locale")&&(s._locale=n._locale),Qw(n)&&Pt(n,"_isValid")&&(s._isValid=n._isValid),s}ho.fn=pC.prototype;ho.invalid=eq;function wu(n,e){var t=n&&parseFloat(n.replace(",","."));return(isNaN(t)?0:t)*e}function c1(n,e){var t={};return t.months=e.month()-n.month()+(e.year()-n.year())*12,n.clone().add(t.months,"M").isAfter(e)&&--t.months,t.milliseconds=+e-+n.clone().add(t.months,"M"),t}function gq(n,e){var t;return n.isValid()&&e.isValid()?(e=MM(e,n),n.isBefore(e)?t=c1(n,e):(t=c1(e,n),t.milliseconds=-t.milliseconds,t.months=-t.months),t):{milliseconds:0,months:0}}function cV(n,e){return function(t,r){var i,s;return r!==null&&!isNaN(+r)&&(Uk(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),s=t,t=r,r=s),i=ho(t,r),dV(this,i,n),this}}function dV(n,e,t,r){var i=e._milliseconds,s=SA(e._days),o=SA(e._months);n.isValid()&&(r=r??!0,o&&Xk(n,Vm(n,"Month")+o*t),s&&Yk(n,"Date",Vm(n,"Date")+s*t),i&&n._d.setTime(n._d.valueOf()+i*t),r&&se.updateOffset(n,s||o))}var pq=cV(1,"add"),wq=cV(-1,"subtract");function fV(n){return typeof n=="string"||n instanceof String}function vq(n){return io(n)||Eg(n)||fV(n)||Qa(n)||Cq(n)||yq(n)||n===null||n===void 0}function yq(n){var e=Ch(n)&&!hM(n),t=!1,r=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,s,o=r.length;for(i=0;i<o;i+=1)s=r[i],t=t||Pt(n,s);return e&&t}function Cq(n){var e=ro(n),t=!1;return e&&(t=n.filter(function(r){return!Qa(r)&&fV(n)}).length===0),e&&t}function Sq(n){var e=Ch(n)&&!hM(n),t=!1,r=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,s;for(i=0;i<r.length;i+=1)s=r[i],t=t||Pt(n,s);return e&&t}function Rq(n,e){var t=n.diff(e,"days",!0);return t<-6?"sameElse":t<-1?"lastWeek":t<0?"lastDay":t<1?"sameDay":t<2?"nextDay":t<7?"nextWeek":"sameElse"}function Eq(n,e){arguments.length===1&&(arguments[0]?vq(arguments[0])?(n=arguments[0],e=void 0):Sq(arguments[0])&&(e=arguments[0],n=void 0):(n=void 0,e=void 0));var t=n||un(),r=MM(t,this).startOf("day"),i=se.calendarFormat(this,r)||"sameElse",s=e&&(la(e[i])?e[i].call(this,t):e[i]);return this.format(s||this.localeData().calendar(i,this,un(t)))}function bq(){return new bg(this)}function Tq(n,e){var t=io(n)?n:un(n);return this.isValid()&&t.isValid()?(e=As(e)||"millisecond",e==="millisecond"?this.valueOf()>t.valueOf():t.valueOf()<this.clone().startOf(e).valueOf()):!1}function Aq(n,e){var t=io(n)?n:un(n);return this.isValid()&&t.isValid()?(e=As(e)||"millisecond",e==="millisecond"?this.valueOf()<t.valueOf():this.clone().endOf(e).valueOf()<t.valueOf()):!1}function Nq(n,e,t,r){var i=io(n)?n:un(n),s=io(e)?e:un(e);return this.isValid()&&i.isValid()&&s.isValid()?(r=r||"()",(r[0]==="("?this.isAfter(i,t):!this.isBefore(i,t))&&(r[1]===")"?this.isBefore(s,t):!this.isAfter(s,t))):!1}function Mq(n,e){var t=io(n)?n:un(n),r;return this.isValid()&&t.isValid()?(e=As(e)||"millisecond",e==="millisecond"?this.valueOf()===t.valueOf():(r=t.valueOf(),this.clone().startOf(e).valueOf()<=r&&r<=this.clone().endOf(e).valueOf())):!1}function Iq(n,e){return this.isSame(n,e)||this.isAfter(n,e)}function Oq(n,e){return this.isSame(n,e)||this.isBefore(n,e)}function _q(n,e,t){var r,i,s;if(!this.isValid())return NaN;if(r=MM(n,this),!r.isValid())return NaN;switch(i=(r.utcOffset()-this.utcOffset())*6e4,e=As(e),e){case"year":s=Zw(this,r)/12;break;case"month":s=Zw(this,r);break;case"quarter":s=Zw(this,r)/3;break;case"second":s=(this-r)/1e3;break;case"minute":s=(this-r)/6e4;break;case"hour":s=(this-r)/36e5;break;case"day":s=(this-r-i)/864e5;break;case"week":s=(this-r-i)/6048e5;break;default:s=this-r}return t?s:hs(s)}function Zw(n,e){if(n.date()<e.date())return-Zw(e,n);var t=(e.year()-n.year())*12+(e.month()-n.month()),r=n.clone().add(t,"months"),i,s;return e-r<0?(i=n.clone().add(t-1,"months"),s=(e-r)/(r-i)):(i=n.clone().add(t+1,"months"),s=(e-r)/(i-r)),-(t+s)||0}se.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";se.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function Pq(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function xq(n){if(!this.isValid())return null;var e=n!==!0,t=e?this.clone().utc():this;return t.year()<0||t.year()>9999?Xw(t,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):la(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",Xw(t,"Z")):Xw(t,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function Lq(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var n="moment",e="",t,r,i,s;return this.isLocal()||(n=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),t="["+n+'("]',r=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",s=e+'[")]',this.format(t+r+i+s)}function Hq(n){n||(n=this.isUtc()?se.defaultFormatUtc:se.defaultFormat);var e=Xw(this,n);return this.localeData().postformat(e)}function Dq(n,e){return this.isValid()&&(io(n)&&n.isValid()||un(n).isValid())?ho({to:this,from:n}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function Fq(n){return this.from(un(),n)}function kq(n,e){return this.isValid()&&(io(n)&&n.isValid()||un(n).isValid())?ho({from:this,to:n}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function Vq(n){return this.to(un(),n)}function mV(n){var e;return n===void 0?this._locale._abbr:(e=rl(n),e!=null&&(this._locale=e),this)}var gV=Ts("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(n){return n===void 0?this.localeData():this.locale(n)});function pV(){return this._locale}var Lv=1e3,sd=60*Lv,Hv=60*sd,wV=(365*400+97)*24*Hv;function od(n,e){return(n%e+e)%e}function vV(n,e,t){return n<100&&n>=0?new Date(n+400,e,t)-wV:new Date(n,e,t).valueOf()}function yV(n,e,t){return n<100&&n>=0?Date.UTC(n+400,e,t)-wV:Date.UTC(n,e,t)}function Uq(n){var e,t;if(n=As(n),n===void 0||n==="millisecond"||!this.isValid())return this;switch(t=this._isUTC?yV:vV,n){case"year":e=t(this.year(),0,1);break;case"quarter":e=t(this.year(),this.month()-this.month()%3,1);break;case"month":e=t(this.year(),this.month(),1);break;case"week":e=t(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=t(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=t(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=od(e+(this._isUTC?0:this.utcOffset()*sd),Hv);break;case"minute":e=this._d.valueOf(),e-=od(e,sd);break;case"second":e=this._d.valueOf(),e-=od(e,Lv);break}return this._d.setTime(e),se.updateOffset(this,!0),this}function Bq(n){var e,t;if(n=As(n),n===void 0||n==="millisecond"||!this.isValid())return this;switch(t=this._isUTC?yV:vV,n){case"year":e=t(this.year()+1,0,1)-1;break;case"quarter":e=t(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=t(this.year(),this.month()+1,1)-1;break;case"week":e=t(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=t(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=t(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=Hv-od(e+(this._isUTC?0:this.utcOffset()*sd),Hv)-1;break;case"minute":e=this._d.valueOf(),e+=sd-od(e,sd)-1;break;case"second":e=this._d.valueOf(),e+=Lv-od(e,Lv)-1;break}return this._d.setTime(e),se.updateOffset(this,!0),this}function Wq(){return this._d.valueOf()-(this._offset||0)*6e4}function $q(){return Math.floor(this.valueOf()/1e3)}function Gq(){return new Date(this.valueOf())}function jq(){var n=this;return[n.year(),n.month(),n.date(),n.hour(),n.minute(),n.second(),n.millisecond()]}function zq(){var n=this;return{years:n.year(),months:n.month(),date:n.date(),hours:n.hours(),minutes:n.minutes(),seconds:n.seconds(),milliseconds:n.milliseconds()}}function Yq(){return this.isValid()?this.toISOString():null}function Kq(){return cM(this)}function qq(){return Ul({},lt(this))}function Xq(){return lt(this).overflow}function Qq(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Be("N",0,0,"eraAbbr");Be("NN",0,0,"eraAbbr");Be("NNN",0,0,"eraAbbr");Be("NNNN",0,0,"eraName");Be("NNNNN",0,0,"eraNarrow");Be("y",["y",1],"yo","eraYear");Be("y",["yy",2],0,"eraYear");Be("y",["yyy",3],0,"eraYear");Be("y",["yyyy",4],0,"eraYear");Me("N",IM);Me("NN",IM);Me("NNN",IM);Me("NNNN",l3);Me("NNNNN",u3);Zt(["N","NN","NNN","NNNN","NNNNN"],function(n,e,t,r){var i=t._locale.erasParse(n,r,t._strict);i?lt(t).era=i:lt(t).invalidEra=n});Me("y",Md);Me("yy",Md);Me("yyy",Md);Me("yyyy",Md);Me("yo",h3);Zt(["y","yy","yyy","yyyy"],Wr);Zt(["yo"],function(n,e,t,r){var i;t._locale._eraYearOrdinalRegex&&(i=n.match(t._locale._eraYearOrdinalRegex)),t._locale.eraYearOrdinalParse?e[Wr]=t._locale.eraYearOrdinalParse(n,i):e[Wr]=parseInt(n,10)});function Zq(n,e){var t,r,i,s=this._eras||rl("en")._eras;for(t=0,r=s.length;t<r;++t){switch(typeof s[t].since){case"string":i=se(s[t].since).startOf("day"),s[t].since=i.valueOf();break}switch(typeof s[t].until){case"undefined":s[t].until=1/0;break;case"string":i=se(s[t].until).startOf("day").valueOf(),s[t].until=i.valueOf();break}}return s}function Jq(n,e,t){var r,i,s=this.eras(),o,a,l;for(n=n.toUpperCase(),r=0,i=s.length;r<i;++r)if(o=s[r].name.toUpperCase(),a=s[r].abbr.toUpperCase(),l=s[r].narrow.toUpperCase(),t)switch(e){case"N":case"NN":case"NNN":if(a===n)return s[r];break;case"NNNN":if(o===n)return s[r];break;case"NNNNN":if(l===n)return s[r];break}else if([o,a,l].indexOf(n)>=0)return s[r]}function e3(n,e){var t=n.since<=n.until?1:-1;return e===void 0?se(n.since).year():se(n.since).year()+(e-n.offset)*t}function t3(){var n,e,t,r=this.localeData().eras();for(n=0,e=r.length;n<e;++n)if(t=this.clone().startOf("day").valueOf(),r[n].since<=t&&t<=r[n].until||r[n].until<=t&&t<=r[n].since)return r[n].name;return""}function n3(){var n,e,t,r=this.localeData().eras();for(n=0,e=r.length;n<e;++n)if(t=this.clone().startOf("day").valueOf(),r[n].since<=t&&t<=r[n].until||r[n].until<=t&&t<=r[n].since)return r[n].narrow;return""}function r3(){var n,e,t,r=this.localeData().eras();for(n=0,e=r.length;n<e;++n)if(t=this.clone().startOf("day").valueOf(),r[n].since<=t&&t<=r[n].until||r[n].until<=t&&t<=r[n].since)return r[n].abbr;return""}function i3(){var n,e,t,r,i=this.localeData().eras();for(n=0,e=i.length;n<e;++n)if(t=i[n].since<=i[n].until?1:-1,r=this.clone().startOf("day").valueOf(),i[n].since<=r&&r<=i[n].until||i[n].until<=r&&r<=i[n].since)return(this.year()-se(i[n].since).year())*t+i[n].offset;return this.year()}function s3(n){return Pt(this,"_erasNameRegex")||OM.call(this),n?this._erasNameRegex:this._erasRegex}function o3(n){return Pt(this,"_erasAbbrRegex")||OM.call(this),n?this._erasAbbrRegex:this._erasRegex}function a3(n){return Pt(this,"_erasNarrowRegex")||OM.call(this),n?this._erasNarrowRegex:this._erasRegex}function IM(n,e){return e.erasAbbrRegex(n)}function l3(n,e){return e.erasNameRegex(n)}function u3(n,e){return e.erasNarrowRegex(n)}function h3(n,e){return e._eraYearOrdinalRegex||Md}function OM(){var n=[],e=[],t=[],r=[],i,s,o,a,l,u=this.eras();for(i=0,s=u.length;i<s;++i)o=Ya(u[i].name),a=Ya(u[i].abbr),l=Ya(u[i].narrow),e.push(o),n.push(a),t.push(l),r.push(o),r.push(a),r.push(l);this._erasRegex=new RegExp("^("+r.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+t.join("|")+")","i")}Be(0,["gg",2],0,function(){return this.weekYear()%100});Be(0,["GG",2],0,function(){return this.isoWeekYear()%100});function wC(n,e){Be(0,[n,n.length],0,e)}wC("gggg","weekYear");wC("ggggg","weekYear");wC("GGGG","isoWeekYear");wC("GGGGG","isoWeekYear");Me("G",dC);Me("g",dC);Me("GG",hn,ji);Me("gg",hn,ji);Me("GGGG",wM,pM);Me("gggg",wM,pM);Me("GGGGG",cC,uC);Me("ggggg",cC,uC);Ag(["gggg","ggggg","GGGG","GGGGG"],function(n,e,t,r){e[r.substr(0,2)]=Rt(n)});Ag(["gg","GG"],function(n,e,t,r){e[r]=se.parseTwoDigitYear(n)});function c3(n){return CV.call(this,n,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function d3(n){return CV.call(this,n,this.isoWeek(),this.isoWeekday(),1,4)}function f3(){return Ka(this.year(),1,4)}function m3(){return Ka(this.isoWeekYear(),1,4)}function g3(){var n=this.localeData()._week;return Ka(this.year(),n.dow,n.doy)}function p3(){var n=this.localeData()._week;return Ka(this.weekYear(),n.dow,n.doy)}function CV(n,e,t,r,i){var s;return n==null?Bm(this,r,i).year:(s=Ka(n,r,i),e>s&&(e=s),w3.call(this,n,e,t,r,i))}function w3(n,e,t,r,i){var s=Jk(n,e,t,r,i),o=Um(s.year,0,s.dayOfYear);return this.year(o.getUTCFullYear()),this.month(o.getUTCMonth()),this.date(o.getUTCDate()),this}Be("Q",0,"Qo","quarter");Me("Q",Wk);Zt("Q",function(n,e){e[Va]=(Rt(n)-1)*3});function v3(n){return n==null?Math.ceil((this.month()+1)/3):this.month((n-1)*3+this.month()%3)}Be("D",["DD",2],"Do","date");Me("D",hn,Id);Me("DD",hn,ji);Me("Do",function(n,e){return n?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});Zt(["D","DD"],zo);Zt("Do",function(n,e){e[zo]=Rt(n.match(hn)[0])});var SV=Od("Date",!0);Be("DDD",["DDDD",3],"DDDo","dayOfYear");Me("DDD",hC);Me("DDDD",$k);Zt(["DDD","DDDD"],function(n,e,t){t._dayOfYear=Rt(n)});function y3(n){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return n==null?e:this.add(n-e,"d")}Be("m",["mm",2],0,"minute");Me("m",hn,vM);Me("mm",hn,ji);Zt(["m","mm"],Zs);var C3=Od("Minutes",!1);Be("s",["ss",2],0,"second");Me("s",hn,vM);Me("ss",hn,ji);Zt(["s","ss"],Ua);var S3=Od("Seconds",!1);Be("S",0,0,function(){return~~(this.millisecond()/100)});Be(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Be(0,["SSS",3],0,"millisecond");Be(0,["SSSS",4],0,function(){return this.millisecond()*10});Be(0,["SSSSS",5],0,function(){return this.millisecond()*100});Be(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Be(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Be(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Be(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});Me("S",hC,Wk);Me("SS",hC,ji);Me("SSS",hC,$k);var Bl,RV;for(Bl="SSSS";Bl.length<=9;Bl+="S")Me(Bl,Md);function R3(n,e){e[hh]=Rt(("0."+n)*1e3)}for(Bl="S";Bl.length<=9;Bl+="S")Zt(Bl,R3);RV=Od("Milliseconds",!1);Be("z",0,0,"zoneAbbr");Be("zz",0,0,"zoneName");function E3(){return this._isUTC?"UTC":""}function b3(){return this._isUTC?"Coordinated Universal Time":""}var ue=bg.prototype;ue.add=pq;ue.calendar=Eq;ue.clone=bq;ue.diff=_q;ue.endOf=Bq;ue.format=Hq;ue.from=Dq;ue.fromNow=Fq;ue.to=kq;ue.toNow=Vq;ue.get=LY;ue.invalidAt=Xq;ue.isAfter=Tq;ue.isBefore=Aq;ue.isBetween=Nq;ue.isSame=Mq;ue.isSameOrAfter=Iq;ue.isSameOrBefore=Oq;ue.isValid=Kq;ue.lang=gV;ue.locale=mV;ue.localeData=pV;ue.max=KK;ue.min=YK;ue.parsingFlags=qq;ue.set=HY;ue.startOf=Uq;ue.subtract=wq;ue.toArray=jq;ue.toObject=zq;ue.toDate=Gq;ue.toISOString=xq;ue.inspect=Lq;typeof Symbol<"u"&&Symbol.for!=null&&(ue[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});ue.toJSON=Yq;ue.toString=Pq;ue.unix=$q;ue.valueOf=Wq;ue.creationData=Qq;ue.eraName=t3;ue.eraNarrow=n3;ue.eraAbbr=r3;ue.eraYear=i3;ue.year=zk;ue.isLeapYear=xY;ue.weekYear=c3;ue.isoWeekYear=d3;ue.quarter=ue.quarters=v3;ue.month=Qk;ue.daysInMonth=GY;ue.week=ue.weeks=ZY;ue.isoWeek=ue.isoWeeks=JY;ue.weeksInYear=g3;ue.weeksInWeekYear=p3;ue.isoWeeksInYear=f3;ue.isoWeeksInISOWeekYear=m3;ue.date=SV;ue.day=ue.days=dK;ue.weekday=fK;ue.isoWeekday=mK;ue.dayOfYear=y3;ue.hour=ue.hours=SK;ue.minute=ue.minutes=C3;ue.second=ue.seconds=S3;ue.millisecond=ue.milliseconds=RV;ue.utcOffset=rq;ue.utc=sq;ue.local=oq;ue.parseZone=aq;ue.hasAlignedHourOffset=lq;ue.isDST=uq;ue.isLocal=cq;ue.isUtcOffset=dq;ue.isUtc=hV;ue.isUTC=hV;ue.zoneAbbr=E3;ue.zoneName=b3;ue.dates=Ts("dates accessor is deprecated. Use date instead.",SV);ue.months=Ts("months accessor is deprecated. Use month instead",Qk);ue.years=Ts("years accessor is deprecated. Use year instead",zk);ue.zone=Ts("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",iq);ue.isDSTShifted=Ts("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",hq);function T3(n){return un(n*1e3)}function A3(){return un.apply(null,arguments).parseZone()}function EV(n){return n}var xt=fM.prototype;xt.calendar=cY;xt.longDateFormat=gY;xt.invalidDate=wY;xt.ordinal=CY;xt.preparse=EV;xt.postformat=EV;xt.relativeTime=RY;xt.pastFuture=EY;xt.set=uY;xt.eras=Zq;xt.erasParse=Jq;xt.erasConvertYear=e3;xt.erasAbbrRegex=o3;xt.erasNameRegex=s3;xt.erasNarrowRegex=a3;xt.months=UY;xt.monthsShort=BY;xt.monthsParse=$Y;xt.monthsRegex=zY;xt.monthsShortRegex=jY;xt.week=KY;xt.firstDayOfYear=QY;xt.firstDayOfWeek=XY;xt.weekdays=aK;xt.weekdaysMin=uK;xt.weekdaysShort=lK;xt.weekdaysParse=cK;xt.weekdaysRegex=gK;xt.weekdaysShortRegex=pK;xt.weekdaysMinRegex=wK;xt.isPM=yK;xt.meridiem=RK;function Dv(n,e,t,r){var i=rl(),s=aa().set(r,e);return i[t](s,n)}function bV(n,e,t){if(Qa(n)&&(e=n,n=void 0),n=n||"",e!=null)return Dv(n,e,t,"month");var r,i=[];for(r=0;r<12;r++)i[r]=Dv(n,r,t,"month");return i}function _M(n,e,t,r){typeof n=="boolean"?(Qa(e)&&(t=e,e=void 0),e=e||""):(e=n,t=e,n=!1,Qa(e)&&(t=e,e=void 0),e=e||"");var i=rl(),s=n?i._week.dow:0,o,a=[];if(t!=null)return Dv(e,(t+s)%7,r,"day");for(o=0;o<7;o++)a[o]=Dv(e,(o+s)%7,r,"day");return a}function N3(n,e){return bV(n,e,"months")}function M3(n,e){return bV(n,e,"monthsShort")}function I3(n,e,t){return _M(n,e,t,"weekdays")}function O3(n,e,t){return _M(n,e,t,"weekdaysShort")}function _3(n,e,t){return _M(n,e,t,"weekdaysMin")}Kl("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(n){var e=n%10,t=Rt(n%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return n+t}});se.lang=Ts("moment.lang is deprecated. Use moment.locale instead.",Kl);se.langData=Ts("moment.langData is deprecated. Use moment.localeData instead.",rl);var fa=Math.abs;function P3(){var n=this._data;return this._milliseconds=fa(this._milliseconds),this._days=fa(this._days),this._months=fa(this._months),n.milliseconds=fa(n.milliseconds),n.seconds=fa(n.seconds),n.minutes=fa(n.minutes),n.hours=fa(n.hours),n.months=fa(n.months),n.years=fa(n.years),this}function TV(n,e,t,r){var i=ho(e,t);return n._milliseconds+=r*i._milliseconds,n._days+=r*i._days,n._months+=r*i._months,n._bubble()}function x3(n,e){return TV(this,n,e,1)}function L3(n,e){return TV(this,n,e,-1)}function d1(n){return n<0?Math.floor(n):Math.ceil(n)}function H3(){var n=this._milliseconds,e=this._days,t=this._months,r=this._data,i,s,o,a,l;return n>=0&&e>=0&&t>=0||n<=0&&e<=0&&t<=0||(n+=d1(EA(t)+e)*864e5,e=0,t=0),r.milliseconds=n%1e3,i=hs(n/1e3),r.seconds=i%60,s=hs(i/60),r.minutes=s%60,o=hs(s/60),r.hours=o%24,e+=hs(o/24),l=hs(AV(e)),t+=l,e-=d1(EA(l)),a=hs(t/12),t%=12,r.days=e,r.months=t,r.years=a,this}function AV(n){return n*4800/146097}function EA(n){return n*146097/4800}function D3(n){if(!this.isValid())return NaN;var e,t,r=this._milliseconds;if(n=As(n),n==="month"||n==="quarter"||n==="year")switch(e=this._days+r/864e5,t=this._months+AV(e),n){case"month":return t;case"quarter":return t/3;case"year":return t/12}else switch(e=this._days+Math.round(EA(this._months)),n){case"week":return e/7+r/6048e5;case"day":return e+r/864e5;case"hour":return e*24+r/36e5;case"minute":return e*1440+r/6e4;case"second":return e*86400+r/1e3;case"millisecond":return Math.floor(e*864e5)+r;default:throw new Error("Unknown unit "+n)}}function il(n){return function(){return this.as(n)}}var NV=il("ms"),F3=il("s"),k3=il("m"),V3=il("h"),U3=il("d"),B3=il("w"),W3=il("M"),$3=il("Q"),G3=il("y"),j3=NV;function z3(){return ho(this)}function Y3(n){return n=As(n),this.isValid()?this[n+"s"]():NaN}function Wh(n){return function(){return this.isValid()?this._data[n]:NaN}}var K3=Wh("milliseconds"),q3=Wh("seconds"),X3=Wh("minutes"),Q3=Wh("hours"),Z3=Wh("days"),J3=Wh("months"),e4=Wh("years");function t4(){return hs(this.days()/7)}var _a=Math.round,qc={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function n4(n,e,t,r,i){return i.relativeTime(e||1,!!t,n,r)}function r4(n,e,t,r){var i=ho(n).abs(),s=_a(i.as("s")),o=_a(i.as("m")),a=_a(i.as("h")),l=_a(i.as("d")),u=_a(i.as("M")),h=_a(i.as("w")),c=_a(i.as("y")),d=s<=t.ss&&["s",s]||s<t.s&&["ss",s]||o<=1&&["m"]||o<t.m&&["mm",o]||a<=1&&["h"]||a<t.h&&["hh",a]||l<=1&&["d"]||l<t.d&&["dd",l];return t.w!=null&&(d=d||h<=1&&["w"]||h<t.w&&["ww",h]),d=d||u<=1&&["M"]||u<t.M&&["MM",u]||c<=1&&["y"]||["yy",c],d[2]=e,d[3]=+n>0,d[4]=r,n4.apply(null,d)}function i4(n){return n===void 0?_a:typeof n=="function"?(_a=n,!0):!1}function s4(n,e){return qc[n]===void 0?!1:e===void 0?qc[n]:(qc[n]=e,n==="s"&&(qc.ss=e-1),!0)}function o4(n,e){if(!this.isValid())return this.localeData().invalidDate();var t=!1,r=qc,i,s;return typeof n=="object"&&(e=n,n=!1),typeof n=="boolean"&&(t=n),typeof e=="object"&&(r=Object.assign({},qc,e),e.s!=null&&e.ss==null&&(r.ss=e.s-1)),i=this.localeData(),s=r4(this,!t,r,i),t&&(s=i.pastFuture(+this,s)),i.postformat(s)}var FE=Math.abs;function Qh(n){return(n>0)-(n<0)||+n}function vC(){if(!this.isValid())return this.localeData().invalidDate();var n=FE(this._milliseconds)/1e3,e=FE(this._days),t=FE(this._months),r,i,s,o,a=this.asSeconds(),l,u,h,c;return a?(r=hs(n/60),i=hs(r/60),n%=60,r%=60,s=hs(t/12),t%=12,o=n?n.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",u=Qh(this._months)!==Qh(a)?"-":"",h=Qh(this._days)!==Qh(a)?"-":"",c=Qh(this._milliseconds)!==Qh(a)?"-":"",l+"P"+(s?u+s+"Y":"")+(t?u+t+"M":"")+(e?h+e+"D":"")+(i||r||n?"T":"")+(i?c+i+"H":"")+(r?c+r+"M":"")+(n?c+o+"S":"")):"P0D"}var Ot=pC.prototype;Ot.isValid=JK;Ot.abs=P3;Ot.add=x3;Ot.subtract=L3;Ot.as=D3;Ot.asMilliseconds=NV;Ot.asSeconds=F3;Ot.asMinutes=k3;Ot.asHours=V3;Ot.asDays=U3;Ot.asWeeks=B3;Ot.asMonths=W3;Ot.asQuarters=$3;Ot.asYears=G3;Ot.valueOf=j3;Ot._bubble=H3;Ot.clone=z3;Ot.get=Y3;Ot.milliseconds=K3;Ot.seconds=q3;Ot.minutes=X3;Ot.hours=Q3;Ot.days=Z3;Ot.weeks=t4;Ot.months=J3;Ot.years=e4;Ot.humanize=o4;Ot.toISOString=vC;Ot.toString=vC;Ot.toJSON=vC;Ot.locale=mV;Ot.localeData=pV;Ot.toIsoString=Ts("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",vC);Ot.lang=gV;Be("X",0,0,"unix");Be("x",0,0,"valueOf");Me("x",dC);Me("X",NY);Zt("X",function(n,e,t){t._d=new Date(parseFloat(n)*1e3)});Zt("x",function(n,e,t){t._d=new Date(Rt(n))});//! moment.js
se.version="2.30.1";aY(un);se.fn=ue;se.min=qK;se.max=XK;se.now=QK;se.utc=aa;se.unix=T3;se.months=N3;se.isDate=Eg;se.locale=Kl;se.invalid=lC;se.duration=ho;se.isMoment=io;se.weekdays=I3;se.parseZone=A3;se.localeData=rl;se.isDuration=Qw;se.monthsShort=M3;se.weekdaysMin=_3;se.defineLocale=EM;se.updateLocale=AK;se.locales=NK;se.weekdaysShort=O3;se.normalizeUnits=As;se.relativeTimeRounding=i4;se.relativeTimeThreshold=s4;se.calendarFormat=Rq;se.prototype=ue;se.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};function MV(n){const e=n.length;let t=0;for(;t<e;)n[t]=[n[t]],t+=1}function bA(n,e){const t=e.length;let r=0;for(;r<t;)n.push(e[r]),r+=1}function sm(n){const e=[];if(!n||n.length===0||!n[0]||n[0].length===0)return e;const t=n.length,r=n[0].length;for(let i=0;i<t;i++)for(let s=0;s<r;s++)e[s]||(e[s]=[]),e[s][i]=n[i][s];return e}function jn(n,e,t,r){let i=-1,s=n,o=t;Array.isArray(n)||(s=Array.from(n));const a=s.length;for(r&&a&&(i+=1,o=s[i]),i+=1;i<a;)o=e(o,s[i],i,s),i+=1;return o}function Za(n,e){let t=0,r=n;Array.isArray(n)||(r=Array.from(n));const i=r.length,s=[];let o=-1;for(;t<i;){const a=r[t];e(a,t,r)&&(o+=1,s[o]=a),t+=1}return s}function wt(n,e){let t=0,r=n;Array.isArray(n)||(r=Array.from(n));const i=r.length,s=[];let o=-1;for(;t<i;){const a=r[t];o+=1,s[o]=e(a,t,r),t+=1}return s}function L(n,e){let t=0,r=n;Array.isArray(n)||(r=Array.from(n));const i=r.length;for(;t<i&&e(r[t],t,r)!==!1;)t+=1;return n}function IV(n){return jn(n,(e,t)=>e+t,0)}function a4(n){return jn(n,(e,t)=>e>t?e:t,Array.isArray(n)?n[0]:void 0)}function l4(n){return jn(n,(e,t)=>e<t?e:t,Array.isArray(n)?n[0]:void 0)}function u4(n){return n.length?IV(n)/n.length:0}function OV(n){return jn(n,(e,t)=>e.concat(Array.isArray(t)?OV(t):t),[])}function PM(n){const e=[];return L(n,t=>{e.indexOf(t)===-1&&e.push(t)}),e}function TA(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];const[r,...i]=[...e];let s=r;return L(i,o=>{s=s.filter(a=>!o.includes(a))}),s}function h4(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];const[r,...i]=[...e];let s=r;return L(i,o=>{s=s.filter(a=>o.includes(a))}),s}function c4(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];const[r,...i]=[...e],s=new Set(r);return L(i,o=>{L(o,a=>{s.has(a)||s.add(a)})}),Array.from(s)}function AA(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return n.split(e)}const d4=Object.freeze(Object.defineProperty({__proto__:null,arrayAvg:u4,arrayEach:L,arrayFilter:Za,arrayFlatten:OV,arrayMap:wt,arrayMax:a4,arrayMin:l4,arrayReduce:jn,arraySum:IV,arrayUnique:PM,extendArray:bA,getDifferenceOfArrays:TA,getIntersectionOfArrays:h4,getUnionOfArrays:c4,pivot:sm,stringToArray:AA,to2dArray:MV},Symbol.toStringTag,{value:"Module"}));function Bt(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];return jn(n,(s,o,a)=>{const l=o.replace(/\r?\n\s*/g,""),u=t[a]?t[a]:"";return s+l+u},"").trim()}function Tn(n){let e;switch(typeof n){case"string":case"number":e=`${n}`;break;case"object":e=n===null?"":n.toString();break;case"undefined":e="";break;default:e=n.toString();break}return e}function Ne(n){return typeof n<"u"}function nn(n){return typeof n>"u"}function An(n){return n===null||n===""||nn(n)}function _V(n){return Object.prototype.toString.call(n)==="[object RegExp]"}const Yf="length",om=n=>parseInt(n,16),f1=n=>parseInt(n,10),Fv=(n,e,t)=>n.substr(e,t),am=n=>n.codePointAt(0)-65,NA=n=>`${n}`.replace(/\-/g,""),f4=n=>om(Fv(NA(n),om("12"),am("F")))/(om(Fv(NA(n),am("B"),~~![][Yf]))||9),m4=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let m1=!1;const g1={invalid:()=>Bt`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:n=>{let{keyValidityDate:e,hotVersion:t}=n;return Bt`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${t}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>Bt`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},p1={invalid:()=>Bt`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:n=>{let{keyValidityDate:e,hotVersion:t}=n;return Bt`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${t}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>Bt`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function PV(n,e){const t=!An(n),r=typeof n=="string"&&n.toLowerCase()==="non-commercial-and-evaluation",i="14.6.2";let s,o="invalid",a="invalid";n=NA(n||"");const l=g4(n);if(t||r||l)if(l){const u=se("10/02/2025","DD/MM/YYYY"),h=Math.floor(u.toDate().getTime()/864e5),c=f4(n);s=se((c+1)*864e5,"x").format("MMMM DD, YYYY"),h>c?(o="expired",a="expired"):(o="valid",a="valid")}else r?(o="non_commercial",a="valid"):(o="invalid",a="invalid");else o="missing",a="missing";if(m4()&&(o="valid",a="valid"),!m1&&o!=="valid"&&(g1[o]({keyValidityDate:s,hotVersion:i})&&console[o==="non_commercial"?"info":"warn"](g1[o]({keyValidityDate:s,hotVersion:i})),m1=!0),a!=="valid"&&e.parentNode&&p1[a]({keyValidityDate:s,hotVersion:i})){const h=document.createElement("div");h.className="hot-display-license-info",h.innerHTML=p1[a]({keyValidityDate:s,hotVersion:i}),e.parentNode.insertBefore(h,e.nextSibling)}}function g4(n){let e=[][Yf],t=e;if(n[Yf]!==am("Z"))return!1;for(let r="",i="B<H4P+".split(""),s=am(i.shift());s;s=am(i.shift()||"A"))--s<""[Yf]?t=t|(f1(`${f1(om(r)+(om(Fv(n,Math.abs(s),2))+[]).padStart(2,"0"))}`)%97||2)>>1:r=Fv(n,s,s?i[Yf]===1?9:8:6);return t===e}const p4=Object.freeze(Object.defineProperty({__proto__:null,_injectProductInfo:PV,isDefined:Ne,isEmpty:An,isRegExp:_V,isUndefined:nn,stringify:Tn},Symbol.toStringTag,{value:"Module"}));function $r(n){return n[0].toUpperCase()+n.substr(1)}function w4(){const n=[];for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];let i=t.length;for(;i;){i-=1;const s=Tn(t[i]).toLowerCase();n.indexOf(s)===-1&&n.push(s)}return n.length===1}function xM(){function n(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return n()+n()+n()+n()}function LM(n){return/^([0-9][0-9]?%$)|(^100%$)/.test(n)}function HM(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${n}`.replace(/(?:\\)?\[([^[\]]+)]/g,(t,r)=>t.charAt(0)==="\\"?t.substr(1,t.length-1):e[r]===void 0?"":e[r])}function MA(n){return yC(`${n}`,{ALLOWED_TAGS:[]})}function yC(n,e){return oY.sanitize(n,e)}const v4=Object.freeze(Object.defineProperty({__proto__:null,equalsIgnoreCase:w4,isPercentValue:LM,randomString:xM,sanitize:yC,stripTags:MA,substitute:HM,toUpperCaseFirst:$r},Symbol.toStringTag,{value:"Module"})),_d=n=>["tabindex",n],y4=()=>["role","treegrid"],Xo=()=>["role","presentation"],C4=()=>["role","gridcell"],S4=()=>["role","rowheader"],xV=()=>["role","rowgroup"],R4=()=>["role","columnheader"],IA=()=>["role","row"],E4=()=>["role","menu"],b4=()=>["role","menuitem"],T4=()=>["role","menuitemcheckbox"],A4=()=>["role","combobox"],LV=()=>["role","listbox"],N4=()=>["role","option"],M4=()=>["role","checkbox"],I4=()=>["scope","col"],O4=()=>["scope","row"],_4=()=>["type","text"],kv=n=>["aria-label",n],$h=()=>["aria-hidden","true"],P4=()=>["aria-disabled","true"],x4=()=>["aria-multiselectable","true"],HV=n=>["aria-haspopup",n],DV=n=>["aria-rowcount",n],CC=n=>["aria-colcount",n],FV=n=>["aria-rowindex",n],DM=n=>["aria-colindex",n],gs=n=>["aria-expanded",n],L4=n=>["aria-sort",n],w1=()=>["aria-readonly","true"],v1=()=>["aria-invalid","true"],kV=n=>["aria-checked",n],FM=()=>["aria-selected","true"],H4=()=>["aria-autocomplete","list"],D4=n=>["aria-controls",n],F4=n=>["aria-activedescendant",n],k4=n=>["aria-live",n],V4=n=>["aria-relevant",n],U4=n=>["aria-setsize",n],B4=n=>["aria-posinset",n];function VV(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=-1,r=null,i=n;for(;i!==null;){if(t===e){r=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(t+=1,i=i.parentNode)}return r}function UV(n,e){const t=n.closest(".handsontable");return!!t&&(t.parentNode===e||t===e)}function BV(n){return Object.getPrototypeOf(n.parent)&&n.frameElement}function Eh(n){return BV(n)&&n.parent}function W4(n){return!!Object.getPrototypeOf(n.parent)}function nu(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],t=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:r,DOCUMENT_FRAGMENT_NODE:i}=Node;let s=n;for(;s!=null&&s!==t;){const{nodeType:o,nodeName:a}=s;if(o===r&&(e.includes(a)||e.includes(s)))return s;const{host:l}=s;l&&o===i?s=l:s=s.parentNode}return null}function Kf(n,e,t){const r=[];let i=n;for(;i&&(i=nu(i,e,t),!(!i||t&&!t.contains(i)));)r.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;const s=r.length;return s?r[s-1]:null}function ql(n,e){let t=n.parentNode,r=[];for(typeof e=="string"?n.defaultView?r=Array.prototype.slice.call(n.querySelectorAll(e),0):r=Array.prototype.slice.call(n.ownerDocument.querySelectorAll(e),0):r.push(e);t!==null;){if(r.indexOf(t)>-1)return!0;t=t.parentNode}return!1}function WV(n){let e=0,t=n;if(t.previousSibling)for(;t=t.previousSibling;)e+=1;return e}function bl(n,e,t){const r=t.parentElement.querySelector(`.ht_clone_${n}`);return r?r.contains(e):null}function $V(n){return!n||!n.length?[]:n.filter(e=>!!e)}function GV(n,e){if(!n||!n.length)return{regexFree:[],regexes:[]};const t=[],r=[];return r.push(...n.filter(i=>{const s=i instanceof RegExp;return s&&e&&t.push(i),!s})),{regexFree:r,regexes:t}}function je(n,e){return n.classList===void 0||typeof e!="string"||e===""?!1:n.classList.contains(e)}function ie(n,e){typeof e=="string"&&(e=e.split(" ")),e=$V(e),e.length>0&&n.classList.add(...e)}function Xe(n,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:t,regexes:r}=GV(e,!0);t=$V(t),t.length>0&&n.classList.remove(...t),r.forEach(i=>{n.classList.forEach(s=>{i.test(s)&&n.classList.remove(s)})})}function Ge(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],t=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,t]]),e.forEach(r=>{Array.isArray(r)&&r[0]!==""&&n.setAttribute(...r)})}function Gh(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:t,regexes:r}=GV(e,!0);t.forEach(i=>{i!==""&&n.removeAttribute(i)}),r.forEach(i=>{n.getAttributeNames().forEach(s=>{i.test(s)&&n.removeAttribute(s)})})}function kM(n){if(n.nodeType===3)n.parentNode.removeChild(n);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(n.nodeName)>-1){const e=n.childNodes;for(let t=e.length-1;t>=0;t--)kM(e[t])}}function so(n){let e;for(;e=n.lastChild;)n.removeChild(e)}const jV=/(<(.*)>|&(.*);)/;function jh(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;jV.test(e)?n.innerHTML=t?yC(e):e:ru(n,e)}function ru(n,e){const t=n.firstChild;t&&t.nodeType===3&&t.nextSibling===null?t.textContent=e:(so(n),n.appendChild(n.ownerDocument.createTextNode(e)))}function bh(n){const e=n.ownerDocument.documentElement;let t=n;for(;t!==e;){if(t===null)return!1;if(t.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(t.host){if(t.host.impl)return bh(t.host.impl);if(t.host)return bh(t.host);throw new Error("Lost in Web Components world")}else return!1;else if(ra(t).display==="none")return!1;t=t.parentNode}return!0}function ir(n){const e=n.ownerDocument,t=e.defaultView,r=e.documentElement;let i=n,s,o,a;for(s=i.offsetLeft,o=i.offsetTop,a=i;(i=i.offsetParent)&&!(i===e.body||!("offsetLeft"in i));)s+=i.offsetLeft,o+=i.offsetTop,a=i;return a&&a.style.position==="fixed"&&(s+=t.pageXOffset||r.scrollLeft,o+=t.pageYOffset||r.scrollTop),{left:s,top:o}}function VM(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function SC(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function RC(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return n===e?VM(e):n.scrollTop}function UM(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return n===e?SC(e):n.scrollLeft}function $m(n){let e=n.ownerDocument,t=e?e.defaultView:void 0;e||(e=n.document?n.document:n,t=e.defaultView);const r=["auto","scroll"];let i=n.parentNode;for(;i&&i.style&&e.body!==i;){let{overflow:s,overflowX:o,overflowY:a}=i.style;if([s,o,a].includes("scroll"))return i;if({overflow:s,overflowX:o,overflowY:a}=t.getComputedStyle(i),r.includes(s)||r.includes(o)||r.includes(a)||i.clientHeight<=i.scrollHeight+1&&(r.includes(a)||r.includes(s))||i.clientWidth<=i.scrollWidth+1&&(r.includes(o)||r.includes(s)))return i;i=i.parentNode}return t}function zV(n){return n.scrollHeight-n.clientHeight}function YV(n){return n.scrollWidth-n.clientWidth}function Th(n){const e=n.ownerDocument,t=e.defaultView;let r=n.parentNode;for(;r&&r.style&&e.body!==r;){if(r.style.overflow!=="visible"&&r.style.overflow!=="")return r;const i=ra(r,t),s=["scroll","hidden","auto"],o=i.getPropertyValue("overflow"),a=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(s.includes(o)||s.includes(a)||s.includes(l))return r;r=r.parentNode}return t}function vd(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(n){if(n===t)return e==="width"?`${t.innerWidth}px`:e==="height"?`${t.innerHeight}px`:void 0}else return;const r=n.style[e];if(r!==""&&r!==void 0)return r;const i=ra(n,t);if(i[e]!==""&&i[e]!==void 0)return i[e]}function $4(n,e){const{selectorText:t}=e;let r=!1;return e.type===CSSRule.STYLE_RULE&&t&&(n.msMatchesSelector?r=n.msMatchesSelector(t):n.matches&&(r=n.matches(t))),r}function ra(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return n.currentStyle||e.getComputedStyle(n)}function rn(n){return n.offsetWidth}function Dn(n){return n.offsetHeight}function ch(n){return n.clientHeight||n.innerHeight}function BM(n){return n.clientWidth||n.innerWidth}function G4(n,e,t){n.addEventListener(e,t,!1)}function j4(n,e,t){n.removeEventListener(e,t,!1)}function WM(n){return n.selectionStart?n.selectionStart:0}function KV(n){return n.selectionEnd?n.selectionEnd:0}function z4(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;const e=n.document;let t="";return n.getSelection?t=n.getSelection().toString():e.selection&&e.selection.type!=="Control"&&(t=e.selection.createRange().text),t}function OA(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;n.getSelection&&(n.getSelection().empty?n.getSelection().empty():n.getSelection().removeAllRanges&&n.getSelection().removeAllRanges())}function Ng(n,e,t){if(t===void 0&&(t=e),n.setSelectionRange){n.focus();try{n.setSelectionRange(e,t)}catch{const i=n.parentNode,s=i.style.display;i.style.display="block",n.setSelectionRange(e,t),i.style.display=s}}}let kE;function Y4(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=n.createElement("div");e.style.height="200px",e.style.width="100%";const t=n.createElement("div");t.style.boxSizing="content-box",t.style.height="150px",t.style.left="0px",t.style.overflow="hidden",t.style.position="absolute",t.style.top="0px",t.style.width="200px",t.style.visibility="hidden",t.appendChild(e),(n.body||n.documentElement).appendChild(t);const r=e.offsetWidth;t.style.overflow="scroll";let i=e.offsetWidth;return r===i&&(i=t.clientWidth),(n.body||n.documentElement).removeChild(t),r-i}function or(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return kE===void 0&&(kE=Y4(n)),kE}function qV(n){return n.offsetWidth!==n.clientWidth}function XV(n){return n.offsetHeight!==n.clientHeight}function EC(n,e,t){n.style.transform=`translate3d(${e},${t},0)`}function K4(n){let e;return n.style.transform&&(e=n.style.transform)!==""?["transform",e]:-1}function Mg(n){n.style.transform&&n.style.transform!==""&&(n.style.transform="")}function lm(n){return n&&(["INPUT","SELECT","TEXTAREA"].indexOf(n.nodeName)>-1||n.contentEditable==="true")}function bC(n){return lm(n)&&n.hasAttribute("data-hot-input")===!1}function q4(n){const e=n.ownerDocument.activeElement;bC(e)||n.select()}function $M(n){return!n.parentNode}function QV(n,e){new IntersectionObserver((r,i)=>{r.forEach(s=>{s.isIntersecting&&n.offsetParent!==null&&(e(),i.unobserve(n))})},{root:n.ownerDocument.body}).observe(n)}function GM(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=n.ownerDocument,i=r.createRange(),s=r.defaultView.getSelection();Ge(n,"contenteditable",!0),t&&Ge(n,...$h()),e&&ie(n,"invisibleSelection"),i.selectNodeContents(n),s.removeAllRanges(),s.addRange(i)}function jM(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const t=n.ownerDocument.defaultView.getSelection();n.hasAttribute("aria-hidden")&&n.removeAttribute("aria-hidden"),t.removeAllRanges(),e&&Xe(n,"invisibleSelection"),n.removeAttribute("contenteditable")}function ZV(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;GM(n,t),e(),jM(n,t)}const X4=Object.freeze(Object.defineProperty({__proto__:null,HTML_CHARACTERS:jV,addClass:ie,addEvent:G4,clearTextSelection:OA,closest:nu,closestDown:Kf,empty:so,fastInnerHTML:jh,fastInnerText:ru,getCaretPosition:WM,getComputedStyle:ra,getCssTransform:K4,getFrameElement:BV,getMaximumScrollLeft:YV,getMaximumScrollTop:zV,getParent:VV,getParentWindow:Eh,getScrollLeft:UM,getScrollTop:RC,getScrollableElement:$m,getScrollbarWidth:or,getSelectionEndPosition:KV,getSelectionText:z4,getStyle:vd,getTrimmingContainer:Th,getWindowScrollLeft:SC,getWindowScrollTop:VM,hasAccessToParentWindow:W4,hasClass:je,hasHorizontalScrollbar:XV,hasVerticalScrollbar:qV,index:WV,innerHeight:ch,innerWidth:BM,isChildOf:ql,isDetached:$M,isInput:lm,isOutsideInput:bC,isThisHotChild:UV,isVisible:bh,makeElementContentEditableAndSelectItsContent:GM,matchesCSSRules:$4,observeVisibilityChangeOnce:QV,offset:ir,outerHeight:Dn,outerWidth:rn,overlayContainsElement:bl,removeAttribute:Gh,removeClass:Xe,removeContentEditableFromElementAndDeselect:jM,removeEvent:j4,removeTextNodes:kM,resetCssTransform:Mg,runWithSelectedContendEditableElement:ZV,selectElementIfAllowed:q4,setAttribute:Ge,setCaretPosition:Ng,setOverlayPosition:EC},Symbol.toStringTag,{value:"Module"}));function Jt(n){return typeof n=="function"}function JV(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,t=0;const r={lastCallThrottled:!0};let i=null;function s(){for(var o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];const u=Date.now();let h=!1;r.lastCallThrottled=!0,t||(t=u,h=!0);const c=e-(u-t);return h?(r.lastCallThrottled=!1,n.apply(this,a)):(i&&clearTimeout(i),i=setTimeout(()=>{r.lastCallThrottled=!1,n.apply(this,a),t=0,i=void 0},c)),r}return s}function Q4(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10;const r=JV(n,e);let i=t;function s(){i=t}function o(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return i?(i-=1,n.apply(this,l)):r.apply(this,l)}return o.clearHits=s,o}function TC(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,t=null,r;function i(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return t&&clearTimeout(t),t=setTimeout(()=>{r=n.apply(this,o)},e),r}return i}function Z4(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];const[r,...i]=e;return function(){for(var o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];return jn(i,(u,h)=>h(u),r.apply(this,a))}}function zM(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];return function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return n.apply(this,t.concat(o))}}function eU(n){const e=n.length;function t(r){return function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];const l=r.concat(o);let u;return l.length>=e?u=n.apply(this,l):u=t(l),u}}return t([])}function J4(n){const e=n.length;function t(r){return function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];const l=r.concat(o.reverse());let u;return l.length>=e?u=n.apply(this,l):u=t(l),u}}return t([])}function Vv(n,e,t,r,i,s,o,a){return Ne(a)?n.call(e,t,r,i,s,o,a):Ne(o)?n.call(e,t,r,i,s,o):Ne(s)?n.call(e,t,r,i,s):Ne(i)?n.call(e,t,r,i):Ne(r)?n.call(e,t,r):Ne(t)?n.call(e,t):n.call(e)}const e6=Object.freeze(Object.defineProperty({__proto__:null,curry:eU,curryRight:J4,debounce:TC,fastCall:Vv,isFunction:Jt,partial:zM,pipe:Z4,throttle:JV,throttleAfterHits:Q4},Symbol.toStringTag,{value:"Module"}));var y1={},VE,C1;function t6(){if(C1)return VE;C1=1;var n=bs(),e=Ck().get;return VE=function(r){if(!n(r))return!1;var i=e(r);return!!i&&i.type==="RawJSON"},VE}var UE,S1;function n6(){if(S1)return UE;S1=1;var n=qn(),e=uo(),t=SyntaxError,r=parseInt,i=String.fromCharCode,s=n("".charAt),o=n("".slice),a=n(/./.exec),l={'\\"':'"',"\\\\":"\\","\\/":"/","\\b":"\b","\\f":"\f","\\n":`
`,"\\r":"\r","\\t":"	"},u=/^[\da-f]{4}$/i,h=/^[\u0000-\u001F]$/;return UE=function(c,d){for(var f=!0,g="";d<c.length;){var p=s(c,d);if(p==="\\"){var v=o(c,d,d+2);if(e(l,v))g+=l[v],d+=2;else if(v==="\\u"){d+=2;var y=o(c,d,d+4);if(!a(u,y))throw new t("Bad Unicode escape at: "+d);g+=i(r(y,16)),d+=4}else throw new t('Unknown escape sequence: "'+v+'"')}else if(p==='"'){f=!1,d++;break}else{if(a(h,p))throw new t("Bad control character in string literal at: "+d);g+=p,d++}}if(f)throw new t("Unterminated string at: "+d);return{value:g,end:d}},UE}var BE,R1;function r6(){if(R1)return BE;R1=1;var n=Mr();return BE=!n(function(){var e="9007199254740993",t=JSON.rawJSON(e);return!JSON.isRawJSON(t)||JSON.stringify(t)!==e}),BE}var E1;function i6(){if(E1)return y1;E1=1;var n=Ir(),e=Nd(),t=oC(),r=lo(),i=qn(),s=Mr(),o=Ak(),a=jr(),l=t6(),u=JN(),h=Dh(),c=aC(),d=uM(),f=n6(),g=rM(),p=ZN(),v=r6(),y=String,S=e("JSON","stringify"),R=i(/./.exec),A=i("".charAt),O=i("".charCodeAt),V=i("".replace),B=i("".slice),Y=i([].push),q=i(1.1.toString),G=/[\uD800-\uDFFF]/g,Z=/^[\uD800-\uDBFF]$/,ee=/^[\uDC00-\uDFFF]$/,ne=g(),re=ne.length,ae=!p||s(function(){var We=e("Symbol")("stringify detection");return S([We])!=="[null]"||S({a:We})!=="{}"||S(Object(We))!=="{}"}),ze=s(function(){return S("\uDF06\uD834")!=='"\\udf06\\ud834"'||S("\uDEAD")!=='"\\udead"'}),Le=ae?function(We,w){var C=d(arguments),b=ye(w);if(!(!a(b)&&(We===void 0||u(We))))return C[1]=function(P,H){if(a(b)&&(H=r(b,this,y(P),H)),!u(H))return H},t(S,null,C)}:S,Se=function(We,w,C){var b=A(C,w-1),P=A(C,w+1);return R(Z,We)&&!R(ee,P)||R(ee,We)&&!R(Z,b)?"\\u"+q(O(We,0),16):We},ye=function(We){if(a(We))return We;if(o(We)){for(var w=We.length,C=[],b=0;b<w;b++){var P=We[b];typeof P=="string"?Y(C,P):(typeof P=="number"||h(P)==="Number"||h(P)==="String")&&Y(C,c(P))}var H=C.length,W=!0;return function(J,te){if(W)return W=!1,te;if(o(this))return te;for(var ce=0;ce<H;ce++)if(C[ce]===J)return te}}};return S&&n({target:"JSON",stat:!0,arity:3,forced:ae||ze||!v},{stringify:function(w,C,b){var P=ye(C),H=[],W=Le(w,function($e,X){var Ze=a(P)?r(P,this,y($e),X):X;return!v&&l(Ze)?ne+(Y(H,Ze.rawJSON)-1):Ze},b);if(typeof W!="string"||(ze&&(W=V(W,G,Se)),v))return W;for(var J="",te=W.length,ce=0;ce<te;ce++){var ge=A(W,ce);if(ge==='"'){var oe=f(W,++ce).end-1,Ue=B(W,ce,oe);J+=B(Ue,0,re)===ne?H[B(Ue,re)]:'"'+Ue+'"',ce=oe}else J+=ge}return J}}),y1}i6();function yd(n){let e;return Array.isArray(n)?e=n.length?new Array(n.length).fill(null):[]:(e={},at(n,(t,r)=>{r!=="__children"&&(t&&typeof t=="object"&&!Array.isArray(t)?e[r]=yd(t):Array.isArray(t)?t.length&&typeof t[0]=="object"&&!Array.isArray(t[0])?e[r]=[yd(t[0])]:e[r]=[]:e[r]=null)})),e}function co(n,e){return e.prototype.constructor=e,n.prototype=new e,n.prototype.constructor=n,n}function Gn(n,e,t){const r=Array.isArray(t);return at(e,(i,s)=>{(r===!1||t.includes(s))&&(n[s]=i)}),n}function Ig(n,e){at(e,(t,r)=>{e[r]&&typeof e[r]=="object"?(n[r]||(Array.isArray(e[r])?n[r]=[]:Object.prototype.toString.call(e[r])==="[object Date]"?n[r]=e[r]:n[r]={}),Ig(n[r],e[r])):n[r]=e[r]})}function Gr(n){return typeof n=="object"?JSON.parse(JSON.stringify(n)):n}function oo(n){const e={};return at(n,(t,r)=>{e[r]=t}),e}function Wt(n){n.MIXINS||(n.MIXINS=[]);for(var e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];return L(t,i=>{n.MIXINS.push(i.MIXIN_NAME),at(i,(s,o)=>{if(n.prototype[o]!==void 0)throw new Error(`Mixin conflict. Property '${o}' already exist and cannot be overwritten.`);if(typeof s=="function")n.prototype[o]=s;else{const a=function(h,c){const d=`_${h}`,f=g=>{let p=g;return(Array.isArray(p)||ot(p))&&(p=Gr(p)),p};return function(){return this[d]===void 0&&(this[d]=f(c)),this[d]}},l=function(h){const c=`_${h}`;return function(d){this[c]=d}};Object.defineProperty(n.prototype,o,{get:a(o,s),set:l(o),configurable:!0})}})}),n}function AC(n,e){return JSON.stringify(n)===JSON.stringify(e)}function ot(n){return Object.prototype.toString.call(n)==="[object Object]"}function ua(n,e,t,r){r.value=t,r.writable=r.writable!==!1,r.enumerable=r.enumerable!==!1,r.configurable=r.configurable!==!1,Object.defineProperty(n,e,r)}function at(n,e){for(const t in n)if((!n.hasOwnProperty||n.hasOwnProperty&&Object.prototype.hasOwnProperty.call(n,t))&&e(n[t],t,n)===!1)break;return n}function tU(n,e){const t=e.split(".");let r=n;return at(t,i=>{if(r=r[i],r===void 0)return r=void 0,!1}),r}function Jw(n,e,t){const r=e.split(".");let i=n;r.forEach((s,o)=>{o!==r.length-1?(pn(i,s)||(i[s]={}),i=i[s]):i[s]=t})}function NC(n){if(!ot(n))return 0;const e=function(t){let r=0;return ot(t)?at(t,(i,s)=>{s!=="__children"&&(r+=e(i))}):r+=1,r};return e(n)}function fs(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const t=`_${e}`,r={_touched:!1,[t]:n,isTouched(){return this._touched}};return Object.defineProperty(r,e,{get(){return this[t]},set(i){this._touched=!0,this[t]=i},enumerable:!0,configurable:!0}),r}function pn(n,e){return Object.prototype.hasOwnProperty.call(n,e)}const s6=Object.freeze(Object.defineProperty({__proto__:null,clone:oo,createObjectPropListener:fs,deepClone:Gr,deepExtend:Ig,deepObjectSize:NC,defineGetter:ua,duckSchema:yd,extend:Gn,getProperty:tU,hasOwnProperty:pn,inherit:co,isObject:ot,isObjectEqual:AC,mixin:Wt,objectEach:at,setProperty:Jw},Symbol.toStringTag,{value:"Module"}));function MC(n){return window.requestAnimationFrame(n)}function Gm(n){window.cancelAnimationFrame(n)}function YM(){return"ontouchstart"in window}function nU(){return typeof window<"u"}let Zh;function rU(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Zh||(typeof Intl=="object"?Zh=new Intl.Collator(n,e).compare:typeof String.prototype.localeCompare=="function"?Zh=(t,r)=>`${t}`.localeCompare(r):Zh=(t,r)=>t===r?0:t>r?-1:1,Zh)}const o6=Object.freeze(Object.defineProperty({__proto__:null,cancelAnimationFrame:Gm,getComparisonFunction:rU,isCSR:nU,isTouchSupported:YM,requestAnimationFrame:MC},Symbol.toStringTag,{value:"Module"})),is=n=>{const e={value:!1};return e.test=(t,r)=>{e.value=n(t,r)},e},sl={chrome:is((n,e)=>/Chrome/.test(n)&&/Google/.test(e)),chromeWebKit:is(n=>/CriOS/.test(n)),edge:is(n=>/Edge/.test(n)),edgeWebKit:is(n=>/EdgiOS/.test(n)),firefox:is(n=>/Firefox/.test(n)),firefoxWebKit:is(n=>/FxiOS/.test(n)),mobile:is(n=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(n)),safari:is((n,e)=>/Safari/.test(n)&&/Apple Computer/.test(e))},Pd={mac:is(n=>/^Mac/.test(n)),win:is(n=>/^Win/.test(n)),linux:is(n=>/^Linux/.test(n)),ios:is(n=>/iPhone|iPad|iPod/i.test(n))};function iU(){let{userAgent:n=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};at(sl,t=>{let{test:r}=t;return void r(n,e)})}function sU(){let{platform:n=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};at(Pd,e=>{let{test:t}=e;return void t(n)})}nU()&&(iU(),sU());function KM(){return sl.chrome.value}function oU(){return sl.chromeWebKit.value}function ev(){return sl.firefox.value}function aU(){return sl.firefoxWebKit.value}function qM(){return sl.safari.value}function lU(){return sl.edge.value}function a6(){return sl.edgeWebKit.value}function Ba(){return sl.mobile.value}function XM(){return Pd.ios.value}function QM(){let{maxTouchPoints:n}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return n>2&&Pd.mac.value}function _A(){return Pd.win.value}function jm(){return Pd.mac.value}function l6(){return Pd.linux.value}const u6=Object.freeze(Object.defineProperty({__proto__:null,isChrome:KM,isChromeWebKit:oU,isEdge:lU,isEdgeWebKit:a6,isFirefox:ev,isFirefoxWebKit:aU,isIOS:XM,isIpadOS:QM,isLinuxOS:l6,isMacOS:jm,isMobileBrowser:Ba,isSafari:qM,isWindowsOS:_A,setBrowserMeta:iU,setPlatformMeta:sU},Symbol.toStringTag,{value:"Module"})),Oe={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:ev()?182:174,AUDIO_MUTE:ev()?181:173,AUDIO_UP:ev()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},h6=[Oe.ALT,Oe.ARROW_DOWN,Oe.ARROW_LEFT,Oe.ARROW_RIGHT,Oe.ARROW_UP,Oe.AUDIO_DOWN,Oe.AUDIO_MUTE,Oe.AUDIO_UP,Oe.BACKSPACE,Oe.CAPS_LOCK,Oe.DELETE,Oe.END,Oe.ENTER,Oe.ESCAPE,Oe.F1,Oe.F2,Oe.F3,Oe.F4,Oe.F5,Oe.F6,Oe.F7,Oe.F8,Oe.F9,Oe.F10,Oe.F11,Oe.F12,Oe.F13,Oe.F14,Oe.F15,Oe.F16,Oe.F17,Oe.F18,Oe.F19,Oe.HOME,Oe.INSERT,Oe.MEDIA_NEXT,Oe.MEDIA_PLAY_PAUSE,Oe.MEDIA_PREV,Oe.MEDIA_STOP,Oe.NULL,Oe.NUM_LOCK,Oe.PAGE_DOWN,Oe.PAGE_UP,Oe.PAUSE,Oe.SCROLL_LOCK,Oe.SHIFT,Oe.TAB];function uU(n){return n===32||n>=48&&n<=57||n>=96&&n<=111||n>=186&&n<=192||n>=219&&n<=222||n>=226||n>=65&&n<=90}function ZM(n){return h6.includes(n)}function c6(n){const e=[];return jm()?e.push(Oe.COMMAND_LEFT,Oe.COMMAND_RIGHT,Oe.COMMAND_FIREFOX):e.push(Oe.CONTROL),e.includes(n)}function hU(n){return[Oe.CONTROL,Oe.COMMAND_LEFT,Oe.COMMAND_RIGHT,Oe.COMMAND_FIREFOX].includes(n)}function xd(n,e){const t=e.split("|");let r=!1;return L(t,i=>{if(n===Oe[i])return r=!0,!1}),r}const d6=Object.freeze(Object.defineProperty({__proto__:null,KEY_CODES:Oe,isCtrlKey:c6,isCtrlMetaKey:hU,isFunctionKey:ZM,isKey:xd,isPrintableChar:uU},Symbol.toStringTag,{value:"Module"}));function Ns(n){n.isImmediatePropagationEnabled=!1,n.cancelBubble=!0}function Hl(n){return n.isImmediatePropagationEnabled===!1}function iu(n){return n.button===2}function IC(n){return n.button===0}function cU(n){return n instanceof TouchEvent}function dU(n,e){const t={x:n.offsetX,y:n.offsetY};let r=n.target;if(!(e instanceof HTMLElement)||r!==e&&r.contains(e))return t;for(;r!==e;)t.x+=r.offsetLeft,t.y+=r.offsetTop,r=r.offsetParent;return t}const f6=Object.freeze(Object.defineProperty({__proto__:null,isImmediatePropagationStopped:Hl,isLeftClick:IC,isRightClick:iu,isTouchEvent:cU,offsetRelativeTo:dU,stopImmediatePropagation:Ns},Symbol.toStringTag,{value:"Module"}));var b1={},WE={},$E,T1;function m6(){if(T1)return $E;T1=1;var n=Sk(),e=oM();return $E=Object.keys||function(r){return n(r,e)},$E}var A1;function g6(){if(A1)return WE;A1=1;var n=ao(),e=vk(),t=Fh(),r=nl(),i=tC(),s=m6();return WE.f=n&&!e?Object.defineProperties:function(a,l){r(a);for(var u=i(l),h=s(l),c=h.length,d=0,f;c>d;)t.f(a,f=h[d++],u[f]);return a},WE}var GE,N1;function p6(){if(N1)return GE;N1=1;var n=nl(),e=g6(),t=oM(),r=sM(),i=_k(),s=iM(),o=yk(),a=">",l="<",u="prototype",h="script",c=o("IE_PROTO"),d=function(){},f=function(S){return l+h+a+S+l+"/"+h+a},g=function(S){S.write(f("")),S.close();var R=S.parentWindow.Object;return S=null,R},p=function(){var S=s("iframe"),R="java"+h+":",A;return S.style.display="none",i.appendChild(S),S.src=String(R),A=S.contentWindow.document,A.open(),A.write(f("document.F=Object")),A.close(),A.F},v,y=function(){try{v=new ActiveXObject("htmlfile")}catch{}y=typeof document<"u"?document.domain&&v?g(v):p():g(v);for(var S=t.length;S--;)delete y[u][t[S]];return y()};return r[c]=!0,GE=Object.create||function(R,A){var O;return R!==null?(d[u]=n(R),O=new d,d[u]=null,O[c]=R):O=y(),A===void 0?O:e.f(O,A)},GE}var jE,M1;function JM(){if(M1)return jE;M1=1;var n=lu(),e=p6(),t=Fh().f,r=n("unscopables"),i=Array.prototype;return i[r]===void 0&&t(i,r,{configurable:!0,value:e(null)}),jE=function(s){i[r][s]=!0},jE}var I1;function w6(){if(I1)return b1;I1=1;var n=JM();return n("flatMap"),b1}w6();function Ut(){Ne(console)&&console.warn(...arguments)}function e0(){Ne(console)&&console.error(...arguments)}function v6(n,e,t){return(e=y6(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function y6(n){var e=C6(n,"string");return typeof e=="symbol"?e:e+""}function C6(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const Jh=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],S6=Bt`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`,zE=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),YE=new Map([[]]),np=new WeakMap;class be{static getSingleton(){return E6()}constructor(){v6(this,"globalBucket",void 0),this.globalBucket=this.createEmptyBucket()}createEmptyBucket(){const e=Object.create(null);return L(Jh,t=>{e[t]=[],this.initOrderMap(e,t)}),e}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=this.createEmptyBucket()),e.pluginHookBucket):this.globalBucket}add(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;if(Array.isArray(t))L(t,s=>this.add(e,s,r));else{zE.has(e)&&Ut(HM(S6,{hookName:e,removedInVersion:zE.get(e)})),YE.has(e)&&Ut(YE.get(e));const s=this.getBucket(r);if(typeof s[e]>"u"&&(this.register(e),s[e]=[],this.initOrderMap(s,e)),t.skip=!1,s[e].indexOf(t)===-1){let o=!1;t.initialHook&&L(s[e],(a,l)=>{if(a.initialHook)return s[e][l]=t,o=!0,!1}),o||s[e].push(t)}this.setCallbackOrderIndex(s,e,t,i),this.orderBucketByOrderIndex(s,e)}return this}once(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;Array.isArray(t)?L(t,s=>this.once(e,s,r)):(t.runOnce=!0,this.add(e,t,r,i))}remove(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;const i=this.getBucket(r);return typeof i[e]<"u"&&i[e].indexOf(t)>=0?(t.skip=!0,!0):!1}has(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const r=this.getBucket(t);return!!(r[e]!==void 0&&r[e].length)}run(e,t,r,i,s,o,a,l){{const u=this.globalBucket[t],h=u?u.length:0;let c=0;if(h)for(;c<h;){if(!u[c]||u[c].skip){c+=1;continue}const d=Vv(u[c],e,r,i,s,o,a,l);d!==void 0&&(r=d),u[c]&&u[c].runOnce&&this.remove(t,u[c]),c+=1}}{const u=this.getBucket(e)[t],h=u?u.length:0;let c=0;if(h)for(;c<h;){if(!u[c]||u[c].skip){c+=1;continue}const d=Vv(u[c],e,r,i,s,o,a,l);d!==void 0&&(r=d),u[c]&&u[c].runOnce&&this.remove(t,u[c],e),c+=1}}return r}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;at(this.getBucket(e),(t,r,i)=>i[r].length=0)}register(e){this.isRegistered(e)||Jh.push(e)}deregister(e){this.isRegistered(e)&&Jh.splice(Jh.indexOf(e),1)}isDeprecated(e){return YE.has(e)||zE.has(e)}isRegistered(e){return Jh.indexOf(e)>=0}getRegistered(){return Jh}setCallbackOrderIndex(e,t,r,i){const s=Number.isInteger(i)?i:0,o=this.getCallbackOrderMap(e,t);o.set(s,[...o.get(s)||[],r])}orderBucketByOrderIndex(e,t){const r=this.getCallbackOrderMap(e,t);r===void 0||r.size===0||r.size===1&&r.has(0)||(e[t]=[...r].sort((i,s)=>i[0]-s[0]).flatMap(i=>{let[,s]=i;return s}))}initOrderMap(e,t){np.has(e)||np.set(e,[]),np.get(e)[t]=new Map}getCallbackOrderMap(e,t){return np.get(e)[t]}}const R6=new be;function E6(){return R6}const KE=new Map;function fo(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";KE.has(n)||KE.set(n,new Map);const e=KE.get(n);function t(a,l){e.set(a,l)}function r(a){return e.get(a)}function i(a){return e.has(a)}function s(){return[...e.keys()]}function o(){return[...e.values()]}return{register:t,getItem:r,hasItem:i,getNames:s,getValues:o}}const PA=new WeakMap,{register:b6,getItem:fU,hasItem:mU,getNames:T6,getValues:fye}=fo("editors");function A6(n){const e={},t=n;this.getConstructor=function(){return n},this.getInstance=function(r){return r.guid in e||(e[r.guid]=new t(r)),e[r.guid]},be.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function gU(n,e){let t;if(typeof n=="function")PA.get(n)||fi(null,n),t=PA.get(n);else if(typeof n=="string")t=fU(n);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!t)throw Error(`No editor registered under name "${n}"`);return t.getInstance(e)}function Uv(n){if(typeof n=="function")return n;if(!mU(n))throw Error(`No registered editor found under "${n}" name`);return fU(n).getConstructor()}function fi(n,e){n&&typeof n!="string"&&(e=n,n=e.EDITOR_TYPE);const t=new A6(e);typeof n=="string"&&b6(n,t),PA.set(e,t)}function N6(n,e,t){return(e=M6(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function M6(n){var e=I6(n,"string");return typeof e=="symbol"?e:e+""}function I6(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}let tv=0;class ys{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;N6(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,t,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function s(o){r.call(this,O6(o))}return this.context.eventListeners.push({element:e,event:t,callback:r,callbackProxy:s,options:i,eventManager:this}),e.addEventListener(t,s,i),tv+=1,()=>{this.removeEventListener(e,t,r)}}removeEventListener(e,t,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,s=this.context.eventListeners.length,o;for(;s;)if(s-=1,o=this.context.eventListeners[s],o.event===t&&o.element===e){if(r&&r!==o.callback||i&&o.eventManager!==this)continue;this.context.eventListeners.splice(s,1),o.element.removeEventListener(o.event,o.callbackProxy,o.options),tv-=1}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let t=this.context.eventListeners.length;for(;t;){t-=1;const r=this.context.eventListeners[t];e&&r.eventManager!==this||(this.context.eventListeners.splice(t,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options),tv-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,t){let r=e.document,i=e;r||(r=e.ownerDocument?e.ownerDocument:e,i=r.defaultView);const s={bubbles:!0,cancelable:t!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0};let o;r.createEvent?(o=r.createEvent("MouseEvents"),o.initMouseEvent(t,s.bubbles,s.cancelable,s.view,s.detail,s.screenX,s.screenY,s.clientX,s.clientY,s.ctrlKey,s.altKey,s.shiftKey,s.metaKey,s.button,r.body.parentNode)):o=r.createEventObject(),e.dispatchEvent?e.dispatchEvent(o):e.fireEvent(`on${t}`,o)}}function O6(n){const e=n.stopImmediatePropagation;return n.stopImmediatePropagation=function(){e.apply(this),Ns(this)},n}function _6(){return tv}function P6(n,e){x6(n,e),e.add(n)}function x6(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vu(n,e,t){return(e=L6(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function L6(n){var e=H6(n,"string");return typeof e=="symbol"?e:e+""}function H6(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function O1(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var qE=new WeakSet;class xA{constructor(e,t,r){P6(this,qE),vu(this,"hot",void 0),vu(this,"tableMeta",void 0),vu(this,"selection",void 0),vu(this,"eventManager",void 0),vu(this,"destroyed",!1),vu(this,"activeEditor",void 0),vu(this,"cellProperties",void 0),this.hot=e,this.tableMeta=t,this.selection=r,this.eventManager=new ys(e),this.hot.addHook("afterDocumentKeyDown",i=>O1(qE,this,D6).call(this,i)),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"compositionstart",i=>{!this.destroyed&&this.hot.isListening()&&this.openEditor("",i)}),this.hot.view._wt.update("onCellDblClick",(i,s,o)=>O1(qE,this,F6).call(this,i,s,o))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,u=>{u&&this.prepareEditor()});return}const t=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!t||t.isHeader())return;const{row:r,col:i}=t,s=this.hot.runHooks("modifyGetCellCoords",r,i);let o=r,a=i;if(Array.isArray(s)&&([o,a]=s),this.cellProperties=this.hot.getCellMeta(o,a),!this.isCellEditable()){this.clearActiveEditor();return}const l=this.hot.getCell(r,i,!0);if(l){const u=this.hot.getCellEditor(this.cellProperties),h=this.hot.colToProp(a),c=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(o),a);this.activeEditor=gU(u,this.hot),this.activeEditor.prepare(r,i,h,l,c,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const i=this.hot.getSelectedRangeLast();let s=this.hot.runHooks("beforeBeginEditing",i.highlight.row,i.highlight.col,e,t,r);if(t instanceof MouseEvent&&typeof s!="boolean"&&(s=this.hot.selection.getLayerLevel()===0&&i.isSingle()),s===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(r&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,t))}closeEditor(e,t,r){this.activeEditor?this.activeEditor.finishEditing(e,t,r):r&&r(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const t=this.hot.getCellEditor(this.cellProperties),{row:r,col:i}=e.highlight,{rowIndexMapper:s,columnIndexMapper:o}=this.hot,a=s.isHidden(this.hot.toPhysicalRow(r))||o.isHidden(this.hot.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!t||a)}moveSelectionAfterEnter(e){const t={...typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(t.row=-t.row,t.col=-t.col),this.hot.selection.isMultiple()?this.selection.transformFocus(t.row,t.col):this.selection.transformStart(t.row,t.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function D6(n){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||Hl(n))return;const{keyCode:t}=n,r=(n.ctrlKey||n.metaKey)&&!n.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!ZM(t)&&!hU(t)&&!r&&!this.isEditorOpened()&&this.openEditor("",n)}function F6(n,e){e.isCell()&&this.openEditor(null,n,!0)}const _1=new WeakMap;xA.getInstance=function(n,e,t){let r=_1.get(n);return r||(r=new xA(n,e,t),_1.set(n,r)),r};function k6(n,e){pU(n,e),e.add(n)}function Kd(n,e,t){pU(n,e),e.set(n,t)}function pU(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dn(n,e){return n.get(ka(n,e))}function qd(n,e,t){return n.set(ka(n,e),t),t}function ka(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const ad=Object.freeze({CELL:"cell",MIXED:"mixed"});var dr=new WeakMap,rp=new WeakMap,ip=new WeakMap,sp=new WeakMap,op=new WeakMap,Al=new WeakSet;class V6{constructor(e){var t=this;k6(this,Al),Kd(this,dr,void 0),Kd(this,rp,void 0),Kd(this,ip,1),Kd(this,sp,null),Kd(this,op,new Map);const r=e.getSettings();qd(dr,this,e),qd(rp,this,r.imeFastEdit?ad.MIXED:ad.CELL),dn(dr,this).addHook("afterUpdateSettings",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return ka(Al,t,B6).call(t,...s)}),dn(dr,this).addHook("afterSelection",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return ka(Al,t,P1).call(t,...s)}),dn(dr,this).addHook("afterSelectionFocusSet",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return ka(Al,t,P1).call(t,...s)}),dn(dr,this).addHook("afterSelectionEnd",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return ka(Al,t,U6).call(t,...s)})}getFocusMode(){return dn(rp,this)}setFocusMode(e){Object.values(ad).includes(e)?qd(rp,this,e):Ut(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return dn(ip,this)}setRefocusDelay(e){qd(ip,this,e)}setRefocusElementGetter(e){qd(sp,this,e)}getRefocusElement(){if(typeof dn(sp,this)=="function")return dn(sp,this).call(this);var e;return(e=dn(dr,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const t=r=>{var i,s;const o=(i=dn(dr,this).getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;if(!o)return;let a=dn(dr,this).runHooks("modifyFocusedElement",o.row,o.col,r);a instanceof HTMLElement||(a=r),a&&!((s=dn(dr,this).getActiveEditor())!==null&&s!==void 0&&s.isOpened())&&a.focus({preventScroll:!0})};e?t(e):ka(Al,this,t0).call(this,r=>t(r))}refocusToEditorTextarea(){var e;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:dn(ip,this);const r=this.getRefocusElement();dn(dr,this).getSettings().imeFastEdit&&!((e=dn(dr,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())&&r&&(dn(op,this).has(t)||dn(op,this).set(t,TC(()=>{r.select()},t)),dn(op,this).get(t)())}}function t0(n){var e;const t=(e=dn(dr,this).getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!t||!dn(dr,this).selection.isCellVisible(t)){n(null);return}const r=dn(dr,this).getCell(t.row,t.col,!0);r===null?dn(dr,this).addHookOnce("afterScroll",()=>{n(dn(dr,this).getCell(t.row,t.col,!0))}):n(r)}function P1(){ka(Al,this,t0).call(this,n=>{const{activeElement:e}=dn(dr,this).rootDocument;e&&bC(e)&&e.blur(),this.focusOnHighlightedCell(n)})}function U6(){ka(Al,this,t0).call(this,n=>{this.getFocusMode()===ad.MIXED&&n.nodeName==="TD"&&this.refocusToEditorTextarea()})}function B6(n){typeof n.imeFastEdit=="boolean"&&this.setFocusMode(n.imeFastEdit?ad.MIXED:ad.CELL)}var x1={},XE,L1;function W6(){if(L1)return XE;L1=1;var n=bs(),e=Dh(),t=lu(),r=t("match");return XE=function(i){var s;return n(i)&&((s=i[r])!==void 0?!!s:e(i)==="RegExp")},XE}var QE,H1;function $6(){if(H1)return QE;H1=1;var n=yr(),e=Mr(),t=n.RegExp,r=!e(function(){var i=!0;try{t(".","d")}catch{i=!1}var s={},o="",a=i?"dgimsy":"gimsy",l=function(d,f){Object.defineProperty(s,d,{get:function(){return o+=f,!0}})},u={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};i&&(u.hasIndices="d");for(var h in u)l(h,u[h]);var c=Object.getOwnPropertyDescriptor(t.prototype,"flags").get.call(s);return c!==a||o!==a});return QE={correct:r},QE}var ZE,D1;function G6(){if(D1)return ZE;D1=1;var n=nl();return ZE=function(){var e=n(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t},ZE}var JE,F1;function j6(){if(F1)return JE;F1=1;var n=lo(),e=uo(),t=nC(),r=$6(),i=G6(),s=RegExp.prototype;return JE=r.correct?function(o){return o.flags}:function(o){return!r.correct&&t(s,o)&&!e(o,"flags")?n(i,o):o.flags},JE}var eb,k1;function z6(){if(k1)return eb;k1=1;var n=qn(),e=wg(),t=Math.floor,r=n("".charAt),i=n("".replace),s=n("".slice),o=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,a=/\$([$&'`]|\d{1,2})/g;return eb=function(l,u,h,c,d,f){var g=h+l.length,p=c.length,v=a;return d!==void 0&&(d=e(d),v=o),i(f,v,function(y,S){var R;switch(r(S,0)){case"$":return"$";case"&":return l;case"`":return s(u,0,h);case"'":return s(u,g);case"<":R=d[s(S,1,-1)];break;default:var A=+S;if(A===0)return y;if(A>p){var O=t(A/10);return O===0?y:O<=p?c[O-1]===void 0?r(S,1):c[O-1]+r(S,1):y}R=c[A-1]}return R===void 0?"":R})},eb}var V1;function Y6(){if(V1)return x1;V1=1;var n=Ir(),e=lo(),t=qn(),r=gg(),i=jr(),s=bs(),o=W6(),a=aC(),l=sC(),u=j6(),h=z6(),c=lu(),d=eM(),f=c("replace"),g=TypeError,p=t("".indexOf),v=t("".replace),y=t("".slice),S=Math.max;return n({target:"String",proto:!0},{replaceAll:function(A,O){var V=r(this),B,Y,q,G,Z,ee,ne,re,ae,ze,Le=0,Se="";if(s(A)){if(B=o(A),B&&(Y=a(r(u(A))),!~p(Y,"g")))throw new g("`.replaceAll` does not allow non-global regexes");if(q=l(A,f),q)return e(q,A,V,O);if(d&&B)return v(a(V),A,O)}for(G=a(V),Z=a(A),ee=i(O),ee||(O=a(O)),ne=Z.length,re=S(1,ne),ae=p(G,Z);ae!==-1;)ze=ee?a(O(Z,ae,G)):h(Z,G,ae,[],void 0,O),Se+=y(G,Le,ae)+ze,Le=ae+ne,ae=ae+re>G.length?-1:p(G,Z,ae+re);return Le<G.length&&(Se+=y(G,Le)),Se}}),x1}Y6();const wU={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},K6=new RegExp(Object.keys(wU).map(n=>`(${n})`).join("|"),"gi");function q6(n){return(n&&n.nodeName||"")==="TABLE"}function LA(n){const e=n.hasColHeaders(),t=n.hasRowHeaders(),r=[e?-1:0,t?-1:0,n.countRows()-1,n.countCols()-1],i=n.getData(...r),s=i.length,o=s>0?i[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],h=t?1:0,c=e?1:0;for(let d=0;d<s;d+=1){const f=e&&d===0,g=[];for(let v=0;v<o;v+=1){const y=!f&&t&&v===0;let S="";if(f)S=`<th>${n.getColHeader(v-h)}</th>`;else if(y)S=`<th>${n.getRowHeader(d-c)}</th>`;else{const R=i[d][v],{hidden:A,rowspan:O,colspan:V}=n.getCellMeta(d-c,v-h);if(!A){const B=[];if(O&&B.push(`rowspan="${O}"`),V&&B.push(`colspan="${V}"`),An(R))S=`<td ${B.join(" ")}></td>`;else{const Y=R.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");S=`<td ${B.join(" ")}>${Y}</td>`}}}g.push(S)}const p=["<tr>",...g,"</tr>"].join("");f?l.splice(1,0,p):u.splice(-1,0,p)}return a.splice(1,0,l.join(""),u.join("")),a.join("")}function HA(n){const e=n.length,t=["<table>"];for(let r=0;r<e;r+=1){const i=n[r],s=i.length,o=[];r===0&&t.push("<tbody>");for(let a=0;a<s;a+=1){const l=i[a],u=An(l)?"":l.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,h=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(h.length-1)} </span>`).replace(/\t/gi,"&#9;");o.push(`<td>${u}</td>`)}t.push("<tr>",...o,"</tr>"),r+1===e&&t.push("</tbody>")}return t.push("</table>"),t.join("")}function vU(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const t={},r=e.createDocumentFragment(),i=e.createElement("div");r.appendChild(i);let s=n;if(typeof s=="string"){const R=s.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,A=>{const O=A.match(/<td\b[^>]*?>/g)[0],V=/<p.*?>/g,B=A.substring(O.length,A.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(V,`
`).replace(`
`,"").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${O}${B}</td>`});i.insertAdjacentHTML("afterbegin",`${R}`),s=i.querySelector("table")}if(!s||!q6(s))return;const o=i.querySelector('meta[name$="enerator"]'),a=s.querySelector("tbody th")!==null,l=s.querySelector("tr"),u=l?Array.from(l.cells).reduce((R,A)=>R+A.colSpan,0)-(a?1:0):0,h=s.tFoot&&Array.from(s.tFoot.rows)||[],c=[];let d=!1,f=0,g=0;if(s.tHead){const R=Array.from(s.tHead.rows).filter(A=>{const O=A.querySelector("td")!==null;return O&&c.push(A),!O});f=R.length,d=f>0,f>1?t.nestedHeaders=Array.from(R).reduce((A,O)=>{const V=Array.from(O.cells).reduce((B,Y,q)=>{if(a&&q===0)return B;const{colSpan:G,innerHTML:Z}=Y,ee=G>1?{label:Z,colspan:G}:Z;return B.push(ee),B},[]);return A.push(V),A},[]):d&&(t.colHeaders=Array.from(R[0].children).reduce((A,O,V)=>(a&&V===0||A.push(O.innerHTML),A),[]))}c.length&&(t.fixedRowsTop=c.length),h.length&&(t.fixedRowsBottom=h.length);const p=[...c,...Array.from(s.tBodies).reduce((R,A)=>(R.push(...Array.from(A.rows)),R),[]),...h];g=p.length;const v=new Array(g);for(let R=0;R<g;R++)v[R]=new Array(u);const y=[],S=[];for(let R=0;R<g;R++){const A=p[R],O=Array.from(A.cells),V=O.length;for(let B=0;B<V;B++){const Y=O[B],{nodeName:q,innerHTML:G,rowSpan:Z,colSpan:ee}=Y,ne=v[R].findIndex(re=>re===void 0);if(q==="TD"){if(Z>1||ee>1){for(let Le=R;Le<R+Z;Le++)if(Le<g)for(let Se=ne;Se<ne+ee;Se++)v[Le][Se]=null;const ae=Y.getAttribute("style");ae&&ae.includes("mso-ignore:colspan")||y.push({col:ne,row:R,rowspan:Z,colspan:ee})}let re="";o&&/excel/gi.test(o.content)?re=G.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):re=G.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),v[R][ne]=re.replace(K6,ae=>wU[ae])}else S.push(G)}}return y.length&&(t.mergeCells=y),S.length&&(t.rowHeaders=S),v.length&&(t.data=v),t}const X6=Object.freeze(Object.defineProperty({__proto__:null,_dataToHTML:HA,htmlToGridSettings:vU,instanceToHTML:LA},Symbol.toStringTag,{value:"Module"}));function Vr(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const t=typeof n;if(t==="number")return!isNaN(n)&&isFinite(n);if(t==="string"){if(n.length===0)return!1;if(n.length===1)return/\d/.test(n);const r=Array.from(new Set([".",...e])).map(i=>`\\${i}`).join("|");return new RegExp(`^[+-]?(((${r})?\\d+((${r})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(n.trim())}else if(t==="object")return!!n&&typeof n.valueOf()=="number"&&!(n instanceof Date);return!1}function yU(n){return Vr(n,[","])}function Pe(n,e,t){let r=-1;for(typeof e=="function"?(t=e,e=n):r=n-1;++r<=e&&t(r)!==!1;);}function DA(n,e,t){let r=n+1;for(typeof e=="function"&&(t=e,e=0);--r>=e&&t(r)!==!1;);}function n0(n,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(n*e/100,10)}function Vt(n,e,t){return Math.min(n,e)===n?e:Math.max(n,t)===n?t:n}const Q6=Object.freeze(Object.defineProperty({__proto__:null,clamp:Vt,isNumeric:Vr,isNumericLike:yU,rangeEach:Pe,rangeEachReverse:DA,valueAccordingPercent:n0},Symbol.toStringTag,{value:"Module"})),FA="asc",Z6="desc",U1=new Map([[FA,[-1,1]],[Z6,[1,-1]]]),J6=n=>`The priority '${n}' is already declared in a map.`,eX=n=>`The priority '${n}' is not a number.`;function tX(){let{errorPriorityExists:n,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=new Map;n=Jt(n)?n:J6,e=Jt(e)?e:eX;function r(s,o){if(!Vr(s))throw new Error(e(s));if(t.has(s))throw new Error(n(s));t.set(s,o)}function i(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:FA;const[o,a]=U1.get(s)||U1.get(FA);return[...t].sort((l,u)=>l[0]<u[0]?o:a).map(l=>l[1])}return{addItem:r,getItems:i}}const nX=n=>`The id '${n}' is already declared in a map.`;function OC(){let{errorIdExists:n}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;n=Jt(n)?n:nX;function t(u,h){if(l(u))throw new Error(n(u));e.set(u,h)}function r(u){return e.delete(u)}function i(){e.clear()}function s(u){const[h]=a().find(c=>{let[d,f]=c;return u===f?d:!1})||[null];return h}function o(u){return e.get(u)}function a(){return[...e]}function l(u){return e.has(u)}return{addItem:t,clear:i,getId:s,getItem:o,getItems:a,hasItem:l,removeItem:r}}const rX=n=>`'${n}' value is already declared in a unique set.`;function iX(){let{errorItemExists:n}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;n=Jt(n)?n:rX;function t(s){if(e.has(s))throw new Error(n(s));e.add(s)}function r(){return[...e]}function i(){e.clear()}return{addItem:t,clear:i,getItems:r}}const r0=n=>`There is already registered "${n}" plugin.`,sX=n=>`There is already registered plugin on priority "${n}".`,oX=n=>`The priority "${n}" is not a number.`,CU=tX({errorPriorityExists:sX,errorPriorityNaN:oX}),SU=iX({errorItemExists:r0}),kA=OC({errorIdExists:r0});function i0(){return[...CU.getItems(),...SU.getItems()]}function Og(n){const e=$r(n);return kA.getItem(e)}function aX(n){return!!Og(n)}function At(n,e,t){[n,e,t]=uX(n,e,t),Og(n)===void 0&&lX(n,e,t)}function lX(n,e,t){const r=$r(n);if(kA.hasItem(r))throw new Error(r0(r));t===void 0?SU.addItem(r):CU.addItem(t,r),kA.addItem(r,e)}function uX(n,e,t){return typeof n=="function"&&(e=n,n=e.PLUGIN_KEY,t=e.PLUGIN_PRIORITY),[n,e,t]}const{register:hX,getItem:cX,hasItem:RU,getNames:dX,getValues:mye}=fo("renderers");function Bv(n){if(typeof n=="function")return n;if(!RU(n))throw Error(`No registered renderer found under "${n}" name`);return cX(n)}function Pi(n,e){typeof n!="string"&&(e=n,n=e.RENDERER_TYPE),hX(n,e)}const{register:fX,getItem:mX,hasItem:EU,getNames:gX,getValues:gye}=fo("validators");function s0(n){if(typeof n=="function")return n;if(!EU(n))throw Error(`No registered validator found under "${n}" name`);return mX(n)}function ah(n,e){typeof n!="string"&&(e=n,n=e.VALIDATOR_TYPE),fX(n,e)}var B1={},W1;function pX(){if(W1)return B1;W1=1;var n=Ir(),e=wg(),t=Cg(),r=yg(),i=JM();return n({target:"Array",proto:!0},{at:function(o){var a=e(this),l=t(a),u=r(o),h=u>=0?u:l+u;return h<0||h>=l?void 0:a[h]}}),i("at"),B1}pX();var $1={},G1;function wX(){if(G1)return $1;G1=1;var n=Ir(),e=qn(),t=gg(),r=yg(),i=aC(),s=Mr(),o=e("".charAt),a=s(function(){return"ð ®·".at(-2)!=="\uD842"});return n({target:"String",proto:!0,forced:a},{at:function(u){var h=i(t(this)),c=h.length,d=r(u),f=d>=0?d:c+d;return f<0||f>=c?void 0:o(h,f)}}),$1}wX();function Xd(n,e,t){return(e=vX(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function vX(n){var e=yX(n,"string");return typeof e=="symbol"?e:e+""}function yX(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class CX{constructor(){Xd(this,"count",0),Xd(this,"startColumn",null),Xd(this,"endColumn",null),Xd(this,"startPosition",null),Xd(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedWidth:r,zeroBasedScrollOffset:i,viewportWidth:s,columnWidth:o}=t,a=i>0?s+1:s;r>=i&&r+o<=i+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var t;const{scrollOffset:r,viewportWidth:i,inlineStartOffset:s,zeroBasedScrollOffset:o,totalColumns:a,needReverse:l,startPositions:u,columnWidth:h}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const g=u[this.endColumn]+h-u[this.startColumn-1];if(g<=i&&(this.startColumn-=1),g>=i)break}this.startPosition=(t=u[this.startColumn])!==null&&t!==void 0?t:null;const c=o>0?i+1:i,d=r+i-c,f=this.startColumn===null?0:e.getColumnWidth(this.startColumn);d<-1*s||r>u.at(-1)||-1*r-i>-1*f?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Qd(n,e,t){return(e=SX(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function SX(n){var e=RX(n,"string");return typeof e=="symbol"?e:e+""}function RX(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class EX{constructor(){Qd(this,"count",0),Qd(this,"startRow",null),Qd(this,"endRow",null),Qd(this,"startPosition",null),Qd(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedHeight:r,zeroBasedScrollOffset:i,innerViewportHeight:s,rowHeight:o}=t;r>=i&&r+o<=s&&(this.startRow===null&&(this.startRow=e),this.endRow=e)}finalize(e){var t;const{scrollOffset:r,viewportHeight:i,horizontalScrollbarHeight:s,totalRows:o,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===o-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const d=l[this.endRow]+u-l[this.startRow-1];if(d<=i-s&&(this.startRow-=1),d>=i-s)break}this.startPosition=(t=l[this.startRow])!==null&&t!==void 0?t:null;const h=r+i-s,c=this.startRow===null?0:e.getRowHeight(this.startRow);h<c||r>l.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,o<this.endRow&&(this.endRow=o-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function Zd(n,e,t){return(e=bX(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function bX(n){var e=TX(n,"string");return typeof e=="symbol"?e:e+""}function TX(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class bU{constructor(){Zd(this,"count",0),Zd(this,"startColumn",null),Zd(this,"endColumn",null),Zd(this,"startPosition",null),Zd(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedWidth:r,zeroBasedScrollOffset:i,viewportWidth:s}=t;r<=i&&(this.startColumn=e);const o=i>0?s+1:s;r>=i&&r<=i+o&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e}finalize(e){var t;const{scrollOffset:r,viewportWidth:i,inlineStartOffset:s,zeroBasedScrollOffset:o,totalColumns:a,needReverse:l,startPositions:u,columnWidth:h}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const f=u[this.endColumn]+h-u[this.startColumn-1];if(this.startColumn-=1,f>i)break}this.startPosition=(t=u[this.startColumn])!==null&&t!==void 0?t:null;const c=o>0?i+1:i;r+i-c<-1*s||r>u.at(-1)+h||-1*r-i>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Jd(n,e,t){return(e=AX(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function AX(n){var e=NX(n,"string");return typeof e=="symbol"?e:e+""}function NX(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class TU{constructor(){Jd(this,"count",0),Jd(this,"startRow",null),Jd(this,"endRow",null),Jd(this,"startPosition",null),Jd(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedHeight:r,zeroBasedScrollOffset:i,innerViewportHeight:s}=t;r<=i&&(this.startRow=e),r>=i&&r<=s&&this.startRow===null&&(this.startRow=e),this.endRow=e}finalize(e){var t;const{scrollOffset:r,viewportHeight:i,horizontalScrollbarHeight:s,totalRows:o,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===o-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const c=l[this.endRow]+u-l[this.startRow-1];if(this.startRow-=1,c>=i-s)break}this.startPosition=(t=l[this.startRow])!==null&&t!==void 0?t:null,r+i-s<0||r>l.at(-1)+u?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,o<this.endRow&&(this.endRow=o-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function ef(n,e,t){return(e=MX(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function MX(n){var e=IX(n,"string");return typeof e=="symbol"?e:e+""}function IX(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class OX{constructor(){ef(this,"count",0),ef(this,"startColumn",0),ef(this,"endColumn",0),ef(this,"startPosition",0),ef(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:t}=e;this.count=t,this.endColumn=this.count-1}process(){}finalize(){}}function tf(n,e,t){return(e=_X(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function _X(n){var e=PX(n,"string");return typeof e=="symbol"?e:e+""}function PX(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class xX{constructor(){tf(this,"count",0),tf(this,"startRow",0),tf(this,"endRow",0),tf(this,"startPosition",0),tf(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:t}=e;this.count=t,this.endRow=this.count-1}process(){}finalize(){}}class LX extends bU{finalize(e){var t;super.finalize(e);const{overrideFn:r,totalColumns:i,startPositions:s}=e;this.startColumn!==null&&typeof r=="function"&&r(this),this.startColumn<0&&(this.startColumn=0),this.startPosition=(t=s[this.startColumn])!==null&&t!==void 0?t:null,i<this.endColumn&&(this.endColumn=i-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}class HX extends TU{finalize(e){var t;super.finalize(e);const{overrideFn:r,totalRows:i,startPositions:s}=e;this.startRow!==null&&typeof r=="function"&&r(this),this.startRow<0&&(this.startRow=0),this.startPosition=(t=s[this.startRow])!==null&&t!==void 0?t:null,i<this.endRow&&(this.endRow=i-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function j1(n,e,t){return(e=DX(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function DX(n){var e=FX(n,"string");return typeof e=="symbol"?e:e+""}function FX(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class AU{constructor(e){j1(this,"calculationTypes",[]),j1(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(t=>{let[r,i]=t;this.calculationResults.set(r,i),i.initialize(e)})}_process(e,t){this.calculationTypes.forEach(r=>{let[,i]=r;return i.process(e,t)})}_finalize(e){this.calculationTypes.forEach(t=>{let[,r]=t;return r.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}}function _s(n,e,t){return(e=kX(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function kX(n){var e=VX(n,"string");return typeof e=="symbol"?e:e+""}function VX(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const _C=50;class UX extends AU{constructor(e){let{calculationTypes:t,viewportWidth:r,scrollOffset:i,totalColumns:s,columnWidthFn:o,overrideFn:a,inlineStartOffset:l}=e;super(t),_s(this,"viewportWidth",0),_s(this,"scrollOffset",0),_s(this,"zeroBasedScrollOffset",0),_s(this,"totalColumns",0),_s(this,"columnWidthFn",null),_s(this,"columnWidth",0),_s(this,"overrideFn",null),_s(this,"inlineStartOffset",0),_s(this,"totalCalculatedWidth",0),_s(this,"startPositions",[]),_s(this,"needReverse",!0),this.viewportWidth=r,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalColumns=s,this.columnWidthFn=o,this.overrideFn=a,this.inlineStartOffset=l,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const t=this.columnWidthFn(e);return isNaN(t)?_C:t}}function Ki(n,e,t){return(e=BX(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function BX(n){var e=WX(n,"string");return typeof e=="symbol"?e:e+""}function WX(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const NU=23;class $X extends AU{constructor(e){let{calculationTypes:t,viewportHeight:r,scrollOffset:i,totalRows:s,rowHeightFn:o,overrideFn:a,horizontalScrollbarHeight:l}=e;super(t),Ki(this,"viewportHeight",0),Ki(this,"scrollOffset",0),Ki(this,"zeroBasedScrollOffset",0),Ki(this,"totalRows",0),Ki(this,"rowHeightFn",null),Ki(this,"rowHeight",0),Ki(this,"overrideFn",null),Ki(this,"horizontalScrollbarHeight",0),Ki(this,"innerViewportHeight",0),Ki(this,"totalCalculatedHeight",0),Ki(this,"startPositions",[]),Ki(this,"needReverse",!0),this.viewportHeight=r,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalRows=s,this.rowHeightFn=o,this.overrideFn=a,this.horizontalScrollbarHeight=l??0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const t=this.rowHeightFn(e);return isNaN(t)?NU:t}}function GX(n,e,t){jX(n,e),e.set(n,t)}function jX(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function z1(n,e,t){return(e=zX(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function zX(n){var e=YX(n,"string");return typeof e=="symbol"?e:e+""}function YX(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function ec(n,e){return n.get(MU(n,e))}function Y1(n,e,t){return n.set(MU(n,e),t),t}function MU(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var ma=new WeakMap;class Ah{constructor(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;z1(this,"row",null),z1(this,"col",null),GX(this,ma,!1),Y1(ma,this,r),typeof e<"u"&&typeof t<"u"&&(this.row=e,this.col=t)}isValid(e){const{countRows:t,countCols:r,countRowHeaders:i,countColHeaders:s}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-s||this.col<-i||this.row>=t||this.col>=r)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return ec(ma,this)}isSouthEastOf(e){return this.row>=e.row&&(ec(ma,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(ec(ma,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(ec(ma,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(ec(ma,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e?.row)&&(this.row=e.row),Number.isInteger(e?.col)&&(this.col=e.col),e instanceof Ah&&Y1(ma,this,e.isRtl()),this}clone(){return new Ah(this.row,this.col,ec(ma,this))}toObject(){return{row:this.row,col:this.col}}}function KX(n,e,t){qX(n,e),e.set(n,t)}function qX(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tb(n,e,t){return(e=XX(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function XX(n){var e=QX(n,"string");return typeof e=="symbol"?e:e+""}function QX(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function qi(n,e){return n.get(IU(n,e))}function ZX(n,e,t){return n.set(IU(n,e),t),t}function IU(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var si=new WeakMap;class _g{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;tb(this,"highlight",null),tb(this,"from",null),tb(this,"to",null),KX(this,si,!1),this.highlight=e.clone(),this.from=t.clone(),this.to=r.clone(),ZX(si,this,i)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),t=Math.max(this.to.row,0);return Math.max(e,t)-Math.min(e,t)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),t=Math.max(this.to.col,0);return Math.max(e,t)-Math.min(e,t)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:t,col:r}=e,i=this.getOuterTopStartCorner(),s=this.getOuterBottomEndCorner();return i.row<=t&&s.row>=t&&i.col<=r&&s.col>=r}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const t=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();return e.row<t.row||e.col<t.col||e.row>r.row||e.col>r.col?(this.from=this._createCellCoords(Math.min(t.row,e.row),Math.min(t.col,e.col)),this.to=this._createCellCoords(Math.max(r.row,e.row),Math.max(r.col,e.col)),!0):!1}expandByRange(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(e)||!this.overlaps(e))return!1;const r=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),s=this.getDirection(),o=e.getOuterTopStartCorner(),a=e.getOuterBottomEndCorner(),l=Math.min(r.row,o.row),u=Math.min(r.col,o.col),h=Math.max(i.row,a.row),c=Math.max(i.col,a.col),d=this._createCellCoords(l,u),f=this._createCellCoords(h,c);return this.from=d,this.to=f,this.setDirection(s),t&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return qi(si,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return qi(si,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return qi(si,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return qi(si,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return qi(si,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return qi(si,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return qi(si,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return qi(si,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof Ah))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const t={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},r={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},i=[];return t.top===r.top&&i.push("top"),t.right===r.right&&i.push(qi(si,this)?"left":"right"),t.bottom===r.bottom&&i.push("bottom"),t.left===r.left&&i.push(qi(si,this)?"right":"left"),i}getInner(){const e=this.getOuterTopStartCorner(),t=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=t.row;i++)for(let s=e.col;s<=t.col;s++)!(this.from.row===i&&this.from.col===s)&&!(this.to.row===i&&this.to.col===s)&&r.push(this._createCellCoords(i,s));return r}getAll(){const e=this.getOuterTopStartCorner(),t=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=t.row;i++)for(let s=e.col;s<=t.col;s++)e.row===i&&e.col===s?r.push(e):t.row===i&&t.col===s?r.push(t):r.push(this._createCellCoords(i,s));return r}forAll(e){const t=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();for(let i=t.row;i<=r.row;i++)for(let s=t.col;s<=r.col;s++)if(e(i,s)===!1)return}clone(){return new _g(this.highlight,this.from,this.to,qi(si,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,t){return new Ah(e,t,qi(si,this))}}function po(n,e,t){JX(n,e),e.set(n,t)}function JX(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xe(n,e){return n.get(OU(n,e))}function hl(n,e,t){return n.set(OU(n,e),t),t}function OU(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Xi=new WeakMap,nb=new WeakMap,lr=new WeakMap,tc=new WeakMap,ap=new WeakMap,Ps=new WeakMap,rb=new WeakMap,nf=new WeakMap,yu=new WeakMap,wo=new WeakMap;let _U=class{constructor(e,t,r,i,s,o){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;po(this,Xi,void 0),po(this,nb,void 0),po(this,lr,void 0),po(this,tc,void 0),po(this,ap,void 0),po(this,Ps,void 0),po(this,rb,void 0),po(this,nf,void 0),po(this,yu,[null,null]),po(this,wo,[null,null]),hl(Xi,this,r),hl(nb,this,t),hl(lr,this,s),hl(tc,this,o),hl(ap,this,a),hl(Ps,this,i),hl(rb,this,e),this.registerEvents()}registerEvents(){xe(Ps,this).addEventListener(xe(lr,this).holder,"contextmenu",r=>this.onContextMenu(r)),xe(Ps,this).addEventListener(xe(lr,this).TABLE,"mouseover",r=>this.onMouseOver(r)),xe(Ps,this).addEventListener(xe(lr,this).TABLE,"mouseout",r=>this.onMouseOut(r));const e=()=>{xe(Ps,this).addEventListener(xe(lr,this).holder,"touchstart",r=>this.onTouchStart(r)),xe(Ps,this).addEventListener(xe(lr,this).holder,"touchend",r=>this.onTouchEnd(r)),this.momentumScrolling||(this.momentumScrolling={}),xe(Ps,this).addEventListener(xe(lr,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||xe(Xi,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,xe(Xi,this).getSetting("onAfterMomentumScroll"))},200)})},t=()=>{xe(Ps,this).addEventListener(xe(lr,this).holder,"mouseup",r=>this.onMouseUp(r)),xe(Ps,this).addEventListener(xe(lr,this).holder,"mousedown",r=>this.onMouseDown(r))};Ba()?e():(YM()&&e(),t())}selectedCellWasTouched(e){const r=this.parentCell(e).coords;if(xe(nf,this)&&r){const[i,s]=[r.row,xe(nf,this).from.row],[o,a]=[r.col,xe(nf,this).from.col];return i===s&&o===a}return!1}parentCell(e){const t={},r=xe(lr,this).TABLE,i=Kf(e,["TD","TH"],r);return i?(t.coords=xe(lr,this).getCoords(i),t.TD=i):je(e,"wtBorder")&&je(e,"current")?(t.coords=xe(tc,this).getFocusSelection().cellRange.highlight,t.TD=xe(lr,this).getCell(t.coords)):je(e,"wtBorder")&&je(e,"area")&&xe(tc,this).getAreaSelection().cellRange&&(t.coords=xe(tc,this).getAreaSelection().cellRange.to,t.TD=xe(lr,this).getCell(t.coords)),t}onMouseDown(e){const t=xe(nb,this).rootDocument.activeElement,r=zM(VV,e.target),i=e.target;if(!["TD","TH"].includes(t.nodeName)&&(i===t||r(0)===t||r(1)===t))return;const s=this.parentCell(i);je(i,"corner")?xe(Xi,this).getSetting("onCellCornerMouseDown",e,i):s.TD&&xe(Xi,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,s.coords,s.TD),(e.button===0||this.touchApplied)&&s.TD&&(xe(wo,this)[0]=s.TD,clearTimeout(xe(yu,this)[0]),xe(yu,this)[0]=setTimeout(()=>{xe(wo,this)[0]=null},1e3))}onContextMenu(e){if(xe(Xi,this).has("onCellContextMenu")){const t=this.parentCell(e.target);t.TD&&this.callListener("onCellContextMenu",e,t.coords,t.TD)}}onMouseOver(e){if(!xe(Xi,this).has("onCellMouseOver"))return;const t=xe(lr,this).TABLE,r=Kf(e.target,["TD","TH"],t),i=xe(ap,this)||this;r&&r!==i.lastMouseOver&&ql(r,t)&&(i.lastMouseOver=r,this.callListener("onCellMouseOver",e,xe(lr,this).getCoords(r),r))}onMouseOut(e){if(!xe(Xi,this).has("onCellMouseOut"))return;const t=xe(lr,this).TABLE,r=Kf(e.target,["TD","TH"],t),i=Kf(e.relatedTarget,["TD","TH"],t),s=xe(ap,this)||this;r&&r!==i&&ql(r,t)&&(this.callListener("onCellMouseOut",e,xe(lr,this).getCoords(r),r),i===null&&(s.lastMouseOver=null))}onMouseUp(e){const t=this.parentCell(e.target);t.TD&&xe(Xi,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,t.coords,t.TD),!(e.button!==0&&!this.touchApplied)&&(t.TD===xe(wo,this)[0]&&t.TD===xe(wo,this)[1]?(je(e.target,"corner")?this.callListener("onCellCornerDblClick",e,t.coords,t.TD):this.callListener("onCellDblClick",e,t.coords,t.TD),xe(wo,this)[0]=null,xe(wo,this)[1]=null):t.TD===xe(wo,this)[0]&&(xe(wo,this)[1]=t.TD,clearTimeout(xe(yu,this)[1]),xe(yu,this)[1]=setTimeout(()=>{xe(wo,this)[1]=null},500)))}onTouchStart(e){hl(nf,this,xe(tc,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var t;const r=e.target,i=(t=this.parentCell(r))===null||t===void 0?void 0:t.coords,s=Ne(i)&&i.row>=0&&i.col>=0;if(e.cancelable&&s&&xe(Xi,this).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];XM()&&(oU()||aU())&&this.selectedCellWasTouched(r)&&!a.includes(r.tagName)?e.preventDefault():this.selectedCellWasTouched(r)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,t,r,i){const s=xe(Xi,this).getSettingPure(e);s&&s(t,r,i,xe(rb,this).call(this))}destroy(){clearTimeout(xe(yu,this)[0]),clearTimeout(xe(yu,this)[1]),xe(Ps,this).destroy()}};function ib(n,e,t){return(e=e9(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function e9(n){var e=t9(n,"string");return typeof e=="symbol"?e:e+""}function t9(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class n9{constructor(e,t,r){ib(this,"offset",void 0),ib(this,"total",void 0),ib(this,"countTH",void 0),this.offset=e,this.total=t,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function sb(n,e,t){return(e=r9(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function r9(n){var e=i9(n,"string");return typeof e=="symbol"?e:e+""}function i9(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class s9{constructor(e,t,r){sb(this,"offset",void 0),sb(this,"total",void 0),sb(this,"countTH",void 0),this.offset=e,this.total=t,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}const o9=0,Wv=1,$v=2;function lp(n,e,t){return(e=a9(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function a9(n){var e=l9(n,"string");return typeof e=="symbol"?e:e+""}function l9(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class K1{constructor(){lp(this,"currentSize",0),lp(this,"nextSize",0),lp(this,"currentOffset",0),lp(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}function ob(n,e,t){return(e=u9(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function u9(n){var e=h9(n,"string");return typeof e=="symbol"?e:e+""}function h9(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class c9{constructor(){ob(this,"size",new K1),ob(this,"workingSpace",o9),ob(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize instanceof K1}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=Wv,e.workingSpace=$v,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=$v,e.workingSpace=Wv,this.sharedSize=e.getViewSize()}}function nc(n,e,t){return(e=d9(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function d9(n){var e=f9(n,"string");return typeof e=="symbol"?e:e+""}function f9(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class PU{constructor(e,t,r){nc(this,"rootNode",void 0),nc(this,"nodesPool",void 0),nc(this,"sizeSet",new c9),nc(this,"childNodeType",void 0),nc(this,"visualIndex",0),nc(this,"collectedNodes",[]),this.rootNode=e,this.nodesPool=t,this.childNodeType=r.toUpperCase()}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}getRenderedChildCount(){const{rootNode:e,sizeSet:t}=this;let r=0;if(this.isSharedViewSet()){let i=e.firstElementChild;for(;i;){if(i.tagName===this.childNodeType)r+=1;else if(t.isPlaceOn(Wv))break;i=i.nextElementSibling}}else r=e.childElementCount;return r}start(){this.collectedNodes.length=0,this.visualIndex=0;const{rootNode:e,sizeSet:t}=this,r=this.isSharedViewSet(),{nextSize:i}=t.getViewSize();let s=this.getRenderedChildCount();for(;s<i;){const a=this.nodesPool();!r||r&&t.isPlaceOn($v)?e.appendChild(a):e.insertBefore(a,e.firstChild),s+=1}const o=r&&t.isPlaceOn(Wv);for(;s>i;)e.removeChild(o?e.firstChild:e.lastChild),s-=1}render(){const{rootNode:e,sizeSet:t}=this;let r=this.visualIndex;this.isSharedViewSet()&&t.isPlaceOn($v)&&(r+=t.sharedSize.nextSize);let i=e.childNodes[r];if(i.tagName!==this.childNodeType){const s=this.nodesPool();e.replaceChild(s,i),i=s}this.collectedNodes.push(i),this.visualIndex+=1}end(){}}class xU extends PU{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function m9(n,e,t){return(e=g9(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function g9(n){var e=p9(n,"string");return typeof e=="symbol"?e:e+""}function p9(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class w9{constructor(e){m9(this,"nodeType",void 0),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(){return this.rootDocument.createElement(this.nodeType)}}function rf(n,e,t){return(e=v9(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function v9(n){var e=y9(n,"string");return typeof e=="symbol"?e:e+""}function y9(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Pg{constructor(e,t){rf(this,"nodesPool",null),rf(this,"nodeType",void 0),rf(this,"rootNode",void 0),rf(this,"table",null),rf(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new w9(e):null,this.nodeType=e,this.rootNode=t}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function q1(n,e,t){return(e=C9(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function C9(n){var e=S9(n,"string");return typeof e=="symbol"?e:e+""}function S9(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class R9 extends Pg{constructor(){super("TH"),q1(this,"orderViews",new WeakMap),q1(this,"sourceRowIndex",0)}obtainOrderView(e){let t;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new xU(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,t)),t}render(){const{rowsToRender:e,rowHeaderFunctions:t,rowHeadersCount:r,rows:i,cells:s}=this.table;for(let o=0;o<e;o++){const a=this.table.renderedRowToSource(o),l=i.getRenderedNode(o);this.sourceRowIndex=a;const u=this.obtainOrderView(l),h=s.obtainOrderView(l);u.appendView(h).setSize(r).setOffset(this.table.renderedColumnToSource(0)).start();for(let c=0;c<r;c++){u.render();const d=u.getCurrentNode();d.className="",d.removeAttribute("style"),Gh(d,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Ge(d,[S4(),O4(),DM(c+1),_d(-1)]),t[c](a,d,c)}u.end()}}}class E9 extends Pg{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:t}=this.table;let r=this.rootNode.firstChild;if(e){const{columnsToRender:i}=this.table,s=i+t;for(let a=0,l=e;a<l;a++){for(r=this.rootNode.childNodes[a],r||(r=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(r)),this.renderedNodes=r.childNodes.length;this.renderedNodes<s;)r.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>s;)r.removeChild(r.lastChild),this.renderedNodes-=1}const o=this.rootNode.childNodes.length;if(o>e)for(let a=e;a<o;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else r&&so(r)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&Ge(this.rootNode,[xV()]);for(let t=0;t<e;t+=1){const{columnHeaderFunctions:r,columnsToRender:i,rowHeadersCount:s}=this.table,o=this.rootNode.childNodes[t];this.table.isAriaEnabled()&&Ge(o,[IA(),FV(t+1)]);for(let a=-1*s;a<i;a+=1){const l=this.table.renderedColumnToSource(a),u=o.childNodes[a+s];u.className="",u.removeAttribute("style"),Gh(u,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Ge(u,[DM(a+1+this.table.rowHeadersCount),_d(-1),R4(),...a>=0?[I4()]:[IA()]]),r[t](l,u,t)}}}}let X1=!1;class b9 extends Pg{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:t}=this.table,r=e+t;for(;this.renderedNodes<r;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>r;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:t}=this.table;!X1&&e>1e3&&(X1=!0,Ut(Bt`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let i=0;i<t;i++){const s=this.table.renderedColumnToSource(i),o=this.table.columnUtils.getHeaderWidth(s);this.rootNode.childNodes[i].style.width=`${o}px`}for(let i=0;i<e;i++){const s=this.table.renderedColumnToSource(i),o=this.table.columnUtils.getStretchedColumnWidth(s);this.rootNode.childNodes[i+t].style.width=`${o}px`}const r=this.rootNode.firstChild;r&&ie(r,"rowHeader")}}function T9(n,e,t){return(e=A9(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function A9(n){var e=N9(n,"string");return typeof e=="symbol"?e:e+""}function N9(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const up={rowEven:"ht__row_even",rowOdd:"ht__row_odd"};let Q1=!1;class M9 extends Pg{constructor(e){super("TR",e),T9(this,"orderView",void 0),this.orderView=new PU(e,t=>this.nodesPool.obtain(t),this.nodeType)}getRenderedNode(e){return this.orderView.getNode(e)}render(){const{rowsToRender:e}=this.table;!Q1&&e>1e3&&(Q1=!0,Ut(Bt`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&Ge(this.rootNode,[xV()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let i=0;i<e;i++){this.orderView.render();const s=this.orderView.getCurrentNode(),o=this.table.renderedRowToSource(i);if(this.table.isAriaEnabled()){var t,r;Ge(s,[IA(),FV(o+((t=(r=this.table.rowUtils)===null||r===void 0||(r=r.dataAccessObject)===null||r===void 0?void 0:r.columnHeaders.length)!==null&&t!==void 0?t:0)+1)])}Xe(s,[up.rowEven,up.rowOdd]),(o+1)%2===0?ie(s,up.rowEven):ie(s,up.rowOdd)}this.orderView.end()}}function Z1(n,e,t){return(e=I9(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function I9(n){var e=O9(n,"string");return typeof e=="symbol"?e:e+""}function O9(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class _9 extends Pg{constructor(){super("TD"),Z1(this,"orderViews",new WeakMap),Z1(this,"sourceRowIndex",0)}obtainOrderView(e){let t;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new xU(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,t)),t}render(){const{rowsToRender:e,columnsToRender:t,rows:r,rowHeaders:i}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),u=r.getRenderedNode(a);this.sourceRowIndex=l;const h=this.obtainOrderView(u),c=i.obtainOrderView(u);h.prependView(c).setSize(t).setOffset(this.table.renderedColumnToSource(0)).start();for(let d=0;d<t;d++){h.render();const f=h.getCurrentNode(),g=this.table.renderedColumnToSource(d);if(je(f,"hide")||(f.className=""),f.removeAttribute("style"),f.removeAttribute("dir"),Gh(f,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,g,f),this.table.isAriaEnabled()){var s,o;Ge(f,[...f.hasAttribute("role")?[]:[C4()],_d(-1),DM(g+((s=(o=this.table.rowUtils)===null||o===void 0||(o=o.dataAccessObject)===null||o===void 0?void 0:o.rowHeaders.length)!==null&&s!==void 0?s:0)+1)])}}h.end()}}}function Jn(n,e,t){return(e=P9(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function P9(n){var e=x9(n,"string");return typeof e=="symbol"?e:e+""}function x9(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class L9{constructor(e){let{cellRenderer:t}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Jn(this,"rootNode",void 0),Jn(this,"rootDocument",void 0),Jn(this,"rowHeaders",null),Jn(this,"columnHeaders",null),Jn(this,"colGroup",null),Jn(this,"rows",null),Jn(this,"cells",null),Jn(this,"rowFilter",null),Jn(this,"columnFilter",null),Jn(this,"rowUtils",null),Jn(this,"columnUtils",null),Jn(this,"rowsToRender",0),Jn(this,"columnsToRender",0),Jn(this,"rowHeaderFunctions",[]),Jn(this,"rowHeadersCount",0),Jn(this,"columnHeaderFunctions",[]),Jn(this,"columnHeadersCount",0),Jn(this,"cellRenderer",void 0),Jn(this,"activeOverlayName",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=t}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,t){this.rowUtils=e,this.columnUtils=t}setViewportSize(e,t){this.rowsToRender=e,this.columnsToRender=t}setFilters(e,t){this.rowFilter=e,this.columnFilter=t}setHeaderContentRenderers(e,t){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=t,this.columnHeadersCount=t.length}setRenderers(){let{rowHeaders:e,columnHeaders:t,colGroup:r,rows:i,cells:s}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),t.setTable(this),r.setTable(this),i.setTable(this),s.setTable(this),this.rowHeaders=e,this.columnHeaders=t,this.colGroup=r,this.rows=i,this.cells=s}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:t}=this;for(let r=0;r<e;r++){const i=t.getRenderedNode(r);if(i.firstChild){const s=this.renderedRowToSource(r),o=this.rowUtils.getHeightByOverlayName(s,this.activeOverlayName);o?i.firstChild.style.height=`${o-1}px`:i.firstChild.style.height=""}}}}class H9{constructor(){let{TABLE:e,THEAD:t,COLGROUP:r,TBODY:i,rowUtils:s,columnUtils:o,cellRenderer:a}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new L9(e,{cellRenderer:a}),this.renderer.setRenderers({rowHeaders:new R9,columnHeaders:new E9(t),colGroup:new b9(r),rows:new M9(i),cells:new _9}),this.renderer.setAxisUtils(s,o)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,t){return this.renderer.setFilters(e,t),this}setViewportSize(e,t){return this.renderer.setViewportSize(e,t),this}setHeaderContentRenderers(e,t){return this.renderer.setHeaderContentRenderers(e,t),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function sf(n,e,t){D9(n,e),e.set(n,t)}function D9(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hp(n,e,t){return(e=F9(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function F9(n){var e=k9(n,"string");return typeof e=="symbol"?e:e+""}function k9(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Pr(n,e){return n.get(LU(n,e))}function of(n,e,t){return n.set(LU(n,e),t),t}function LU(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var cp=new WeakMap,rc=new WeakMap,af=new WeakMap,dp=new WeakMap,Cu=new WeakMap;class V9{constructor(e){let{totalColumns:t,stretchMode:r,stretchingColumnWidthFn:i,columnWidthFn:s}=e;hp(this,"stretchAllRatio",0),hp(this,"stretchLastWidth",0),hp(this,"stretchAllColumnsWidth",[]),sf(this,cp,0),hp(this,"needVerifyLastColumnWidth",!0),sf(this,rc,()=>0),sf(this,af,o=>o),sf(this,dp,o=>o),sf(this,Cu,()=>"none"),of(rc,this,t),of(Cu,this,r),of(af,this,i??Pr(af,this)),of(dp,this,s??Pr(dp,this))}refreshStretching(e){if(Pr(Cu,this).call(this)==="none")return;this.stretchAllRatio=0,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0,this.stretchLastWidth=0,of(cp,this,e);let t=0;for(let i=0;i<Pr(rc,this).call(this);i++){const s=this._getColumnWidth(i),o=Pr(af,this).call(this,void 0,i);typeof o=="number"?e-=o:t+=s}const r=e-t;if(Pr(Cu,this).call(this)==="all"&&r>0)this.stretchAllRatio=e/t,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if(Pr(Cu,this).call(this)==="last"&&e!==1/0){const i=this._getColumnWidth(Pr(rc,this).call(this)-1),s=r+i;this.stretchLastWidth=s>=0?s:i}}getStretchedColumnWidth(e,t){let r=null;return Pr(Cu,this).call(this)==="all"&&this.stretchAllRatio!==0?r=this._getStretchedAllColumnWidth(e,t):Pr(Cu,this).call(this)==="last"&&this.stretchLastWidth!==0&&(r=this._getStretchedLastColumnWidth(e)),r}_getStretchedAllColumnWidth(e,t){let r=0;if(!this.stretchAllColumnsWidth[e]){const i=Math.round(t*this.stretchAllRatio),s=Pr(af,this).call(this,i,e);s===void 0?this.stretchAllColumnsWidth[e]=i:this.stretchAllColumnsWidth[e]=isNaN(s)?this._getColumnWidth(e):s}if(this.stretchAllColumnsWidth.length===Pr(rc,this).call(this)&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(let i=0;i<this.stretchAllColumnsWidth.length;i++)r+=this.stretchAllColumnsWidth[i];r!==Pr(cp,this)&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=Pr(cp,this)-r)}return this.stretchAllColumnsWidth[e]}_getStretchedLastColumnWidth(e){return e===Pr(rc,this).call(this)-1?this.stretchLastWidth:null}_getColumnWidth(e){let t=Pr(dp,this).call(this,e);return isNaN(t)&&(t=_C),t}}function fp(n,e,t){return(e=U9(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function U9(n){var e=B9(n,"string");return typeof e=="symbol"?e:e+""}function B9(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class W9{constructor(e,t){fp(this,"dataAccessObject",void 0),fp(this,"wtSettings",void 0),fp(this,"headerWidths",new Map),fp(this,"stretching",void 0),this.dataAccessObject=e,this.wtSettings=t,this.stretching=new V9({totalColumns:()=>this.wtSettings.getSetting("totalColumns"),stretchMode:()=>this.wtSettings.getSetting("stretchH"),stretchingColumnWidthFn:(r,i)=>this.wtSettings.getSetting("onBeforeStretchingColumnWidth",r,i),columnWidthFn:r=>this.dataAccessObject.wtTable.getColumnWidth(r)})}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getStretchedColumnWidth(e){let t=this.getWidth(e);const r=this.stretching.getStretchedColumnWidth(e,t);return r&&(t=r),t}getHeaderHeight(e){let t=this.wtSettings.getSetting("defaultRowHeight");const r=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return r!==void 0&&(t=t?Math.max(t,r):r),t}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}refreshStretching(){const{wtTable:e,wtViewport:t,cloneSource:r}=this.dataAccessObject,i=r?r.wtTable.holder:e.holder,s=i.offsetHeight<i.scrollHeight?or():0;this.stretching.refreshStretching(t.getViewportWidth()-s)}calculateWidths(){const{wtSettings:e}=this;let t=e.getSetting("rowHeaderWidth");if(this.refreshStretching(),t=e.getSetting("onModifyRowHeaderWidth",t),t!=null){const r=e.getSetting("rowHeaders").length,i=e.getSetting("defaultColumnWidth");for(let s=0;s<r;s++){let o=Array.isArray(t)?t[s]:t;o=o??i,this.headerWidths.set(s,o)}}}}function J1(n,e,t){return(e=$9(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function $9(n){var e=G9(n,"string");return typeof e=="symbol"?e:e+""}function G9(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class j9{constructor(e,t){J1(this,"dataAccessObject",void 0),J1(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=t}getHeight(e){let t=this.wtSettings.getSetting("rowHeight",e);const r=this.dataAccessObject.wtViewport.oversizedRows[e];return r!==void 0&&(t=t===void 0?r:Math.max(t,r)),t}getHeightByOverlayName(e,t){let r=this.wtSettings.getSetting("rowHeightByOverlayName",e,t);const i=this.dataAccessObject.wtViewport.oversizedRows[e];return i!==void 0&&(r=r===void 0?i:Math.max(r,i)),r}}function vo(n,e,t){return(e=z9(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function z9(n){var e=Y9(n,"string");return typeof e=="symbol"?e:e+""}function Y9(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Ld{constructor(e,t,r,i,s){vo(this,"wtSettings",null),vo(this,"domBindings",void 0),vo(this,"TBODY",null),vo(this,"THEAD",null),vo(this,"COLGROUP",null),vo(this,"hasTableHeight",!0),vo(this,"hasTableWidth",!0),vo(this,"isTableVisible",!1),vo(this,"tableOffset",0),vo(this,"holderOffset",0),this.domBindings=r,this.isMaster=s==="master",this.name=s,this.dataAccessObject=e,this.facadeGetter=t,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=r.rootTable,kM(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const o=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(o)),this.rowUtils=new j9(this.dataAccessObject,this.wtSettings),this.columnUtils=new W9(this.dataAccessObject,this.wtSettings),this.tableRenderer=new H9({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const t=e.parentNode;let r;return(!t||t.nodeType!==Node.ELEMENT_NODE||!je(t,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtSpreader",t&&t.insertBefore(r,e),r.appendChild(e)),r.style.position="relative",this.wtSettings.getSetting("ariaTags")&&Ge(r,[Xo()]),r}createHider(e){const t=e.parentNode;let r;return(!t||t.nodeType!==Node.ELEMENT_NODE||!je(t,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtHider",t&&t.insertBefore(r,e),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Ge(r,[Xo()]),r}createHolder(e){const t=e.parentNode;let r;return(!t||t.nodeType!==Node.ELEMENT_NODE||!je(t,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.style.position="relative",r.className="wtHolder",t&&t.insertBefore(r,e),this.isMaster&&(r.parentNode.className+="ht_master handsontable",r.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&Ge(r.parentNode,[Xo()])),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Ge(r,[Xo()]),r}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:t}=this,{wtOverlays:r,wtViewport:i}=this.dataAccessObject,s=t.getSetting("totalRows"),o=t.getSetting("totalColumns"),a=t.getSetting("rowHeaders"),l=a.length,u=t.getSetting("columnHeaders"),h=u.length;let c=e;if(this.isMaster&&(r.beforeDraw(),this.holderOffset=ir(this.holder),c=i.createCalculators(c),l&&!t.getSetting("fixedColumnsStart"))){const f=r.inlineStartOverlay.getScrollPosition(),g=this.correctHeaderWidth;this.correctHeaderWidth=f!==0,g!==this.correctHeaderWidth&&(c=!1)}if(c)this.isMaster&&r.refresh(!0);else{this.isMaster?this.tableOffset=ir(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const f=s>0?this.getFirstRenderedRow():0,g=o>0?this.getFirstRenderedColumn():0;this.rowFilter=new s9(f,s,h),this.columnFilter=new n9(g,o,l);let p=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const v={};this.wtSettings.getSetting("beforeDraw",!0,v),p=v.skipRender!==!0}if(p){this.tableRenderer.setHeaderContentRenderers(a,u),(this.is(Yo)||this.is(Xl))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();let v;if(this.isMaster&&(v=this.dataAccessObject.workspaceWidth,i.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(Yo))&&this.markOversizedRows(),this.isMaster){this.wtSettings.getSetting("externalRowCalculator")||i.createVisibleCalculators(),r.refresh(!1),r.applyToDOM();const y=rn(this.hider),S=rn(this.TABLE);y!==0&&S!==y&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),v!==i.getWorkspaceWidth()&&(i.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(Yo)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}let d=!1;return this.isMaster&&(d=r.topOverlay.resetFixedPosition(),r.bottomOverlay.clone&&(d=r.bottomOverlay.resetFixedPosition()||d),d=r.inlineStartOverlay.resetFixedPosition()||d,r.topInlineStartCornerOverlay&&r.topInlineStartCornerOverlay.resetFixedPosition(),r.bottomInlineStartCornerOverlay&&r.bottomInlineStartCornerOverlay.clone&&r.bottomInlineStartCornerOverlay.resetFixedPosition()),d?(r.refreshAll(),r.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(c),this.isMaster&&r.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const t=this.columnFilter.renderedToSource(e);let r=this.wtSettings.getSetting("columnHeaders").length;const i=this.wtSettings.getSetting("defaultRowHeight");let s,o,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;r;)r-=1,s=this.getColumnHeaderHeight(r),o=this.getColumnHeader(t,r),o&&(a=ch(o),(!s&&i<a||s<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=a),Array.isArray(l)?l[r]!==null&&l[r]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]<(l[r]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,t=this.THEAD.childNodes,r=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=e.getSetting("columnHeaders");for(let s=0,o=i.length;s<o;s++)if(r[s]){if(!t[s]||t[s].childNodes.length===0)return;t[s].childNodes[0].style.height=`${r[s]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:t}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(Yo))&&!e.getSetting("externalRowCalculator")){const r=this.getRenderedRowsCount();for(let i=0;i<r;i++){const s=this.rowFilter.renderedToSource(i);t.oversizedRows&&t.oversizedRows[s]&&(t.oversizedRows[s]=void 0)}}}getCell(e){let t=e.row,r=e.col;const i=this.wtSettings.getSetting("onModifyGetCellCoords",t,r);if(i&&Array.isArray(i)&&([t,r]=i),this.isRowBeforeRenderedRows(t))return-1;if(this.isRowAfterRenderedRows(t))return-2;if(this.isColumnBeforeRenderedColumns(r))return-3;if(this.isColumnAfterRenderedColumns(r))return-4;const s=this.getRow(t);if(!s&&t>=0)throw new Error("TR was expected to be rendered but is not");const o=s.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)];if(!o&&r>=0)throw new Error("TD or TH was expected to be rendered but is not");return o}getRow(e){let t=null,r=null;if(e<0){var i;t=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(e),r=this.THEAD}else{var s;t=(s=this.rowFilter)===null||s===void 0?void 0:s.sourceToRendered(e),r=this.TBODY}return t!==void 0&&r!==void 0?r.childNodes.length<t+1?!1:r.childNodes[t]:!1}getColumnHeader(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.THEAD.childNodes[t];return r?.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const t=[],r=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(i=>{const s=i.childNodes[r];s&&t.push(s)}),t}getRowHeader(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.wtSettings.getSetting("rowHeaders").length;if(t>=r)return;const i=this.rowFilter.sourceToRendered(e),s=i<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):i,a=(i<0?this.THEAD:this.TBODY).childNodes[s];return a?.childNodes[t]}getRowHeaders(e){const t=[],r=this.wtSettings.getSetting("rowHeaders").length;for(let i=0;i<r;i++){const s=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],o=s?.childNodes[i];o&&t.push(o)}return t}getCoords(e){let t=e;if(t.nodeName!=="TD"&&t.nodeName!=="TH"&&(t=nu(t,["TD","TH"])),t===null)return null;const r=t.parentNode,i=r.parentNode;let s=WV(r),o=t.cellIndex;return bl(Ih,t,this.wtRootElement)||bl(Nh,t,this.wtRootElement)?i.nodeName==="THEAD"&&(s-=i.childNodes.length):bl(Xl,t,this.wtRootElement)||bl(Yo,t,this.wtRootElement)?s=this.wtSettings.getSetting("totalRows")-i.childNodes.length+s:i===this.THEAD?s=this.rowFilter.visibleColHeadedRowToSourceRow(s):s=this.rowFilter.renderedToSource(s),bl(Ih,t,this.wtRootElement)||bl(Mh,t,this.wtRootElement)||bl(Xl,t,this.wtRootElement)?o=this.columnFilter.offsettedTH(o):o=this.columnFilter.visibleRowHeadedColumnToSourceColumn(o),this.wot.createCellCoords(s,o)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const t=e*this.wtSettings.getSetting("defaultRowHeight"),r=ch(this.TBODY)-1;let i,s,o,a,l;if(!(t===r&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;)e-=1,o=this.rowFilter.renderedToSource(e),i=this.getRowHeight(o),a=this.getTrForRow(o),l=a.querySelector("th"),l?s=ch(l):s=ch(a)-1,(!i&&this.wtSettings.getSetting("defaultRowHeight")<s||i<s)&&(s+=1,this.dataAccessObject.wtViewport.oversizedRows[o]=s)}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=r}isRowHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=r}isRowBeforeRenderedRows(e){const t=this.getFirstRenderedRow();return e<0&&t<=0?!this.isRowHeaderRendered(e):e<t}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const t=this.getFirstRenderedColumn();return e<0&&t<=0?!this.isColumnHeaderRendered(e):e<t}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}getStretchedColumnWidth(e){return this.columnUtils.getStretchedColumnWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return rn(this.TABLE)}getHeight(){return Dn(this.TABLE)}getTotalWidth(){const e=rn(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=Dn(this.hider);return e!==0?e:this.getHeight()}isVisible(){return bh(this.TABLE)}_modifyRowHeaderWidth(e){let t=Jt(e)?e():null;return Array.isArray(t)?(t=[...t],t[t.length-1]=this._correctRowHeaderWidth(t[t.length-1])):t=this._correctRowHeaderWidth(t),t}_correctRowHeaderWidth(e){let t=e;return typeof e!="number"&&(t=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(t+=1),t}}const K9="stickyRowsBottom",o0={getFirstRenderedRow(){const n=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsBottom"),t=n-e;return n===0||e===0?-1:t<0?0:t},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const n=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),n)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};ua(o0,"MIXIN_NAME",K9,{writable:!1,enumerable:!1});const q9="stickyColumnsStart",PC={getFirstRenderedColumn(){return this.wtSettings.getSetting("totalColumns")===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){const n=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),n)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};ua(PC,"MIXIN_NAME",q9,{writable:!1,enumerable:!1});class a0 extends Ld{constructor(e,t,r,i){super(e,t,r,i,Xl)}}Wt(a0,o0);Wt(a0,PC);const Nh="top",Yo="bottom",Mh="inline_start",Ih="top_inline_start_corner",Xl="bottom_inline_start_corner",HU=[Nh,Yo,Mh,Ih,Xl],X9=new Map([[Nh,`ht_clone_${Nh}`],[Yo,`ht_clone_${Yo}`],[Mh,`ht_clone_${Mh} ht_clone_left`],[Ih,`ht_clone_${Ih} ht_clone_top_left_corner`],[Xl,`ht_clone_${Xl} ht_clone_bottom_left_corner`]]);function Q9(n,e){Z9(n,e),e.add(n)}function Z9(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function J9(n,e,t){return(e=e5(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function e5(n){var e=t5(n,"string");return typeof e=="symbol"?e:e+""}function t5(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function mp(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var lf=new WeakSet;class n5{constructor(e){Q9(this,lf),J9(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,t,r,i,s){const o=this.scrollViewportHorizontally(e.col,r,s),a=this.scrollViewportVertically(e.row,t,i);return o||a}scrollViewportHorizontally(e,t,r){const{drawn:i,totalColumns:s}=this.dataAccessObject;if(!i||!Number.isInteger(e)||e<0||e>s)return!1;const o=t===void 0&&r===void 0,{fixedColumnsStart:a,inlineStartOverlay:l}=this.dataAccessObject;if(o&&e<a||(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e),!Number.isInteger(e)||e<0||e>s))return!1;const u=this.getFirstVisibleColumn(),h=this.getLastVisibleColumn();let c=!1;return(o&&(e<u||e>h)||!o)&&(c=l.scrollTo(e,o?e>=this.getLastPartiallyVisibleColumn():t)),c}scrollViewportVertically(e,t,r){const{drawn:i,totalRows:s}=this.dataAccessObject;if(!i||!Number.isInteger(e)||e<0||e>s)return!1;const o=t===void 0&&r===void 0,{fixedRowsBottom:a,fixedRowsTop:l,topOverlay:u}=this.dataAccessObject;if(o&&(e<l||e>s-a-1)||(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e),!Number.isInteger(e)||e<0||e>s))return!1;const h=this.getFirstVisibleRow(),c=this.getLastVisibleRow();let d=!1;return(o&&(e<h||e>c)||!o)&&(d=u.scrollTo(e,o?e>=this.getLastPartiallyVisibleRow():r)),d}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return mp(lf,this,tL).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return mp(lf,this,tL).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return mp(lf,this,eL).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return mp(lf,this,eL).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function eL(n){const{wtSettings:e,inlineStartOverlay:t,wtTable:r,wtViewport:i,totalColumns:s,rootWindow:o}=this.dataAccessObject;if(t.mainTableScrollableElement===o){const a=e.getSetting("rtlMode");let l=null;if(a){const h=r.TABLE.getBoundingClientRect(),d=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;l=Math.abs(h.right-d)}else l=ir(r.wtRootElement).left;const u=Math.abs(UM(o,o));if(l>u){const h=BM(o);let c=i.getRowHeaderWidth();for(let d=1;d<=s;d++)if(c+=t.sumCellSizes(d-1,d),l+c-u>=h){n=d-2;break}}}return n}function tL(n){const{topOverlay:e,wtTable:t,wtViewport:r,totalRows:i,rootWindow:s}=this.dataAccessObject;if(e.mainTableScrollableElement===s){const o=ir(t.wtRootElement),a=RC(s,s);if(o.top>a){const l=ch(s);let u=r.getColumnHeaderHeight();for(let h=1;h<=i;h++)if(u+=e.sumCellSizes(h-1,h),o.top+u-a>=l){n=h-2;break}}}return n}function xs(n,e,t){return(e=r5(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function r5(n){var e=i5(n,"string");return typeof e=="symbol"?e:e+""}function i5(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class l0{get eventManager(){return new ys(this)}constructor(e,t){xs(this,"wtTable",void 0),xs(this,"wtScroll",void 0),xs(this,"wtViewport",void 0),xs(this,"wtOverlays",void 0),xs(this,"selectionManager",void 0),xs(this,"wtEvent",void 0),xs(this,"guid",`wt_${xM()}`),xs(this,"drawInterrupted",!1),xs(this,"drawn",!1),xs(this,"domBindings",void 0),xs(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=t,this.wtScroll=new n5(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let t=0,r=this.wtTable.THEAD.childNodes[0].childNodes.length;t<r;t++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[t].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(t,r){ru(r,e[t])}])}}createCellCoords(e,t){return new Ah(e,t,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,t,r){return new _g(e,t,r,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,this.wtTable.isVisible()?this.wtTable.draw(e):this.drawInterrupted=!0,this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const r=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),s=this.wtSettings.getSetting("fixedRowsBottom"),o=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<i&&e.col<o)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<o&&e.row>=r-s){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<o)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<r&&e.row>=r-s&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,t,r,i,s){return e.col<0||e.row<0?!1:this.wtScroll.scrollViewport(e,t,r,i,s)}scrollViewportHorizontally(e,t,r){return e<0?!1:this.wtScroll.scrollViewportHorizontally(e,t,r)}scrollViewportVertically(e,t,r){return e<0?!1:this.wtScroll.scrollViewportVertically(e,t,r)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get drawn(){return e.drawn},set drawn(t){e.drawn=t},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function nL(n,e,t){return(e=s5(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function s5(n){var e=o5(n,"string");return typeof e=="symbol"?e:e+""}function o5(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class a5 extends l0{constructor(e,t,r){super(e,t),nL(this,"cloneSource",void 0),nL(this,"cloneOverlay",void 0);const i=this.wtSettings.getSetting("facade",this);this.cloneSource=r.source,this.cloneOverlay=r.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=r.viewport,this.selectionManager=r.selectionManager,this.wtEvent=new _U(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,r.event),this.findOriginalHeaders()}}function l5(n,e,t){return(e=u5(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function u5(n){var e=h5(n,"string");return typeof e=="symbol"?e:e+""}function h5(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class xg{constructor(e,t,r,i,s){l5(this,"wtSettings",null),ua(this,"wot",e,{writable:!1}),this.domBindings=s,this.facadeGetter=t,this.wtSettings=i;const{TABLE:o,hider:a,spreader:l,holder:u,wtRootElement:h}=this.wot.wtTable;this.instance=this.wot,this.type=r,this.mainTableScrollableElement=null,this.TABLE=o,this.hider=a,this.spreader=l,this.holder=u,this.wtRootElement=h,this.trimmingContainer=Th(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=Th(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:t}=this.domBindings;t.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=$m(e.TABLE)}getRelativeCellPosition(e,t,r){if(this.clone.wtTable.holder.contains(e)===!1){Ut(`The provided element is not a child of the ${this.type} overlay`);return}const i=this.mainTableScrollableElement===this.domBindings.rootWindow,s=r<this.wtSettings.getSetting("fixedColumnsStart"),o=t<this.wtSettings.getSetting("fixedRowsTop"),a=t>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(l),top:l.offsetTop},h={start:this.getRelativeStartPosition(e),top:e.offsetTop};let c=null;return i?c=this.getRelativeCellPositionWithinWindow(o,s,h,u):c=this.getRelativeCellPositionWithinHolder(o,a,s,h,u),c}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,t,r,i){const s=this.wot.wtTable.wtRootElement.getBoundingClientRect();let o=0,a=0;if(!t)o=i.start;else{let l=s.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(s.left+s.width+or())),o=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-s.top:a=i.top,{start:r.start+o,top:r.top+a}}getRelativeCellPositionWithinHolder(e,t,r,i,s){const o={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(r||(a=o.horizontal-s.start),t){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(l=o.vertical-s.top);return{start:i.start-a,top:i.top-l}}makeClone(){if(HU.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:t}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,s=r.createElement("div"),o=r.createElement("table"),a=e.wtRootElement.parentNode;s.className=`${X9.get(this.type)} handsontable`,s.setAttribute("dir",this.isRtl()?"rtl":"ltr"),s.style.position="absolute",s.style.top=0,s.style.overflow="visible",this.isRtl()?s.style.right=0:s.style.left=0,t.getSetting("ariaTags")&&Ge(s,[Xo()]),o.className=e.TABLE.className,e.TABLE.getAttribute("role")&&o.setAttribute("role",e.TABLE.getAttribute("role")),s.appendChild(o),a.appendChild(s);const u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===Nh||u==="vertical"&&this.type===Mh?this.mainTableScrollableElement=i:i.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=$m(e.TABLE),new a5(o,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.needFullRender&&this.clone.draw(e)}reset(){const e=this.clone.wtTable.holder,t=this.clone.wtTable.hider,r=e.style,i=t.style,s=e.parentNode.style;[r,i,s].forEach(o=>{o.width="",o.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class c5 extends xg{constructor(e,t,r,i,s,o){super(e,t,Xl,r,i),this.bottomOverlay=s,this.inlineStartOverlay=o}createTable(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new a0(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const t=this.clone.wtTable.holder.parentNode;if(t.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const s=this.inlineStartOverlay.getOverlayOffset(),o=this.bottomOverlay.getOverlayOffset();t.style[this.isRtl()?"right":"left"]=`${s}px`,t.style.bottom=`${o}px`}else Mg(t),this.repositionOverlay();let r=Dn(this.clone.wtTable.TABLE);const i=rn(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),t.style.height=`${r}px`,t.style.width=`${i}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let s=0;t.hasVerticalScroll()||(s+=t.getWorkspaceHeight()-e.getTotalHeight()),t.hasVerticalScroll()&&t.hasHorizontalScroll()&&(s+=or(r)),i.style.bottom=`${s}px`}}const d5="calculatedColumns",xC={getFirstRenderedColumn(){const n=this.dataAccessObject.startColumnRendered;return n===null?-1:n},getFirstVisibleColumn(){const n=this.dataAccessObject.startColumnVisible;return n===null?-1:n},getFirstPartiallyVisibleColumn(){const n=this.dataAccessObject.startColumnPartiallyVisible;return n===null?-1:n},getLastRenderedColumn(){const n=this.dataAccessObject.endColumnRendered;return n===null?-1:n},getLastVisibleColumn(){const n=this.dataAccessObject.endColumnVisible;return n===null?-1:n},getLastPartiallyVisibleColumn(){const n=this.dataAccessObject.endColumnPartiallyVisible;return n===null?-1:n},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};ua(xC,"MIXIN_NAME",d5,{writable:!1,enumerable:!1});class u0 extends Ld{constructor(e,t,r,i){super(e,t,r,i,Yo)}}Wt(u0,o0);Wt(u0,xC);function f5(n,e,t){return(e=m5(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function m5(n){var e=g5(n,"string");return typeof e=="symbol"?e:e+""}function g5(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class p5 extends xg{constructor(e,t,r,i){super(e,t,Yo,r,i),f5(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new u0(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,t=this.clone.wtTable.holder.parentNode;t.style.top="";let r=0;const i=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!i||i!=="vertical")?(r=this.getOverlayOffset(),t.style.bottom=`${r}px`):(r=this.getScrollPosition(),this.repositionOverlay());const s=this.adjustHeaderBordersPosition(r);return this.adjustElementsSize(),s}repositionOverlay(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let s=0;t.hasVerticalScroll()||(s+=t.getWorkspaceHeight()-e.getTotalHeight()),t.hasVerticalScroll()&&t.hasHorizontalScroll()&&(s+=or(r)),i.style.bottom=`${s}px`}setScrollPosition(e){const{rootWindow:t}=this.domBindings;let r=!1;return this.mainTableScrollableElement===t?(t.scrollTo(SC(t),e),r=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,t){const{wtTable:r,wtSettings:i}=this.wot,s=i.getSetting("defaultRowHeight");let o=e,a=0;for(;o<t;){const l=r.getRowHeight(o);a+=l===void 0?s:l,o+=1}return a}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,s=or(r),a=this.clone.wtTable.holder.parentNode.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||l==="horizontal"){let h=t.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(h-=s),h=Math.min(h,e.wtRootElement.scrollWidth),a.width=`${h}px`}else a.width="";this.clone.wtTable.holder.style.width=a.width;let u=Dn(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(u=0),a.height=`${u}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:t}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?t.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:t.style[e]=""}scrollTo(e,t){let r=this.getTableParentOffset();const s=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let o=0;t&&s.offsetHeight!==s.clientHeight&&(o=or(this.domBindings.rootDocument)),t?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportHeight(),r+=1):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),r+=o,this.setScrollPosition(r)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return RC(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!t||t!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),o=i-s,a=this.domBindings.rootDocument.documentElement.clientHeight;r=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+i,0),r>o&&(r=0)}return r}adjustHeaderBordersPosition(e){const t=this.wtSettings.getSetting("fixedRowsBottom"),r=this.cachedFixedRowsBottom!==t,i=this.wtSettings.getSetting("columnHeaders");let s=!1;if((r||t===0)&&i.length>0){const o=this.wot.wtTable.holder.parentNode,a=je(o,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(ie(o,"innerBorderBottom"),s=!a):(Xe(o,"innerBorderBottom"),s=a)}return s}}const w5="calculatedRows",h0={getFirstRenderedRow(){const n=this.dataAccessObject.startRowRendered;return n===null?-1:n},getFirstVisibleRow(){const n=this.dataAccessObject.startRowVisible;return n===null?-1:n},getFirstPartiallyVisibleRow(){const n=this.dataAccessObject.startRowPartiallyVisible;return n===null?-1:n},getLastRenderedRow(){const n=this.dataAccessObject.endRowRendered;return n===null?-1:n},getLastVisibleRow(){const n=this.dataAccessObject.endRowVisible;return n===null?-1:n},getLastPartiallyVisibleRow(){const n=this.dataAccessObject.endRowPartiallyVisible;return n===null?-1:n},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};ua(h0,"MIXIN_NAME",w5,{writable:!1,enumerable:!1});class c0 extends Ld{constructor(e,t,r,i){super(e,t,r,i,Mh)}}Wt(c0,h0);Wt(c0,PC);const v5="localHooks",Or={_localHooks:Object.create(null),addLocalHook(n,e){return this._localHooks[n]||(this._localHooks[n]=[]),this._localHooks[n].push(e),this},runLocalHooks(n,e,t,r,i,s,o){if(this._localHooks[n]){const a=this._localHooks[n].length;for(let l=0;l<a;l++)Vv(this._localHooks[n][l],this,e,t,r,i,s,o)}},clearLocalHooks(){return this._localHooks={},this}};ua(Or,"MIXIN_NAME",v5,{writable:!1,enumerable:!1});let DU=class{constructor(e,t){this.settings=e,this.cellRange=t||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,t){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=t,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=t,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),t=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,t.row,t.col]}destroy(){this.runLocalHooks("destroy")}};Wt(DU,Or);const FU="active-header",d0="header",f0="area",m0="focus",y5="fill",C5="row",S5="column",R5="custom-selection",g0=Object.freeze({width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"});var rL={},iL;function E5(){if(iL)return rL;iL=1;var n=JM();return n("flat"),rL}E5();function b5(n,e){kU(n,e),e.add(n)}function sL(n,e,t){kU(n,e),e.set(n,t)}function kU(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kn(n,e){return n.get(um(n,e))}function oL(n,e,t){return n.set(um(n,e),t),t}function um(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Ls=new WeakMap,hi=new WeakMap,gp=new WeakSet;class T5{constructor(){b5(this,gp),sL(this,Ls,void 0),sL(this,hi,void 0)}setActiveOverlay(e){return oL(hi,this,e),this}setActiveSelection(e){return oL(Ls,this,e),this}scan(){const e=kn(Ls,this).settings.selectionType,t=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(r=>t.add(r)),this.scanRowsInHeadersRange(r=>t.add(r))):e==="area"?this.scanCellsRange(r=>t.add(r)):e==="focus"?(this.scanColumnsInHeadersRange(r=>t.add(r)),this.scanRowsInHeadersRange(r=>t.add(r)),this.scanCellsRange(r=>t.add(r))):e==="fill"?this.scanCellsRange(r=>t.add(r)):e==="header"?(this.scanColumnsInHeadersRange(r=>t.add(r)),this.scanRowsInHeadersRange(r=>t.add(r))):e==="row"?(this.scanRowsInHeadersRange(r=>t.add(r)),this.scanRowsInCellsRange(r=>t.add(r))):e==="column"&&(this.scanColumnsInHeadersRange(r=>t.add(r)),this.scanColumnsInCellsRange(r=>t.add(r))),t}scanColumnsInHeadersRange(e){const[t,r,i,s]=kn(Ls,this).getCorners(),{wtTable:o}=kn(hi,this),a=o.getRenderedColumnsCount(),l=o.getColumnHeadersCount();let u=0;for(let h=-o.getRowHeadersCount();h<a;h++){const c=o.columnFilter.renderedToSource(h);if(!(c<r||c>s)){for(let d=-l;d<0;d++){if(d<t||d>i)continue;const f=d+l;let g=o.getColumnHeader(c,f);const p=kn(hi,this).getSetting("onBeforeHighlightingColumnHeader",c,f,{selectionType:kn(Ls,this).settings.selectionType,columnCursor:u,selectionWidth:s-r+1});p!==null&&(p!==c&&(g=o.getColumnHeader(p,f)),e(g))}u+=1}}}scanRowsInHeadersRange(e){const[t,r,i,s]=kn(Ls,this).getCorners(),{wtTable:o}=kn(hi,this),a=o.getRenderedRowsCount(),l=o.getRowHeadersCount();let u=0;for(let h=-o.getColumnHeadersCount();h<a;h++){const c=o.rowFilter.renderedToSource(h);if(!(c<t||c>i)){for(let d=-l;d<0;d++){if(d<r||d>s)continue;const f=d+l;let g=o.getRowHeader(c,f);const p=kn(hi,this).getSetting("onBeforeHighlightingRowHeader",c,f,{selectionType:kn(Ls,this).settings.selectionType,rowCursor:u,selectionHeight:i-t+1});p!==null&&(p!==c&&(g=o.getRowHeader(p,f)),e(g))}u+=1}}}scanCellsRange(e){const[t,r,i,s]=kn(Ls,this).getCorners(),{wtTable:o}=kn(hi,this);um(gp,this,ab).call(this,(a,l)=>{if(a>=t&&a<=i&&l>=r&&l<=s){const u=o.getCell(kn(hi,this).createCellCoords(a,l)),h=kn(hi,this).getSetting("onAfterDrawSelection",a,l,kn(Ls,this).settings.layerLevel);typeof h=="string"&&ie(u,h),e(u)}})}scanRowsInCellsRange(e){const[t,,r]=kn(Ls,this).getCorners(),{wtTable:i}=kn(hi,this);um(gp,this,ab).call(this,(s,o)=>{if(s>=t&&s<=r){const a=i.getCell(kn(hi,this).createCellCoords(s,o));e(a)}})}scanColumnsInCellsRange(e){const[,t,,r]=kn(Ls,this).getCorners(),{wtTable:i}=kn(hi,this);um(gp,this,ab).call(this,(s,o)=>{if(o>=t&&o<=r){const a=i.getCell(kn(hi,this).createCellCoords(s,o));e(a)}})}}function ab(n){const{wtTable:e}=kn(hi,this),t=e.getRenderedRowsCount(),r=e.getRenderedColumnsCount();for(let i=0;i<t;i+=1){const s=e.rowFilter.renderedToSource(i);for(let o=0;o<r;o+=1)n(s,e.columnFilter.renderedToSource(o))}}class aL{constructor(e,t){t&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=t,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=g0,this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(t),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let t=0,r=this.main.childNodes.length;t<r;t++){const i=this.main.childNodes[t];this.eventManager.addEventListener(i,"mouseenter",s=>this.onMouseEnter(s,this.main.childNodes[t]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,t){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),Ns(e);const r=this,i=this.wot.rootDocument.body,s=t.getBoundingClientRect();t.style.display="none";function o(l){if(l.clientY<Math.floor(s.top)||l.clientY>Math.ceil(s.top+s.height)||l.clientX<Math.floor(s.left)||l.clientX>Math.ceil(s.left+s.width))return!0}function a(l){o(l)&&(r.eventManager.removeEventListener(i,"mousemove",a),t.style.display="block")}this.eventManager.addEventListener(i,"mousemove",a)}createBorders(e){const{rootDocument:t}=this.wot;this.main=t.createElement("div");const r=["top","start","bottom","end","corner"];let i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(let a=0;a<5;a++){const l=r[a],u=t.createElement("div");u.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(u.className+=" hidden"),i=u.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,i.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,i.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Ba()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:s}=this.wot;let o=s.bordersHolder;o||(o=t.createElement("div"),o.className="htBorders",s.bordersHolder=o,s.spreader.appendChild(o)),o.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e}=this.wot;this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const t=10,r=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const i={position:"absolute",height:`${r}px`,width:`${r}px`,"border-radius":`${parseInt(r/1.5,10)}px`};at(i,(o,a)=>{this.selectionHandles.styles.bottomHitArea[a]=o,this.selectionHandles.styles.topHitArea[a]=o});const s={position:"absolute",height:`${t}px`,width:`${t}px`,"border-radius":`${parseInt(t/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"};at(s,(o,a)=>{this.selectionHandles.styles.bottom[a]=o,this.selectionHandles.styles.top[a]=o}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,t){const r=this.wot.selectionManager.getAreaSelection();return!!(r.cellRange&&(e!==r.cellRange.to.row||t!==r.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,t,r,i,s,o){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:h,bottom:c,bottomHitArea:d}=this.selectionHandles.styles,f=parseInt(u.borderWidth,10),g=parseInt(u.width,10),p=parseInt(h.width,10),v=this.wot.wtTable.getWidth(),y=this.wot.wtTable.getHeight();u.top=`${parseInt(r-g-1,10)}px`,u[l]=`${parseInt(i-g-1,10)}px`,h.top=`${parseInt(r-p/4*3,10)}px`,h[l]=`${parseInt(i-p/4*3,10)}px`;const S=Math.min(parseInt(i+s,10),v-g-f*2),R=Math.min(parseInt(i+s-p/4,10),v-p-f*2);c[l]=`${S}px`,d[l]=`${R}px`;const A=Math.min(parseInt(r+o,10),y-g-f*2),O=Math.min(parseInt(r+o-p/4,10),y-p-f*2);c.top=`${A}px`,d.top=`${O}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",h.display="block",this.isPartRange(e,t)?(c.display="none",d.display="none"):(c.display="block",d.display="block")):(u.display="none",c.display="none",h.display="none",d.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||t===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",h.zIndex="9999"):(u.zIndex="",h.zIndex="")}appear(e){if(this.disabled)return;const{wtTable:t,rootDocument:r,rootWindow:i}=this.wot;let s,o,a,l,u,h;const c=t.getRenderedRowsCount();for(let Se=0;Se<c;Se+=1){const ye=t.rowFilter.renderedToSource(Se);if(ye>=e[0]&&ye<=e[2]){s=ye,u=e[0];break}}for(let Se=c-1;Se>=0;Se-=1){const ye=t.rowFilter.renderedToSource(Se);if(ye>=e[0]&&ye<=e[2]){o=ye;break}}const d=t.getRenderedColumnsCount();for(let Se=0;Se<d;Se+=1){const ye=t.columnFilter.renderedToSource(Se);if(ye>=e[1]&&ye<=e[3]){a=ye,h=e[1];break}}for(let Se=d-1;Se>=0;Se-=1){const ye=t.columnFilter.renderedToSource(Se);if(ye>=e[1]&&ye<=e[3]){l=ye;break}}if(s===void 0||a===void 0){this.disappear();return}let f=t.getCell(this.wot.createCellCoords(s,a));const g=s!==o||a!==l,p=g?t.getCell(this.wot.createCellCoords(o,l)):f,v=ir(f),y=g?ir(p):v,S=ir(t.TABLE),R=rn(t.TABLE),A=v.top,O=v.left,V=this.wot.wtSettings.getSetting("rtlMode");let B=0,Y=0;if(V){const Se=rn(f),ye=i.innerWidth-S.left-R;Y=O+Se-y.left,B=i.innerWidth-O-Se-ye-1}else Y=y.left+rn(p)-O,B=O-S.left-1;if(this.isEntireColumnSelected(s,o)){const Se=this.getDimensionsFromHeader("columns",a,l,u,S);let ye=null;Se&&([ye,B,Y]=Se),ye&&(f=ye)}let q=A-S.top-1,G=y.top+Dn(p)-A;if(this.isEntireRowSelected(a,l)){const Se=this.getDimensionsFromHeader("rows",s,o,h,S);let ye=null;Se&&([ye,q,G]=Se),ye&&(f=ye)}const Z=ra(f,i);parseInt(Z.borderTopWidth,10)>0&&(q+=1,G=G>0?G-1:0),parseInt(Z[V?"borderRightWidth":"borderLeftWidth"],10)>0&&(B+=1,Y=Y>0?Y-1:0);const ee=V?"right":"left";this.topStyle.top=`${q}px`,this.topStyle[ee]=`${B}px`,this.topStyle.width=`${Y}px`,this.topStyle.display="block",this.startStyle.top=`${q}px`,this.startStyle[ee]=`${B}px`,this.startStyle.height=`${G}px`,this.startStyle.display="block";const ne=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${q+G-ne}px`,this.bottomStyle[ee]=`${B}px`,this.bottomStyle.width=`${Y}px`,this.bottomStyle.display="block",this.endStyle.top=`${q}px`,this.endStyle[ee]=`${B+Y-ne}px`,this.endStyle.height=`${G+1}px`,this.endStyle.display="block";let re=this.settings.border.cornerVisible;re=typeof re=="function"?re(this.settings.layerLevel):re;const ae=this.wot.getSetting("onModifyGetCellCoords",o,l);let[ze,Le]=[o,l];if(ae&&Array.isArray(ae)&&([,,ze,Le]=ae),Ba()||!re||this.isPartRange(ze,Le))this.cornerStyle.display="none";else{this.cornerStyle.top=`${q+G+this.cornerCenterPointOffset-1}px`,this.cornerStyle[ee]=`${B+Y+this.cornerCenterPointOffset-1}px`,this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let Se=Th(t.TABLE);const ye=Se===i;ye&&(Se=r.documentElement);const We=parseInt(this.cornerDefaultStyle.width,10)/2,w=parseInt(this.cornerDefaultStyle.height,10)/2;if(l===this.wot.getSetting("totalColumns")-1){const C=ye?p.getBoundingClientRect().left:p.offsetLeft;let b=!1,P=0;V?(P=C-parseInt(this.cornerDefaultStyle.width,10)/2,b=P<0):(P=C+rn(p)+parseInt(this.cornerDefaultStyle.width,10)/2,b=P>=BM(Se)),b&&(this.cornerStyle[ee]=`${Math.floor(B+Y+this.cornerCenterPointOffset-We)}px`,this.cornerStyle[V?"borderLeftWidth":"borderRightWidth"]=0)}o===this.wot.getSetting("totalRows")-1&&(ye?p.getBoundingClientRect().top:p.offsetTop)+Dn(p)+parseInt(this.cornerDefaultStyle.height,10)/2>=ch(Se)&&(this.cornerStyle.top=`${Math.floor(q+G+this.cornerCenterPointOffset-w)}px`,this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"}Ba()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(o,l,q,B,Y,G)}isEntireColumnSelected(e,t){return e===this.wot.wtTable.getFirstRenderedRow()&&t===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,t){return e===this.wot.wtTable.getFirstRenderedColumn()&&t===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,t,r,i,s){const{wtTable:o}=this.wot,a=o.wtRootElement.parentNode;let l=null,u=null,h=null,c=null,d=null,f=null,g=null,p=null;switch(e){case"rows":l=function(){return o.getRowHeader(...arguments)},u=function(){return Dn(...arguments)},h="ht__selection--rows",f="top";break;case"columns":l=function(){return o.getColumnHeader(...arguments)},u=function(){return rn(...arguments)},h="ht__selection--columns",f="left";break}if(a.classList.contains(h)){const v=this.wot.getSetting("columnHeaders").length;if(g=l(t,v-i),p=l(r,v-i),!g||!p)return!1;const y=ir(g),S=ir(p);return g&&p&&(c=y[f]-s[f]-1,d=S[f]+u(p)-y[f]),[g,c,d]}return!1}changeBorderStyle(e,t){const r=this[e].style,i=t[e];!i||i.hide?ie(this[e],"hidden"):(je(this[e],"hidden")&&Xe(this[e],"hidden"),r.backgroundColor=i.color,(e==="top"||e==="bottom")&&(r.height=`${i.width}px`),(e==="start"||e==="end")&&(r.width=`${i.width}px`))}changeBorderToDefaultStyle(e){const t={width:1,color:"#000"},r=this[e].style;r.backgroundColor=t.color,r.width=`${t.width}px`,r.height=`${t.width}px`}toggleHiddenClass(e,t){this.changeBorderToDefaultStyle(e),t?ie(this[e],"hidden"):Xe(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",Ba()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}function A5(n,e){VU(n,e),e.add(n)}function ic(n,e,t){VU(n,e),e.set(n,t)}function VU(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mt(n,e){return n.get(p0(n,e))}function lL(n,e,t){return n.set(p0(n,e),t),t}function p0(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Dr=new WeakMap,mi=new WeakMap,lb=new WeakMap,qf=new WeakMap,ub=new WeakMap,Su=new WeakMap,uL=new WeakSet;class N5{constructor(e){A5(this,uL),ic(this,Dr,void 0),ic(this,mi,void 0),ic(this,lb,new T5),ic(this,qf,new WeakMap),ic(this,ub,new WeakSet),ic(this,Su,new Map),lL(mi,this,e)}setActiveOverlay(e){return lL(Dr,this,e),mt(lb,this).setActiveOverlay(mt(Dr,this)),mt(qf,this).has(mt(Dr,this))||mt(qf,this).set(mt(Dr,this),new Set),this}getFocusSelection(){return mt(mi,this)!==null?mt(mi,this).getFocus():null}getAreaSelection(){return mt(mi,this)!==null?mt(mi,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(mt(Su,this).has(e)){const r=mt(Su,this).get(e);if(r.has(mt(Dr,this)))return r.get(mt(Dr,this));const i=new aL(mt(Dr,this),e.settings);return r.set(mt(Dr,this),i),i}const t=new aL(mt(Dr,this),e.settings);return mt(Su,this).set(e,new Map([[mt(Dr,this),t]])),t}getBorderInstances(e){var t,r;return Array.from((t=(r=mt(Su,this).get(e))===null||r===void 0?void 0:r.values())!==null&&t!==void 0?t:[])}destroyBorders(e){mt(Su,this).get(e).forEach(t=>t.destroy()),mt(Su,this).delete(e)}render(e){if(mt(mi,this)===null)return;e&&p0(uL,this,M5).call(this);const t=Array.from(mt(mi,this)),r=new Map,i=new Map;for(let s=0;s<t.length;s++){const o=t[s],{className:a,headerAttributes:l,createLayers:u,selectionType:h}=o.settings;mt(ub,this).has(o)||(mt(ub,this).add(o),o.addLocalHook("destroy",()=>this.destroyBorders(o)));const c=this.getBorderInstance(o);if(o.isEmpty()){c?.disappear();continue}a&&mt(lb,this).setActiveSelection(o).scan().forEach(g=>{if(r.has(g)){const p=r.get(g);p.has(a)&&u===!0?p.set(a,p.get(a)+1):p.set(a,1)}else r.set(g,new Map([[a,1]]));l&&(i.has(g)||i.set(g,[]),g.nodeName==="TH"&&i.get(g).push(...l))});const d=o.getCorners();mt(Dr,this).getSetting("onBeforeDrawBorders",d,h),c?.appear(d)}r.forEach((s,o)=>{var a;const l=Array.from(s).map(u=>{let[h,c]=u;return c===1?h:[h,...Array.from({length:c-1},(d,f)=>`${h}-${f+1}`)]}).flat();l.forEach(u=>mt(qf,this).get(mt(Dr,this)).add(u)),ie(o,l),o.nodeName==="TD"&&Array.isArray((a=mt(mi,this).options)===null||a===void 0?void 0:a.cellAttributes)&&Ge(o,mt(mi,this).options.cellAttributes)}),Array.from(i.keys()).forEach(s=>{Ge(s,[...i.get(s)])})}}function M5(){const n=mt(qf,this).get(mt(Dr,this)),e=mt(Dr,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let t=0;t<e.length;t++)n.add(e[t]);n.forEach(t=>{var r,i;const s=mt(Dr,this).wtTable.TABLE.querySelectorAll(`.${t}`);let o=[];Array.isArray((r=mt(mi,this).options)===null||r===void 0?void 0:r.cellAttributes)&&(o=mt(mi,this).options.cellAttributes.map(a=>a[0])),Array.isArray((i=mt(mi,this).options)===null||i===void 0?void 0:i.headerAttributes)&&(o=[...o,...mt(mi,this).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=s.length;a<l;a++)Xe(s[a],t),Gh(s[a],o)}),n.clear()}class I5 extends xg{constructor(e,t,r,i){super(e,t,Mh,r,i)}createTable(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new c0(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:t}=this.domBindings,r=this.clone.wtTable.holder.parentNode,i=this.wtSettings.getSetting("preventOverflow");let s=0;this.trimmingContainer===t&&(!i||i!=="horizontal")?(s=this.getOverlayOffset()*(this.isRtl()?-1:1),EC(r,`${s}px`,"0px")):(s=this.getScrollPosition(),Mg(r));const o=this.adjustHeaderBordersPosition(s);return this.adjustElementsSize(),o}setScrollPosition(e){const{rootWindow:t}=this.domBindings;let r=!1;return this.isRtl()&&(e=-e),this.mainTableScrollableElement===t&&t.scrollX!==e?(t.scrollTo(e,VM(t)),r=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,t){const r=this.wtSettings.getSetting("defaultColumnWidth");let i=e,s=0;for(;i<t;)s+=this.wot.wtTable.getStretchedColumnWidth(i)||r,i+=1;return s}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:t,rootWindow:r}=this.domBindings,i=or(t),o=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||a==="vertical"){let u=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(u-=i),u=Math.min(u,e.wtRootElement.scrollHeight),o.height=`${u}px`}else o.height="";this.clone.wtTable.holder.style.height=o.height;const l=rn(this.clone.wtTable.TABLE);o.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,t=this.wot.selectionManager.getFocusSelection()?parseInt(g0.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+t}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),t=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[t]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[t]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,t){const{wtSettings:r}=this,i=r.getSetting("rowHeaders"),s=r.getSetting("fixedColumnsStart"),a=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,l=s===0&&i.length>0&&!je(a.parentNode,"innerBorderInlineStart")?1:0;let u=this.getTableParentOffset(),h=0;if(t){const c=this.wot.wtTable.getColumnWidth(e),d=this.wot.wtViewport.getViewportWidth();c>d&&(t=!1)}return t&&a.offsetWidth!==a.clientWidth&&(h=or(this.domBindings.rootDocument)),t?(u+=this.sumCellSizes(0,e+1),u-=this.wot.wtViewport.getViewportWidth(),u+=l):u+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),u+=h,YV(this.mainTableScrollableElement)===u-l&&l>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(l),this.setScrollPosition(u)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let t=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(t=this.wot.wtTable.holderOffset.left),t}getScrollPosition(){return Math.abs(UM(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!t||t!=="horizontal")){this.isRtl()?r=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const i=this.wot.wtTable.getTotalWidth(),s=this.clone.wtTable.getTotalWidth(),o=i-s;r>o&&(r=0)}return r}adjustHeaderBordersPosition(e){const{wtSettings:t}=this,r=this.wot.wtTable.holder.parentNode,i=t.getSetting("rowHeaders"),s=t.getSetting("fixedColumnsStart"),o=t.getSetting("totalRows"),a=t.getSetting("preventOverflow")==="vertical";o?Xe(r,"emptyRows"):ie(r,"emptyRows");let l=!1;if(!a){if(s&&!i.length)ie(r,"innerBorderLeft innerBorderInlineStart");else if(!s&&i.length){const u=je(r,"innerBorderInlineStart");e?(ie(r,"innerBorderLeft innerBorderInlineStart"),l=!u):(Xe(r,"innerBorderLeft innerBorderInlineStart"),l=u)}}return l}}const O5="stickyRowsTop",w0={getFirstRenderedRow(){return this.wtSettings.getSetting("totalRows")===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const n=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),n)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};ua(w0,"MIXIN_NAME",O5,{writable:!1,enumerable:!1});class v0 extends Ld{constructor(e,t,r,i){super(e,t,r,i,Ih)}}Wt(v0,w0);Wt(v0,PC);function hL(n,e,t){return(e=_5(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function _5(n){var e=P5(n,"string");return typeof e=="symbol"?e:e+""}function P5(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class x5 extends xg{constructor(e,t,r,i,s,o){super(e,t,Ih,r,i),hL(this,"topOverlay",void 0),hL(this,"inlineStartOverlay",void 0),this.topOverlay=s,this.inlineStartOverlay=o}createTable(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new v0(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),s=this.topOverlay.getOverlayOffset();EC(e,`${i}px`,`${s}px`)}else Mg(e);let t=Dn(this.clone.wtTable.TABLE);const r=rn(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(t=0),e.style.height=`${t}px`,e.style.width=`${r}px`,!1}}class y0 extends Ld{constructor(e,t,r,i){super(e,t,r,i,Nh)}}Wt(y0,w0);Wt(y0,xC);function L5(n,e,t){return(e=H5(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function H5(n){var e=D5(n,"string");return typeof e=="symbol"?e:e+""}function D5(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class F5 extends xg{constructor(e,t,r,i){super(e,t,Nh,r,i),L5(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new y0(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:t}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let i=0,s=!1;if(this.trimmingContainer===t&&(!r||r!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),u=Math.ceil(l.bottom),h=e.offsetHeight;s=u===h,i=this.getOverlayOffset(),EC(e,"0px",`${i}px`)}else i=this.getScrollPosition(),Mg(e);const o=this.adjustHeaderBordersPosition(i,s);return this.adjustElementsSize(),o}setScrollPosition(e){const t=this.domBindings.rootWindow;let r=!1;return this.mainTableScrollableElement===t&&t.scrollY!==e?(t.scrollTo(SC(t),e),r=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,t){const r=this.wtSettings.getSetting("defaultRowHeight");let i=e,s=0;for(;i<t;){const o=this.wot.wtTable.getRowHeight(i);s+=o===void 0?r:o,i+=1}return s}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:t,rootWindow:r}=this.domBindings,i=or(t),o=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||a==="horizontal"){let u=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(u-=i),u=Math.min(u,e.wtRootElement.scrollWidth),o.width=`${u}px`}else o.width="";this.clone.wtTable.holder.style.width=o.width;let l=Dn(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(l=0),o.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,t=this.wot.selectionManager.getFocusSelection()?parseInt(g0.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+t}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:t}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?t.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:t.style[e]=""}scrollTo(e,t){const{wot:r,wtSettings:i}=this,o=(r.cloneSource?r.cloneSource:r).wtTable.holder,a=i.getSetting("columnHeaders"),u=i.getSetting("fixedRowsTop")===0&&a.length>0&&!je(o.parentNode,"innerBorderTop")?1:0;let h=this.getTableParentOffset(),c=0;if(t){const d=this.wot.wtTable.getRowHeight(e),f=this.wot.wtViewport.getViewportHeight();d>f&&(t=!1)}if(t&&o.offsetHeight!==o.clientHeight&&(c=or(this.domBindings.rootDocument)),t){const d=i.getSetting("fixedRowsBottom"),f=i.getSetting("totalRows");h+=this.sumCellSizes(0,e+1),h-=r.wtViewport.getViewportHeight()-this.sumCellSizes(f-d,f),h+=1,h+=u}else h+=this.sumCellSizes(i.getSetting("fixedRowsTop"),e);return h+=c,zV(this.mainTableScrollableElement)===h-u&&u>0&&this.wot.wtOverlays.expandHiderVerticallyBy(u),this.setScrollPosition(h)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return RC(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!t||t!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),o=i-s;r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),r>o&&(r=0)}return r}adjustHeaderBordersPosition(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{wtSettings:r}=this,i=this.wot.wtTable.holder.parentNode,s=r.getSetting("totalColumns"),o=r.getSetting("preventOverflow")==="horizontal";s?Xe(i,"emptyColumns"):ie(i,"emptyColumns");let a=!1;if(!t&&!o){const l=r.getSetting("fixedRowsTop"),u=this.cachedFixedRowsTop!==l,h=r.getSetting("columnHeaders");if((u||l===0)&&h.length>0){const c=je(i,"innerBorderTop");this.cachedFixedRowsTop=r.getSetting("fixedRowsTop"),e||r.getSetting("totalRows")===0?(ie(i,"innerBorderTop"),a=!c):(Xe(i,"innerBorderTop"),a=c)}}return a}}function pp(n,e,t){k5(n,e),e.set(n,t)}function k5(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ga(n,e,t){return(e=V5(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function V5(n){var e=U5(n,"string");return typeof e=="symbol"?e:e+""}function U5(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Ru(n,e,t){return n.set(UU(n,e),t),t}function pa(n,e){return n.get(UU(n,e))}function UU(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var sc=new WeakMap,wp=new WeakMap,oc=new WeakMap,vp=new WeakMap;class B5{constructor(e,t,r,i,s,o){ga(this,"wot",null),pp(this,sc,[]),ga(this,"topOverlay",null),ga(this,"bottomOverlay",null),ga(this,"inlineStartOverlay",null),ga(this,"topInlineStartCornerOverlay",null),ga(this,"bottomInlineStartCornerOverlay",null),ga(this,"browserLineHeight",void 0),ga(this,"wtSettings",null),pp(this,wp,!1),pp(this,oc,0),pp(this,vp,null),ga(this,"resizeObserver",new ResizeObserver(h=>{MC(()=>{!Array.isArray(h)||!h.length||(Ru(oc,this,pa(oc,this)+1),pa(oc,this)===100&&(Ut("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),pa(vp,this)!==null&&clearTimeout(pa(vp,this)),Ru(vp,this,setTimeout(()=>{Ru(oc,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=i,this.domBindings=r,this.facadeGetter=t,this.wtTable=o;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=s,this.scrollbarSize=or(a);const u=l.getComputedStyle(o.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?o.holder:$m(o.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const t=[...pa(sc,this)];return e&&t.push(this.wtTable),t}initBrowserLineHeight(){const{rootWindow:e,rootDocument:t}=this.domBindings,r=e.getComputedStyle(t.body),i=parseInt(r.lineHeight,10),s=parseInt(r.fontSize,10)*1.2;this.browserLineHeight=i||s}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new F5(...e),this.bottomOverlay=new p5(...e),this.inlineStartOverlay=new I5(...e),this.topInlineStartCornerOverlay=new x5(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new c5(...e,this.bottomOverlay,this.inlineStartOverlay),Ru(sc,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){Ru(wp,this,pa(sc,this).reduce((e,t)=>t.hasRenderingStateChanged()||e,!1)),pa(sc,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),pa(sc,this).forEach(e=>{const t=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),t&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:t}=this.domBindings,{mainTableScrollableElement:r}=this.topOverlay,{mainTableScrollableElement:i}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",c=>this.onKeyDown(c)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(r,"scroll",c=>this.onTableScroll(c),{passive:!0}),r!==i&&this.eventManager.addEventListener(i,"scroll",c=>this.onTableScroll(c),{passive:!0});const s=t.devicePixelRatio&&t.devicePixelRatio>1,o=this.scrollableElement===t,a=this.wtSettings.getSetting("preventWheel"),l={passive:o};(a||s||!KM())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",c=>this.onCloneWheel(c,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(c=>{if(c&&c.needFullRender){const{holder:d}=c.clone.wtTable;this.eventManager.addEventListener(d,"wheel",f=>this.onCloneWheel(f,a),l)}});let h;this.eventManager.addEventListener(t,"resize",()=>{clearTimeout(h),h=setTimeout(()=>{this.wtSettings.getSetting("onWindowResize"),Ru(oc,this,0)},200)}),o||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}deregisterListeners(){this.eventManager.clearEvents(!0)}onTableScroll(e){const t=this.domBindings.rootWindow,r=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,s=e.target;this.keyPressed&&(i!==t&&s!==t&&!e.target.contains(i)||r!==t&&s!==t&&!e.target.contains(r))||this.syncScrollPositions(e)}onCloneWheel(e,t){const{rootWindow:r}=this.domBindings,i=this.inlineStartOverlay.mainTableScrollableElement,s=this.topOverlay.mainTableScrollableElement,o=e.target,a=s!==r&&o!==r&&!o.contains(s),l=i!==r&&o!==r&&!o.contains(i);if(this.keyPressed&&(a||l)||this.scrollableElement===r)return;const u=this.translateMouseWheelToScroll(e);(t||this.scrollableElement!==r&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=xd(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let t=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,r=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(r+=r*this.browserLineHeight,t+=t*this.browserLineHeight);const i=this.scrollVertically(t),s=this.scrollHorizontally(r);return i||s}scrollVertically(e){const t=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,t!==this.scrollableElement.scrollTop}scrollHorizontally(e){const t=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,t!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const{rootWindow:e}=this.domBindings,t=this.topOverlay.clone.wtTable.holder,r=this.inlineStartOverlay.clone.wtTable.holder,[i,s]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=t.scrollLeft!==i||this.lastScrollX!==e.scrollX,this.verticalScrolling=r.scrollTop!==s||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling){t.scrollLeft=i;const o=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;o&&(o.scrollLeft=i)}this.verticalScrolling&&(r.scrollTop=s),this.refreshAll()}syncScrollWithMaster(){if(!pa(wp,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:t,scrollTop:r}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=t),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=t),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=r),Ru(wp,this,!1)}updateMainScrollableElements(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:t}=this.domBindings;t.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=$m(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,t=e.clientWidth,r=e.clientHeight,i=t!==this.spreaderLastSize.width||r!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=t,this.spreaderLastSize.height=r),i}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:t}=this,{rootWindow:r}=this.domBindings,i=this.scrollableElement===r,s=this.wtSettings.getSetting("totalColumns"),o=this.wtSettings.getSetting("totalRows"),a=e.getRowHeaderWidth(),u=e.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,o)+1,h=a+this.inlineStartOverlay.sumCellSizes(0,s),d=t.hider.style,f=()=>i?!1:this.scrollableElement.scrollTop>Math.max(0,u-t.holder.clientHeight),g=()=>i?!1:this.scrollableElement.scrollLeft>Math.max(0,h-t.holder.clientWidth),p=f()?1:0,v=g()?1:0;if(d.width=`${h+v}px`,d.height=`${u+p}px`,this.scrollbarSize>0){const{scrollHeight:y,scrollWidth:S}=t.wtRootElement,{scrollHeight:R,scrollWidth:A}=t.holder;this.hasScrollbarRight=y<R,this.hasScrollbarBottom=S<A,this.hasScrollbarRight&&t.hider.scrollWidth+this.scrollbarSize>S?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&t.hider.scrollHeight+this.scrollbarSize>y&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:t}=this;t.hider.style.height=`${parseInt(t.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:t}=this;t.hider.style.width=`${parseInt(t.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const t=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let r=null;return L(t,i=>{i&&i.clone&&i.clone.wtTable.TABLE.contains(e)&&(r=i.clone)}),r}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,t=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];L(t,r=>{r&&(r.clone.wtTable.TABLE.className=e.className)})}}function cL(n,e,t){return(e=W5(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function W5(n){var e=$5(n,"string");return typeof e=="symbol"?e:e+""}function $5(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class G5{constructor(e){cL(this,"settings",{}),cL(this,"defaults",Object.freeze(this.getDefaults())),at(this.defaults,(t,r)=>{if(e[r]!==void 0)this.settings[r]=e[r];else{if(t===void 0)throw new Error(`A required setting "${r}" was not provided`);this.settings[r]=t}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,t,r)=>{const i=this.getSetting("data",e,t);ru(r,i??"")},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:e=>e,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,t){return t===void 0?at(e,(r,i)=>{this.settings[i]=r}):this.settings[e]=t,this}getSetting(e,t,r,i,s){return typeof this.settings[e]=="function"?this.settings[e](t,r,i,s):t!==void 0&&Array.isArray(this.settings[e])?this.settings[e][t]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class C0 extends Ld{constructor(e,t,r,i){super(e,t,r,i,"master")}alignOverlaysWithTrimmingContainer(){const e=Th(this.wtRootElement),{rootWindow:t}=this.domBindings;if(e===t)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const r=e.parentElement,i=vd(e,"height",t),s=vd(e,"overflow",t),o=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let u=e.offsetWidth,h=e.offsetHeight;if(r&&["auto","hidden","scroll"].includes(s)){const d=e.cloneNode(!1);d.style.overflow="auto",d.style.position="absolute",e.nextElementSibling?r.insertBefore(d,e.nextElementSibling):r.appendChild(d);const f=parseInt(ra(d,t).height,10);r.removeChild(d),f===0&&(h=0)}h=Math.min(h,l),o.height=i==="auto"?"auto":`${h}px`,u=Math.min(u,a),o.width=`${u}px`,o.overflow="",this.hasTableHeight=o.height==="auto"?!0:h>0,this.hasTableWidth=u>0}this.isTableVisible=bh(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:t}=this.dataAccessObject,r="master",s=e.getSetting("columnHeaders").length;if(s&&!t.hasOversizedColumnHeadersMarked[r]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let u=0;u<s;u++)for(let h=-1*a;h<l;h++)this.markIfOversizedColumnHeader(h);t.hasOversizedColumnHeadersMarked[r]=!0}}}Wt(C0,h0);Wt(C0,xC);class j5{constructor(e,t,r,i,s){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=t,this.wtSettings=r,this.wtTable=s,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new xX:new HX],["fullyVisible",()=>new EX],["partiallyVisible",()=>new TU]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new OX:new LX],["fullyVisible",()=>new CX],["partiallyVisible",()=>new bU]]),this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,t=this.dataAccessObject.topOverlayTrimmingContainer;let r=0;return t===this.domBindings.rootWindow?r=e.documentElement.clientHeight:r=Dn(t)>0&&t.clientHeight>0?t.clientHeight:1/0,r}getWorkspaceWidth(){const{wtSettings:e}=this,{rootDocument:t,rootWindow:r}=this.domBindings,i=this.dataAccessObject.inlineStartOverlayTrimmingContainer,s=t.documentElement.offsetWidth,o=e.getSetting("totalColumns"),a=e.getSetting("preventOverflow"),l=e.getSetting("rtlMode"),u=this.wtTable.TABLE.getBoundingClientRect(),h=l?u.right-s:u.left,c=s-h;let d,f;if(a)return rn(this.wtTable.wtRootElement);if(e.getSetting("freezeOverlays")?d=Math.min(c,s):d=Math.min(this.getContainerFillWidth(),c,s),i===r&&o>0&&this.sumColumnWidths(0,o-1)>d)return t.documentElement.clientWidth;if(i!==r&&(f=vd(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",r),f==="scroll"||f==="hidden"||f==="auto"))return Math.max(d,i.clientWidth);const g=e.getSetting("stretchH");return g==="none"||!g?Math.max(d,rn(this.wtTable.TABLE)):d}hasVerticalScroll(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}sumColumnWidths(e,t){let r=0,i=e;for(;i<t;)r+=this.wtTable.getColumnWidth(i),i+=1;return r}getContainerFillWidth(){if(this.containerWidth)return this.containerWidth;const e=this.wtTable.holder,t=this.domBindings.rootDocument.createElement("div");t.style.width="100%",t.style.height="1px",e.appendChild(t);const r=t.offsetWidth;return this.containerWidth=r,e.removeChild(t),r}getWorkspaceOffset(){return ir(this.wtTable.TABLE)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=Dn(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const t=this.getColumnHeaderHeight();return t>0&&(e-=t),e}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),t=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let r=0,i=t.length;r<i;r++)this.rowHeaderWidth+=e[r]||e}if(isNaN(this.rowHeaderWidth))if(t.length){let r=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,s=t.length;i<s;i++)r?(this.rowHeaderWidth+=rn(r),r=r.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const t=this.getRowHeaderWidth();return t>0?e-t:e}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:t,wtTable:r}=this;let i=this.getViewportHeight(),s,o;this.rowHeaderWidth=NaN;let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=t.getSetting("fixedRowsTop"),u=t.getSetting("fixedRowsBottom"),h=t.getSetting("totalRows");return l&&a>=0&&(o=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=o,i-=o),u&&this.dataAccessObject.bottomOverlay.clone&&(o=this.dataAccessObject.bottomOverlay.sumCellSizes(h-u,h),i-=o),r.holder.clientHeight===r.holder.offsetHeight?s=0:s=or(this.domBindings.rootDocument),new $X({calculationTypes:e.map(c=>[c,this.rowsCalculatorTypes.get(c)()]),viewportHeight:i,scrollOffset:a,totalRows:t.getSetting("totalRows"),rowHeightFn:c=>r.getRowHeight(c),overrideFn:t.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:s})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:t,wtTable:r}=this;let i=this.getViewportWidth(),s=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const o=t.getSetting("fixedColumnsStart");if(o&&s>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,o);s+=a,i-=a}return r.holder.clientWidth!==r.holder.offsetWidth&&(i-=or(this.domBindings.rootDocument)),new UX({calculationTypes:e.map(a=>[a,this.columnsCalculatorTypes.get(a)()]),viewportWidth:i,scrollOffset:s,totalColumns:t.getSetting("totalColumns"),columnWidthFn:a=>r.getColumnWidth(a),overrideFn:t.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:t}=this,r=this.createRowsCalculator(),i=this.createColumnsCalculator();if(e&&!t.getSetting("renderAllRows")){const s=r.getResultsFor("fullyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(s)}if(e&&!t.getSetting("renderAllColumns")){const s=i.getResultsFor("fullyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(s)}return e||(this.rowsRenderCalculator=r.getResultsFor("rendered"),this.columnsRenderCalculator=i.getResultsFor("rendered")),this.rowsVisibleCalculator=r.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=i.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),t=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=t.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=t.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;let{startRow:t,endRow:r}=e;if(t===null&&r===null){if(!e.isVisibleInTrimmingContainer)return!0;t=this.rowsPartiallyVisibleCalculator.startRow,r=this.rowsPartiallyVisibleCalculator.endRow}const{startRow:i,endRow:s}=this.rowsRenderCalculator;return t<i||t===i&&t>0?!1:!(r>s||r===s&&r<this.wtSettings.getSetting("totalRows")-1)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;let{startColumn:t,endColumn:r}=e;if(t===null&&r===null){if(!e.isVisibleInTrimmingContainer)return!0;t=this.columnsPartiallyVisibleCalculator.startColumn,r=this.columnsPartiallyVisibleCalculator.endColumn}const{startColumn:i,endColumn:s}=this.columnsRenderCalculator;return t<i||t===i&&t>0?!1:!(r>s||r===s&&r<this.wtSettings.getSetting("totalColumns")-1)}resetHasOversizedColumnHeadersMarked(){at(this.hasOversizedColumnHeadersMarked,(e,t,r)=>{r[t]=void 0})}}class z5 extends l0{constructor(e,t){super(e,new G5(t));const r=this.wtSettings.getSetting("facade",this);this.wtTable=new C0(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=new j5(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new N5(this.wtSettings.getSetting("selections")),this.wtEvent=new _U(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new B5(this,r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},t=[],r=[];at(e,(i,s)=>{this.wtSettings.getSetting(s).length&&r.push(i),t.push(i)}),Xe(this.wtTable.wtRootElement.parentNode,t),ie(this.wtTable.wtRootElement.parentNode,r)}getOverlayByName(e){var t;if(!HU.includes(e))return null;const r=e.replace(/_([a-z])/g,i=>i[1].toUpperCase());return(t=this.wtOverlays[`${r}Overlay`])!==null&&t!==void 0?t:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class S0{constructor(e){e instanceof l0?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=t=>{const r=new S0(t);return()=>r},this._wot=new z5(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,t){return this._wot.createCellCoords(e,t)}createCellRange(e,t,r){return this._wot.createCellRange(e,t,r)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,t)}scrollViewport(e,t,r,i,s){return this._wot.scrollViewport(e,t,r,i,s)}scrollViewportHorizontally(e,t,r){return this._wot.scrollViewportHorizontally(e,t,r)}scrollViewportVertically(e,t,r){return this._wot.scrollViewportVertically(e,t,r)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,t){return this._wot.wtSettings.update(e,t),this}getSetting(e,t,r,i,s){return this._wot.wtSettings.getSetting(e,t,r,i,s)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function dL(n){let{isShiftKey:e,isLeftClick:t,isRightClick:r,coords:i,selection:s,controller:o,cellCoordsFactory:a}=n;const l=s.isSelected()?s.getSelectedRange().current():null,u=s.isSelectedByCorner(),h=s.isSelectedByRowHeader();if(s.markSource("mouse"),e&&l)i.row>=0&&i.col>=0&&!o.cell?s.setRangeEnd(i):(u||h)&&i.row>=0&&i.col>=0&&!o.cell?s.setRangeEnd(a(i.row,i.col)):u&&i.row<0&&!o.column?s.setRangeEnd(a(l.to.row,i.col)):h&&i.col<0&&!o.row?s.setRangeEnd(a(i.row,l.to.col)):(!u&&!h&&i.col<0||u&&i.col<0)&&!o.row?s.selectRows(Math.max(l.from.row,0),i.row,i.col):(!u&&!h&&i.row<0||h&&i.row<0)&&!o.column&&s.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{const c=!s.inInSelection(i),d=t||r&&c;i.row<0&&i.col>=0&&!o.column?d&&s.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!o.row?d&&s.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!o.cell?d&&s.setRangeStart(i):i.col<0&&i.row<0&&s.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}s.markEndSource()}function Y5(n){let{isLeftClick:e,coords:t,selection:r,controller:i,cellCoordsFactory:s}=n;if(!e)return;const o=r.isSelectedByRowHeader(),a=r.isSelectedByColumnHeader(),l=r.tableProps.countCols(),u=r.tableProps.countRows();r.markSource("mouse"),a&&!i.column?r.setRangeEnd(s(u-1,t.col)):o&&!i.row?r.setRangeEnd(s(t.row,l-1)):i.cell||r.setRangeEnd(t),r.markEndSource()}const K5=new Map([["mousedown",dL],["mouseover",Y5],["touchstart",dL]]);function fL(n,e){let{coords:t,selection:r,controller:i,cellCoordsFactory:s}=e;K5.get(n.type)({coords:t,selection:r,controller:i,cellCoordsFactory:s,isShiftKey:n.shiftKey,isLeftClick:IC(n)||n.type==="touchstart",isRightClick:iu(n)})}const BU=new WeakMap,R0=Symbol("rootInstance");function q5(n){BU.set(n,!0)}function X5(n){return n===R0}function nv(n){return BU.has(n)}function Q5(n,e){WU(n,e),e.add(n)}function Eu(n,e,t){WU(n,e),e.set(n,t)}function WU(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cl(n,e,t){return(e=Z5(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Z5(n){var e=J5(n,"string");return typeof e=="symbol"?e:e+""}function J5(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function ur(n,e){return n.get(zm(n,e))}function Qi(n,e,t){return n.set(zm(n,e),t),t}function zm(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var hb=new WeakMap,yp=new WeakMap,Cp=new WeakMap,wa=new WeakMap,Hs=new WeakMap,cb=new WeakMap,db=new WeakMap,rv=new WeakSet;class e8{constructor(e){Q5(this,rv),cl(this,"hot",void 0),cl(this,"eventManager",void 0),cl(this,"settings",void 0),cl(this,"THEAD",void 0),cl(this,"TBODY",void 0),cl(this,"_wt",void 0),cl(this,"activeWt",void 0),Eu(this,hb,0),Eu(this,yp,0),cl(this,"postponedAdjustElementsSize",!1),Eu(this,Cp,!1),Eu(this,wa,void 0),Eu(this,Hs,void 0),Eu(this,cb,0),Eu(this,db,0),this.hot=e,this.eventManager=new ys(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.hot.isRenderSuspended()||(this.hot.runHooks("beforeRender",this.hot.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.hot.forceFullRender),this.hot.runHooks("afterRender",this.hot.forceFullRender),this.hot.forceFullRender=!1,this.hot.renderCall=!1)}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(e,t){const r=this._wt.getCell(e,t);return r<0?null:r}scrollViewport(e,t,r,i,s){return this._wt.scrollViewport(e,t,r,i,s)}scrollViewportHorizontally(e,t,r){return this._wt.scrollViewportHorizontally(e,t,r)}scrollViewportVertically(e,t,r){return this._wt.scrollViewportVertically(e,t,r)}createElements(){const{rootElement:e,rootDocument:t}=this.hot,r=e.getAttribute("style");r&&e.setAttribute("data-originalstyle",r),ie(e,"handsontable"),Qi(Hs,this,t.createElement("TABLE")),ie(ur(Hs,this),"htCore"),this.hot.getSettings().tableClassName&&ie(ur(Hs,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(Ge(ur(Hs,this),[Xo()]),Ge(e,[y4(),DV(-1),CC(this.hot.countCols()),x4()])),this.THEAD=t.createElement("THEAD"),ur(Hs,this).appendChild(this.THEAD),this.TBODY=t.createElement("TBODY"),ur(Hs,this).appendChild(this.TBODY),this.hot.table=ur(Hs,this),this.hot.container.insertBefore(ur(Hs,this),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:t,selection:r,rootWindow:i}=this.hot,s=t.documentElement;this.eventManager.addEventListener(e,"mousedown",a=>{Qi(Cp,this,!0),this.isTextSelectionAllowed(a.target)||(OA(i),a.preventDefault(),i.focus())}),this.eventManager.addEventListener(e,"mouseup",()=>{Qi(Cp,this,!1)}),this.eventManager.addEventListener(e,"mousemove",a=>{ur(Cp,this)&&!this.isTextSelectionAllowed(a.target)&&(this.settings.fragmentSelection&&OA(i),a.preventDefault())}),this.eventManager.addEventListener(s,"keyup",a=>{r.isInProgress()&&!a.shiftKey&&r.finish()}),this.eventManager.addEventListener(s,"mouseup",a=>{r.isInProgress()&&IC(a)&&r.finish(),Qi(wa,this,!1);const l=bC(t.activeElement);lm(t.activeElement)&&!l||(l||!r.isSelected()&&!r.isSelectedByAnyHeader()&&!e.contains(a.target)&&!iu(a))&&this.hot.unlisten()}),this.eventManager.addEventListener(s,"contextmenu",a=>{r.isInProgress()&&iu(a)&&(r.finish(),Qi(wa,this,!1))}),this.eventManager.addEventListener(s,"touchend",()=>{r.isInProgress()&&r.finish(),Qi(wa,this,!1)}),this.eventManager.addEventListener(s,"mousedown",a=>{const l=a.target,u=a.x||a.clientX,h=a.y||a.clientY;let c=a.target;if(ur(wa,this)||!e||!this.hot.view)return;const{holder:d}=this._wt.wtTable;if(c===d){const g=or(t);if(t.elementFromPoint(u+g,h)!==d||t.elementFromPoint(u,h+g)!==d)return}else for(;c!==s;){if(c===null){if(a.isTargetWebComponent)break;return}if(c===e)return;c=c.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(l):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let o=Eh(i);for(;o!==null;)this.eventManager.addEventListener(o.document.documentElement,"click",()=>{this.hot.unlisten()}),o=Eh(o);this.eventManager.addEventListener(ur(Hs,this),"selectstart",a=>{this.settings.fragmentSelection||lm(a.target)||a.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:t,col:r}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(t,r))}translateFromRenderableToVisualIndex(e,t){let r=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,i=t>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(t):t;return r===null&&(r=e),i===null&&(i=t),[r,i]}countRenderableIndexes(e,t){const r=Math.min(e.getNotTrimmedIndexesLength(),t),i=e.getNearestNotHiddenIndex(r-1,-1);return i===null?0:e.getRenderableFromVisualIndex(i)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,t){return this.countNotHiddenIndexes(e,t,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,t){return this.countNotHiddenIndexes(e,t,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,t,r,i){if(isNaN(e)||e<0)return 0;const s=r.getNearestNotHiddenIndex(e,t),o=r.getRenderableFromVisualIndex(s);if(!Number.isInteger(o))return 0;let a=0;return t<0?a=o+1:t>0&&(a=i-o),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),t=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(t,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),t=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(t,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),t=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(t,1)}countRenderableColumnsInRange(e,t){let r=0;for(let i=e;i<=t;i++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}countRenderableRowsInRange(e,t){let r=0;for(let i=e;i<=t;i++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),t=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>t}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:ur(Hs,this),isDataViewInstance:()=>nv(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,stretchH:()=>this.settings.stretchH,data:(s,o)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(s,o)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const s=[];return this.hot.hasRowHeaders()&&s.push((o,a)=>{const l=o>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(o):o;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",s),Qi(yp,this,s.length),this.hot.getSettings().ariaTags&&zm(rv,this,$U).call(this)===this.hot.countCols()&&zm(rv,this,t8).call(this,ur(yp,this)),s},columnHeaders:()=>{const s=[];return this.hot.hasColHeaders()&&s.push((o,a)=>{const l=o>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(o):o;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",s),Qi(hb,this,s.length),s},columnWidth:s=>{const o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(s);return this.hot.getColWidth(o===null?s:o)},rowHeight:s=>{const o=this.hot.rowIndexMapper.getVisualFromRenderableIndex(s);return this.hot.getRowHeight(o===null?s:o)},rowHeightByOverlayName:(s,o)=>{const a=this.hot.rowIndexMapper.getVisualFromRenderableIndex(s),l=a===null?s:a;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(l),l,o)},cellRenderer:(s,o,a)=>{const[l,u]=this.translateFromRenderableToVisualIndex(s,o),h=this.hot.runHooks("modifyGetCellCoords",l,u);let c=l,d=u;Array.isArray(h)&&([c,d]=h);const f=this.hot.getCellMeta(c,d),g=this.hot.colToProp(d);let p=this.hot.getDataAtRowProp(c,g);this.hot.hasHook("beforeValueRender")&&(p=this.hot.runHooks("beforeValueRender",p,f)),this.hot.runHooks("beforeRenderer",a,l,u,g,p,f),this.hot.getCellRenderer(f)(this.hot,a,l,u,g,p,f),this.hot.runHooks("afterRenderer",a,l,u,g,p,f)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&bh(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(s,o,a,l)=>{const u=this.translateFromRenderableToVisualCoords(o),h={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,Qi(wa,this,!0),this.hot.runHooks("beforeOnCellMouseDown",s,u,a,h),!Hl(s)&&(fL(s,{coords:u,selection:this.hot.selection,controller:h,cellCoordsFactory:(c,d)=>this.hot._createCellCoords(c,d)}),this.hot.runHooks("afterOnCellMouseDown",s,u,a),this.activeWt=this._wt)},onCellContextMenu:(s,o,a,l)=>{const u=this.translateFromRenderableToVisualCoords(o);this.activeWt=l,Qi(wa,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",s,u,a),!Hl(s)&&(this.hot.runHooks("afterOnCellContextMenu",s,u,a),this.activeWt=this._wt)},onCellMouseOut:(s,o,a,l)=>{const u=this.translateFromRenderableToVisualCoords(o);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",s,u,a),!Hl(s)&&(this.hot.runHooks("afterOnCellMouseOut",s,u,a),this.activeWt=this._wt)},onCellMouseOver:(s,o,a,l)=>{const u=this.translateFromRenderableToVisualCoords(o),h={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",s,u,a,h),!Hl(s)&&(ur(wa,this)&&fL(s,{coords:u,selection:this.hot.selection,controller:h,cellCoordsFactory:(c,d)=>this.hot._createCellCoords(c,d)}),this.hot.runHooks("afterOnCellMouseOver",s,u,a),this.activeWt=this._wt)},onCellMouseUp:(s,o,a,l)=>{const u=this.translateFromRenderableToVisualCoords(o);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",s,u,a),!(Hl(s)||this.hot.isDestroyed)&&(this.hot.runHooks("afterOnCellMouseUp",s,u,a),this.activeWt=this._wt)},onCellCornerMouseDown:s=>{s.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",s)},onCellCornerDblClick:s=>{s.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",s)},beforeDraw:(s,o)=>this.beforeRender(s,o),onDraw:s=>this.afterRender(s),onBeforeViewportScrollVertically:s=>{const o=this.hot.rowIndexMapper,a=s<0;let l=s;return!a&&(l=o.getVisualFromRenderableIndex(s),l===null)?s:(l=this.hot.runHooks("beforeViewportScrollVertically",l),this.hot.runHooks("beforeViewportScroll"),a?l:o.getRenderableFromVisualIndex(l))},onBeforeViewportScrollHorizontally:s=>{const o=this.hot.columnIndexMapper,a=s<0;let l=s;return!a&&(l=o.getVisualFromRenderableIndex(s),l===null)?s:(l=this.hot.runHooks("beforeViewportScrollHorizontally",l),this.hot.runHooks("beforeViewportScroll"),a?l:o.getRenderableFromVisualIndex(l))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(s,o,a)=>{const l=this.hot.rowIndexMapper,u=s<0;let h=s;u||(h=l.getVisualFromRenderableIndex(s));const c=this.hot.runHooks("beforeHighlightingRowHeader",h,o,a);return u?c:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(c,1))},onBeforeHighlightingColumnHeader:(s,o,a)=>{const l=this.hot.columnIndexMapper,u=s<0;let h=s;u||(h=l.getVisualFromRenderableIndex(s));const c=this.hot.runHooks("beforeHighlightingColumnHeader",h,o,a);return u?c:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(c,1))},onAfterDrawSelection:(s,o,a)=>{let l;const[u,h]=this.translateFromRenderableToVisualIndex(s,o),c=this.hot.selection.getSelectedRange();if(c.size()>0){const f=c.peekByIndex(a??0);l=[f.from.row,f.from.col,f.to.row,f.to.col]}return this.hot.runHooks("afterDrawSelection",u,h,l,a)},onBeforeDrawBorders:(s,o)=>{const[a,l,u,h]=s,c=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(h)];return this.hot.runHooks("beforeDrawBorders",c,o)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onBeforeStretchingColumnWidth:(s,o)=>{const a=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o);return this.hot.runHooks("beforeStretchingColumnWidth",s,a)},onModifyRowHeaderWidth:s=>this.hot.runHooks("modifyRowHeaderWidth",s),onModifyGetCellCoords:(s,o,a)=>{const l=this.hot.rowIndexMapper,u=this.hot.columnIndexMapper,h=o>=0?u.getVisualFromRenderableIndex(o):o,c=s>=0?l.getVisualFromRenderableIndex(s):s,d=this.hot.runHooks("modifyGetCellCoords",c,h,a);if(Array.isArray(d)){const[f,g,p,v]=d;return[f>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(f,1)):f,g>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(g,1)):g,p>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(p,-1)):p,v>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(v,-1)):v]}},viewportRowCalculatorOverride:s=>{let o=this.settings.viewportRowRenderingOffset;if(o==="auto"&&this.settings.fixedRowsTop&&(o=10),o>0||o==="auto"){const a=this.countRenderableRows(),l=s.startRow,u=s.endRow;if(typeof o=="number")s.startRow=Math.max(l-o,0),s.endRow=Math.min(u+o,a-1);else if(o==="auto"){const h=Math.ceil(u/a*12);s.startRow=Math.max(l-h,0),s.endRow=Math.min(u+h,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",s)},viewportColumnCalculatorOverride:s=>{let o=this.settings.viewportColumnRenderingOffset;if(o==="auto"&&this.settings.fixedColumnsStart&&(o=10),o>0||o==="auto"){const a=this.countRenderableColumns(),l=s.startColumn,u=s.endColumn;if(typeof o=="number"&&(s.startColumn=Math.max(l-o,0),s.endColumn=Math.min(u+o,a-1)),o==="auto"){const h=Math.ceil(u/a*6);s.startColumn=Math.max(l-h,0),s.endColumn=Math.min(u+h,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",s)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const s=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||s}};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new S0(e),this.activeWt=this._wt;const t=this._wt.wtTable.spreader,{width:r,height:i}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(r,i),this.eventManager.addEventListener(t,"mousedown",s=>{s.target===t&&s.which===3&&s.stopPropagation()}),this.eventManager.addEventListener(t,"contextmenu",s=>{s.target===t&&s.which===3&&s.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.hot.forceFullRender=!0,this.render())})}isTextSelectionAllowed(e){if(lm(e))return!0;const t=ql(e,this._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&t||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&t||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return ur(wa,this)}isSelectedOnlyCell(){var e,t;return(e=(t=this.hot.getSelectedRangeLast())===null||t===void 0?void 0:t.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,t){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,t)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,t){if(t.firstChild){const r=t.firstChild;if(!je(r,"relative")){so(t),this.appendRowHeader(e,t);return}this.updateCellHeader(r.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:r,getRowHeader:i}=this.hot,s=r.createElement("div"),o=r.createElement("span");s.className="relative",o.className="rowHeader",this.updateCellHeader(o,e,i),s.appendChild(o),t.appendChild(s)}this.hot.runHooks("afterGetRowHeader",e,t)}appendColHeader(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const s=()=>{const o=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return o?o.split(" "):[]};if(t.firstChild){const o=t.firstChild;je(o,"relative")?(this.updateCellHeader(o.querySelector(".colHeader"),e,r,i),o.className="",ie(o,["relative",...s()])):(so(t),this.appendColHeader(e,t,r,i))}else{const{rootDocument:o}=this.hot,a=o.createElement("div"),l=o.createElement("span"),u=s();a.classList.add("relative",...u),l.className="colHeader",this.settings.ariaTags&&(Ge(a,...Xo()),Ge(l,...Xo())),this.updateCellHeader(l,e,r,i),a.appendChild(l),t.appendChild(a)}this.hot.runHooks("afterGetColHeader",e,t,i)}updateCellHeader(e,t,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,s=t;const o=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(je(e,"colHeader")?s=o.wtTable.columnFilter.sourceToRendered(t):je(e,"rowHeader")&&(s=o.wtTable.rowFilter.sourceToRendered(t))),s>-1?jh(e,r(t,i)):(ru(e,"Â "),ie(e,"cornerHeader"))}maximumVisibleElementWidth(e){const r=this._wt.wtViewport.getWorkspaceWidth()-e;return r>0?r:0}maximumVisibleElementHeight(e){const r=this._wt.wtViewport.getWorkspaceHeight()-e;return r>0?r:0}setLastSize(e,t){Qi(cb,this,e),Qi(db,this,t)}getLastSize(){return{width:ur(cb,this),height:ur(db,this)}}getFirstRenderedVisibleRow(){return this._wt.wtViewport.rowsRenderCalculator?this.hot.rowIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getFirstRenderedRow(),1):null}getLastRenderedVisibleRow(){return this._wt.wtViewport.rowsRenderCalculator?this.hot.rowIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getLastRenderedRow(),-1):null}getFirstRenderedVisibleColumn(){return this._wt.wtViewport.columnsRenderCalculator?this.hot.columnIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getFirstRenderedColumn(),1):null}getLastRenderedVisibleColumn(){return this._wt.wtViewport.columnsRenderCalculator?this.hot.columnIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getLastRenderedColumn(),-1):null}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return ur(hb,this)}getRowHeadersCount(){return ur(yp,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var t;return((t=this._wt.wtOverlays.getParentOverlay(e))!==null&&t!==void 0?t:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}isVisible(){return this._wt.wtTable.isVisible()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function $U(){return parseInt(this.hot.rootElement.getAttribute(CC()[0]),10)}function t8(n){const e=zm(rv,this,$U).call(this)+n;Ge(this.hot.rootElement,...CC(e))}const GU="ABCDEFGHIJKLMNOPQRSTUVWXYZ",VA=GU.length;function LC(n){let e=n+1,t="",r;for(;e>0;)r=(e-1)%VA,t=String.fromCharCode(65+r)+t,e=parseInt((e-r)/VA,10);return t}function n8(n){let e=0;if(n)for(let t=0,r=n.length-1;t<n.length;t+=1,r-=1)e+=VA**r*(GU.indexOf(n[t])+1);return e-=1,e}function r8(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const t=[];let r,i;for(r=0;r<n;r++){const s=[];for(i=0;i<e;i++)s.push(LC(i)+(r+1));t.push(s)}return t}function i8(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const t=[];let r,i;for(r=0;r<n;r++){const s={};for(i=0;i<e;i++)s[`prop${i}`]=LC(i)+(r+1);t.push(s)}return t}function s8(n,e){const t=[];let r;for(let i=0;i<n;i++){r=[];for(let s=0;s<e;s++)r.push("");t.push(r)}return t}function E0(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=n;const r=[];return(!Array.isArray(n)||!Array.isArray(n[0]))&&(t=[n]),t.forEach((i,s)=>{Array.isArray(i)?i.forEach((o,a)=>{r.push([s+e,a,o])}):Object.keys(i).forEach(o=>{r.push([s+e,o,i[o]])})}),r}function b0(n){let e=0;return Array.isArray(n)&&(n[0]&&Array.isArray(n[0])?e=n[0].length:n[0]&&ot(n[0])&&(e=NC(n[0]))),e}function jU(n){return!!(Array.isArray(n)&&n.length&&n.every(e=>Array.isArray(e)))}function zU(n){return!!(Array.isArray(n)&&n.length&&n.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}const o8=Object.freeze(Object.defineProperty({__proto__:null,countFirstRowKeys:b0,createEmptySpreadsheetData:s8,createSpreadsheetData:r8,createSpreadsheetObjectData:i8,dataRowToChangesArray:E0,isArrayOfArrays:jU,isArrayOfObjects:zU,spreadsheetColumnIndex:n8,spreadsheetColumnLabel:LC},Symbol.toStringTag,{value:"Module"}));function uf(n,e,t){return(e=a8(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function a8(n){var e=l8(n,"string");return typeof e=="symbol"?e:e+""}function l8(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class u8{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];uf(this,"hot",void 0),uf(this,"data",void 0),uf(this,"dataType","array"),uf(this,"colToProp",()=>{}),uf(this,"propToCol",()=>{}),this.hot=e,this.data=t}modifyRowData(e){let t;return this.hot.hasHook("modifyRowData")&&(t=this.hot.runHooks("modifyRowData",e)),t!==void 0&&!Number.isInteger(t)?t:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const t=[];return L(this.data,(r,i)=>{const s=this.getAtCell(i,e);t.push(s)}),t}getAtRow(e,t,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const s=t===void 0&&r===void 0,{dataDotNotation:o}=this.hot.getSettings();let a=null,l=null;if(a=this.modifyRowData(e),Array.isArray(a))l=[],s?a.forEach((u,h)=>{l[h]=this.getAtPhysicalCell(e,h,a)}):Pe(t,r,u=>{l[u-t]=this.getAtPhysicalCell(e,u,a)});else if(ot(a)||Jt(a))if(i?l=[]:l={},!s||i){const h=this.countFirstRowKeys()-1;Pe(0,h,c=>{const d=this.colToProp(c);if(c>=(t||0)&&c<=(r||h)&&!Number.isInteger(d)){const f=this.getAtPhysicalCell(e,d,a);i?l.push(f):o?Jw(l,d,f):l[d]=f}})}else at(a,(u,h)=>{const c=this.getAtPhysicalCell(e,h,a);o?Jw(l,h,c):l[h]=c});return l}setAtCell(e,t,r){if(!(e>=this.countRows()||t>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const i=fs(r);this.hot.runHooks("modifySourceData",e,t,i,"set"),i.isTouched()&&(r=i.value)}Number.isInteger(t)?this.data[e][t]=r:Jw(this.data[e],t,r)}}getAtPhysicalCell(e,t,r){let i=null;if(r)if(typeof t=="string"){const{dataDotNotation:s}=this.hot.getSettings();i=s?tU(r,t):r[t]}else typeof t=="function"?i=t(r):i=r[t];if(this.hot.hasHook("modifySourceData")){const s=fs(i);this.hot.runHooks("modifySourceData",e,t,s,"get"),s.isTouched()&&(i=s.value)}return i}getAtCell(e,t){const r=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(t),r)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,s=null,o=null,a=null,l=null;e===null||t===null?(i=!0,s=0,a=this.countRows()-1):(s=Math.min(e.row,t.row),o=Math.min(e.col,t.col),a=Math.max(e.row,t.row),l=Math.max(e.col,t.col));const u=[];return Pe(s,a,h=>{u.push(i?this.getAtRow(h,void 0,void 0,r):this.getAtRow(h,o,l,r))}),u}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return b0(this.data)}destroy(){this.data=null,this.hot=null}}function mL(n,e,t){return(e=h8(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function h8(n){var e=c8(n,"string");return typeof e=="symbol"?e:e+""}function c8(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class zh{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;mL(this,"indexedValues",[]),mL(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const t=this.indexedValues;if(e<t.length)return t[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,t){return e<this.indexedValues.length?(this.indexedValues[e]=t,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,Jt(this.initValueOrFn)?Pe(e-1,t=>this.indexedValues.push(this.initValueOrFn(t))):Pe(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}Wt(zh,Or);function T0(n,e,t,r){const i=t.length?t[0]:void 0;return[...n.slice(0,i),...t.map((s,o)=>Jt(r)?r(s,o):r),...i===void 0?[]:n.slice(i)]}function A0(n,e){return Za(n,(t,r)=>e.includes(r)===!1)}class uu extends zh{insert(e,t){this.indexedValues=T0(this.indexedValues,e,t,this.initValueOrFn),super.insert(e,t)}remove(e){this.indexedValues=A0(this.indexedValues,e),super.remove(e)}}class HC extends uu{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return jn(this.getValues(),(e,t,r)=>(t&&e.push(r),e),[])}}function N0(n,e,t){return[...n.slice(0,e),...t,...n.slice(e)]}function Ym(n,e){return Za(n,t=>e.includes(t)===!1)}function M0(n,e){return wt(n,t=>t-e.filter(r=>r<t).length)}function I0(n,e){const t=e[0],r=e.length;return wt(n,i=>i>=t?i+r:i)}function d8(n,e,t){return(e=f8(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function f8(n){var e=m8(n,"string");return typeof e=="symbol"?e:e+""}function m8(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class DC extends zh{constructor(){super(...arguments),d8(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=t,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(r,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=Ym(this.orderOfIndexes,[e]),Jt(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,t){this.indexedValues=T0(this.indexedValues,e,t,this.initValueOrFn),this.orderOfIndexes=I0(this.orderOfIndexes,t),super.insert(e,t)}remove(e){this.indexedValues=A0(this.indexedValues,e),this.orderOfIndexes=Ym(this.orderOfIndexes,e),this.orderOfIndexes=M0(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class Lg extends uu{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return jn(this.getValues(),(e,t,r)=>(t&&e.push(r),e),[])}}const gL=new Map([["indexesSequence",{getListWithInsertedItems:N0,getListWithRemovedItems:Ym}],["physicallyIndexed",{getListWithInsertedItems:T0,getListWithRemovedItems:A0}]]),YU=n=>{if(gL.has(n)===!1)throw new Error(`Alter strategy with ID '${n}' does not exist.`);return gL.get(n)};class KU extends zh{constructor(){super(e=>e)}insert(e,t){const r=I0(this.indexedValues,t);this.indexedValues=N0(r,e,t),super.insert(e,t)}remove(e){const t=Ym(this.indexedValues,e);this.indexedValues=M0(t,e),super.remove(e)}}const pL=new Map([["hiding",HC],["index",zh],["linkedPhysicalIndexToValue",DC],["physicalIndexToValue",uu],["trimming",Lg]]);function g8(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!pL.has(n))throw new Error(`The provided map type ("${n}") does not exist.`);return new(pL.get(n))(e)}function p8(n,e,t){return(e=w8(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function w8(n){var e=v8(n,"string");return typeof e=="symbol"?e:e+""}function v8(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}let UA=0;class O0{constructor(){p8(this,"collection",new Map)}register(e,t){this.collection.has(e)===!1&&(this.collection.set(e,t),t.addLocalHook("change",()=>this.runLocalHooks("change",t)),UA+=1)}unregister(e){const t=this.collection.get(e);Ne(t)&&(t.destroy(),this.collection.delete(e),this.runLocalHooks("change",t),UA-=1)}unregisterAll(){this.collection.forEach((e,t)=>this.unregister(t)),this.collection.clear()}get(e){return nn(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(t=>{t.remove(e)})}insertToEvery(e,t){this.collection.forEach(r=>{r.insert(e,t)})}initEvery(e){this.collection.forEach(t=>{t.init(e)})}}Wt(O0,Or);function y8(){return UA}function fb(n,e,t){return(e=C8(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function C8(n){var e=S8(n,"string");return typeof e=="symbol"?e:e+""}function S8(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class wL extends O0{constructor(e,t){super(),fb(this,"mergedValuesCache",[]),fb(this,"aggregationFunction",void 0),fb(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=t}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const t=wt(this.get(),s=>s.getValues()),r=[],i=Ne(t[0])&&t[0].length||0;for(let s=0;s<i;s+=1){const o=[];for(let a=0;a<this.getLength();a+=1)o.push(t[a][s]);r.push(o)}return wt(r,this.aggregationFunction)}getMergedValueAtIndex(e,t){const r=this.getMergedValues(t)[e];return Ne(r)?r:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function R8(n,e,t){E8(n,e),e.set(n,t)}function E8(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function b8(n,e,t){return n.set(qU(n,e),t),t}function T8(n,e){return n.get(qU(n,e))}function qU(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var mb=new WeakMap;class XU{constructor(){R8(this,mb,[])}subscribe(e){return this.addLocalHook("change",e),this._write(T8(mb,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){b8(mb,this,e)}}Wt(XU,Or);function vL(n,e){const t=[];let r=0,i=0;for(;r<n.length&&i<e.length;r++,i++)n[r]!==e[i]&&t.push({op:"replace",index:i,oldValue:n[r],newValue:e[i]});for(;r<e.length;r++)t.push({op:"insert",index:r,oldValue:void 0,newValue:e[r]});for(;i<n.length;i++)t.push({op:"remove",index:i,oldValue:n[i],newValue:void 0});return t}function hf(n,e,t){A8(n,e),e.set(n,t)}function A8(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zi(n,e){return n.get(QU(n,e))}function Sp(n,e,t){return n.set(QU(n,e),t),t}function QU(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Rp=new WeakMap,cf=new WeakMap,Ep=new WeakMap,bp=new WeakMap,Tp=new WeakMap;class N8{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};hf(this,Rp,new Set),hf(this,cf,[]),hf(this,Ep,[]),hf(this,bp,!1),hf(this,Tp,!1),Sp(Tp,this,e??!1)}createObserver(){const e=new XU;return Zi(Rp,this).add(e),e.addLocalHook("unsubscribe",()=>{Zi(Rp,this).delete(e)}),e._writeInitialChanges(vL(Zi(cf,this),Zi(Ep,this))),e}emit(e){let t=Zi(Ep,this);(!Zi(bp,this)||Zi(cf,this).length!==e.length)&&(e.length===0?e=new Array(t.length).fill(Zi(Tp,this)):Sp(cf,this,new Array(e.length).fill(Zi(Tp,this))),Zi(bp,this)||(Sp(bp,this,!0),t=Zi(cf,this)));const r=vL(t,e);Zi(Rp,this).forEach(i=>i._write(r)),Sp(Ep,this,e)}}function zr(n,e,t){return(e=M8(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function M8(n){var e=I8(n,"string");return typeof e=="symbol"?e:e+""}function I8(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class BA{constructor(){zr(this,"indexesSequence",new KU),zr(this,"trimmingMapsCollection",new wL(e=>e.some(t=>t===!0),!1)),zr(this,"hidingMapsCollection",new wL(e=>e.some(t=>t===!0),!1)),zr(this,"variousMapsCollection",new O0),zr(this,"hidingChangesObservable",new N8({initialIndexValue:!1})),zr(this,"notTrimmedIndexesCache",[]),zr(this,"notHiddenIndexesCache",[]),zr(this,"isBatched",!1),zr(this,"indexesSequenceChanged",!1),zr(this,"indexesChangeSource",void 0),zr(this,"trimmedIndexesChanged",!1),zr(this,"hiddenIndexesChanged",!1),zr(this,"renderablePhysicalIndexesCache",[]),zr(this,"fromPhysicalToVisualIndexesCache",new Map),zr(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,t,r){return this.registerMap(e,g8(t,r))}registerMap(e,t){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);t instanceof Lg?this.trimmingMapsCollection.register(e,t):t instanceof HC?this.hidingMapsCollection.register(e,t):this.variousMapsCollection.register(e,t);const r=this.getNumberOfIndexes();return r>0&&t.init(r),t}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const t=this.notTrimmedIndexesCache[e];return Ne(t)?t:null}getPhysicalFromRenderableIndex(e){const t=this.renderablePhysicalIndexesCache[e];return Ne(t)?t:null}getVisualFromPhysicalIndex(e){const t=this.fromPhysicalToVisualIndexesCache.get(e);return Ne(t)?t:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const t=this.fromVisualToRenderableIndexesCache.get(e);return Ne(t)?t:null}getNearestNotHiddenIndex(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const s=Array.from(this.fromVisualToRenderableIndexesCache.keys());let o=-1;return t>0?o=s.findIndex(a=>a>e):o=s.reverse().findIndex(a=>a<e),o===-1?r?this.getNearestNotHiddenIndex(e,-t,!1):null:s[o]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const t=this.getNumberOfIndexes();if(e<t){const r=[...Array(this.getNumberOfIndexes()-e).keys()].map(i=>i+e);this.removeIndexes(r)}else this.insertIndexes(t,e-t)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(r=>this.isTrimmed(r)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(r=>this.isHidden(r)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(r=>this.isHidden(r)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,t){typeof e=="number"&&(e=[e]);const r=wt(e,u=>this.getPhysicalFromVisualIndex(u)),i=this.getNotTrimmedIndexesLength(),s=e.length,o=Ym(this.getIndexesSequence(),r),a=o.filter(u=>this.isTrimmed(u)===!1);let l=o.indexOf(a[a.length-1])+1;if(t+s<i){const u=a[t];l=o.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(N0(o,l,r)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,t){const r=this.getNotTrimmedIndexes()[e],i=Ne(r)?r:this.getNumberOfIndexes(),s=this.getIndexesSequence().includes(r)?this.getIndexesSequence().indexOf(r):this.getNumberOfIndexes(),o=wt(new Array(t).fill(i),(a,l)=>a+l);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(s,o),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(s,o),this.hidingMapsCollection.insertToEvery(s,o),this.variousMapsCollection.insertToEvery(s,o),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const t=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&t===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let t=0;t<e;t+=1){const r=this.getPhysicalFromVisualIndex(t);this.fromPhysicalToVisualIndexesCache.set(r,t)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let t=0;t<e;t+=1){const r=this.getPhysicalFromRenderableIndex(t),i=this.getVisualFromPhysicalIndex(r);this.fromVisualToRenderableIndexesCache.set(i,t)}}}Wt(BA,Or);function O8(n,e){return at(e,(t,r)=>{nn(n[r])&&(n[r]=t)}),n}function ZU(n){const t=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(n);return t?`${t[1].toLowerCase()}-${t[2].toUpperCase()}`:n}function JU(n){Ne(n)&&e0(Bt`Language with code "${n}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function _8(n,e){return Array.isArray(n)&&Number.isInteger(e)?n[e]:n}const{register:P8,getValues:x8}=fo("phraseFormatters");function L8(n,e){P8(n,e)}function H8(){return x8()}L8("pluralize",_8);const eB="ContextMenu:items",tt=eB,_0=`${tt}.noItems`,P0=`${tt}.insertRowAbove`,x0=`${tt}.insertRowBelow`,L0=`${tt}.insertColumnOnTheLeft`,H0=`${tt}.insertColumnOnTheRight`,D0=`${tt}.removeRow`,F0=`${tt}.removeColumn`,k0=`${tt}.undo`,V0=`${tt}.redo`,Gv=`${tt}.readOnly`,U0=`${tt}.clearColumn`,B0=`${tt}.copy`,W0=`${tt}.copyWithHeaders`,$0=`${tt}.copyWithGroupHeaders`,G0=`${tt}.copyHeadersOnly`,j0=`${tt}.cut`,z0=`${tt}.freezeColumn`,Y0=`${tt}.unfreezeColumn`,K0=`${tt}.mergeCells`,q0=`${tt}.unmergeCells`,X0=`${tt}.addComment`,Q0=`${tt}.editComment`,Z0=`${tt}.removeComment`,J0=`${tt}.readOnlyComment`,eI=`${tt}.align`,jv=`${tt}.align.left`,zv=`${tt}.align.center`,Yv=`${tt}.align.right`,Kv=`${tt}.align.justify`,qv=`${tt}.align.top`,Xv=`${tt}.align.middle`,Qv=`${tt}.align.bottom`,tI=`${tt}.borders`,nI=`${tt}.borders.top`,rI=`${tt}.borders.right`,iI=`${tt}.borders.bottom`,sI=`${tt}.borders.left`,oI=`${tt}.borders.remove`,aI=`${tt}.nestedHeaders.insertChildRow`,lI=`${tt}.nestedHeaders.detachFromParent`,uI=`${tt}.hideColumn`,hI=`${tt}.showColumn`,cI=`${tt}.hideRow`,dI=`${tt}.showRow`,ri="Filters:",Mn=`${ri}conditions`,FC=`${Mn}.none`,fI=`${Mn}.isEmpty`,mI=`${Mn}.isNotEmpty`,gI=`${Mn}.isEqualTo`,pI=`${Mn}.isNotEqualTo`,wI=`${Mn}.beginsWith`,vI=`${Mn}.endsWith`,yI=`${Mn}.contains`,CI=`${Mn}.doesNotContain`,D8=`${Mn}.byValue`,SI=`${Mn}.greaterThan`,RI=`${Mn}.greaterThanOrEqualTo`,EI=`${Mn}.lessThan`,bI=`${Mn}.lessThanOrEqualTo`,TI=`${Mn}.isBetween`,AI=`${Mn}.isNotBetween`,NI=`${Mn}.after`,MI=`${Mn}.before`,II=`${Mn}.today`,OI=`${Mn}.tomorrow`,_I=`${Mn}.yesterday`,PI=`${ri}labels.filterByCondition`,xI=`${ri}labels.filterByValue`,LI=`${ri}labels.conjunction`,kC=`${ri}labels.disjunction`,Zv=`${ri}values.blankCells`,HI=`${ri}buttons.selectAll`,DI=`${ri}buttons.clear`,FI=`${ri}buttons.ok`,kI=`${ri}buttons.cancel`,VI=`${ri}buttons.placeholder.search`,UI=`${ri}buttons.placeholder.value`,BI=`${ri}buttons.placeholder.secondValue`,WI="CheckboxRenderer:",$I=`${WI}checked`,GI=`${WI}unchecked`,F8=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:$I,CHECKBOX_RENDERER_NAMESPACE:WI,CHECKBOX_UNCHECKED:GI,CONTEXTMENU_ITEMS_ADD_COMMENT:X0,CONTEXTMENU_ITEMS_ALIGNMENT:eI,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:Qv,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:zv,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:Kv,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:jv,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:Xv,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:Yv,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:qv,CONTEXTMENU_ITEMS_BORDERS:tI,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:iI,CONTEXTMENU_ITEMS_BORDERS_LEFT:sI,CONTEXTMENU_ITEMS_BORDERS_RIGHT:rI,CONTEXTMENU_ITEMS_BORDERS_TOP:nI,CONTEXTMENU_ITEMS_CLEAR_COLUMN:U0,CONTEXTMENU_ITEMS_COPY:B0,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:G0,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:$0,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:W0,CONTEXTMENU_ITEMS_CUT:j0,CONTEXTMENU_ITEMS_EDIT_COMMENT:Q0,CONTEXTMENU_ITEMS_FREEZE_COLUMN:z0,CONTEXTMENU_ITEMS_HIDE_COLUMN:uI,CONTEXTMENU_ITEMS_HIDE_ROW:cI,CONTEXTMENU_ITEMS_INSERT_LEFT:L0,CONTEXTMENU_ITEMS_INSERT_RIGHT:H0,CONTEXTMENU_ITEMS_MERGE_CELLS:K0,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:lI,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:aI,CONTEXTMENU_ITEMS_NO_ITEMS:_0,CONTEXTMENU_ITEMS_READ_ONLY:Gv,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:J0,CONTEXTMENU_ITEMS_REDO:V0,CONTEXTMENU_ITEMS_REMOVE_BORDERS:oI,CONTEXTMENU_ITEMS_REMOVE_COLUMN:F0,CONTEXTMENU_ITEMS_REMOVE_COMMENT:Z0,CONTEXTMENU_ITEMS_REMOVE_ROW:D0,CONTEXTMENU_ITEMS_ROW_ABOVE:P0,CONTEXTMENU_ITEMS_ROW_BELOW:x0,CONTEXTMENU_ITEMS_SHOW_COLUMN:hI,CONTEXTMENU_ITEMS_SHOW_ROW:dI,CONTEXTMENU_ITEMS_UNDO:k0,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:Y0,CONTEXTMENU_ITEMS_UNMERGE_CELLS:q0,CONTEXT_MENU_ITEMS_NAMESPACE:eB,FILTERS_BUTTONS_CANCEL:kI,FILTERS_BUTTONS_CLEAR:DI,FILTERS_BUTTONS_OK:FI,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:VI,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:BI,FILTERS_BUTTONS_PLACEHOLDER_VALUE:UI,FILTERS_BUTTONS_SELECT_ALL:HI,FILTERS_CONDITIONS_AFTER:NI,FILTERS_CONDITIONS_BEFORE:MI,FILTERS_CONDITIONS_BEGINS_WITH:wI,FILTERS_CONDITIONS_BETWEEN:TI,FILTERS_CONDITIONS_BY_VALUE:D8,FILTERS_CONDITIONS_CONTAINS:yI,FILTERS_CONDITIONS_EMPTY:fI,FILTERS_CONDITIONS_ENDS_WITH:vI,FILTERS_CONDITIONS_EQUAL:gI,FILTERS_CONDITIONS_GREATER_THAN:SI,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:RI,FILTERS_CONDITIONS_LESS_THAN:EI,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:bI,FILTERS_CONDITIONS_NAMESPACE:Mn,FILTERS_CONDITIONS_NONE:FC,FILTERS_CONDITIONS_NOT_BETWEEN:AI,FILTERS_CONDITIONS_NOT_CONTAIN:CI,FILTERS_CONDITIONS_NOT_EMPTY:mI,FILTERS_CONDITIONS_NOT_EQUAL:pI,FILTERS_CONDITIONS_TODAY:II,FILTERS_CONDITIONS_TOMORROW:OI,FILTERS_CONDITIONS_YESTERDAY:_I,FILTERS_DIVS_FILTER_BY_CONDITION:PI,FILTERS_DIVS_FILTER_BY_VALUE:xI,FILTERS_LABELS_CONJUNCTION:LI,FILTERS_LABELS_DISJUNCTION:kC,FILTERS_NAMESPACE:ri,FILTERS_VALUES_BLANK_CELLS:Zv},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const tB={languageCode:"en-US",[_0]:"No available options",[P0]:"Insert row above",[x0]:"Insert row below",[L0]:"Insert column left",[H0]:"Insert column right",[D0]:["Remove row","Remove rows"],[F0]:["Remove column","Remove columns"],[k0]:"Undo",[V0]:"Redo",[Gv]:"Read only",[U0]:"Clear column",[eI]:"Alignment",[jv]:"Left",[zv]:"Center",[Yv]:"Right",[Kv]:"Justify",[qv]:"Top",[Xv]:"Middle",[Qv]:"Bottom",[z0]:"Freeze column",[Y0]:"Unfreeze column",[tI]:"Borders",[nI]:"Top",[rI]:"Right",[iI]:"Bottom",[sI]:"Left",[oI]:"Remove border(s)",[X0]:"Add comment",[Q0]:"Edit comment",[Z0]:"Delete comment",[J0]:"Read-only comment",[K0]:"Merge cells",[q0]:"Unmerge cells",[B0]:"Copy",[W0]:["Copy with header","Copy with headers"],[$0]:["Copy with group header","Copy with group headers"],[G0]:["Copy header only","Copy headers only"],[j0]:"Cut",[aI]:"Insert child row",[lI]:"Detach from parent",[uI]:["Hide column","Hide columns"],[hI]:["Show column","Show columns"],[cI]:["Hide row","Hide rows"],[dI]:["Show row","Show rows"],[FC]:"None",[fI]:"Is empty",[mI]:"Is not empty",[gI]:"Is equal to",[pI]:"Is not equal to",[wI]:"Begins with",[vI]:"Ends with",[yI]:"Contains",[CI]:"Does not contain",[SI]:"Greater than",[RI]:"Greater than or equal to",[EI]:"Less than",[bI]:"Less than or equal to",[TI]:"Is between",[AI]:"Is not between",[NI]:"After",[MI]:"Before",[II]:"Today",[OI]:"Tomorrow",[_I]:"Yesterday",[Zv]:"Blank cells",[PI]:"Filter by condition",[xI]:"Filter by value",[LI]:"And",[kC]:"Or",[HI]:"Select all",[DI]:"Clear",[FI]:"OK",[kI]:"Cancel",[VI]:"Search",[UI]:"Value",[BI]:"Second value",[$I]:"Checked",[GI]:"Unchecked"},k8=F8,WA=tB.languageCode,{register:V8,getItem:nB,hasItem:U8,getValues:B8}=fo("languagesDictionaries");rB(tB);function rB(n,e){let t=n,r=e;return ot(n)&&(r=n,t=r.languageCode),W8(t,r),V8(t,Gr(r)),Gr(r)}function W8(n,e){n!==WA&&O8(e,nB(WA))}function iB(n){return jI(n)?Gr(nB(n)):null}function jI(n){return U8(n)}function $8(){return B8()}function sB(n,e,t){const r=iB(n);if(r===null)return null;const i=r[e];if(nn(i))return null;const s=G8(i,t);return Array.isArray(s)?s[0]:s}function G8(n,e){let t=n;return L(H8(),r=>{t=r(n,e)}),t}function j8(n){let e=ZU(n);return jI(e)||(e=WA,JU(n)),e}function z8(n,e,t){return(e=Y8(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Y8(n){var e=K8(n,"string");return typeof e=="symbol"?e:e+""}function K8(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class ol extends DU{constructor(e,t){super(e,null),z8(this,"visualCellRange",null),this.visualCellRange=t||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:t,to:r}=e,i=this.getNearestNotHiddenCoords(t,1),s=this.getNearestNotHiddenCoords(r,-1);return i===null||s===null?null:((i.row>s.row||i.col>s.col)&&(i=t,s=r),this.settings.createCellRange(i,i,s))}getNearestNotHiddenCoords(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const i=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,t);if(i===null)return null;const s=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,r);return s===null?null:this.settings.createCellCoords(i,s)}getNearestNotHiddenIndex(e,t,r){return t<0?t:e.getNearestNotHiddenIndex(t,r)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const t=e.from.clone().normalize(),r=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,s=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let o=null;if((s===null||s.col===null||s.row===null)&&(o=this.getNearestNotHiddenCoords(t,r,i)),o!==null&&e.overlaps(o)){const a=e.highlight.clone();if(a.row>=0&&(a.row=o.row),a.col>=0&&(a.col=o.col),this.cellRange===null){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&s!==null&&o===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:t}=this.cellRange;return[Math.min(e.row,t.row),Math.min(e.col,t.col),Math.max(e.row,t.row),Math.max(e.col,t.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),t=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,t.row,t.col]}createRenderableCellRange(e,t){const r=this.settings.visualToRenderableCoords(e),i=this.settings.visualToRenderableCoords(t);return r.row===null||r.col===null||i.row===null||i.col===null?null:this.settings.createCellRange(r,r,i)}}function gb(n){let{activeHeaderClassName:e,...t}=n;return new ol({className:e,...t,selectionType:FU})}function q8(n){let{areaCornerVisible:e,...t}=n;return new ol({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...t,selectionType:f0})}function X8(n){let{...e}=n;return new ol({className:"highlight",...e,selectionType:f0})}function Q8(n){let{columnClassName:e,...t}=n;return new ol({className:e,...t,selectionType:S5})}function Z8(n){let{cellCornerVisible:e,...t}=n;return new ol({className:"current",headerAttributes:[FM()],border:{width:2,color:"#4b89ff",cornerVisible:e},...t,selectionType:m0})}function J8(n){let{border:e,visualCellRange:t,...r}=n;return new ol({...e,...r,selectionType:R5},t)}function e7(n){let{...e}=n;return new ol({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:y5})}function yL(n){let{headerClassName:e,...t}=n;return new ol({className:e,...t,selectionType:d0})}function t7(n){let{rowClassName:e,...t}=n;return new ol({className:e,...t,selectionType:C5})}function n7(n,e){r7(n,e),e.add(n)}function r7(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function oi(n,e,t){return(e=i7(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function i7(n){var e=s7(n,"string");return typeof e=="symbol"?e:e+""}function s7(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function va(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var yo=new WeakSet;class o7{constructor(e){n7(this,yo),oi(this,"options",void 0),oi(this,"layerLevel",0),oi(this,"focus",void 0),oi(this,"fill",void 0),oi(this,"layeredAreas",new Map),oi(this,"areas",new Map),oi(this,"rowHeaders",new Map),oi(this,"columnHeaders",new Map),oi(this,"activeRowHeaders",new Map),oi(this,"activeColumnHeaders",new Map),oi(this,"activeCornerHeaders",new Map),oi(this,"rowHighlights",new Map),oi(this,"columnHighlights",new Map),oi(this,"customSelections",[]),this.options=e,this.focus=Z8(e),this.fill=e7(e)}isEnabledFor(e,t){let r=e;e===m0&&(r="current");let i=this.options.disabledCellSelection(t.row,t.col);return typeof i=="string"&&(i=[i]),i===!1||Array.isArray(i)&&!i.includes(r)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return va(yo,this,ya).call(this,this.layeredAreas,q8)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return va(yo,this,ya).call(this,this.areas,X8)}getAreas(){return[...this.areas.values()]}createRowHeader(){return va(yo,this,ya).call(this,this.rowHeaders,yL)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return va(yo,this,ya).call(this,this.columnHeaders,yL)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return va(yo,this,ya).call(this,this.activeRowHeaders,gb)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return va(yo,this,ya).call(this,this.activeColumnHeaders,gb)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return va(yo,this,ya).call(this,this.activeCornerHeaders,gb)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return va(yo,this,ya).call(this,this.rowHighlights,t7)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return va(yo,this,ya).call(this,this.columnHighlights,Q8)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(J8({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),L(this.areas.values(),e=>void e.clear()),L(this.layeredAreas.values(),e=>void e.clear()),L(this.rowHeaders.values(),e=>void e.clear()),L(this.columnHeaders.values(),e=>void e.clear()),L(this.activeRowHeaders.values(),e=>void e.clear()),L(this.activeColumnHeaders.values(),e=>void e.clear()),L(this.activeCornerHeaders.values(),e=>void e.clear()),L(this.rowHighlights.values(),e=>void e.clear()),L(this.columnHighlights.values(),e=>void e.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function ya(n,e){const t=this.layerLevel;if(n.has(t))return n.get(t);const r=e({layerLevel:t,...this.options});return n.set(t,r),r}function CL(n,e,t){return(e=a7(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function a7(n){var e=l7(n,"string");return typeof e=="symbol"?e:e+""}function l7(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class u7{constructor(e){CL(this,"ranges",[]),CL(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){return this.ranges.some(t=>t.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t;return e>=0&&e<this.size()&&(t=this.ranges[e]),t}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}function h7(n,e){oB(n,e),e.add(n)}function pb(n,e,t){oB(n,e),e.set(n,t)}function oB(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mt(n,e){return n.get(Yn(n,e))}function Ap(n,e,t){return n.set(Yn(n,e),t),t}function Yn(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Np=new WeakMap,sn=new WeakMap,eo=new WeakMap,tr=new WeakSet;class $A{constructor(e,t){h7(this,tr),pb(this,Np,void 0),pb(this,sn,void 0),pb(this,eo,{x:0,y:0}),Ap(Np,this,e),Ap(sn,this,t)}transformStart(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=Mt(sn,this).createCellCoords(e,t);let s=Mt(Np,this).current().highlight;const o=Mt(sn,this).visualToRenderableCoords(s);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",i),o.row!==null&&o.col!==null){const{width:u,height:h}=Yn(tr,this,aB).call(this),{row:c,col:d}=Yn(tr,this,RL).call(this,s),f=Mt(sn,this).fixedRowsBottom(),g=Mt(sn,this).minSpareRows(),p=Mt(sn,this).minSpareCols(),v=Mt(sn,this).autoWrapRow(),y=Mt(sn,this).autoWrapCol(),S=Mt(sn,this).createCellCoords(c+i.row,d+i.col);if(S.row>=h){const O=fs(r&&g>0&&f===0),V=S.col+1,B=Mt(sn,this).createCellCoords(S.row-h,V>=u?V-u:V);this.runLocalHooks("beforeColumnWrap",O,Yn(tr,this,ac).call(this,B),V>=u),O.value?this.runLocalHooks("insertRowRequire",Mt(sn,this).countRenderableRows()):y&&S.assign(B)}else if(S.row<0){const O=fs(y),V=S.col-1,B=Mt(sn,this).createCellCoords(h+S.row,V<0?u+V:V);this.runLocalHooks("beforeColumnWrap",O,Yn(tr,this,ac).call(this,B),V<0),y&&S.assign(B)}if(S.col>=u){const O=fs(r&&p>0),V=S.row+1,B=Mt(sn,this).createCellCoords(V>=h?V-h:V,S.col-u);this.runLocalHooks("beforeRowWrap",O,Yn(tr,this,ac).call(this,B),V>=h),O.value?this.runLocalHooks("insertColRequire",Mt(sn,this).countRenderableColumns()):v&&S.assign(B)}else if(S.col<0){const O=fs(v),V=S.row-1,B=Mt(sn,this).createCellCoords(V<0?h+V:V,u+S.col);this.runLocalHooks("beforeRowWrap",O,Yn(tr,this,ac).call(this,B),V<0),v&&S.assign(B)}const{rowDir:R,colDir:A}=Yn(tr,this,SL).call(this,S);a=R,l=A,s=Yn(tr,this,ac).call(this,S)}return this.runLocalHooks("afterTransformStart",s,a,l),s}transformEnd(e,t){const r=Mt(sn,this).createCellCoords(e,t),i=Mt(Np,this).current(),s=Mt(sn,this).visualToRenderableCoords(i.highlight),o=Yn(tr,this,wb).call(this,i.to.row,i.from.row),a=Yn(tr,this,vb).call(this,i.to.col,i.from.col),l=i.to.clone();let u=0,h=0;if(this.runLocalHooks("beforeTransformEnd",r),s.row!==null&&s.col!==null&&o!==null&&a!==null){const{row:c,col:d}=Yn(tr,this,RL).call(this,i.highlight),f=Mt(sn,this).createCellCoords(o+r.row,a+r.col),g=i.getTopStartCorner(),p=i.getTopEndCorner(),v=i.getBottomEndCorner();if(r.col<0&&a>=d&&f.col<d){const A=f.col-d;f.col=Yn(tr,this,vb).call(this,g.col,p.col)+A}else if(r.col>0&&a<=d&&f.col>d){const A=Yn(tr,this,vb).call(this,p.col,g.col),O=Math.max(f.col-A,1);f.col=A+O}if(r.row<0&&o>=c&&f.row<c){const A=f.row-c;f.row=Yn(tr,this,wb).call(this,g.row,v.row)+A}else if(r.row>0&&o<=c&&f.row>c){const A=Yn(tr,this,wb).call(this,v.row,g.row),O=Math.max(f.row-A,1);f.row=A+O}const{rowDir:y,colDir:S}=Yn(tr,this,SL).call(this,f);u=y,h=S;const R=Yn(tr,this,ac).call(this,f);r.row===0&&r.col!==0?l.col=R.col:r.row!==0&&r.col===0?l.row=R.row:(l.row=R.row,l.col=R.col)}return this.runLocalHooks("afterTransformEnd",l,u,h),l}setOffsetSize(e){let{x:t,y:r}=e;Ap(eo,this,{x:t,y:r})}resetOffsetSize(){Ap(eo,this,{x:0,y:0})}}function SL(n){const{width:e,height:t}=Yn(tr,this,aB).call(this);let r=0,i=0;return n.row<0?(r=-1,n.row=0):n.row>0&&n.row>=t&&(r=1,n.row=t-1),n.col<0?(i=-1,n.col=0):n.col>0&&n.col>=e&&(i=1,n.col=e-1),{rowDir:r,colDir:i}}function aB(){return{width:Mt(eo,this).x+Mt(sn,this).countRenderableColumns(),height:Mt(eo,this).y+Mt(sn,this).countRenderableRows()}}function wb(n,e){const t=Mt(sn,this).findFirstNonHiddenRenderableRow(n,e);return t===null?null:Mt(eo,this).y+t}function vb(n,e){const t=Mt(sn,this).findFirstNonHiddenRenderableColumn(n,e);return t===null?null:Mt(eo,this).x+t}function RL(n){const{row:e,col:t}=Mt(sn,this).visualToRenderableCoords(n);if(e===null||t===null)throw new Error("Renderable coords are not visible.");return Mt(sn,this).createCellCoords(Mt(eo,this).y+e,Mt(eo,this).x+t)}function ac(n){const e=n.clone();return e.col=n.col-Mt(eo,this).x,e.row=n.row-Mt(eo,this).y,Mt(sn,this).renderableToVisualCoords(e)}Wt($A,Or);const VC=0,UC=1,lB=2,zI=3,c7=[zI,lB],d7=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],yb=Symbol("root"),EL=Symbol("child");function Cd(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:yb;if(e!==yb&&e!==EL)throw new Error("The second argument is used internally only and cannot be overwritten.");const t=Array.isArray(n),r=e===yb;let i=VC;if(t){const s=n[0];n.length===0?i=UC:r&&s instanceof _g?i=zI:r&&Array.isArray(s)?i=Cd(s,EL):n.length>=2&&n.length<=4&&!n.some((a,l)=>!d7[l].includes(typeof a))&&(i=lB)}return i}function Km(n){let{createCellCoords:e,createCellRange:t,keepDirection:r=!1,propToCol:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!c7.includes(n))throw new Error("Unsupported selection ranges schema type was provided.");return function(s){const o=n===zI;let a=o?s.from.row:s[0],l=o?s.from.col:s[1],u=o?s.to.row:s[2],h=o?s.to.col:s[3];if(typeof i=="function"&&(typeof l=="string"&&(l=i(l)),typeof h=="string"&&(h=i(h))),nn(u)&&(u=a),nn(h)&&(h=l),!r){const f=a,g=l,p=u,v=h;a=Math.min(f,p),l=Math.min(g,v),u=Math.max(f,p),h=Math.max(g,v)}const c=e(a,l),d=e(u,h);return t(c,c,d)}}function f7(n){const e=Cd(n.getSelected());if(e===VC||e===UC)return[];const t=Km(e,{createCellCoords:n._createCellCoords.bind(n),createCellRange:n._createCellRange.bind(n)}),r=new Set;L(n.getSelected(),o=>{const{from:a,to:l}=t(o),u=Math.max(a.col,0),h=l.col-u+1;L(Array.from(new Array(h),(c,d)=>u+d),c=>{r.has(c)||r.add(c)})});const i=Array.from(r).sort((o,a)=>o-a);return jn(i,(o,a,l,u)=>(l!==0&&a===u[l-1]+1?o[o.length-1][1]+=1:o.push([a,1]),o),[])}function m7(n){const e=Cd(n.getSelected());if(e===VC||e===UC)return[];const t=Km(e,{createCellCoords:n._createCellCoords.bind(n),createCellRange:n._createCellRange.bind(n)}),r=new Set;L(n.getSelected(),o=>{const{from:a,to:l}=t(o),u=Math.max(a.row,0),h=l.row-u+1;L(Array.from(new Array(h),(c,d)=>u+d),c=>{r.has(c)||r.add(c)})});const i=Array.from(r).sort((o,a)=>o-a);return jn(i,(o,a,l,u)=>(l!==0&&a===u[l-1]+1?o[o.length-1][1]+=1:o.push([a,1]),o),[])}function lc(n,e,t){g7(n,e),e.set(n,t)}function g7(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bu(n,e,t){return(e=p7(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function p7(n){var e=w7(n,"string");return typeof e=="symbol"?e:e+""}function w7(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function an(n,e){return n.get(uB(n,e))}function Co(n,e,t){return n.set(uB(n,e),t),t}function uB(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var xr=new WeakMap,Tu=new WeakMap,Mp=new WeakMap,df=new WeakMap,Ip=new WeakMap,ff=new WeakMap;class hB{constructor(e,t){var r=this;bu(this,"settings",void 0),bu(this,"tableProps",void 0),bu(this,"inProgress",!1),bu(this,"selectedRange",new u7((i,s,o)=>this.tableProps.createCellRange(i,s,o))),bu(this,"highlight",void 0),lc(this,xr,void 0),lc(this,Tu,void 0),bu(this,"selectedByRowHeader",new Set),bu(this,"selectedByColumnHeader",new Set),lc(this,Mp,!1),lc(this,df,!1),lc(this,Ip,"unknown"),lc(this,ff,-1),this.settings=e,this.tableProps=t,this.highlight=new o7({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[FM()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(i,s)=>this.tableProps.isDisabledCellSelection(i,s),cellCornerVisible:function(){return r.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return r.isAreaCornerVisible(...arguments)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,s)=>this.tableProps.createCellCoords(i,s),createCellRange:(i,s,o)=>this.tableProps.createCellRange(i,s,o)}),Co(xr,this,new $A(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return r.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return r.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,s)=>this.tableProps.createCellCoords(i,s),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),Co(Tu,this,new $A(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,i.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,i.getOuterBottomEndCorner().col)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return r.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return r.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,s)=>this.tableProps.createCellCoords(i,s),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),an(xr,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("beforeModifyTransformStart",...s)}),an(xr,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("afterModifyTransformStart",...s)}),an(xr,this).addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("beforeModifyTransformEnd",...s)}),an(xr,this).addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("afterModifyTransformEnd",...s)}),an(xr,this).addLocalHook("insertRowRequire",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("insertRowRequire",...s)}),an(xr,this).addLocalHook("insertColRequire",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("insertColRequire",...s)}),an(xr,this).addLocalHook("beforeRowWrap",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("beforeRowWrap",...s)}),an(xr,this).addLocalHook("beforeColumnWrap",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("beforeColumnWrap",...s)}),an(Tu,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("beforeModifyTransformFocus",...s)}),an(Tu,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("afterModifyTransformFocus",...s)})}getSelectedRange(){return this.selectedRange}markSource(e){Co(Ip,this,e)}markEndSource(){Co(Ip,this,"unknown")}getSelectionSource(){return an(Ip,this)}setExpectedLayers(e){Co(ff,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,Co(ff,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const s=this.settings.selectionMode==="multiple",o=nn(t)?this.tableProps.getShortcutManager().isCtrlPressed():t,a=e.clone();Co(Mp,this,!1),this.runLocalHooks(`beforeSetRangeStart${r?"Only":""}`,a),(!s||s&&!o&&nn(t))&&this.selectedRange.clear(),this.selectedRange.add(a).current().setHighlight(i.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),r||this.setRangeEnd(e)}setRangeStartOnly(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,t,!0,r)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const t=e.clone(),r=this.tableProps.countRows(),i=this.tableProps.countCols(),s=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((r>0||i>0)&&(r===0&&t.col<0&&!s||i===0&&t.row<0&&!s))return;this.runLocalHooks("beforeSetRangeEnd",t),this.begin();const o=this.selectedRange.current();if(this.settings.navigableHeaders||o.highlight.normalize(),this.settings.selectionMode==="single")o.setFrom(o.highlight),o.setTo(o.highlight);else{const l=o.getHorizontalDirection(),u=o.getVerticalDirection(),h=this.isMultiple();o.setTo(t),h&&(l!==o.getHorizontalDirection()||o.getWidth()===1&&!o.includes(o.highlight))&&o.from.assign({col:o.highlight.col}),h&&(u!==o.getVerticalDirection()||o.getHeight()===1&&!o.includes(o.highlight))&&o.from.assign({row:o.highlight.row})}r>0&&i>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!o.isSingleHeader())&&o.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit();const a=an(ff,this)===-1||this.selectedRange.size()===an(ff,this);this.runLocalHooks("afterSetRangeEnd",e,a)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectedRange.current(),t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();const r=this.tableProps.countRows(),i=this.tableProps.countCols();t<this.highlight.layerLevel&&(L(this.highlight.getAreas(),g=>void g.clear()),L(this.highlight.getLayeredAreas(),g=>void g.clear()),L(this.highlight.getRowHeaders(),g=>void g.clear()),L(this.highlight.getColumnHeaders(),g=>void g.clear()),L(this.highlight.getActiveRowHeaders(),g=>void g.clear()),L(this.highlight.getActiveColumnHeaders(),g=>void g.clear()),L(this.highlight.getActiveCornerHeaders(),g=>void g.clear()),L(this.highlight.getRowHighlights(),g=>void g.clear()),L(this.highlight.getColumnHighlights(),g=>void g.clear())),this.highlight.useLayerLevel(t);const s=this.highlight.createArea(),o=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),h=this.highlight.createActiveColumnHeader(),c=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();if(s.clear(),o.clear(),a.clear(),l.clear(),u.clear(),h.clear(),c.clear(),d.clear(),f.clear(),this.highlight.isEnabledFor(f0,e.highlight)&&(this.isMultiple()||t>=1)&&(s.add(e.from).add(e.to).commit(),o.add(e.from).add(e.to).commit(),t===1)){const g=this.selectedRange.previous();this.highlight.useLayerLevel(t-1),this.highlight.createArea().add(g.from).commit().syncWith(g),this.highlight.createLayeredArea().add(g.from).commit().syncWith(g),this.highlight.useLayerLevel(t)}if(this.highlight.isEnabledFor(d0,e.highlight)){if(!e.isSingleHeader()){const v=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),y=this.tableProps.createCellCoords(e.to.row,-1),S=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),R=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(a.add(v).commit(),l.add(S).commit(),d.add(v).commit(),f.add(S).commit()):(a.add(v).add(y).commit(),l.add(S).add(R).commit(),d.add(v).add(y).commit(),f.add(S).add(R).commit())}const g=!an(df,this)&&this.isEntireRowSelected()&&(i>0&&i===e.getWidth()||i===0&&this.isSelectedByRowHeader()),p=!an(df,this)&&this.isEntireColumnSelected()&&(r>0&&r===e.getHeight()||r===0&&this.isSelectedByColumnHeader());g&&u.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),p&&h.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),g&&p&&c.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){if(this.selectedRange.isEmpty())return;const t=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const r=this.highlight.getFocus();r.clear(),t.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(m0,t.highlight)&&r.add(t.highlight).commit().syncWith(t),this.inProgress||(Co(Mp,this,!0),this.runLocalHooks("afterSetFocus",t.highlight))}transformStart(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.settings.navigableHeaders?an(xr,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):an(xr,this).resetOffsetSize(),this.setRangeStart(an(xr,this).transformStart(e,t,r))}transformEnd(e,t){this.settings.navigableHeaders?an(xr,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):an(xr,this).resetOffsetSize(),this.setRangeEnd(an(xr,this).transformEnd(e,t))}transformFocus(e,t){const r=this.selectedRange.current(),{row:i,col:s}=r.getOuterTopStartCorner(),o=this.tableProps.countRenderableColumnsInRange(0,s-1),a=this.tableProps.countRenderableRowsInRange(0,i-1);r.highlight.isHeader()?an(Tu,this).setOffsetSize({x:s<0?Math.abs(s):-o,y:i<0?Math.abs(i):-a}):an(Tu,this).setOffsetSize({x:s<0?0:-o,y:i<0?0:-a});const l=an(Tu,this).transformStart(e,t);this.setRangeFocus(l.normalize())}shiftRows(e,t){if(!this.isSelected())return;const r=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||r.getOuterTopStartCorner().row>=e){const{from:i,to:s,highlight:o}=r,a=this.tableProps.countRows(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),h=u?-1:0,c=u?0:t;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(Vt(i.row+c,h,a-1),i.col),f=this.tableProps.createCellCoords(Vt(s.row+t,h,a-1),s.col);this.markSource("shift"),o.row>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(Vt(o.row+t,0,a-1),o.col)):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}shiftColumns(e,t){if(!this.isSelected())return;const r=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||r.getOuterTopStartCorner().col>=e){const{from:i,to:s,highlight:o}=r,a=this.tableProps.countCols(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),h=l?-1:0,c=l?0:t;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(i.row,Vt(i.col+c,h,a-1)),f=this.tableProps.createCellCoords(s.row,Vt(s.col+t,h,a-1));this.markSource("shift"),o.col>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(o.row,Vt(o.col+t,0,a-1))):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){if(!this.isSelected())return!1;const e=fs(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}isFocusSelectionChanged(){return this.isSelected()&&an(Mp,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const t=i=>{const{col:s}=i.getOuterTopStartCorner(),o=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(o>0&&s<0||o===0)&&i.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>t(i));const r=this.selectedRange.peekByIndex(e);return r?t(r):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const t=i=>{const{row:s}=i.getOuterTopStartCorner(),o=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(o>0&&s<0||o===0)&&i.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>t(i));const r=this.selectedRange.peekByIndex(e);return r?t(r):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const t=this.tableProps.visualToRenderableCoords(e);return t.row!==null&&t.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const s=this.tableProps.countRows(),o=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),u=r?-l:0,h=t?-a:0;if(u===0&&h===0&&(s===0||o===0))return;let c=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:d,disableHeadersHighlight:f}=i;Co(df,this,f),d&&Number.isInteger(d?.row)&&Number.isInteger(d?.col)&&(c=this.tableProps.createCellCoords(Vt(d.row,u,s-1),Vt(d.col,h,o-1)));const g=this.tableProps.createCellCoords(u,h),p=this.tableProps.createCellCoords(s-1,o-1);this.clear(),this.setRangeStartOnly(g,void 0,c),h<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(p),this.finish(),Co(df,this,!1)}selectCells(e){var t=this;const r=Cd(e);if(r===UC)return!1;if(r===VC)throw new Error(Bt`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const i=Km(r,{createCellCoords:function(){return t.tableProps.createCellCoords(...arguments)},createCellRange:function(){return t.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),s=this.settings.navigableHeaders,o={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:s?this.tableProps.countRowHeaders():0,countColHeaders:s?this.tableProps.countColHeaders():0},a=!e.some(l=>{const u=i(l),h=u.isValid(o);return!(h&&!u.containsHeaders()||h&&u.containsHeaders()&&u.isSingleHeader())});return a&&(this.clear(),this.setExpectedLayers(e.length),L(e,l=>{const{from:u,to:h}=i(l);this.setRangeStartOnly(u.clone(),!1),this.setRangeEnd(h.clone())}),this.finish()),a}selectColumns(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=typeof e=="string"?this.tableProps.propToCol(e):e,s=typeof t=="string"?this.tableProps.propToCol(t):t,o=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),u=l===0?0:-l,h=this.tableProps.createCellCoords(u,i),c=this.tableProps.createCellCoords(o-1,s),d=this.tableProps.createCellRange(h,h,c).isValid({countRows:o,countCols:a,countRowHeaders:0,countColHeaders:l});if(d){let f=0,g=0;Number.isInteger(r?.row)&&Number.isInteger(r?.col)?(f=Vt(r.row,u,o-1),g=Vt(r.col,Math.min(i,s),Math.max(i,s))):(f=Vt(r,u,o-1),g=i);const p=this.tableProps.createCellCoords(f,g),v=l===0?0:Vt(p.row,u,-1),y=o-1,S=this.tableProps.createCellCoords(v,i),R=this.tableProps.createCellCoords(y,s);this.runLocalHooks("beforeSelectColumns",S,R,p),S.row=v,R.row=y,this.setRangeStartOnly(S,void 0,p),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(R),this.runLocalHooks("afterSelectColumns",S,R,p),this.finish()}return d}selectRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=this.tableProps.countRows(),s=this.tableProps.countCols(),o=this.tableProps.countRowHeaders(),a=o===0?0:-o,l=this.tableProps.createCellCoords(e,a),u=this.tableProps.createCellCoords(t,s-1),h=this.tableProps.createCellRange(l,l,u).isValid({countRows:i,countCols:s,countRowHeaders:o,countColHeaders:0});if(h){let c=0,d=0;Number.isInteger(r?.row)&&Number.isInteger(r?.col)?(c=Vt(r.row,Math.min(e,t),Math.max(e,t)),d=Vt(r.col,a,s-1)):(c=e,d=Vt(r,a,s-1));const f=this.tableProps.createCellCoords(c,d),g=o===0?0:Vt(f.col,a,-1),p=s-1,v=this.tableProps.createCellCoords(e,g),y=this.tableProps.createCellCoords(t,p);this.runLocalHooks("beforeSelectRows",v,y,f),v.col=g,y.col=p,this.setRangeStartOnly(v,void 0,f),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(y),this.runLocalHooks("afterSelectRows",v,y,f),this.finish()}return h}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),t=this.tableProps.countCols();if(e===0||t===0){this.deselect();return}const r=this.selectedRange.peekByIndex(this.selectedRange.size()-1),{from:i,to:s,highlight:o}=r;this.clear(),o.assign({row:Vt(o.row,-1/0,e-1),col:Vt(o.col,-1/0,t-1)}),i.assign({row:Vt(i.row,-1/0,e-1),col:Vt(i.col,-1/0,t-1)}),s.assign({row:Vt(s.row,0,e-1),col:Vt(s.col,0,t-1)}),this.selectedRange.ranges.push(r),this.highlight.getFocus().add(o).commit().syncWith(r),this.applyAndCommit(r)}commit(){if(this.highlight.getCustomSelections().forEach(i=>{i.commit()}),!this.isSelected())return;const t=this.highlight.getFocus(),r=this.getLayerLevel();t.commit().syncWith(this.selectedRange.current());for(let i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);const s=this.highlight.createArea(),o=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),h=this.highlight.createActiveColumnHeader(),c=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();s.commit(),o.commit(),a.commit(),l.commit(),u.commit(),h.commit(),c.commit(),d.commit(),f.commit()}this.highlight.useLayerLevel(r)}}Wt(hB,Or);const bL=/^(\r\n|\n\r|\r|\n)/,v7=/^[^\t\r\n]+/,TL=/^\t/;function y7(n){const e=[[""]];if(n.length===0)return e;let t=0,r=0,i;for(;n.length>0&&i!==n.length;)if(i=n.length,n.match(TL))n=n.replace(TL,""),t+=1,e[r][t]="";else if(n.match(bL))n=n.replace(bL,""),t=0,r+=1,e[r]=[""];else{let s="";if(n.startsWith('"')){let o=0,a=!0;for(;a;){const l=n.slice(0,1);l==='"'&&(o+=1),s+=l,n=n.slice(1),(n.length===0||n.match(/^[\t\r\n]/)&&o%2===0)&&(a=!1)}s=s.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const o=n.match(v7);s=o?o[0]:"",n=n.slice(s.length)}e[r][t]=s}return e}function hm(n){let e,t,r,i,s="",o;for(e=0,t=n.length;e<t;e+=1){for(i=n[e].length,r=0;r<i;r+=1)r>0&&(s+="	"),o=n[e][r],typeof o=="string"?o.indexOf(`
`)>-1?s+=`"${o.replace(/"/g,'""')}"`:s+=o:o==null?s+="":s+=o;e!==t-1&&(s+=`
`)}return s}function Au(n,e,t){return(e=C7(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function C7(n){var e=S7(n,"string");return typeof e=="symbol"?e:e+""}function S7(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Xc{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,t,r){Au(this,"hot",void 0),Au(this,"metaManager",void 0),Au(this,"tableMeta",void 0),Au(this,"dataSource",void 0),Au(this,"duckSchema",void 0),Au(this,"colToPropCache",void 0),Au(this,"propToColCache",void 0),this.hot=e,this.metaManager=r,this.tableMeta=r.getTableMeta(),this.dataSource=t,this.duckSchema=this.createDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const t=this.tableMeta.columns;let r;if(this.colToPropCache=[],this.propToColCache=new Map,t){let i=0,s=0,o=!1;if(typeof t=="function"){const a=NC(e);i=a>0?a:this.countFirstRowKeys(),o=!0}else{const a=this.tableMeta.maxCols;i=Math.min(a,t.length)}for(r=0;r<i;r++){const a=o?t(r):t[r];if(ot(a)){if(typeof a.data<"u"){const l=o?s:r;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}s+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return b0(this.dataSource)}recursiveDuckColumns(e,t,r){let i=t,s=r,o;return typeof i>"u"&&(i=0,s=""),typeof e=="object"&&!Array.isArray(e)&&at(e,(a,l)=>{a===null?(o=s+l,this.colToPropCache.push(o),this.propToColCache.set(o,i),i+=1):i=this.recursiveDuckColumns(a,i,`${l}.`)}),i}colToProp(e){if(Number.isInteger(e)===!1)return e;const t=this.hot.toPhysicalColumn(e);return t===null?e:this.colToPropCache&&Ne(this.colToPropCache[t])?this.colToPropCache[t]:t}propToCol(e){const t=this.propToColCache.get(e);if(Ne(t))return this.hot.toVisualColumn(t);const r=this.hot.toVisualColumn(e);return r===null?e:r}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?yd(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const s=this.hot.countSourceRows();let o=s,a=0,l=e;if((typeof l!="number"||l>=s)&&(l=s),l<this.hot.countRows()&&(o=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,t,r)===!1||o===null)return{delta:0};const h=this.tableMeta.maxRows,c=this.getSchema().length,d=[];for(;a<t&&s+a<h;){let g=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?g=Gr(this.getSchema()):(g=[],Pe(c-1,()=>g.push(null))):this.hot.dataType==="function"?g=this.tableMeta.dataSchema(l+a):(g={},Ig(g,this.getSchema())),d.push(g),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),i==="below"&&(o=Math.min(o+1,s)),this.spliceData(o,0,d);const f=this.hot.toVisualRow(o);return this.hot.countSourceRows()===d.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):r!=="auto"&&this.metaManager.createRow(o,t)),this.hot.runHooks("afterCreateRow",f,a,r),this.hot.forceFullRender=!0,{delta:a,startPhysicalIndex:o}}createCol(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const s=this.dataSource,o=this.tableMeta.maxCols,a=this.hot.countSourceCols();let l=e;if((typeof l!="number"||l>=a)&&(l=a),this.hot.runHooks("beforeCreateCol",l,t,r)===!1)return{delta:0};let h=a;l<this.hot.countCols()&&(h=this.hot.toPhysicalColumn(l));const c=this.hot.countSourceRows();let d=this.hot.countCols(),f=0,g=h;i==="end"&&(g=Math.min(g+1,a));const p=g;for(;f<t&&d<o;){if(typeof l!="number"||l>=d)if(c>0)for(let y=0;y<c;y+=1)typeof s[y]>"u"&&(s[y]=[]),s[y].push(null);else s.push([null]);else for(let y=0;y<c;y++)s[y].splice(g,0,null);f+=1,g+=1,d+=1}this.hot.columnIndexMapper.insertIndexes(l,f),f>0&&(e==null?this.metaManager.createColumn(null,f):r!=="auto"&&this.metaManager.createColumn(p,t));const v=this.hot.toVisualColumn(p);return this.hot.runHooks("afterCreateCol",v,f,r),this.hot.forceFullRender=!0,this.refreshDuckSchema(),{delta:f,startPhysicalIndex:p}}removeRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(e)?e:-t;const s=this.visualRowsToPhysical(i,t),o=this.hot.countSourceRows();if(i=(o+i)%o,this.hot.runHooks("beforeRemoveRow",i,s.length,s,r)===!1)return!1;const l=s.length;if(this.filterData(i,l,s),i<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(s);const h=Ne(this.tableMeta.columns)||Ne(this.tableMeta.dataSchema);this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&h===!1&&this.hot.columnIndexMapper.setIndexesSequence([])}return s.slice(0).sort((h,c)=>c-h).forEach(h=>{this.metaManager.removeRow(h,1)}),this.hot.runHooks("afterRemoveRow",i,l,s,r),this.hot.forceFullRender=!0,!0}removeCol(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let i=typeof e!="number"?-t:e;i=(this.hot.countCols()+i)%this.hot.countCols();const s=this.visualColumnsToPhysical(i,t),o=s.slice(0).sort((c,d)=>d-c);if(this.hot.runHooks("beforeRemoveCol",i,t,s,r)===!1)return!1;let l=!0;const u=o.length,h=this.dataSource;for(let c=0;c<u;c++)l&&s[0]!==s[c]-c&&(l=!1);if(l)for(let c=0,d=this.hot.countSourceRows();c<d;c++)h[c].splice(s[0],t),c===0&&this.metaManager.removeColumn(s[0],t);else for(let c=0,d=this.hot.countSourceRows();c<d;c++)for(let f=0;f<u;f++)h[c].splice(o[f],1),c===0&&this.metaManager.removeColumn(o[f],1);return i<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(s),this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",i,t,s,r),this.hot.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(e,t,r){const i=this.hot.getDataAtCol(e),s=i.slice(t,t+r),o=i.slice(t+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];bA(l,o);let h=0;for(;h<r;)l.push(null),h+=1;return MV(l),this.hot.populateFromArray(t,e,l,null,null,"spliceCol"),s}spliceRow(e,t,r){const i=this.hot.getSourceDataAtRow(e),s=i.slice(t,t+r),o=i.slice(t+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];bA(l,o);let h=0;for(;h<r;)l.push(null),h+=1;return this.hot.populateFromArray(e,t,[l],null,null,"spliceRow"),s}spliceData(e,t,r){if(this.hot.runHooks("beforeDataSplice",e,t,r)!==!1){const s=[...this.dataSource.slice(0,e),...r,...this.dataSource.slice(e)];this.dataSource.length=0,s.forEach(o=>this.dataSource.push(o))}}filterData(e,t,r){let i=this.hot.runHooks("filterData",e,t,r);Array.isArray(i)===!1&&(i=this.dataSource.filter((s,o)=>r.indexOf(o)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}get(e,t){const r=this.hot.toPhysicalRow(e);let i=this.dataSource[r];const s=this.hot.runHooks("modifyRowData",r);i=isNaN(s)?s:i;const{dataDotNotation:o}=this.hot.getSettings();let a=null;if(i&&i.hasOwnProperty&&pn(i,t))a=i[t];else if(o&&typeof t=="string"&&t.indexOf(".")>-1){let l=i;if(!l)return null;const u=t.split(".");for(let h=0,c=u.length;h<c;h++)if(l=l[u[h]],typeof l>"u")return null;a=l}else typeof t=="function"&&(a=t(this.dataSource.slice(r,r+1)[0]));if(this.hot.hasHook("modifyData")){const l=fs(a);this.hot.runHooks("modifyData",r,this.propToCol(t),l,"get"),l.isTouched()&&(a=l.value)}return a}getCopyable(e,t){return this.hot.getCellMeta(e,this.propToCol(t)).copyable?this.get(e,t):""}set(e,t,r){const i=this.hot.toPhysicalRow(e);let s=r,o=this.dataSource[i];const a=this.hot.runHooks("modifyRowData",i);if(o=isNaN(a)?a:o,this.hot.hasHook("modifyData")){const u=fs(s);this.hot.runHooks("modifyData",i,this.propToCol(t),u,"set"),u.isTouched()&&(s=u.value)}const{dataDotNotation:l}=this.hot.getSettings();if(o&&o.hasOwnProperty&&pn(o,t))o[t]=s;else if(l&&typeof t=="string"&&t.indexOf(".")>-1){let u=o,h=0,c;const d=t.split(".");for(h=0,c=d.length-1;h<c;h++)typeof u[d[h]]>"u"&&(u[d[h]]={}),u=u[d[h]];u[d[h]]=s}else typeof t=="function"?t(this.dataSource.slice(i,i+1)[0],s):o[t]=s}visualRowsToPhysical(e,t){const r=this.hot.countSourceRows(),i=[];let s=(r+e)%r,o=t,a;for(;s<r&&o;)a=this.hot.toPhysicalRow(s),i.push(a),o-=1,s+=1;return i}visualColumnsToPhysical(e,t){const r=this.hot.countCols(),i=[];let s=(r+e)%r,o=t;for(;s<r&&o;){const a=this.hot.toPhysicalColumn(s);i.push(a),o-=1,s+=1}return i}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let t=0;t<this.hot.countCols();t++)this.set(e,this.colToProp(t),"")}getLength(){const e=this.tableMeta.maxRows;let t;e<0||e===0?t=0:t=e||1/0;const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(r,t)}getAll(){const e={row:0,col:0},t={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-t.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,t,Xc.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,t,r){const i=[];let s,o,a;const l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(l===0||u===0)return[];const h=r===Xc.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,c=Math.min(Math.max(l-1,0),Math.max(e.row,t.row)),d=Math.min(Math.max(u-1,0),Math.max(e.col,t.col));for(s=Math.min(e.row,t.row);s<=c;s++){a=[];const f=s>=0?this.hot.toPhysicalRow(s):s;for(o=Math.min(e.col,t.col);o<=d&&f!==null;o++)a.push(h.call(this,s,this.colToProp(o)));f!==null&&i.push(a)}return i}getText(e,t){return hm(this.getRange(e,t,Xc.DESTINATION_RENDERER))}getCopyableText(e,t){return hm(this.getRange(e,t,Xc.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const{register:R7,getItem:E7,hasItem:cB,getNames:b7,getValues:vye}=fo("cellTypes");function YI(n){if(!cB(n))throw Error(`You declared cell type "${n}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return E7(n)}function ts(n,e){typeof n!="string"&&(e=n,n=e.CELL_TYPE);const{editor:t,renderer:r,validator:i}=e;t&&fi(n,t),r&&Pi(n,r),i&&ah(n,i),R7(n,e)}function T7(n,e){var t;return n==="CELL_TYPE"?!1:((t=e._automaticallyAssignedMetaProps)===null||t===void 0?void 0:t.has(n))||!pn(e,n)}function BC(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:n;const r=typeof e.type=="string"?YI(e.type):e.type;if(n._automaticallyAssignedMetaProps&&at(e,(s,o)=>void n._automaticallyAssignedMetaProps.delete(o)),!ot(r))return;t===n&&!n._automaticallyAssignedMetaProps&&(n._automaticallyAssignedMetaProps=new Set);const i={};at(r,(s,o)=>{if(T7(o,t)){var a;i[o]=s,(a=n._automaticallyAssignedMetaProps)===null||a===void 0||a.add(o)}}),Gn(n,i)}function A7(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function t(){}co(t,n);for(let r=0;r<e.length;r++)t.prototype[e[r]]=void 0;return t}function iv(n){return Number.isInteger(n)&&n>=0}function sv(n,e){if(!n())throw new Error(`Assertion failed: ${e}`)}function Op(n){return n==null}const dB=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(n){let e,t,r;for(e=0,t=this.countRows();e<t;e++)if(r=this.getDataAtCell(e,n),An(r)===!1)return!1;return!0},isEmptyRow(n){let e,t,r,i;for(e=0,t=this.countCols();e<t;e++)if(r=this.getDataAtCell(n,e),An(r)===!1)return typeof r=="object"?(i=this.getCellMeta(n,e),AC(this.getSchema()[i.prop],r)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0});function AL(n,e,t){return(e=N7(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function N7(n){var e=M7(n,"string");return typeof e=="symbol"?e:e+""}function M7(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function I7(){return class{}}class O7{constructor(e){AL(this,"metaCtor",I7()),AL(this,"meta",void 0),this.meta=this.metaCtor.prototype,Gn(this.meta,dB()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var t;Gn(this.meta,e),BC(this.meta,{...e,type:(t=e.type)!==null&&t!==void 0?t:this.meta.type},e)}}function _7(n,e,t){return(e=P7(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function P7(n){var e=x7(n,"string");return typeof e=="symbol"?e:e+""}function x7(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class L7{constructor(e){_7(this,"meta",void 0);const t=e.getMetaConstructor();this.meta=new t}getMeta(){return this.meta}updateMeta(e){Gn(this.meta,e),BC(this.meta,e,e)}}function _p(n,e,t){return(e=H7(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function H7(n){var e=D7(n,"string");return typeof e=="symbol"?e:e+""}function D7(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Jv{constructor(e){_p(this,"valueFactory",void 0),_p(this,"data",[]),_p(this,"index",[]),_p(this,"holes",new Set),this.valueFactory=e}obtain(e){sv(()=>iv(e),"Expecting an unsigned number.");const t=this._getStorageIndexByKey(e);let r;if(t>=0)r=this.data[t],r===void 0&&(r=this.valueFactory(e),this.data[t]=r);else if(r=this.valueFactory(e),this.holes.size>0){const i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=r,this.index[e]=i}else this.data.push(r),this.index[e]=this.data.length-1;return r}insert(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;sv(()=>iv(e)||Op(e),"Expecting an unsigned number or null/undefined argument.");const r=[],i=this.data.length;for(let o=0;o<t;o++)r.push(i+o),this.data.push(void 0);const s=Op(e)?this.index.length:e;this.index=[...this.index.slice(0,s),...r,...this.index.slice(s)]}remove(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;sv(()=>iv(e)||Op(e),"Expecting an unsigned number or null/undefined argument.");const r=this.index.splice(Op(e)?this.index.length-t:e,t);for(let i=0;i<r.length;i++){const s=r[i];typeof s=="number"&&this.holes.add(s)}}size(){return this.data.length-this.holes.size}values(){return Za(this.data,(e,t)=>!this.holes.has(t))[Symbol.iterator]()}entries(){const e=[];for(let r=0;r<this.data.length;r++){const i=this._getKeyByStorageIndex(r);i!==-1&&e.push([i,this.data[r]])}let t=0;return{next:()=>{if(t<e.length){const r=e[t];return t+=1,{value:r,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function NL(n,e,t){return(e=F7(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function F7(n){var e=k7(n,"string");return typeof e=="symbol"?e:e+""}function k7(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const V7=["data","width"];class U7{constructor(e){NL(this,"globalMeta",void 0),NL(this,"metas",new Jv(()=>this._createMeta())),this.globalMeta=e,this.metas=new Jv(()=>this._createMeta())}updateMeta(e,t){const r=this.getMeta(e);Gn(r,t),BC(r,t)}createColumn(e,t){this.metas.insert(e,t)}removeColumn(e,t){this.metas.remove(e,t)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return A7(this.globalMeta.getMetaConstructor(),V7).prototype}}function ML(n,e,t){return(e=B7(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function B7(n){var e=W7(n,"string");return typeof e=="symbol"?e:e+""}function W7(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class $7{constructor(e){ML(this,"columnMeta",void 0),ML(this,"metas",new Jv(()=>this._createRow())),this.columnMeta=e}updateMeta(e,t,r){const i=this.getMeta(e,t);Gn(i,r),BC(i,r)}createRow(e,t){this.metas.insert(e,t)}createColumn(e,t){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).insert(e,t)}removeRow(e,t){this.metas.remove(e,t)}removeColumn(e,t){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).remove(e,t)}getMeta(e,t,r){const i=this.metas.obtain(e).obtain(t);return r===void 0?i:i[r]}setMeta(e,t,r,i){var s;const o=this.metas.obtain(e).obtain(t);(s=o._automaticallyAssignedMetaProps)===null||s===void 0||s.delete(r),o[r]=i}removeMeta(e,t,r){const i=this.metas.obtain(e).obtain(t);delete i[r]}getMetas(){const e=[],t=Array.from(this.metas.values());for(let r=0;r<t.length;r++)Ne(t[r])&&e.push(...t[r].values());return e}getMetasAtRow(e){sv(()=>iv(e),"Expecting an unsigned number.");const t=new Map(this.metas);return t.has(e)?Array.from(t.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new Jv(e=>this._createMeta(e))}_createMeta(e){const t=this.columnMeta.getMetaConstructor(e);return new t}}class fB{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new O7(e),this.tableMeta=new L7(this.globalMeta),this.columnMeta=new U7(this.globalMeta),this.cellMeta=new $7(this.columnMeta),r.forEach(i=>new i(this)),this.globalMeta.updateMeta(t)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,t){this.columnMeta.updateMeta(e,t)}getCellMeta(e,t,r){let{visualRow:i,visualColumn:s}=r;const o=this.cellMeta.getMeta(e,t);return o.visualRow=i,o.visualCol=s,o.row=e,o.col=t,this.runLocalHooks("afterGetCellMeta",o),o}getCellMetaKeyValue(e,t,r){if(typeof r!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,t,r)}setCellMeta(e,t,r,i){this.cellMeta.setMeta(e,t,r,i)}updateCellMeta(e,t,r){this.cellMeta.updateMeta(e,t,r)}removeCellMeta(e,t,r){this.cellMeta.removeMeta(e,t,r)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,t)}removeRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,t)}createColumn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,t),this.columnMeta.createColumn(e,t)}removeColumn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,t),this.columnMeta.removeColumn(e,t)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}Wt(fB,Or);function IL(n,e,t,r){const{hotInstance:i,dataMap:s,dataSource:o,internalSource:a,source:l,metaManager:u,firstRun:h}=r,c=$r(a),d=i.getSettings();Array.isArray(d.dataSchema)?i.dataType="array":Jt(d.dataSchema)?i.dataType="function":i.dataType="object",s&&s.destroy(),n=i.runHooks(`before${c}`,n,h,l);const f=new Xc(i,n,u);if(e(f),typeof n=="object"&&n!==null)n.push&&n.splice||(n=[n]);else if(n===null){const g=f.getSchema();n=[];let p,v=0,y=0;for(v=0,y=d.startRows;v<y;v++)if((i.dataType==="object"||i.dataType==="function")&&d.dataSchema)p=Gr(g),n.push(p);else if(i.dataType==="array")p=Gr(g[0]),n.push(p);else{p=[];for(let S=0,R=d.startCols;S<R;S++)p.push(null);n.push(p)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof n} given)`);Array.isArray(n[0])&&(i.dataType="array"),d.data=n,f.dataSource=n,o.data=n,o.dataType=i.dataType,o.colToProp=f.colToProp.bind(f),o.propToCol=f.propToCol.bind(f),o.countCachedColumns=f.countCachedColumns.bind(f),t(f),i.runHooks(`after${c}`,n,h,l),h||(i.runHooks("afterChange",null,a),i.render()),i.getSettings().ariaTags&&Ge(i.rootElement,[DV(-1),CC(i.countCols()+(i.view?i.countRowHeaders():0))])}function OL(n,e,t){return(e=G7(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function G7(n){var e=j7(n,"string");return typeof e=="symbol"?e:e+""}function j7(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class z7{constructor(e){OL(this,"metaManager",void 0),OL(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",t=>this.extendCellMeta(t)),be.getSingleton().add("beforeRender",t=>{t&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var t;const{row:r,col:i}=e;if((t=this.metaSyncMemo.get(r))!==null&&t!==void 0&&t.has(i))return;const{visualRow:s,visualCol:o}=e,a=this.metaManager.hot,l=a.colToProp(o);e.prop=l,a.runHooks("beforeGetCellMeta",s,o,e);const u=pn(e,"type")?e.type:null;let h=Jt(e.cells)?e.cells(r,i,l):null;if(u)if(h){var c;h.type=(c=h.type)!==null&&c!==void 0?c:u}else h={type:u};h&&this.metaManager.updateCellMeta(r,i,h),a.runHooks("afterGetCellMeta",s,o,e),this.metaSyncMemo.has(r)||this.metaSyncMemo.set(r,new Set),this.metaSyncMemo.get(r).add(i)}}function Y7(n,e,t){K7(n,e),e.set(n,t)}function K7(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Cb(n,e,t){return(e=q7(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function q7(n){var e=X7(n,"string");return typeof e=="symbol"?e:e+""}function X7(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Q7(n,e){return n.get(Z7(n,e))}function Z7(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _L=new WeakMap;class J7{constructor(e){Cb(this,"metaManager",void 0),Cb(this,"usageTracker",new Set),Cb(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(t){if(this.metaManager.hot.isRtl()&&t==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),Y7(this,_L,(t,r,i)=>{if(!i)throw new Error(`The \`${t}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,t)=>{const{initOnly:r,target:i,onChange:s}=e,o=typeof i=="string",a=o?i:t,l=`_${a}`;this.metaManager.globalMeta.meta[l]=this.metaManager.globalMeta.meta[a],s?(this.installPropWatcher(t,l,s),o&&this.installPropWatcher(i,l,s)):r&&(this.installPropWatcher(t,l,Q7(_L,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(t))})}installPropWatcher(e,t,r){const i=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[t]},set(s){const o=!i.usageTracker.has(e);i.usageTracker.add(e),r.call(i,e,s,o),this[t]=s},enumerable:!0,configurable:!0})}}const mB="gridDefault",hu="editorManager.handlingEditor",eQ={name:"editorCloseAndSave",callback(n){n._getEditorManager().closeEditorAndSaveChanges()}},tQ="hooksRefRegisterer",gB={_hooksStorage:Object.create(null),addHook(n,e){return this._hooksStorage[n]||(this._hooksStorage[n]=[]),this.hot.addHook(n,e),this._hooksStorage[n].push(e),this},removeHooksByKey(n){L(this._hooksStorage[n]||[],e=>{this.hot.removeHook(n,e)})},clearHooks(){at(this._hooksStorage,(n,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};ua(gB,"MIXIN_NAME",tQ,{writable:!1,enumerable:!1});function Ds(n,e,t){return(e=nQ(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function nQ(n){var e=rQ(n,"string");return typeof e=="symbol"?e:e+""}function rQ(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const iQ="base",xn=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class Hd{static get EDITOR_TYPE(){return iQ}constructor(e){Ds(this,"hot",void 0),Ds(this,"state",xn.VIRGIN),Ds(this,"_opened",!1),Ds(this,"_fullEditMode",!1),Ds(this,"_closeCallback",null),Ds(this,"TD",null),Ds(this,"row",null),Ds(this,"col",null),Ds(this,"prop",null),Ds(this,"originalValue",null),Ds(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,t,r,i,s,o){this.TD=i,this.row=e,this.col=t,this.prop=r,this.originalValue=s,this.cellProperties=o,this.state=this.isOpened()?this.state:xn.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,t){let r,i,s,o;if(t){const l=this.hot.getSelectedLast();r=Math.max(Math.min(l[0],l[2]),0),i=Math.max(Math.min(l[1],l[3]),0),s=Math.max(l[0],l[2]),o=Math.max(l[1],l[3])}else[r,i,s,o]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",r,i);Array.isArray(a)&&([r,i]=a),this.hot.populateFromArray(r,i,e,s,o,"edit")}beginEditing(e,t){if(this.state!==xn.VIRGIN)return;const r=this.hot,i=r.rowIndexMapper.getRenderableFromVisualIndex(this.row),s=r.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(r.view.scrollViewport(r._createCellCoords(i,s)),this.state=xn.EDITING,this.isInFullEditMode()){const o=typeof e=="string"?e:Tn(this.originalValue);this.setValue(o)}this.open(t),this._opened=!0,this.focus(),r.view.render(),r.runHooks("afterBeginEditing",this.row,this.col)}finishEditing(e,t,r){let i;if(r){const s=this._closeCallback;this._closeCallback=o=>{s&&s(o),r(o),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===xn.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===xn.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const s=this.getValue();this.cellProperties.trimWhitespace?i=[[typeof s=="string"?String.prototype.trim.call(s||""):s]]:i=[[s]],this.state=xn.WAITING,this.saveValue(i,t),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",o=>{this.state=xn.FINISHED,this.discardEditor(o)}):(this.state=xn.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=xn.FINISHED,this.discardEditor()}discardEditor(e){this.state===xn.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=xn.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=xn.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===xn.WAITING}getEditedCellRect(){var e;const t=this.getEditedCell();if(!t)return;const{wtOverlays:r,wtViewport:i}=this.hot.view._wt,s=this.hot.rootWindow,o=ir(t),a=rn(t),l=ir(this.hot.rootElement),u=rn(this.hot.rootElement),h=r.topOverlay.holder,c=r.inlineStartOverlay.holder,d=h!==s?h.scrollTop:0,f=c!==s?c.scrollLeft:0,g=s.innerWidth-l.left-u,{wtTable:p}=(e=r.getParentOverlay(t))!==null&&e!==void 0?e:this.hot.view._wt,v=p.name,y=["master","inline_start"].includes(v)?d:0,S=["master","top","bottom"].includes(v)?f:0,R=o.top===l.top?0:1;let A=o.top-l.top-R-y,O=0;this.hot.isRtl()?O=s.innerWidth-o.left-a-g-1+S:O=o.left-l.left-1-S,["top","top_inline_start_corner"].includes(v)&&(A+=r.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(v)&&(O+=Math.abs(r.inlineStartOverlay.getOverlayOffset()));const V=this.hot.hasColHeaders(),B=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),Y=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),G=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(V&&B<=0||B===G)&&(A+=1),Y<=0&&(O+=1);const Z=i.rowsRenderCalculator.startPosition,ee=i.columnsRenderCalculator.startPosition,ne=Math.abs(r.inlineStartOverlay.getScrollPosition()),re=r.topOverlay.getScrollPosition(),ae=or(this.hot.rootDocument);let ze=t.offsetTop;if(["inline_start","master"].includes(v)&&(ze+=Z-re),["bottom","bottom_inline_start_corner"].includes(v)){const{wtViewport:te,wtTable:ce}=r.bottomOverlay.clone;ze+=te.getWorkspaceHeight()-ce.getHeight()-ae}let Le=t.offsetLeft;this.hot.isRtl()?(Le>=0?Le=p.getWidth()-t.offsetLeft:Le=Math.abs(Le),Le+=ee-ne-a):["top","master","bottom"].includes(v)&&(Le+=ee-ne);const Se=ra(this.TD,this.hot.rootWindow),ye=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",We=parseInt(Se[ye],10)>0?0:1,w=parseInt(Se.borderTopWidth,10)>0?0:1,C=rn(t)+We,b=Dn(t)+w,P=qV(h)?ae:0,H=XV(c)?ae:0,W=this.hot.view.maximumVisibleElementWidth(Le)-P+We,J=Math.max(this.hot.view.maximumVisibleElementHeight(ze)-H+w,23);return{top:A,start:O,height:b,maxHeight:J,width:C,maxWidth:W}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let t="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?t="top-inline-start-corner":t="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?t="bottom-inline-start-corner":t="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(t="inline-start"),t}}Wt(Hd,gB);const sQ={name:"editorCloseAndSaveByArrowKeys",callback(n,e,t){const r=n._getEditorManager(),i=r.getActiveEditor();i.isInFullEditMode()&&i.state===xn.EDITING||(r.closeEditorAndSaveChanges(),n.getSelected()&&(t.includes("arrowdown")?n.selection.transformStart(1,0):t.includes("arrowup")?n.selection.transformStart(-1,0):t.includes("arrowleft")?n.selection.transformStart(0,-1*n.getDirectionFactor()):t.includes("arrowright")&&n.selection.transformStart(0,n.getDirectionFactor())),e.preventDefault())}},oQ={name:"editorCloseAndSaveByEnter",callback(n,e){const t=n._getEditorManager();t.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),t.moveSelectionAfterEnter(e)}},aQ={name:"editorCloseWithoutSaving",callback(n){const e=n._getEditorManager();e.closeEditorAndRestoreOriginalValue(n.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},lQ={name:"editorFastOpen",callback(n,e){const{highlight:t}=n.getSelectedRangeLast();t.isHeader()||n._getEditorManager().openEditor(null,e,!0)}},uQ={name:"editorOpen",callback(n,e,t){const r=n._getEditorManager(),i=n.getSelectedRangeLast(),{highlight:s}=i;if(n.selection.isMultiple()&&!i.isHeader()&&n.countRenderedCols()>0&&n.countRenderedRows()>0){const o=n.getSettings(),a=typeof o.enterMoves=="function"?o.enterMoves(e):o.enterMoves;t.includes("shift")?n.selection.transformFocus(-a.row,-a.col):n.selection.transformFocus(a.row,a.col);return}s.isHeader()||(n.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter(e):r.openEditor(null,e,!0):r.moveSelectionAfterEnter(e),Ns(e))}};function hQ(){return[eQ,sQ,oQ,aQ,lQ,uQ]}const cQ={name:"extendCellsSelectionDown",callback(n){const{highlight:e}=n.getSelectedRangeLast();!n.selection.isSelectedByColumnHeader()&&!n.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&n.selection.isSelectedByRowHeader())&&n.selection.transformEnd(1,0)}},dQ={name:"extendCellsSelectionDownByViewportHeight",callback(n){const{to:e}=n.getSelectedRangeLast(),t=Math.min(e.row+n.countVisibleRows(),n.countRows()-1),r=n.rowIndexMapper.getNearestNotHiddenIndex(t,-1);if(r!==null){const i=n._createCellCoords(r,e.col),s=e.row-n.view.getFirstFullyVisibleRow(),o=Math.min(i.row-s,n.countRows()-1);n.selection.setRangeEnd(i),n.scrollViewportTo({row:o,verticalSnap:"top",horizontalSnap:"start"})}}},fQ={name:"extendCellsSelectionLeft",callback(n){const{highlight:e}=n.getSelectedRangeLast();!n.selection.isSelectedByRowHeader()&&!n.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&n.selection.isSelectedByColumnHeader())&&n.selection.transformEnd(0,-1*n.getDirectionFactor())}},mQ={name:"extendCellsSelectionRight",callback(n){const{highlight:e}=n.getSelectedRangeLast();!n.selection.isSelectedByRowHeader()&&!n.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&n.selection.isSelectedByColumnHeader())&&n.selection.transformEnd(0,n.getDirectionFactor())}},gQ={name:"extendCellsSelectionToColumns",callback(n){const{highlight:e,from:t,to:r}=n.getSelectedRangeLast();n.selection.isSelectedByRowHeader()?n.selection.selectAll(!0,!0):n.selectColumns(t.col,r.col,e)}},pQ={name:"extendCellsSelectionToMostBottom",callback(n){const{selection:e,rowIndexMapper:t}=n,{highlight:r,from:i,to:s}=n.getSelectedRangeLast(),o=r.isHeader()&&n.selection.isSelectedByRowHeader();if(r.isCell()||o){const a=t.getNearestNotHiddenIndex(n.countRows()-1,-1),l=i.clone();l.row=r.row,e.setRangeStart(l,void 0,!1,r.clone()),o&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(n._createCellCoords(a,s.col))}}},wQ={name:"extendCellsSelectionToMostInlineEnd",callback(n){const{selection:e,columnIndexMapper:t}=n,{highlight:r,from:i,to:s}=n.getSelectedRangeLast();if(!n.selection.isSelectedByRowHeader()&&!n.selection.isSelectedByCorner()&&r.isCell()){const o=t.getNearestNotHiddenIndex(n.countCols()-1,-1),a=i.clone();a.col=r.col,e.setRangeStart(a,void 0,!1,r.clone()),e.setRangeEnd(n._createCellCoords(s.row,o))}}},vQ={name:"extendCellsSelectionToMostInlineStart",callback(n){const{selection:e,columnIndexMapper:t}=n,{highlight:r,from:i,to:s}=n.getSelectedRangeLast();if(!n.selection.isSelectedByRowHeader()&&!n.selection.isSelectedByCorner()&&r.isCell()){const o=parseInt(n.getSettings().fixedColumnsStart,10),a=t.getNearestNotHiddenIndex(o,1),l=i.clone();l.col=r.col,e.setRangeStart(l,void 0,!1,r.clone()),e.setRangeEnd(n._createCellCoords(s.row,a))}}},yQ={name:"extendCellsSelectionToMostLeft",callback(n){const{selection:e,columnIndexMapper:t}=n,{highlight:r,from:i,to:s}=n.getSelectedRangeLast(),o=r.isHeader()&&n.selection.isSelectedByColumnHeader();if(r.isCell()||o){const a=t.getNearestNotHiddenIndex(...n.isRtl()?[n.countCols()-1,-1]:[0,1]),l=i.clone();l.col=r.col,e.setRangeStart(l,void 0,!1,r.clone()),o&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(n._createCellCoords(s.row,a))}}},CQ={name:"extendCellsSelectionToMostRight",callback(n){const{selection:e,columnIndexMapper:t}=n,{highlight:r,from:i,to:s}=n.getSelectedRangeLast(),o=r.isHeader()&&n.selection.isSelectedByColumnHeader();if(r.isCell()||o){const a=t.getNearestNotHiddenIndex(...n.isRtl()?[0,1]:[n.countCols()-1,-1]),l=i.clone();l.col=r.col,e.setRangeStart(l,void 0,!1,r.clone()),o&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(n._createCellCoords(s.row,a))}}},SQ={name:"extendCellsSelectionToMostTop",callback(n){const{selection:e,rowIndexMapper:t}=n,{highlight:r,from:i,to:s}=n.getSelectedRangeLast(),o=r.isHeader()&&n.selection.isSelectedByRowHeader();if(r.isCell()||o){const a=t.getNearestNotHiddenIndex(0,1),l=i.clone();l.row=r.row,e.setRangeStart(l,void 0,!1,r.clone()),o&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(n._createCellCoords(a,s.col))}}},RQ={name:"extendCellsSelectionToRows",callback(n){const{highlight:e,from:t,to:r}=n.getSelectedRangeLast();n.selection.isSelectedByColumnHeader()?n.selection.selectAll(!0,!0):n.selectRows(t.row,r.row,e)}},EQ={name:"extendCellsSelectionUp",callback(n){const{highlight:e}=n.getSelectedRangeLast();!n.selection.isSelectedByColumnHeader()&&!n.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&n.selection.isSelectedByRowHeader())&&n.selection.transformEnd(-1,0)}},bQ={name:"extendCellsSelectionUpByViewportHeight",callback(n){const{to:e}=n.getSelectedRangeLast(),t=Math.max(e.row-n.countVisibleRows(),0),r=n.rowIndexMapper.getNearestNotHiddenIndex(t,1);if(r!==null){const i=n._createCellCoords(r,e.col),s=e.row-n.view.getFirstFullyVisibleRow(),o=Math.max(i.row-s,0);n.selection.setRangeEnd(i),n.scrollViewportTo({row:o,verticalSnap:"top",horizontalSnap:"start"})}}};function TQ(){return[cQ,dQ,fQ,mQ,gQ,pQ,wQ,vQ,yQ,CQ,SQ,RQ,EQ,bQ]}const AQ={name:"moveCellSelectionDown",callback(n){let{selection:e}=n;e.transformStart(1,0)}},NQ={name:"moveCellSelectionDownByViewportHeight",callback(n){const{navigableHeaders:e}=n.getSettings(),t=e?n.countColHeaders():0,{row:r}=n.getSelectedRangeLast().highlight;let i=n.countVisibleRows()+t;r===n.countRows()-1?i=1:r+i>n.countRows()&&(i=n.countRows()-r-1),n.selection.transformStart(i,0),n.getSelectedRangeLast().highlight.row<0&&n.scrollViewportTo({row:0})}},MQ={name:"moveCellSelectionInlineEnd",callback(n,e){const t=n.getSettings(),r=n.getSelectedRangeLast(),i=typeof t.tabMoves=="function"?t.tabMoves(e):t.tabMoves;n.selection.isMultiple()&&!r.isHeader()&&n.countRenderedCols()>0&&n.countRenderedRows()>0?n.selection.transformFocus(-i.row,-i.col):n.selection.transformStart(-i.row,-i.col)}},IQ={name:"moveCellSelectionInlineStart",callback(n,e){const t=n.getSettings(),r=n.getSelectedRangeLast(),i=typeof t.tabMoves=="function"?t.tabMoves(e):t.tabMoves;n.selection.isMultiple()&&!r.isHeader()&&n.countRenderedCols()>0&&n.countRenderedRows()>0?n.selection.transformFocus(i.row,i.col):n.selection.transformStart(i.row,i.col)}},OQ={name:"moveCellSelectionLeft",callback(n){n.selection.transformStart(0,-1*n.getDirectionFactor())}},_Q={name:"moveCellSelectionRight",callback(n){n.selection.transformStart(0,n.getDirectionFactor())}},PQ={name:"moveCellSelectionToMostBottom",callback(n){const{col:e}=n.getSelectedRangeLast().highlight;let t=n.rowIndexMapper.getNearestNotHiddenIndex(n.countRows()-1,-1);t===null&&(t=-1),n.selection.setRangeStart(n._createCellCoords(t,e))}},xQ={name:"moveCellSelectionToMostBottomInlineEnd",callback(n){const{selection:e,rowIndexMapper:t,columnIndexMapper:r}=n,i=parseInt(n.getSettings().fixedRowsBottom,10),s=t.getNearestNotHiddenIndex(n.countRows()-i-1,-1),o=r.getNearestNotHiddenIndex(n.countCols()-1,-1);e.setRangeStart(n._createCellCoords(s,o))}},LQ={name:"moveCellSelectionToMostInlineEnd",callback(n){const{selection:e,columnIndexMapper:t}=n;e.setRangeStart(n._createCellCoords(n.getSelectedRangeLast().highlight.row,t.getNearestNotHiddenIndex(n.countCols()-1,-1)))}},HQ={name:"moveCellSelectionToMostInlineStart",callback(n){const{selection:e,columnIndexMapper:t}=n,r=parseInt(n.getSettings().fixedColumnsStart,10),i=n.getSelectedRangeLast().highlight.row,s=t.getNearestNotHiddenIndex(r,1);e.setRangeStart(n._createCellCoords(i,s))}},DQ={name:"moveCellSelectionToMostLeft",callback(n){const{selection:e,columnIndexMapper:t}=n,r=n.getSelectedRangeLast().highlight.row;let i=t.getNearestNotHiddenIndex(...n.isRtl()?[n.countCols()-1,-1]:[0,1]);i===null&&(i=n.isRtl()?-1:-n.countRowHeaders()),e.setRangeStart(n._createCellCoords(r,i))}},FQ={name:"moveCellSelectionToMostRight",callback(n){const{selection:e,columnIndexMapper:t}=n,{row:r}=n.getSelectedRangeLast().highlight;let i=t.getNearestNotHiddenIndex(...n.isRtl()?[0,1]:[n.countCols()-1,-1]);i===null&&(i=n.isRtl()?-n.countRowHeaders():-1),e.setRangeStart(n._createCellCoords(r,i))}},kQ={name:"moveCellSelectionToMostTop",callback(n){const{col:e}=n.getSelectedRangeLast().highlight;let t=n.rowIndexMapper.getNearestNotHiddenIndex(0,1);t===null&&(t=-n.countColHeaders()),n.selection.setRangeStart(n._createCellCoords(t,e))}},VQ={name:"moveCellSelectionToMostTopInlineStart",callback(n){const{selection:e,rowIndexMapper:t,columnIndexMapper:r}=n,i=parseInt(n.getSettings().fixedRowsTop,10),s=parseInt(n.getSettings().fixedColumnsStart,10),o=t.getNearestNotHiddenIndex(i,1),a=r.getNearestNotHiddenIndex(s,1);e.setRangeStart(n._createCellCoords(o,a))}},UQ={name:"moveCellSelectionUp",callback(n){let{selection:e}=n;e.transformStart(-1,0)}},BQ={name:"moveCellSelectionUpByViewportHight",callback(n){const{navigableHeaders:e}=n.getSettings(),t=e?n.countColHeaders():0,{row:r}=n.getSelectedRangeLast().highlight;let i=-(n.countVisibleRows()+t);r===-t?i=-1:r+i<t&&(i=-(r+t)),n.selection.transformStart(i,0),n.getSelectedRangeLast().highlight.row<0&&n.scrollViewportTo({row:0})}};function WQ(){return[AQ,NQ,MQ,IQ,OQ,_Q,PQ,xQ,LQ,HQ,DQ,FQ,kQ,VQ,UQ,BQ]}const $Q={name:"emptySelectedCells",callback(n){n.emptySelectedCells(),n._getEditorManager().prepareEditor()}},GQ={name:"scrollToFocusedCell",callback(n){const{highlight:e}=n.getSelectedRangeLast(),t=n.view.getFirstFullyVisibleRow()-1,r=n.view.getFirstFullyVisibleColumn()-1,i=n.view.getLastFullyVisibleRow()+1,s=n.view.getLastFullyVisibleColumn()+1,o=n._createCellCoords(t,r),a=n._createCellCoords(i,s);if(!n._createCellRange(o,o,a).includes(e)&&(e.row>=0||e.col>=0)){const u={};if(e.col>=0){const h=Math.floor(n.countVisibleCols()/2);u.col=Math.max(e.col-h,0)}if(e.row>=0){const h=Math.floor(n.countVisibleRows()/2);u.row=Math.max(e.row-h,0)}n.scrollViewportTo({...u,verticalSnap:"top",horizontalSnap:"start"})}}},jQ={name:"selectAllCells",callback(n){n.selection.selectAll(!0,!0,{disableHeadersHighlight:!0})}},zQ={name:"selectAllCellsAndHeaders",callback(n){n.selection.selectAll(!0,!0,{disableHeadersHighlight:!1})}},YQ={name:"populateSelectedCellsData",callback(n){const e=n.getSelectedRange(),{row:t,col:r}=e[e.length-1].highlight.normalize(),i=n.getDataAtCell(t,r),s=new Map;for(let o=0;o<e.length;o++)e[o].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==t||l!==r)){const{readOnly:u}=n.getCellMeta(a,l);u||s.set(`${a}x${l}`,[a,l,i])}});n.setDataAtCell(Array.from(s.values()))}},KQ=[...hQ(),...TQ(),...WQ(),$Q,GQ,jQ,zQ,YQ];function pB(n){const e={};return KQ.forEach(t=>{let{name:r,callback:i}=t;e[r]=function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return i(n,...o)}}),e}function qQ(n){const e=n.getShortcutManager().addContext("editor"),t=pB(n),r={group:hu};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(i,s)=>t.editorCloseAndSaveByEnter(i,s)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(i,s)=>t.editorCloseAndSaveByEnter(i,s)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:n.getShortcutManager().getContext("grid"),callback:(i,s)=>t.editorCloseAndSave(i,s)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(i,s)=>t.editorCloseAndSaveByArrowKeys(i,s)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>t.editorCloseWithoutSaving()}],r)}function XQ(n){const e=n.getShortcutManager().addContext("grid"),t=pB(n),r={runOnlyIf:()=>{const{navigableHeaders:i}=n.getSettings();return Ne(n.getSelected())&&(i||!i&&n.countRenderedRows()>0&&n.countRenderedCols()>0)},group:mB};e.addShortcuts([{keys:[["F2"]],callback:i=>t.editorFastOpen(i)},{keys:[["Enter"],["Enter","Shift"]],callback:(i,s)=>t.editorOpen(i,s)},{keys:[["Backspace"],["Delete"]],callback:()=>t.emptySelectedCells()}],{group:hu,runOnlyIf:()=>Ne(n.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>t.selectAllCells(),runOnlyIf:()=>{var i;return!((i=n.getSelectedRangeLast())!==null&&i!==void 0&&i.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var i;return(i=n.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>t.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>t.populateSelectedCellsData(),runOnlyIf:()=>{var i,s;return!((i=n.getSelectedRangeLast())!==null&&i!==void 0&&i.highlight.isHeader())&&((s=n.getSelectedRangeLast())===null||s===void 0?void 0:s.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>t.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>t.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>t.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>t.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>t.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(n.selection.isSelectedByCorner()||n.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>t.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>t.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>t.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(n.selection.isSelectedByCorner()||n.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>t.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>t.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>t.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(n.selection.isSelectedByCorner()||n.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>t.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>t.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>t.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(n.selection.isSelectedByCorner()||n.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>n.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>t.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>n.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>n.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>t.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>n.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>t.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>t.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>t.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>t.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:i=>t.moveCellSelectionInlineStart(i)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:i=>t.moveCellSelectionInlineEnd(i)},{keys:[["Control/Meta","Backspace"]],callback:()=>t.scrollToFocusedCell()}],r)}function QQ(n){[XQ,qQ].forEach(e=>e(n))}function ZQ(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const t=n.rootElement,r=PL(n),i=PL(n);return r.addEventListener("focus",()=>e?.onFocusFromTop()),i.addEventListener("focus",()=>e?.onFocusFromBottom()),t.firstChild.before(r),t.lastChild.after(i),{activate(){n._registerTimeout(()=>{r.tabIndex=0,i.tabIndex=0},10)},deactivate(){n._registerTimeout(()=>{r.tabIndex=-1,i.tabIndex=-1},10)}}}function PL(n){const t=n.rootDocument.createElement("input");return t.type="text",t.classList.add("htFocusCatcher"),n.getSettings().ariaTags&&Ge(t,[Xo(),$h()]),t}function JQ(n){const e=eZ(n);let t;const{activate:r,deactivate:i}=ZQ(n,{onFocusFromTop(){var c;const d=(c=e(t))!==null&&c!==void 0?c:GA(n);d&&(n.runHooks("modifyFocusOnTabNavigation","from_above",d),n.selectCell(d.row,d.col)),n.listen()},onFocusFromBottom(){var c;const d=(c=e(t))!==null&&c!==void 0?c:jA(n);d&&(n.runHooks("modifyFocusOnTabNavigation","from_below",d),n.selectCell(d.row,d.col)),n.listen()}}),s={wrapped:!1,flipped:!1};let o=!0,a=!1,l=!1;n.addHook("afterListen",()=>i()),n.addHook("afterUnlisten",()=>r()),n.addHook("afterSelection",(c,d,f,g,p)=>{if(a&&(s.wrapped&&s.flipped||l)&&(l=!1,p.value=!0),o){var v;t=(v=n.getSelectedRangeLast())===null||v===void 0?void 0:v.highlight}}),n.addHook("beforeRowWrap",(c,d,f)=>{s.wrapped=!0,s.flipped=f});function u(){s.wrapped=!1,s.flipped=!1,n.deselectCell(),n.unlisten()}const h={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:mB,group:"focusCatcher"};n.getShortcutManager().getContext("grid").addShortcuts([{...h,callback:()=>{const{tabNavigation:c}=n.getSettings();a=!0,n.getSelectedRangeLast()&&!c&&(o=!1),c||(l=!0)},position:"before"},{...h,callback:c=>{const{tabNavigation:d,autoWrapRow:f}=n.getSettings();if(a=!1,o=!0,!d||!n.selection.isSelected()||f&&s.wrapped&&s.flipped||!f&&s.wrapped)return f&&s.wrapped&&s.flipped&&(t=c.shiftKey?GA(n):jA(n)),u(),!1;c.preventDefault()},position:"after"}])}function GA(n){const{rowIndexMapper:e,columnIndexMapper:t}=n,{navigableHeaders:r}=n.getSettings();let i=r&&n.countColHeaders()>0?-n.countColHeaders():0,s=r&&n.countRowHeaders()>0?-n.countRowHeaders():0;return i===0&&(i=e.getVisualFromRenderableIndex(i)),s===0&&(s=t.getVisualFromRenderableIndex(s)),i===null||s===null?null:n._createCellCoords(i,s)}function jA(n){var e,t;const{rowIndexMapper:r,columnIndexMapper:i}=n,{navigableHeaders:s}=n.getSettings();let o=r.getRenderableIndexesLength()-1,a=i.getRenderableIndexesLength()-1;if(o<0){if(!s||n.countColHeaders()===0)return null;o=-1}if(a<0){if(!s||n.countColHeaders()===0)return null;a=-1}return n._createCellCoords((e=r.getVisualFromRenderableIndex(o))!==null&&e!==void 0?e:o,(t=i.getVisualFromRenderableIndex(a))!==null&&t!==void 0?t:a)}function eZ(n){return e=>{if(!e)return null;const t=GA(n),r=jA(n);return e.col<t.col&&(e.col=t.col),e.col>r.col&&(e.col=r.col),e.row<t.row&&(e.row=t.row),e.row>r.row&&(e.row=r.row),e}}function tZ(n){return e=>{let{col:t}=e;n.scrollViewportTo({col:t})}}function nZ(){return()=>{}}function rZ(n){return e=>{n.scrollViewportTo(e.toObject())}}function iZ(n){return e=>{n.scrollViewportTo(e.toObject())}}function sZ(n){return e=>{n.scrollViewportTo(e.toObject())}}function oZ(n){return e=>{let{row:t}=e;n.scrollViewportTo({row:t})}}function aZ(n){return e=>{const t=n.selection.getSelectionSource(),{row:r,col:i}=e;if(r<0&&i>=0)n.scrollViewportTo({col:i});else if(i<0&&r>=0)n.scrollViewportTo({row:r});else{if(t==="mouse"&&(i===n.view.getLastPartiallyVisibleColumn()||r===n.view.getLastPartiallyVisibleRow()))return;n.scrollViewportTo({row:r,col:i})}}}function lZ(n){const{selection:e}=n;let t=!1,r=!1;return{resume(){r=!1},suspend(){r=!0},skipNextScrollCycle(){t=!0},scrollTo(i){var s;if(t||r){t=!1;return}let o;e.isFocusSelectionChanged()?o=rZ(n):e.isSelectedByCorner()?o=nZ():e.isSelectedByRowHeader()?o=oZ(n):e.isSelectedByColumnHeader()?o=tZ(n):e.getSelectedRange().size()===1&&e.isMultiple()?o=iZ(n):e.getSelectedRange().size()===1&&!e.isMultiple()?o=aZ(n):e.getSelectedRange().size()>1&&(o=sZ(n)),(s=o)===null||s===void 0||s(i)}}}const xL=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),Pp=n=>n.map(e=>{const t=e.toLowerCase();return xL.has(t)?xL.get(t):t}).sort().join("+"),uZ=n=>n.split("+"),LL=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),Sb=n=>{let{which:e,key:t}=n;if(LL.has(e))return LL.get(e);const r=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(r)?r:t.toLowerCase()},wB=Symbol("shortcut-context");function vB(n){return ot(n)&&n.__kindOf===wB}const hZ=n=>{const e=OC({errorIdExists:l=>`The "${l}" shortcut is already registered in the "${n}" context.`}),t=function(){let{keys:l,callback:u,group:h,runOnlyIf:c=()=>!0,captureCtrl:d=!1,preventDefault:f=!0,stopPropagation:g=!1,relativeToGroup:p,position:v,forwardToContext:y}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(nn(h))throw new Error("You need to define the shortcut's group.");if(Jt(u)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(l)===!1)throw new Error(Bt`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const S={callback:u,group:h,runOnlyIf:c,captureCtrl:d,preventDefault:f,stopPropagation:g};Ne(p)&&(S.relativeToGroup=p,S.position=v),vB(y)&&(S.forwardToContext=y),l.forEach(R=>{const A=Pp(R);if(e.hasItem(A)){const V=e.getItem(A);let B=V.findIndex(Y=>Y.group===p);B!==-1?v==="before"?B-=1:B+=1:B=V.length,V.splice(B,0,S)}else e.addItem(A,[S])})},r=function(l){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};l.forEach(h=>{at(u,(c,d)=>{Object.prototype.hasOwnProperty.call(h,d)===!1&&(h[d]=u[d])}),t(h)})},i=l=>{const u=Pp(l);e.removeItem(u)};return{__kindOf:wB,addShortcut:t,addShortcuts:r,getShortcuts:l=>{const u=Pp(l),h=e.getItem(u);return Ne(h)?h.slice():[]},hasShortcut:l=>{const u=Pp(l);return e.hasItem(u)},removeShortcutsByKeys:i,removeShortcutsByGroup:l=>{e.getItems().forEach(h=>{let[c,d]=h;const f=d.filter(g=>g.group!==l);f.length===0?i(uZ(c)):(d.length=0,d.push(...f))})}}};function cZ(){const n=new Set;return{press(e){n.add(e)},release(e){n.delete(e)},releaseAll(){n.clear()},isPressed(e){return n.has(e)}}}const dZ=["meta","alt","shift","control"],mf=cZ(),gf=[];let xp=0;function fZ(n,e,t,r,i){const s=f=>dZ.includes(f),o=function(f){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const p=[];return f.altKey&&p.push("alt"),g&&(f.ctrlKey||f.metaKey)?p.push("control/meta"):(f.ctrlKey&&p.push("control"),f.metaKey&&p.push("meta")),f.shiftKey&&p.push("shift"),p},a=f=>{if(e(f)===!1)return;const g=t(f);if(f.keyCode===229||g===!1||Hl(f))return;const p=Sb(f);let v=[];s(p)||(v=o(f));const y=[p].concat(v);!i(f,y)&&(jm()&&v.includes("meta")||!jm()&&v.includes("control"))&&i(f,[p].concat(o(f,!0))),r(f)},l=f=>{if(f.key){const g=Sb(f);s(g)&&mf.press(g)}},u=f=>{if(f.key){const g=Sb(f);s(g)&&mf.release(g)}},h=()=>{mf.releaseAll()};return{mount:()=>{let f=n;for(xp+=1;f;)xp===1&&(f.document.documentElement.addEventListener("keydown",l),gf.push({event:"keydown",listener:l}),f.document.documentElement.addEventListener("keyup",u),gf.push({event:"keyup",listener:u})),f.document.documentElement.addEventListener("keydown",a),f.document.documentElement.addEventListener("blur",h),f=Eh(f)},unmount:()=>{let f=n;for(xp-=1;f;){if(xp===0){for(let g=0;g<gf.length;g++){const{event:p,listener:v}=gf[g];f.document.documentElement.removeEventListener(p,v)}gf.length=0}f.document.documentElement.removeEventListener("keydown",a),f.document.documentElement.removeEventListener("blur",h),f=Eh(f)}},isPressed:f=>mf.isPressed(f),releasePressedKeys:()=>mf.releaseAll()}}const mZ=n=>{let{ownerWindow:e,handleEvent:t,beforeKeyDown:r,afterKeyDown:i}=n;const s=OC({errorIdExists:g=>`The "${g}" context name is already registered.`});let o="grid";const a=g=>{const p=hZ(g);return s.addItem(g,p),p},l=()=>o,u=g=>s.getItem(g),h=g=>{if(!s.hasItem(g))throw new Error(Bt`You've tried to activate the "${g}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);o=g};let c=!1;const d=function(g,p){let v=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l();const y=vB(v)?v:u(v);let S=!1;if(!y.hasShortcut(p))return S;const R=y.getShortcuts(p);for(let A=0;A<R.length;A++){const{callback:O,runOnlyIf:V,preventDefault:B,stopPropagation:Y,captureCtrl:q,forwardToContext:G}=R[A];if(V(g)===!0){if(c=q,S=O(g,p)===!1,c=!1,B&&g.preventDefault(),Y&&(Ns(g),g.stopPropagation()),S)break;G&&d(g,p,G)}}return S},f=fZ(e,t,r,i,d);return f.mount(),{addContext:a,getActiveContextName:l,getContext:u,setActiveContextName:h,isCtrlPressed:()=>!c&&(f.isPressed("control")||f.isPressed("meta")),releasePressedKeys:()=>f.releasePressedKeys(),destroy:()=>f.unmount()}};let Rb=null;const Eb=new Map;function yB(n,e){var t,r=this;let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=this;const o=new ys(s);let a,l,u,h,c,d,f=!0;X5(i)&&q5(this),this.rootElement=n,this.rootDocument=n.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const g=(t=e?.layoutDirection)!==null&&t!==void 0?t:"inherit",p=["rtl","ltr"].includes(g)?g:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",p),this.isRtl=function(){return p==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1},e.language=j8(e.language);const v=new fB(s,e,[z7,J7]),y=v.getTableMeta(),S=v.getGlobalMeta(),R=OC();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,n.insertBefore(this.container,n.firstChild),nv(this)&&PV(e.licenseKey,n),this.guid=`ht_${xM()}`,Eb.set(this.guid,this),this.columnIndexMapper=new BA,this.rowIndexMapper=new BA,this.columnIndexMapper.addLocalHook("indexesSequenceChange",w=>{s.runHooks("afterColumnSequenceChange",w)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",w=>{s.runHooks("afterRowSequenceChange",w)}),l=new u8(s),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const A=w=>{const{row:C,col:b}=w;return s._createCellCoords(C>=0?s.rowIndexMapper.getRenderableFromVisualIndex(C):C,b>=0?s.columnIndexMapper.getRenderableFromVisualIndex(b):b)},O=w=>{const{row:C,col:b}=w;return s._createCellCoords(C>=0?s.rowIndexMapper.getVisualFromRenderableIndex(C):C,b>=0?s.columnIndexMapper.getVisualFromRenderableIndex(b):b)},V=(w,C)=>{const b=C>w?1:-1,P=Math.min(w,C),H=Math.max(w,C),W=s.rowIndexMapper.getNearestNotHiddenIndex(w,b);return W===null||b===1&&W>H||b===-1&&W<P?null:W>=0?s.rowIndexMapper.getRenderableFromVisualIndex(W):W},B=(w,C)=>{const b=C>w?1:-1,P=Math.min(w,C),H=Math.max(w,C),W=s.columnIndexMapper.getNearestNotHiddenIndex(w,b);return W===null||b===1&&W>H||b===-1&&W<P?null:W>=0?s.columnIndexMapper.getRenderableFromVisualIndex(W):W};let Y=new hB(y,{rowIndexMapper:s.rowIndexMapper,columnIndexMapper:s.columnIndexMapper,countCols:()=>s.countCols(),countRows:()=>s.countRows(),propToCol:w=>a.propToCol(w),isEditorOpened:()=>s.getActiveEditor()?s.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return r.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return r.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>s.getShortcutManager(),createCellCoords:(w,C)=>s._createCellCoords(w,C),createCellRange:(w,C,b)=>s._createCellRange(w,C,b),visualToRenderableCoords:A,renderableToVisualCoords:O,findFirstNonHiddenRenderableRow:V,findFirstNonHiddenRenderableColumn:B,isDisabledCellSelection:(w,C)=>w<0||C<0?s.getSettings().disableVisualSelection:s.getCellMeta(w,C).disableVisualSelection});this.selection=Y;const q=w=>{let{hiddenIndexesChanged:C}=w;C&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",q),this.rowIndexMapper.addLocalHook("cacheUpdated",q),this.selection.addLocalHook("afterSetRangeEnd",(w,C)=>{const b=fs(!1),P=this.selection.getSelectedRange(),{from:H,to:W}=P.current(),J=P.size()-1;this.runHooks("afterSelection",H.row,H.col,W.row,W.col,b,J),this.runHooks("afterSelectionByProp",H.row,s.colToProp(H.col),W.row,s.colToProp(W.col),b,J),C&&(!b.isTouched()||b.isTouched()&&!b.value)&&d.scrollTo(w);const te=Y.isSelectedByRowHeader(),ce=Y.isSelectedByColumnHeader();te&&ce?ie(this.rootElement,["ht__selection--rows","ht__selection--columns"]):te?(Xe(this.rootElement,"ht__selection--columns"),ie(this.rootElement,"ht__selection--rows")):ce?(Xe(this.rootElement,"ht__selection--rows"),ie(this.rootElement,"ht__selection--columns")):Xe(this.rootElement,["ht__selection--rows","ht__selection--columns"]),Y.getSelectionSource()!=="shift"&&h.closeEditor(null),s.view.render(),h.prepareEditor()}),this.selection.addLocalHook("beforeSetFocus",w=>{this.runHooks("beforeSelectionFocusSet",w.row,w.col)}),this.selection.addLocalHook("afterSetFocus",w=>{const C=fs(!1);this.runHooks("afterSelectionFocusSet",w.row,w.col,C),(!C.isTouched()||C.isTouched()&&!C.value)&&d.scrollTo(w),h.closeEditor(),s.view.render(),h.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",w=>{const C=w.length-1,{from:b,to:P}=w[C];this.runHooks("afterSelectionEnd",b.row,b.col,P.row,P.col,C),this.runHooks("afterSelectionEndByProp",b.row,s.colToProp(b.col),P.row,s.colToProp(P.col),C)}),this.selection.addLocalHook("afterIsMultipleSelection",w=>{const C=this.runHooks("afterIsMultipleSelection",w.value);w.value&&(w.value=C)}),this.selection.addLocalHook("afterDeselect",()=>{h.closeEditor(),s.view.render(),Xe(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var w=arguments.length,C=new Array(w),b=0;b<w;b++)C[b]=arguments[b];return r.runHooks("beforeSetRangeStart",...C)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var w=arguments.length,C=new Array(w),b=0;b<w;b++)C[b]=arguments[b];return r.runHooks("beforeSetRangeStartOnly",...C)}).addLocalHook("beforeSetRangeEnd",function(){for(var w=arguments.length,C=new Array(w),b=0;b<w;b++)C[b]=arguments[b];return r.runHooks("beforeSetRangeEnd",...C)}).addLocalHook("beforeSelectColumns",function(){for(var w=arguments.length,C=new Array(w),b=0;b<w;b++)C[b]=arguments[b];return r.runHooks("beforeSelectColumns",...C)}).addLocalHook("afterSelectColumns",function(){for(var w=arguments.length,C=new Array(w),b=0;b<w;b++)C[b]=arguments[b];return r.runHooks("afterSelectColumns",...C)}).addLocalHook("beforeSelectRows",function(){for(var w=arguments.length,C=new Array(w),b=0;b<w;b++)C[b]=arguments[b];return r.runHooks("beforeSelectRows",...C)}).addLocalHook("afterSelectRows",function(){for(var w=arguments.length,C=new Array(w),b=0;b<w;b++)C[b]=arguments[b];return r.runHooks("afterSelectRows",...C)}).addLocalHook("beforeModifyTransformStart",function(){for(var w=arguments.length,C=new Array(w),b=0;b<w;b++)C[b]=arguments[b];return r.runHooks("modifyTransformStart",...C)}).addLocalHook("afterModifyTransformStart",function(){for(var w=arguments.length,C=new Array(w),b=0;b<w;b++)C[b]=arguments[b];return r.runHooks("afterModifyTransformStart",...C)}).addLocalHook("beforeModifyTransformFocus",function(){for(var w=arguments.length,C=new Array(w),b=0;b<w;b++)C[b]=arguments[b];return r.runHooks("modifyTransformFocus",...C)}).addLocalHook("afterModifyTransformFocus",function(){for(var w=arguments.length,C=new Array(w),b=0;b<w;b++)C[b]=arguments[b];return r.runHooks("afterModifyTransformFocus",...C)}).addLocalHook("beforeModifyTransformEnd",function(){for(var w=arguments.length,C=new Array(w),b=0;b<w;b++)C[b]=arguments[b];return r.runHooks("modifyTransformEnd",...C)}).addLocalHook("afterModifyTransformEnd",function(){for(var w=arguments.length,C=new Array(w),b=0;b<w;b++)C[b]=arguments[b];return r.runHooks("afterModifyTransformEnd",...C)}).addLocalHook("beforeRowWrap",function(){for(var w=arguments.length,C=new Array(w),b=0;b<w;b++)C[b]=arguments[b];return r.runHooks("beforeRowWrap",...C)}).addLocalHook("beforeColumnWrap",function(){for(var w=arguments.length,C=new Array(w),b=0;b<w;b++)C[b]=arguments[b];return r.runHooks("beforeColumnWrap",...C)}).addLocalHook("insertRowRequire",w=>this.alter("insert_row_above",w,1,"auto")).addLocalHook("insertColRequire",w=>this.alter("insert_col_start",w,1,"auto")),u={alter(w,C){var b,P;let H=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,W=arguments.length>3?arguments[3]:void 0,J=arguments.length>4?arguments[4]:void 0;const te=ce=>{if(ce.length===0)return[];const ge=[...ce];return ge.sort((Ue,$e)=>{let[X]=Ue,[Ze]=$e;return X===Ze?0:X>Ze?1:-1}),jn(ge,(Ue,$e)=>{let[X,Ze]=$e;const it=Ue[Ue.length-1],[vt,qe]=it,He=vt+qe;if(X<=He){const T=Math.max(Ze-(He-X),0);it[1]+=T}else Ue.push([X,Ze]);return Ue},[ge[0]])};switch(w){case"insert_row_below":case"insert_row_above":const ce=s.countSourceRows();if(y.maxRows===ce)return;const ge=w==="insert_row_below"?"below":"above";C=(b=C)!==null&&b!==void 0?b:ge==="below"?ce:0;const{delta:oe,startPhysicalIndex:Ue}=a.createRow(C,H,{source:W,mode:ge});Y.shiftRows(s.toVisualRow(Ue),oe);break;case"insert_col_start":case"insert_col_end":const $e=w==="insert_col_end"?"end":"start";C=(P=C)!==null&&P!==void 0?P:$e==="end"?s.countSourceCols():0;const{delta:X,startPhysicalIndex:Ze}=a.createCol(C,H,{source:W,mode:$e});if(X){if(Array.isArray(y.colHeaders)){const qe=[s.toVisualColumn(Ze),0];qe.length+=X,Array.prototype.splice.apply(y.colHeaders,qe)}Y.shiftColumns(s.toVisualColumn(Ze),X)}break;case"remove_row":const it=qe=>{let He=0;L(qe,T=>{let[I,x]=T;const j=An(I)?s.countRows()-1:Math.max(I-He,0);if(Number.isInteger(I)&&(I=Math.max(I-He,0)),!a.removeRow(I,x,W))return;if(Y.isSelected()){const{row:z}=s.getSelectedRangeLast().highlight;z>=I&&z<=I+x-1&&h.closeEditor(!0)}const K=s.countRows();K===0?Y.deselect():W==="ContextMenu.removeRow"?Y.refresh():Y.shiftRows(I,-x);const U=y.fixedRowsTop;U>=j+1&&(y.fixedRowsTop-=Math.min(x,U-j));const F=y.fixedRowsBottom;F&&j>=K-F&&(y.fixedRowsBottom-=Math.min(x,F)),He+=x})};Array.isArray(C)?it(te(C)):it([[C,H]]);break;case"remove_col":const vt=qe=>{let He=0;L(qe,T=>{let[I,x]=T;const j=An(I)?s.countCols()-1:Math.max(I-He,0);let D=s.toPhysicalColumn(j);if(Number.isInteger(I)&&(I=Math.max(I-He,0)),!a.removeCol(I,x,W))return;if(Y.isSelected()){const{col:z}=s.getSelectedRangeLast().highlight;z>=I&&z<=I+x-1&&h.closeEditor(!0)}s.countCols()===0?Y.deselect():W==="ContextMenu.removeColumn"?Y.refresh():Y.shiftColumns(I,-x);const F=y.fixedColumnsStart;F>=j+1&&(y.fixedColumnsStart-=Math.min(x,F-j)),Array.isArray(y.colHeaders)&&(typeof D>"u"&&(D=-1),y.colHeaders.splice(D,x)),He+=x})};Array.isArray(C)?vt(te(C)):vt([[C,H]]);break;default:throw new Error(`There is no such action "${w}"`)}s.view.render(),J||u.adjustRowsAndCols()},adjustRowsAndCols(){const w=y.minRows,C=y.minSpareRows,b=y.minCols,P=y.minSpareCols;if(w){const H=s.countRows();H<w&&a.createRow(H,w-H,{source:"auto"})}if(C){const H=s.countEmptyRows(!0);if(H<C){const W=C-H,J=Math.min(W,y.maxRows-s.countSourceRows());a.createRow(s.countRows(),J,{source:"auto"})}}{let H;(b||P)&&(H=s.countEmptyCols(!0));let W=s.countCols();if(b&&!y.columns&&W<b){const J=b-W;H+=J,a.createCol(W,J,{source:"auto"})}if(P&&!y.columns&&s.dataType==="array"&&H<P){W=s.countCols();const J=P-H,te=Math.min(J,y.maxCols-W);a.createCol(W,te,{source:"auto"})}}s.view&&s.view.adjustElementsSize()},populateFromArray(w,C,b,P,H){let W,J,te,ce;const ge=[],oe={},Ue=[],$e=w.row,X=w.col;if(J=C.length,J===0)return!1;let Ze=0,it=0;switch(ot(b)&&(Ze=b.col-X+1,it=b.row-$e+1),H){case"shift_down":const vt=sm(C),qe=vt.length,He=Math.max(qe,Ze),T=s.getData().slice($e),I=sm(T).slice(X,X+He);for(te=0;te<He;te+=1)if(te<qe){for(W=0,J=vt[te].length;W<it-J;W+=1)vt[te].push(vt[te][W%J]);te<I.length?Ue.push(vt[te].concat(I[te])):Ue.push(vt[te].concat(new Array(T.length).fill(null)))}else Ue.push(vt[te%qe].concat(I[te]));s.populateFromArray($e,X,sm(Ue));break;case"shift_right":const x=C.length,j=Math.max(x,it),D=s.getData().slice($e).map(Re=>Re.slice(X));for(W=0;W<j;W+=1)if(W<x){for(te=0,ce=C[W].length;te<Ze-ce;te+=1)C[W].push(C[W][te%ce]);if(W<D.length)for(let Re=0;Re<D[W].length;Re+=1)C[W].push(D[W][Re]);else C[W].push(...new Array(D[0].length).fill(null))}else C.push(C[W%J].slice(0,j).concat(D[W]));s.populateFromArray($e,X,C);break;case"overwrite":default:oe.row=w.row,oe.col=w.col;let K=0,U=0,F=!0,z;const $=function(De){let st=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const Ct=C[De%C.length];return st!==null?Ct[st%Ct.length]:Ct},Q=C.length,de=b?b.row-w.row+1:0;for(b?J=de:J=Math.max(Q,de),W=0;W<J&&!(b&&oe.row>b.row&&de>Q||!y.allowInsertRow&&oe.row>s.countRows()-1||oe.row>=y.maxRows);W++){const Re=W-K,De=$(Re).length,st=b?b.col-w.col+1:0;if(b?ce=st:ce=Math.max(De,st),oe.col=w.col,z=s.getCellMeta(oe.row,oe.col),(P==="CopyPaste.paste"||P==="Autofill.fill")&&z.skipRowOnPaste){K+=1,oe.row+=1,J+=1;continue}for(U=0,te=0;te<ce&&!(b&&oe.col>b.col&&st>De||!y.allowInsertColumn&&oe.col>s.countCols()-1||oe.col>=y.maxCols);te++){if(z=s.getCellMeta(oe.row,oe.col),(P==="CopyPaste.paste"||P==="Autofill.fill")&&z.skipColumnOnPaste){U+=1,oe.col+=1,ce+=1;continue}if(z.readOnly&&P!=="UndoRedo.undo"){oe.col+=1;continue}const Ct=te-U;let dt=$(Re,Ct),Ye=s.getDataAtCell(oe.row,oe.col);if(dt!==null&&typeof dt=="object")if(Array.isArray(dt)&&Ye===null&&(Ye=[]),Ye===null||typeof Ye!="object")F=!1;else{const Et=yd(Array.isArray(Ye)?Ye:Ye[0]||Ye),wn=yd(Array.isArray(dt)?dt:dt[0]||dt);AC(Et,wn)||Array.isArray(Et)&&Array.isArray(wn)?dt=Gr(dt):F=!1}else Ye!==null&&typeof Ye=="object"&&(F=!1);F&&ge.push([oe.row,oe.col,dt]),F=!0,oe.col+=1}oe.row+=1}s.setDataAtCell(ge,null,null,P||"populateFromArray");break}}};function G(w){const C=ZU(w);jI(C)?(s.runHooks("beforeLanguageChange",C),S.language=C,s.runHooks("afterLanguageChange",C)):JU(w)}function Z(w,C){const b=w==="className"?s.rootElement:s.table;if(f)ie(b,C);else{let P=[],H=[];S[w]&&(P=Array.isArray(S[w])?S[w]:AA(S[w])),C&&(H=Array.isArray(C)?C:AA(C));const W=TA(P,H),J=TA(H,P);W.length&&Xe(b,W),J.length&&ie(b,J)}S[w]=C}this.init=function(){l.setData(y.data),s.runHooks("beforeInit"),(Ba()||QM())&&ie(s.rootElement,"mobile"),this.updateSettings(y,!0),this.view=new e8(this),h=xA.getInstance(s,y,Y),d=lZ(s),c=new V6(s),nv(this)&&JQ(s),s.runHooks("init"),this.forceFullRender=!0,this.view.render(),f&&s.rootElement.offsetParent===null&&QV(s.rootElement,()=>{s.view._wt.wtOverlays.updateLastSpreaderSize(),s.render(),s.view.adjustElementsSize()}),typeof f=="object"&&(s.runHooks("afterChange",f[0],f[1]),f=!1),s.runHooks("afterInit")};function ee(){let w=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,w=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&w===!1&&(w=!0,this.onQueueEmpty(this.valid))}}}function ne(w){const C=w.replace(",",".");return isNaN(parseFloat(C))===!1?parseFloat(C):w}function re(w,C,b){if(!w.length){b();return}const P=s.getActiveEditor(),H=new ee;let W=!0;H.onQueueEmpty=()=>{P&&W&&P.cancelChanges(),b()};for(let J=w.length-1;J>=0;J--){const[te,ce,,ge]=w[J],oe=a.propToCol(ce);let Ue;Number.isInteger(oe)?Ue=s.getCellMeta(te,oe):Ue={...Object.getPrototypeOf(y),...y},Ue.type==="numeric"&&typeof ge=="string"&&yU(ge)&&(w[J][3]=ne(ge)),s.getCellValidator(Ue)&&(H.addValidatorToQueue(),s.validateCell(w[J][3],Ue,(function($e,X){return function(Ze){if(typeof Ze!="boolean")throw new Error("Validation error: result is not boolean");Ze===!1&&X.allowInvalid===!1&&(W=!1,w.splice($e,1),X.valid=!0),H.removeValidatorFormQueue()}})(J,Ue),C))}H.checkIfQueueIsEmpty()}function ae(w,C){for(let P=w.length-1;P>=0;P--){let H=!1;if(w[P]===null){w.splice(P,1);continue}if(!((w[P][2]===null||w[P][2]===void 0)&&(w[P][3]===null||w[P][3]===void 0))){if(y.allowInsertRow)for(;w[P][0]>s.countRows()-1;){const{delta:W}=a.createRow(void 0,void 0,{source:C});if(W===0){H=!0;break}}if(s.dataType==="array"&&(!y.columns||y.columns.length===0)&&y.allowInsertColumn)for(;a.propToCol(w[P][1])>s.countCols()-1;){const{delta:W}=a.createCol(void 0,void 0,{source:C});if(W===0){H=!0;break}}H||a.set(w[P][0],w[P][1],w[P][3])}}const b=w.length>0;if(s.forceFullRender=!0,b){u.adjustRowsAndCols(),s.runHooks("beforeChangeRender",w,C),h.closeEditor(),s.view.render(),h.prepareEditor(),s.view.adjustElementsSize(),s.runHooks("afterChange",w,C||"edit");const P=s.getActiveEditor();P&&Ne(P.refreshValue)&&P.refreshValue()}else s.view.render()}this._createCellCoords=function(w,C){return s.view._wt.createCellCoords(w,C)},this._createCellRange=function(w,C,b){return s.view._wt.createCellRange(w,C,b)},this.validateCell=function(w,C,b,P){let H=s.getCellValidator(C);function W(J){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||C.hidden===!0){b(J);return}const ce=C.visualCol,ge=C.visualRow,oe=s.getCell(ge,ce,!0);if(oe&&oe.nodeName!=="TH"){const Ue=s.rowIndexMapper.getRenderableFromVisualIndex(ge),$e=s.columnIndexMapper.getRenderableFromVisualIndex(ce);s.view._wt.getSetting("cellRenderer",Ue,$e,oe)}b(J)}_V(H)&&(H=(function(J){return function(te,ce){ce(J.test(te))}})(H)),Jt(H)?(w=s.runHooks("beforeValidate",w,C.visualRow,C.prop,P),s._registerImmediate(()=>{H.call(C,w,J=>{s&&(J=s.runHooks("afterValidate",J,w,C.visualRow,C.prop,P),C.valid=J,W(J),s.runHooks("postAfterValidate",J,w,C.visualRow,C.prop,P))})})):s._registerImmediate(()=>{C.valid=!0,W(C.valid,!1)})};function ze(w,C,b){return Array.isArray(w)?w:[[w,C,b]]}function Le(w,C){const b=s.getActiveEditor(),P=s.runHooks("beforeChange",w,C||"edit"),H=w.filter(W=>W!==null);return P===!1||H.length===0?(b&&b.cancelChanges(),[]):H}this.setDataAtCell=function(w,C,b,P){const H=ze(w,C,b),W=[];let J=P,te,ce,ge;for(te=0,ce=H.length;te<ce;te++){if(typeof H[te]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof H[te][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");H[te][1]>=this.countCols()?ge=H[te][1]:ge=a.colToProp(H[te][1]),W.push([H[te][0],ge,l.getAtCell(this.toPhysicalRow(H[te][0]),H[te][1]),H[te][2]])}!J&&typeof w=="object"&&(J=C);const oe=Le(W,P);s.runHooks("afterSetDataAtCell",oe,J),re(oe,J,()=>{ae(oe,J)})},this.setDataAtRowProp=function(w,C,b,P){const H=ze(w,C,b),W=[];let J=P,te,ce;for(te=0,ce=H.length;te<ce;te++)W.push([H[te][0],H[te][1],l.getAtCell(this.toPhysicalRow(H[te][0]),H[te][1]),H[te][2]]);!J&&typeof w=="object"&&(J=C);const ge=Le(W,P);s.runHooks("afterSetDataAtRowProp",ge,J),re(ge,J,()=>{ae(ge,J)})},this.listen=function(){s&&!s.isListening()&&(Eb.forEach(w=>{s!==w&&w.unlisten()}),Rb=s.guid,s.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(Rb=null,s.runHooks("afterUnlisten"))},this.isListening=function(){return Rb===s.guid},this.destroyEditor=function(){let w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;h.closeEditor(w),s.view.render(),C&&Y.isSelected()&&h.prepareEditor()},this.populateFromArray=function(w,C,b,P,H,W,J){if(!(typeof b=="object"&&typeof b[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const te=typeof P=="number"?s._createCellCoords(P,H):null;return u.populateFromArray(s._createCellCoords(w,C),b,te,W,J)},this.spliceCol=function(w,C,b){for(var P=arguments.length,H=new Array(P>3?P-3:0),W=3;W<P;W++)H[W-3]=arguments[W];return a.spliceCol(w,C,b,...H)},this.spliceRow=function(w,C,b){for(var P=arguments.length,H=new Array(P>3?P-3:0),W=3;W<P;W++)H[W-3]=arguments[W];return a.spliceRow(w,C,b,...H)},this.getSelected=function(){if(Y.isSelected())return wt(Y.getSelectedRange(),w=>{let{from:C,to:b}=w;return[C.row,C.col,b.row,b.col]})},this.getSelectedLast=function(){const w=this.getSelected();let C;return w&&w.length>0&&(C=w[w.length-1]),C},this.getSelectedRange=function(){if(Y.isSelected())return Array.from(Y.getSelectedRange())},this.getSelectedRangeLast=function(){const w=this.getSelectedRange();let C;return w&&w.length>0&&(C=w[w.length-1]),C},this.emptySelectedCells=function(w){if(!Y.isSelected()||this.countRows()===0||this.countCols()===0)return;const C=[];L(Y.getSelectedRange(),b=>{if(b.isSingleHeader())return;const P=b.getTopStartCorner(),H=b.getBottomEndCorner();Pe(P.row,H.row,W=>{Pe(P.col,H.col,J=>{this.getCellMeta(W,J).readOnly||C.push([W,J,null])})})}),C.length>0&&this.setDataAtCell(C,w)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const w=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(w,0),!this.isRenderSuspended()&&w===this.renderSuspendedCounter&&(this.renderCall?this.render():s.view.render())},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||s.view.render())},this.batchRender=function(w){this.suspendRender();const C=w();return this.resumeRender(),C},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const C=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(C,0),(!this.isExecutionSuspended()&&C===this.executionSuspendedCounter||w)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(w){let C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const b=w();return this.resumeExecution(C),b},this.batch=function(w){this.suspendRender(),this.suspendExecution();const C=w();return this.resumeExecution(),this.resumeRender(),C},this.refreshDimensions=function(){if(!s.view)return;const{width:w,height:C}=s.view.getLastSize(),{width:b,height:P}=s.rootElement.getBoundingClientRect(),H=b!==w||P!==C;s.runHooks("beforeRefreshDimensions",{width:w,height:C},{width:b,height:P},H)!==!1&&((H||s.view._wt.wtOverlays.scrollableElement===s.rootWindow)&&(s.view.setLastSize(b,P),s.render()),s.runHooks("afterRefreshDimensions",{width:w,height:C},{width:b,height:P},H))},this.updateData=function(w,C){IL(w,b=>{a=b},b=>{a=b,s.columnIndexMapper.fitToLength(this.getInitialColumnCount()),s.rowIndexMapper.fitToLength(this.countSourceRows()),u.adjustRowsAndCols(),Y.refresh()},{hotInstance:s,dataMap:a,dataSource:l,internalSource:"updateData",source:C,metaManager:v,firstRun:f})},this.loadData=function(w,C){IL(w,b=>{a=b},()=>{v.clearCellsCache(),s.initIndexMappers(),u.adjustRowsAndCols(),Y.refresh(),f&&(f=[null,"loadData"])},{hotInstance:s,dataMap:a,dataSource:l,internalSource:"loadData",source:C,metaManager:v,firstRun:f})},this.getInitialColumnCount=function(){const w=y.columns;let C=0;if(Array.isArray(w))C=w.length;else if(Jt(w))if(s.dataType==="array"){const b=this.countSourceCols();for(let P=0;P<b;P+=1)w(P)&&(C+=1)}else(s.dataType==="object"||s.dataType==="function")&&(C=a.colToPropCache.length);else if(Ne(y.dataSchema)){const b=a.getSchema();C=Array.isArray(b)?b.length:NC(b)}else C=this.countSourceCols();return C},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(w,C,b,P){return nn(w)?a.getAll():a.getRange(s._createCellCoords(w,C),s._createCellCoords(b,P),a.DESTINATION_RENDERER)},this.getCopyableText=function(w,C,b,P){return a.getCopyableText(s._createCellCoords(w,C),s._createCellCoords(b,P))},this.getCopyableData=function(w,C){return a.getCopyable(w,a.colToProp(C))},this.getSchema=function(){return a.getSchema()},this.updateSettings=function(w){let C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const b=(f?s.loadData:s.updateData).bind(this);let P=!1,H,W;if(Ne(w.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(Ne(w.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(Ne(w.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(H in w)H==="data"||(H==="language"?G(w.language):H==="className"?Z("className",w.className):H==="tableClassName"&&s.table?(Z("tableClassName",w.tableClassName),s.view._wt.wtOverlays.syncOverlayTableClassNames()):be.getSingleton().isRegistered(H)||be.getSingleton().isDeprecated(H)?(Jt(w[H])||Array.isArray(w[H]))&&(w[H].initialHook=!0,s.addHook(H,w[H])):!C&&pn(w,H)&&(S[H]=w[H]));w.data===void 0&&y.data===void 0?b(null,"updateSettings"):w.data!==void 0?b(w.data,"updateSettings"):w.columns!==void 0&&(a.createMap(),s.initIndexMappers());const J=s.countCols(),te=y.columns;if(te&&Jt(te)&&(P=!0),(w.cell!==void 0||w.cells!==void 0||w.columns!==void 0)&&v.clearCache(),J>0)for(H=0,W=0;H<J;H++){if(te){const oe=P?te(H):te[W];oe&&v.updateColumnMeta(W,oe)}W+=1}Ne(w.cell)&&at(w.cell,oe=>{s.setCellMetaObject(oe.row,oe.col,oe)}),s.runHooks("afterCellMetaReset");let ce=s.rootElement.style.height;ce!==""&&(ce=parseInt(s.rootElement.style.height,10));let ge=w.height;if(Jt(ge)&&(ge=ge()),C&&s.rootElement.getAttribute("style")&&s.rootElement.setAttribute("data-initialstyle",s.rootElement.getAttribute("style")),ge===null){const oe=s.rootElement.getAttribute("data-initialstyle");oe&&(oe.indexOf("height")>-1||oe.indexOf("overflow")>-1)?s.rootElement.setAttribute("style",oe):(s.rootElement.style.height="",s.rootElement.style.overflow="")}else ge!==void 0&&(s.rootElement.style.height=isNaN(ge)?`${ge}`:`${ge}px`,s.rootElement.style.overflow="hidden");if(typeof w.width<"u"){let oe=w.width;Jt(oe)&&(oe=oe()),s.rootElement.style.width=isNaN(oe)?`${oe}`:`${oe}px`}C||(s.view&&(s.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),s.view._wt.exportSettingsAsClassNames()),s.runHooks("afterUpdateSettings",w)),u.adjustRowsAndCols(),s.view&&!f&&(s.forceFullRender=!0,s.view.render(),s.view._wt.wtOverlays.adjustElementsSize()),!C&&s.view&&(ce===""||ge===""||ge===void 0)&&ce!==ge&&s.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const w=s.getSelectedLast();if(y.getValue){if(Jt(y.getValue))return y.getValue.call(s);if(w)return s.getData()[w[0][0]][y.getValue]}else if(w)return s.getDataAtCell(w[0],w[1])},this.getSettings=function(){return y},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(w,C,b,P,H){u.alter(w,C,b,P,H)},this.getCell=function(w,C){let b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,P=C,H=w;if(C>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(C)))return null;P=this.columnIndexMapper.getRenderableFromVisualIndex(C)}if(w>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(w)))return null;H=this.rowIndexMapper.getRenderableFromVisualIndex(w)}return H===null||P===null||H===void 0||P===void 0?null:s.view.getCellAtCoords(s._createCellCoords(H,P),b)},this.getCoords=function(w){const C=this.view._wt.wtTable.getCoords(w);if(C===null)return null;const{row:b,col:P}=C;let H=b,W=P;return b>=0&&(H=this.rowIndexMapper.getVisualFromRenderableIndex(b)),P>=0&&(W=this.columnIndexMapper.getVisualFromRenderableIndex(P)),s._createCellCoords(H,W)},this.colToProp=function(w){return a.colToProp(w)},this.propToCol=function(w){return a.propToCol(w)},this.toVisualRow=w=>this.rowIndexMapper.getVisualFromPhysicalIndex(w),this.toVisualColumn=w=>this.columnIndexMapper.getVisualFromPhysicalIndex(w),this.toPhysicalRow=w=>this.rowIndexMapper.getPhysicalFromVisualIndex(w),this.toPhysicalColumn=w=>this.columnIndexMapper.getPhysicalFromVisualIndex(w),this.getDataAtCell=function(w,C){return a.get(w,a.colToProp(C))},this.getDataAtRowProp=function(w,C){return a.get(w,C)},this.getDataAtCol=function(w){const C=[],b=a.getRange(s._createCellCoords(0,w),s._createCellCoords(y.data.length-1,w),a.DESTINATION_RENDERER);for(let P=0;P<b.length;P+=1)for(let H=0;H<b[P].length;H+=1)C.push(b[P][H]);return C},this.getDataAtProp=function(w){const C=[],b=a.getRange(s._createCellCoords(0,a.propToCol(w)),s._createCellCoords(y.data.length-1,a.propToCol(w)),a.DESTINATION_RENDERER);for(let P=0;P<b.length;P+=1)for(let H=0;H<b[P].length;H+=1)C.push(b[P][H]);return C},this.getSourceData=function(w,C,b,P){let H;return w===void 0?H=l.getData():H=l.getByRange(s._createCellCoords(w,C),s._createCellCoords(b,P)),H},this.getSourceDataArray=function(w,C,b,P){let H;return w===void 0?H=l.getData(!0):H=l.getByRange(s._createCellCoords(w,C),s._createCellCoords(b,P),!0),H},this.getSourceDataAtCol=function(w){return l.getAtColumn(w)},this.setSourceDataAtCell=function(w,C,b,P){const H=ze(w,C,b),W=this.hasHook("afterSetSourceDataAtCell"),J=[];W&&L(H,ce=>{let[ge,oe,Ue]=ce;J.push([ge,oe,l.getAtCell(ge,oe),Ue])}),L(H,ce=>{let[ge,oe,Ue]=ce;l.setAtCell(ge,oe,Ue)}),W&&this.runHooks("afterSetSourceDataAtCell",J,P),this.render();const te=s.getActiveEditor();te&&Ne(te.refreshValue)&&te.refreshValue()},this.getSourceDataAtRow=function(w){return l.getAtRow(w)},this.getSourceDataAtCell=function(w,C){return l.getAtCell(w,C)},this.getDataAtRow=function(w){return a.getRange(s._createCellCoords(w,0),s._createCellCoords(w,this.countCols()-1),a.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(w,C,b,P){const H=w===void 0?[0,0,this.countRows(),this.countCols()]:[w,C,b,P],[W,J]=H;let[,,te,ce]=H,ge=null,oe=null;te===void 0&&(te=W),ce===void 0&&(ce=J);let Ue="mixed";return Pe(Math.max(Math.min(W,te),0),Math.max(W,te),$e=>{let X=!0;return Pe(Math.max(Math.min(J,ce),0),Math.max(J,ce),Ze=>(oe=this.getCellMeta($e,Ze).type,ge?X=ge===oe:ge=oe,X)),Ue=X?oe:"mixed",X}),Ue},this.removeCellMeta=function(w,C,b){const[P,H]=[this.toPhysicalRow(w),this.toPhysicalColumn(C)];let W=v.getCellMetaKeyValue(P,H,b);s.runHooks("beforeRemoveCellMeta",w,C,b,W)!==!1&&(v.removeCellMeta(P,H,b),s.runHooks("afterRemoveCellMeta",w,C,b,W)),W=null},this.spliceCellsMeta=function(w){let C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var b=arguments.length,P=new Array(b>2?b-2:0),H=2;H<b;H++)P[H-2]=arguments[H];if(P.length>0&&!Array.isArray(P[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");C>0&&v.removeRow(this.toPhysicalRow(w),C),P.length>0&&L(P.reverse(),W=>{v.createRow(this.toPhysicalRow(w)),L(W,(J,te)=>this.setCellMetaObject(w,te,J))}),s.render()},this.setCellMetaObject=function(w,C,b){typeof b=="object"&&at(b,(P,H)=>{this.setCellMeta(w,C,H,P)})},this.setCellMeta=function(w,C,b,P){if(s.runHooks("beforeSetCellMeta",w,C,b,P)===!1)return;let W=w,J=C;w<this.countRows()&&(W=this.toPhysicalRow(w)),C<this.countCols()&&(J=this.toPhysicalColumn(C)),v.setCellMeta(W,J,b,P),s.runHooks("afterSetCellMeta",w,C,b,P)},this.getCellsMeta=function(){return v.getCellsMeta()},this.getCellMeta=function(w,C){let b=this.toPhysicalRow(w),P=this.toPhysicalColumn(C);return b===null&&(b=w),P===null&&(P=C),v.getCellMeta(b,P,{visualRow:w,visualColumn:C})},this.getColumnMeta=function(w){return v.getColumnMeta(this.toPhysicalColumn(w))},this.getCellMetaAtRow=function(w){return v.getCellsMetaAtRow(w)},this.isColumnModificationAllowed=function(){return!(s.dataType==="object"||y.columns)},this.getCellRenderer=function(w,C){const b=typeof w=="number"?s.getCellMeta(w,C).renderer:w.renderer;return typeof b=="string"?Bv(b):nn(b)?Bv("text"):b},this.getCellEditor=function(w,C){const b=typeof w=="number"?s.getCellMeta(w,C).editor:w.editor;return typeof b=="string"?Uv(b):nn(b)?Uv("text"):b},this.getCellValidator=function(w,C){const b=typeof w=="number"?s.getCellMeta(w,C).validator:w.validator;return typeof b=="string"?s0(b):b},this.validateCells=function(w){this._validateCells(w)},this.validateRows=function(w,C){if(!Array.isArray(w))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(C,w)},this.validateColumns=function(w,C){if(!Array.isArray(w))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(C,void 0,w)},this._validateCells=function(w,C,b){const P=new ee;w&&(P.onQueueEmpty=w);let H=s.countRows()-1;for(;H>=0;){if(C!==void 0&&C.indexOf(H)===-1){H-=1;continue}let W=s.countCols()-1;for(;W>=0;){if(b!==void 0&&b.indexOf(W)===-1){W-=1;continue}P.addValidatorToQueue(),s.validateCell(s.getDataAtCell(H,W),s.getCellMeta(H,W),J=>{if(typeof J!="boolean")throw new Error("Validation error: result is not boolean");J===!1&&(P.valid=!1),P.removeValidatorFormQueue()},"validateCells"),W-=1}H-=1}P.checkIfQueueIsEmpty()},this.getRowHeader=function(w){let C=y.rowHeaders,b=w;return b!==void 0&&(b=s.runHooks("modifyRowHeader",b)),b===void 0?(C=[],Pe(s.countRows()-1,P=>{C.push(s.getRowHeader(P))})):Array.isArray(C)&&C[b]!==void 0?C=C[b]:Jt(C)?C=C(b):C&&typeof C!="string"&&typeof C!="number"&&(C=b+1),C},this.hasRowHeaders=function(){return!!y.rowHeaders},this.hasColHeaders=function(){if(y.colHeaders!==void 0&&y.colHeaders!==null)return!!y.colHeaders;for(let w=0,C=s.countCols();w<C;w++)if(s.getColHeader(w))return!0;return!1},this.getColHeader=function(w){let C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const b=s.runHooks("modifyColHeader",w);if(b===void 0){const te=[],ce=s.countCols();for(let ge=0;ge<ce;ge++)te.push(s.getColHeader(ge));return te}let P=y.colHeaders;const H=function(te){const ce=[],ge=s.countCols();let oe=0;for(;oe<ge;oe++)Jt(y.columns)&&y.columns(oe)&&ce.push(oe);return ce[te]},W=s.toPhysicalColumn(b),J=H(W);return y.colHeaders===!1?P=null:y.columns&&Jt(y.columns)&&y.columns(J)&&y.columns(J).title?P=y.columns(J).title:y.columns&&y.columns[W]&&y.columns[W].title?P=y.columns[W].title:Array.isArray(y.colHeaders)&&y.colHeaders[W]!==void 0?P=y.colHeaders[W]:Jt(y.colHeaders)?P=y.colHeaders(W):y.colHeaders&&typeof y.colHeaders!="string"&&typeof y.colHeaders!="number"&&(P=LC(b)),P=s.runHooks("modifyColumnHeaderValue",P,w,C),P},this._getColWidthFromSettings=function(w){let C;if(w>=0&&(C=s.getCellMeta(0,w).width),(C===void 0||C===y.width)&&(C=y.colWidths),C!=null){switch(typeof C){case"object":C=C[w];break;case"function":C=C(w);break}typeof C=="string"&&(C=parseInt(C,10))}return C},this.getColWidth=function(w){let C=s._getColWidthFromSettings(w);return C=s.runHooks("modifyColWidth",C,w),C===void 0&&(C=_C),C},this._getRowHeightFromSettings=function(w){let C=y.rowHeights;if(C!=null){switch(typeof C){case"object":C=C[w];break;case"function":C=C(w);break}typeof C=="string"&&(C=parseInt(C,10))}return C},this.getRowHeight=function(w){let C=s._getRowHeightFromSettings(w);return C=s.runHooks("modifyRowHeight",C,w),C},this.countSourceRows=function(){return l.countRows()},this.countSourceCols=function(){return l.countFirstRowKeys()},this.countRows=function(){return a.getLength()},this.countCols=function(){const w=y.maxCols,C=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(w,C)},this.countRenderedRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,C=0;return DA(s.countRows()-1,b=>{if(s.isEmptyRow(b))C+=1;else if(w===!0)return!1}),C},this.countEmptyCols=function(){let w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,C=0;return DA(s.countCols()-1,b=>{if(s.isEmptyCol(b))C+=1;else if(w===!0)return!1}),C},this.isEmptyRow=function(w){return y.isEmptyRow.call(s,w)},this.isEmptyCol=function(w){return y.isEmptyCol.call(s,w)},this.selectCell=function(w,C,b,P){let H=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,W=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return nn(w)||nn(C)?!1:this.selectCells([[w,C,b,P]],H,W)},this.selectCells=function(){let w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;C===!1&&d.suspend();const P=Y.selectCells(w);return P&&b&&s.listen(),d.resume(),P},this.selectColumns=function(w){let C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:w,b=arguments.length>2?arguments[2]:void 0;return Y.selectColumns(w,C,b)},this.selectRows=function(w){let C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:w,b=arguments.length>2?arguments[2]:void 0;return Y.selectRows(w,C,b)},this.deselectCell=function(){Y.deselect()},this.selectAll=function(){let w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:w,b=arguments.length>2?arguments[2]:void 0;d.skipNextScrollCycle(),Y.selectAll(w,C,b)};const Se=(w,C)=>w.getNearestNotHiddenIndex(C,1,!0);this.scrollViewportTo=function(w){var C;if(typeof w=="number"){var b;w={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(b=arguments[4])!==null&&b!==void 0?b:!0}}const{row:P,col:H,verticalSnap:W,horizontalSnap:J,considerHiddenIndexes:te}=(C=w)!==null&&C!==void 0?C:{};let ce,ge,oe,Ue;W!==void 0&&(ce=W==="top",ge=!ce),J!==void 0&&(oe=J==="start",Ue=!oe);let $e=P,X=H;if(te===void 0||te){const vt=Number.isInteger(P)&&P>=0,qe=Number.isInteger(H)&&H>=0,He=vt?Se(this.rowIndexMapper,P):void 0,T=qe?Se(this.columnIndexMapper,H):void 0;if(He===null||T===null)return!1;$e=vt?s.rowIndexMapper.getRenderableFromVisualIndex(He):P,X=qe?s.columnIndexMapper.getRenderableFromVisualIndex(T):H}const Ze=Number.isInteger($e),it=Number.isInteger(X);return Ze&&$e>=0&&it&&X>=0?s.view.scrollViewport(s._createCellCoords($e,X),ce,Ue,ge,oe):Ze&&$e>=0&&(it&&X<0||!it)?s.view.scrollViewportVertically($e,ce,ge):it&&X>=0&&(Ze&&$e<0||!Ze)?s.view.scrollViewportHorizontally(X,Ue,oe):!1},this.scrollToFocusedCell=function(){let w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:()=>{};if(!this.selection.isSelected())return;this.addHookOnce("afterScroll",w);const{highlight:C}=this.getSelectedRangeLast();this.scrollViewportTo(C.toObject())?this.view.render():(this.removeHook("afterScroll",w),this._registerImmediate(()=>w()))},this.destroy=function(){if(s._clearTimeouts(),s._clearImmediates(),s.view&&s.view.destroy(),l&&l.destroy(),l=null,this.getShortcutManager().destroy(),v.clearCache(),Eb.delete(this.guid),nv(s)){const w=this.rootDocument.querySelector(".hot-display-license-info");w&&w.parentNode.removeChild(w)}so(s.rootElement),o.destroy(),h&&h.destroy(),s.batchExecution(()=>{s.rowIndexMapper.unregisterAll(),s.columnIndexMapper.unregisterAll(),R.getItems().forEach(w=>{let[,C]=w;C.destroy()}),R.clear(),s.runHooks("afterDestroy")},!0),be.getSingleton().destroy(s),at(s,(w,C,b)=>{Jt(w)?b[C]=ye(C):C!=="guid"&&(b[C]=null)}),s.isDestroyed=!0,a&&a.destroy(),a=null,u=null,Y=null,h=null,s=null};function ye(w){return()=>{throw new Error(`The "${w}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return h.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return s.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return s.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return s.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return s.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return s.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return s.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return s.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return s.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return s.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return s.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return s.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return s.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(w){const C=$r(w);return C==="UndoRedo"?this.undoRedo:R.getItem(C)},this.getPluginName=function(w){return w===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:R.getId(w)},this.getInstance=function(){return s},this.addHook=function(w,C,b){be.getSingleton().add(w,C,s,b)},this.hasHook=function(w){return be.getSingleton().has(w,s)||be.getSingleton().has(w)},this.addHookOnce=function(w,C,b){be.getSingleton().once(w,C,s,b)},this.removeHook=function(w,C){be.getSingleton().remove(w,C,s)},this.runHooks=function(w,C,b,P,H,W,J){return be.getSingleton().run(s,w,C,b,P,H,W,J)},this.getTranslatedPhrase=function(w,C){return sB(y.language,w,C)},this.toHTML=()=>LA(this),this.toTableElement=()=>{const w=this.rootDocument.createElement("div");return w.insertAdjacentHTML("afterbegin",LA(this)),w.firstElementChild},this.timeouts=[],this._registerTimeout=function(w){let C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,b=w;typeof b=="function"&&(b=setTimeout(b,C)),this.timeouts.push(b)},this._clearTimeouts=function(){L(this.timeouts,w=>{clearTimeout(w)})},this.immediates=[],this._registerImmediate=function(w){this.immediates.push(setImmediate(w))},this._clearImmediates=function(){L(this.immediates,w=>{clearImmediate(w)})},this._getEditorManager=function(){return h},this.isRtl=function(){return s.rootWindow.getComputedStyle(s.rootElement).direction==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1};const We=mZ({handleEvent(){return s.isListening()},beforeKeyDown:w=>this.runHooks("beforeKeyDown",w),afterKeyDown:w=>{this.isDestroyed||s.runHooks("afterDocumentKeyDown",w)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",w=>{w.ctrlKey===!1&&w.metaKey===!1&&We.releasePressedKeys()}),this.getShortcutManager=function(){return We},this.getFocusManager=function(){return c},i0().forEach(w=>{const C=Og(w);R.addItem(w,new C(this))}),QQ(s),We.setActiveContextName("grid"),be.getSingleton().run(s,"construct")}function HL(n,e,t){n.addEventListener(e,t,!1)}function DL(n,e,t){n.removeEventListener(e,t,!1)}function FL(n){return n.ownerDocument.defaultView.getComputedStyle(n)}function gZ(n){const e={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},t=n.body,r=n.createTextNode(""),i=n.createElement("span");let s;function o(){r.textContent=s.value,i.style.position="absolute",i.style.fontSize=FL(s).fontSize,i.style.fontFamily=FL(s).fontFamily,i.style.whiteSpace="pre",t.appendChild(i);const h=i.clientWidth+2;t.removeChild(i);const c=s.style;c.height=`${e.minHeight}px`,e.minWidth>h?c.width=`${e.minWidth}px`:h>e.maxWidth?c.width=`${e.maxWidth}px`:c.width=`${h}px`;const d=s.scrollHeight?s.scrollHeight-1:0;e.minHeight>d?c.height=`${e.minHeight}px`:e.maxHeight<d?(c.height=`${e.maxHeight}px`,c.overflowY="visible"):c.height=`${d}px`}function a(){n.defaultView.setTimeout(o,0)}function l(h){if(h&&h.minHeight)if(h.minHeight==="inherit")e.minHeight=s.clientHeight;else{const c=parseInt(h.minHeight,10);isNaN(c)||(e.minHeight=c)}if(h&&h.maxHeight)if(h.maxHeight==="inherit")e.maxHeight=s.clientHeight;else{const c=parseInt(h.maxHeight,10);isNaN(c)||(e.maxHeight=c)}if(h&&h.minWidth)if(h.minWidth==="inherit")e.minWidth=s.clientWidth;else{const c=parseInt(h.minWidth,10);isNaN(c)||(e.minWidth=c)}if(h&&h.maxWidth)if(h.maxWidth==="inherit")e.maxWidth=s.clientWidth;else{const c=parseInt(h.maxWidth,10);isNaN(c)||(e.maxWidth=c)}i.firstChild||(i.className="autoResize",i.style.display="inline-block",i.appendChild(r))}function u(h,c){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;s=h,l(c),s.nodeName==="TEXTAREA"&&(s.style.resize="none",s.style.height=`${e.minHeight}px`,s.style.minWidth=`${e.minWidth}px`,s.style.maxWidth=`${e.maxWidth}px`,s.style.overflowY="hidden"),d&&(HL(s,"input",o),HL(s,"keydown",a)),o()}return{init:u,resize:o,unObserve(){DL(s,"input",o),DL(s,"keydown",a)}}}function kL(n,e){const t=WM(e),r=e.value.split(`
`);let i=t,s=0;for(let o=0;o<r.length;o++){const a=r[o];o!==0&&(s+=r[o-1].length+1);const l=s+a.length;if(n==="home"?i=s:n==="end"&&(i=l),t<=l)break}Ng(e,i)}function Nu(n,e,t){return(e=pZ(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function pZ(n){var e=wZ(n,"string");return typeof e=="symbol"?e:e+""}function wZ(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const vZ="ht_editor_visible",Lp="ht_editor_hidden",VL="textEditor",yZ="text";class Yh extends Hd{static get EDITOR_TYPE(){return yZ}constructor(e){super(e),Nu(this,"eventManager",new ys(this)),Nu(this,"autoResize",gZ(this.hot.rootDocument)),Nu(this,"TEXTAREA",void 0),Nu(this,"textareaStyle",void 0),Nu(this,"TEXTAREA_PARENT",void 0),Nu(this,"textareaParentStyle",void 0),Nu(this,"layerClass",void 0),this.eventManager=new ys(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),UV(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,t,r,i,s,o){const a=this.state;if(super.prepare(e,t,r,i,s,o),!o.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=o;l&&!this.isOpened()&&(this.TEXTAREA.value=""),a!==xn.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,t){this.state===xn.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,t))}focus(){this.TEXTAREA.select(),Ng(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),Ge(this.TEXTAREA,[["data-hot-input",""],_d(-1)]),ie(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),ie(this.TEXTAREA_PARENT,"handsontableInputHolder"),je(this.TEXTAREA_PARENT,this.layerClass)&&Xe(this.TEXTAREA_PARENT,this.layerClass),ie(this.TEXTAREA_PARENT,Lp),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){lU()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",Xe(this.TEXTAREA_PARENT,this.layerClass),ie(this.TEXTAREA_PARENT,Lp)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let t=!1;Pe(e.length-1,r=>{const i=e[r];if(je(i,"handsontableEditor"))return t=!0,!1}),je(this.TEXTAREA_PARENT,Lp)&&Xe(this.TEXTAREA_PARENT,Lp),t?(this.layerClass=vZ,ie(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),ie(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),t=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=t,this.setValue(t),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==xn.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:t,start:r,width:i,maxWidth:s,height:o,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${t}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${r}px`,this.showEditableElement();const l=ra(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;const u=ra(this.TEXTAREA),h=parseInt(u.paddingLeft,10)+parseInt(u.paddingRight,10),c=parseInt(u.paddingTop,10)+parseInt(u.paddingBottom,10),d=i-h,f=o-c,g=s-h,p=a-c;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(d,g),minHeight:Math.min(f,p),maxWidth:g,maxHeight:p},!0)}bindEvents(){XM()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===xn.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===xn.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("editor"),r={runOnlyIf:()=>Ne(this.hot.getSelected()),group:VL},i=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};t.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(i(),!1),runOnlyIf:s=>!this.hot.selection.isMultiple()&&!s.altKey},{keys:[["Meta","Enter"]],callback:()=>(i(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(i(),!1)},{keys:[["Home"]],callback:(s,o)=>{let[a]=o;kL(a,this.TEXTAREA)}},{keys:[["End"]],callback:(s,o)=>{let[a]=o;kL(a,this.TEXTAREA)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(VL)}}const CZ="base";function Hg(n,e,t,r,i,s,o){const a=o.ariaTags,l=[],u=[],h=[],c=[];o.className&&ie(e,o.className),o.readOnly?(l.push(o.readOnlyCellClassName),a&&c.push(w1())):a&&h.push(w1()[0]),o.valid===!1&&o.invalidCellClassName?(l.push(o.invalidCellClassName),a&&c.push(v1())):(u.push(o.invalidCellClassName),a&&h.push(v1()[0])),o.wordWrap===!1&&o.noWordWrapClassName&&l.push(o.noWordWrapClassName),!s&&o.placeholder&&l.push(o.placeholderCellClassName),Xe(e,u),ie(e,l),Gh(e,h),Ge(e,c)}Hg.RENDERER_TYPE=CZ;const SZ="text";function al(n,e,t,r,i,s,o){Hg.apply(this,[n,e,t,r,i,s,o]);let a=s;if(!a&&o.placeholder&&(a=o.placeholder),a=Tn(a),o.trimWhitespace&&(a=a.trim()),o.rendererTemplate){so(e);const l=n.rootDocument.createElement("TEMPLATE");l.setAttribute("bind","{{}}"),l.innerHTML=o.rendererTemplate,HTMLTemplateElement.decorate(l),l.model=n.getSourceDataAtRow(t),e.appendChild(l)}else ru(e,a)}al.RENDERER_TYPE=SZ;const RZ="text",CB={CELL_TYPE:RZ,editor:Yh,renderer:al};ts(CB);Qe.editors={BaseEditor:Hd};function Qe(n,e){const t=new yB(n,e||{},R0);return t.init(),t}Qe.Core=function(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new yB(n,e,R0)};Qe.DefaultSettings=dB();Qe.hooks=be.getSingleton();Qe.CellCoords=Ah;Qe.CellRange=_g;Qe.packageName="handsontable";Qe.buildDate="07/02/2025 16:13:23";Qe.version="14.6.2";Qe.languages={dictionaryKeys:k8,getLanguageDictionary:iB,getLanguagesDictionaries:$8,registerLanguageDictionary:rB,getTranslatedPhrase:sB};const UL="handsontableEditor",EZ="handsontable";class KI extends Yh{static get EDITOR_TYPE(){return EZ}open(){super.open(),this.htEditor&&this.htEditor.destroy(),this.htContainer.style.display==="none"&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),Ng(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,t,r,i,s,o){super.prepare(e,t,r,i,s,o);const a=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,afterOnCellMouseDown(u,h){const c=this.getSourceData(h.row,h.col);c!==void 0&&a.setValue(c),a.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&Gn(l,o.handsontable),this.htOptions=l}beginEditing(e,t){const r=this.hot.getSettings().onBeginEditing;r&&r()===!1||super.beginEditing(e,t)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,t,r){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const i=this.htEditor.getValue();i!==void 0&&this.setValue(i)}super.finishEditing(e,t,r)}assignHooks(){this.hot.addHook("afterDestroy",()=>{this.htEditor&&this.htEditor.destroy()})}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const r={group:UL,relativeToGroup:hu,position:"before"},i=(s,o)=>{const a=this.htEditor;if(s!==void 0&&(s<0||a.flipped&&s>a.countRows()-1?a.deselectCell():a.selectCell(s,0),a.getData().length))return o.preventDefault(),Ns(o),this.hot.listen(),this.TEXTAREA.focus(),!1};t.addShortcuts([{keys:[["ArrowUp"]],callback:s=>{const o=this.htEditor;let a,l;return!o.getSelectedLast()&&o.flipped?a=o.countRows()-1:o.getSelectedLast()&&(o.flipped?(l=o.getSelectedLast()[0],a=Math.max(0,l-1)):(l=o.getSelectedLast()[0],a=l-1)),i(a,s)},preventDefault:!1},{keys:[["ArrowDown"]],callback:s=>{const o=this.htEditor;let a,l;if(!o.getSelectedLast()&&!o.flipped)a=0;else if(o.getSelectedLast()){if(o.flipped)a=o.getSelectedLast()[0]+1;else if(!o.flipped){const u=o.countRows()-1;l=o.getSelectedLast()[0],a=Math.min(u,l+1)}}return i(a,s)},preventDefault:!1}],r)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(UL)}}function bZ(n,e,t){TZ(n,e),e.set(n,t)}function TZ(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hp(n,e,t){return(e=AZ(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function AZ(n){var e=NZ(n,"string");return typeof e=="symbol"?e:e+""}function NZ(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function BL(n,e){return n.get(MZ(n,e))}function MZ(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const IZ="autocomplete";var bb=new WeakMap;class qI extends KI{constructor(){super(...arguments),Hp(this,"query",null),Hp(this,"strippedChoices",[]),Hp(this,"rawChoices",[]),bZ(this,bb,this.hot.guid.slice(0,9)),Hp(this,"sortByRelevance",function(e,t,r){const i=[],s=[],o=e.length;let a=t.length,l,u,h,c;if(o===0){for(h=0;h<a;h++)s.push(h);return s}for(h=0;h<a;h++){if(u=MA(Tn(t[h])),r)c=u.indexOf(e);else{const d=this.cellProperties.locale;c=u.toLocaleLowerCase(d).indexOf(e.toLocaleLowerCase(d))}c!==-1&&(l=u.length-c-o,i.push({baseIndex:h,index:c,charsLeft:l,value:u}))}for(i.sort((d,f)=>{if(f.index===-1)return-1;if(d.index===-1)return 1;if(d.index<f.index)return-1;if(f.index<d.index)return 1;if(d.index===f.index){if(d.charsLeft<f.charsLeft)return-1;if(d.charsLeft>f.charsLeft)return 1}return 0}),h=0,a=i.length;h<a;h++)s.push(i[h].baseIndex);return s})}static get EDITOR_TYPE(){return IZ}getValue(){const e=this.rawChoices.find(t=>this.stripValueIfNeeded(t)===this.TEXTAREA.value);return Ne(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),ie(this.htContainer,"autocompleteEditor"),ie(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&Ge(this.TEXTAREA,[_4(),A4(),HV("listbox"),H4()])}prepare(e,t,r,i,s,o){super.prepare(e,t,r,i,s,o),this.hot.getSettings().ariaTags&&Ge(this.TEXTAREA,[gs("false"),D4(`${BL(bb,this)}-listbox-${e}-${t}`)])}open(){super.open();const e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,t=this.hot.getSettings().ariaTags,r=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,i=r?.length,{row:s,col:o}=this;this.showEditableElement(),this.focus();let a=or();a===0&&jm()&&(a+=15),this.addHook("beforeKeyDown",l=>this.onBeforeKeyDown(l)),this.htEditor.updateSettings({colWidths:e?[rn(this.TEXTAREA)-2]:void 0,width:e?rn(this.TEXTAREA)+a:void 0,autoColumnSize:!0,renderer:(l,u,h,c,d,f,g)=>{al(l,u,h,c,d,f,g);const{filteringCaseSensitive:p,allowHtml:v,locale:y}=this.cellProperties,S=this.query;let R=Tn(f),A,O;R&&!v&&(A=p===!0?R.indexOf(S):R.toLocaleLowerCase(y).indexOf(S.toLocaleLowerCase(y)),A!==-1&&(O=R.substr(A,S.length),R=R.replace(O,`<strong>${O}</strong>`))),t&&Ge(u,[N4(),...r?[U4(i)]:[],...r?[B4(r.indexOf(f)+1)]:[],["id",`${this.htEditor.rootElement.id}_${h}-${c}`]]),u.innerHTML=R},afterSelectionEnd:(l,u)=>{if(t){const h=this.htEditor.getCell(l,u,!0);Ge(h,[FM()]),Ge(this.TEXTAREA,...F4(h.id))}}}),t&&(Ge(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...Xo()),Ge(this.htEditor.rootElement,[LV(),k4("polite"),V4("text"),["id",`${BL(bb,this)}-listbox-${s}-${o}`]]),Ge(this.TEXTAREA,...gs("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&Ge(this.TEXTAREA,[gs("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const t=this.cellProperties.source;this.query=e,typeof t=="function"?t.call(this.cellProperties,e,r=>{this.rawChoices=r,this.updateChoicesList(this.stripValuesIfNeeded(r))}):Array.isArray(t)?(this.rawChoices=t,this.updateChoicesList(this.stripValuesIfNeeded(t))):this.updateChoicesList([])}updateChoicesList(e){const t=WM(this.TEXTAREA),r=KV(this.TEXTAREA),i=this.cellProperties.sortByRelevance,s=this.cellProperties.filter;let o=null,a=null,l=e;i&&(o=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));const u=Array.isArray(o)?o.length:0;if(s===!1)u&&(a=o[0]);else{const h=[];for(let c=0,d=l.length;c<d&&!(i&&u<=c);c++)u?h.push(l[o[c]]):h.push(l[c]);a=0,l=h}this.strippedChoices=l,l.length===0?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData(sm([l])),l.length>0&&(this.updateDropdownDimensions(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(a)),this.hot.listen(),Ng(this.TEXTAREA,t,t===r?void 0:r)}flipDropdownIfNeeded(){const e=Th(this.hot.view._wt.wtTable.TABLE),t=e===this.hot.rootWindow,r=this.cellProperties.preventOverflow;if(t||!t&&(r||r==="horizontal"))return!1;const i=ir(this.TEXTAREA),s=Dn(this.TEXTAREA),o=this.getDropdownHeight(),a=e.scrollTop,l=Dn(this.hot.view._wt.wtTable.THEAD),u=ir(e),h=i.top-u.top-l+a,c=e.scrollHeight-h-l-s,d=o>c&&h>c;return d?this.flipDropdown(o):this.unflipDropdown(),this.limitDropdownIfNeeded(d?h:c,o),d}limitDropdownIfNeeded(e,t){if(t>e){let r=0,i=0,s=0,o=null;do s=this.htEditor.getRowHeight(i)||this.htEditor.view._wt.getSetting("defaultRowHeight"),r+=s,i+=1;while(r<e);o=r-s,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+t-o}px`),this.setDropdownHeight(r-s)}}flipDropdown(e){const t=this.htEditor.rootElement.style;t.position="absolute",t.top=`${-e}px`,this.htEditor.flipped=!0}unflipDropdown(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}updateDropdownDimensions(){const e=this.htEditor.getColWidth(0)+or(this.hot.rootDocument)+2,t=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:t?void 0:e}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e})}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getDropdownHeight(){const e=this.htEditor.getRowHeight(0)||23,t=this.cellProperties.visibleRows;return this.strippedChoices.length>=t?t*e:this.strippedChoices.length*e+8}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:t}=this.cellProperties,r=wt(e,s=>Tn(s));return wt(r,s=>t?s:MA(s))}allowKeyEventPropagation(e){const t=this.htEditor.getSelectedRangeLast(),r={row:t?t.from.row:-1};let i=!1;return e===Oe.ARROW_DOWN&&r.row>0&&r.row<this.htEditor.countRows()-1&&(i=!0),e===Oe.ARROW_UP&&r.row>-1&&(i=!0),i}onBeforeKeyDown(e){if(uU(e.keyCode)||e.keyCode===Oe.BACKSPACE||e.keyCode===Oe.DELETE||e.keyCode===Oe.INSERT){let t=10;if(e.keyCode===Oe.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(t+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},t)}}}const OZ="checkbox";class SB extends Hd{static get EDITOR_TYPE(){return OZ}beginEditing(e,t){if(t&&t.type==="mouseup"&&t.target.nodeName==="TD"){const r=this.TD.querySelector('input[type="checkbox"]');je(r,"htBadValue")||r.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}/*!
 * Pikaday
 *
 * Copyright Â© 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */const Wl=()=>window,as=()=>window.document,zA=(n,e)=>window.setTimeout(n,e),Ho=function(n,e,t,r){n.addEventListener(e,t,!!r)},Ca=function(n,e,t,r){n.removeEventListener(e,t,!!r)},_Z=function(n){return n.trim?n.trim():n.replace(/^\s+|\s+$/g,"")},_i=function(n,e){return(" "+n.className+" ").indexOf(" "+e+" ")!==-1},Tb=function(n,e){_i(n,e)||(n.className=n.className===""?e:n.className+" "+e)},Ab=function(n,e){n.className=_Z((" "+n.className+" ").replace(" "+e+" "," "))},XI=function(n){return/Array/.test(Object.prototype.toString.call(n))},Hi=function(n){return/Date/.test(Object.prototype.toString.call(n))&&!isNaN(n.getTime())},PZ=function(n){let e=n.getDay();return e===0||e===6},xZ=function(n){return n%4===0&&n%100!==0||n%400===0},WL=function(n,e){return[31,xZ(n)?29:28,31,30,31,30,31,31,30,31,30,31][e]},Dp=function(n){Hi(n)&&n.setHours(0,0,0,0)},Fp=function(n,e){return n.getTime()===e.getTime()},ey=function(n,e,t){let r,i;for(r in e)i=n[r]!==void 0,i&&typeof e[r]=="object"&&e[r]!==null&&e[r].nodeName===void 0?Hi(e[r])?t&&(n[r]=new Date(e[r].getTime())):XI(e[r])?t&&(n[r]=e[r].slice(0)):n[r]=ey({},e[r],t):(t||!i)&&(n[r]=e[r]);return n},$L=function(n,e,t){let r=as().createEvent("HTMLEvents");r.initEvent(e,!0,!1),r=ey(r,t),n.dispatchEvent(r)},GL=function(n){return n.month<0&&(n.year-=Math.ceil(Math.abs(n.month)/12),n.month+=12),n.month>11&&(n.year+=Math.floor(Math.abs(n.month)/12),n.month-=12),n},So={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},jL=function(n,e,t){for(e+=n.firstDay;e>=7;)e-=7;return t?n.i18n.weekdaysShort[e]:n.i18n.weekdays[e]},LZ=function(n){let e=[],t="false";if(n.isEmpty)if(n.showDaysInNextAndPreviousMonths)e.push("is-outside-current-month"),n.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled");else return'<td class="is-empty"></td>';return n.isDisabled&&e.push("is-disabled"),n.isToday&&e.push("is-today"),n.isSelected&&(e.push("is-selected"),t="true"),n.hasEvent&&e.push("has-event"),n.isInRange&&e.push("is-inrange"),n.isStartRange&&e.push("is-startrange"),n.isEndRange&&e.push("is-endrange"),'<td data-day="'+n.day+'" class="'+e.join(" ")+'" aria-selected="'+t+'"><button class="pika-button pika-day" type="button" data-pika-year="'+n.year+'" data-pika-month="'+n.month+'" data-pika-day="'+n.day+'">'+n.day+"</button></td>"},HZ=function(n,e){n.setHours(0,0,0,0);let t=n.getDate(),r=n.getDay(),i=e,s=i-1,o=7,a=function(d){return(d+o-1)%o};n.setDate(t+s-a(r));let l=new Date(n.getFullYear(),0,i),u=1440*60*1e3,h=(n.getTime()-l.getTime())/u;return 1+Math.round((h-s+a(l.getDay()))/o)},DZ=function(n,e,t,r,i){let s=new Date(r,t,e);return'<td class="pika-week">'+(n.hasMoment?n.moment(s).isoWeek():HZ(s,i))+"</td>"},FZ=function(n,e,t,r){return'<tr class="pika-row'+(t?" pick-whole-week":"")+(r?" is-selected":"")+'">'+(e?n.reverse():n).join("")+"</tr>"},kZ=function(n){return"<tbody>"+n.join("")+"</tbody>"},VZ=function(n){let e,t=[];for(n.showWeekNumber&&t.push("<th></th>"),e=0;e<7;e++)t.push('<th scope="col"><abbr title="'+jL(n,e)+'">'+jL(n,e,!0)+"</abbr></th>");return"<thead><tr>"+(n.isRTL?t.reverse():t).join("")+"</tr></thead>"},UZ=function(n,e,t,r,i,s){let o,a,l,u=n._o,h=t===u.minYear,c=t===u.maxYear,d='<div id="'+s+'" class="pika-title" role="heading" aria-live="polite">',f,g,p=!0,v=!0;for(l=[],o=0;o<12;o++)l.push('<option value="'+(t===i?o-e:12+o-e)+'"'+(o===r?' selected="selected"':"")+(h&&o<u.minMonth||c&&o>u.maxMonth?' disabled="disabled"':"")+">"+u.i18n.months[o]+"</option>");for(f='<div class="pika-label">'+u.i18n.months[r]+'<select class="pika-select pika-select-month" tabindex="-1">'+l.join("")+"</select></div>",XI(u.yearRange)?(o=u.yearRange[0],a=u.yearRange[1]+1):(o=t-u.yearRange,a=1+t+u.yearRange),l=[];o<a&&o<=u.maxYear;o++)o>=u.minYear&&l.push('<option value="'+o+'"'+(o===t?' selected="selected"':"")+">"+o+"</option>");return g='<div class="pika-label">'+t+u.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+l.join("")+"</select></div>",u.showMonthAfterYear?d+=g+f:d+=f+g,h&&(r===0||u.minMonth>=r)&&(p=!1),c&&(r===11||u.maxMonth<=r)&&(v=!1),e===0&&(d+='<button class="pika-prev'+(p?"":" is-disabled")+'" type="button">'+u.i18n.previousMonth+"</button>"),e===n._o.numberOfMonths-1&&(d+='<button class="pika-next'+(v?"":" is-disabled")+'" type="button">'+u.i18n.nextMonth+"</button>"),d+="</div>"},BZ=function(n,e,t){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+t+'">'+VZ(n)+kZ(e)+"</table>"};function YA(n){let e=this,t=e.config(n);e._onMouseDown=function(i){if(!e._v)return;i=i||Wl().event;let s=i.target||i.srcElement;if(s)if(_i(s,"is-disabled")||(_i(s,"pika-button")&&!_i(s,"is-empty")&&!_i(s.parentNode,"is-disabled")?(e.setDate(new Date(s.getAttribute("data-pika-year"),s.getAttribute("data-pika-month"),s.getAttribute("data-pika-day"))),t.bound&&zA(function(){e.hide(),t.blurFieldOnSelect&&t.field&&t.field.blur()},100)):_i(s,"pika-prev")?e.prevMonth():_i(s,"pika-next")&&e.nextMonth()),_i(s,"pika-select"))e._c=!0;else if(i.preventDefault)i.preventDefault();else return i.returnValue=!1,!1},e._onChange=function(i){i=i||Wl().event;let s=i.target||i.srcElement;s&&(_i(s,"pika-select-month")?e.gotoMonth(s.value):_i(s,"pika-select-year")&&e.gotoYear(s.value))},e._onKeyChange=function(i){if(i=i||Wl().event,e.isVisible())switch(i.keyCode){case 13:case 27:t.field&&t.field.blur();break;case 37:e.adjustDate("subtract",1);break;case 38:e.adjustDate("subtract",7);break;case 39:e.adjustDate("add",1);break;case 40:e.adjustDate("add",7);break;case 8:case 46:e.setDate(null);break}},e._parseFieldValue=function(){if(t.parse)return t.parse(t.field.value,t.format);if(this.hasMoment){let i=this.moment(t.field.value,t.format,t.formatStrict);return i&&i.isValid()?i.toDate():null}else return new Date(Date.parse(t.field.value))},e._onInputChange=function(i){let s;i.firedBy!==e&&(s=e._parseFieldValue(),Hi(s)&&e.setDate(s),e._v||e.show())},e._onInputFocus=function(){e.show()},e._onInputClick=function(){e.show()},e._onInputBlur=function(){let i=as().activeElement;do if(_i(i,"pika-single"))return;while(i=i.parentNode);e._c||(e._b=zA(function(){e.hide()},50)),e._c=!1},e._onClick=function(i){i=i||Wl().event;let s=i.target||i.srcElement,o=s;if(s){!hasEventListeners&&_i(s,"pika-select")&&(s.onchange||(s.setAttribute("onchange","return;"),Ho(s,"change",e._onChange)));do if(_i(o,"pika-single")||o===t.trigger)return;while(o=o.parentNode);e._v&&s!==t.trigger&&o!==t.trigger&&e.hide()}},e.el=as().createElement("div"),e.el.className="pika-single"+(t.isRTL?" is-rtl":"")+(t.theme?" "+t.theme:""),Ho(e.el,"mousedown",e._onMouseDown,!0),Ho(e.el,"touchend",e._onMouseDown,!0),Ho(e.el,"change",e._onChange),t.keyboardInput&&Ho(as(),"keydown",e._onKeyChange),t.field&&(t.container?t.container.appendChild(e.el):t.bound?as().body.appendChild(e.el):t.field.parentNode.insertBefore(e.el,t.field.nextSibling),Ho(t.field,"change",e._onInputChange),t.defaultDate||(t.defaultDate=e._parseFieldValue(),t.setDefaultDate=!0));let r=t.defaultDate;Hi(r)?t.setDefaultDate?e.setDate(r,!0):e.gotoDate(r):e.gotoDate(new Date),t.bound?(this.hide(),e.el.className+=" is-bound",Ho(t.trigger,"click",e._onInputClick),Ho(t.trigger,"focus",e._onInputFocus),Ho(t.trigger,"blur",e._onInputBlur)):this.show()}YA.prototype={config:function(n){this._o||(this._o=ey({},So,!0));let e=ey(this._o,n,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme=typeof e.theme=="string"&&e.theme?e.theme:null,e.bound=!!(e.bound!==void 0?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn=typeof e.disableDayFn=="function"?e.disableDayFn:null;let t=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=t>4?4:t,Hi(e.minDate)||(e.minDate=!1),Hi(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),XI(e.yearRange)){let r=new Date().getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||r,e.yearRange[1]=parseInt(e.yearRange[1],10)||r}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||So.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(n){return n=n||this._o.format,Hi(this._d)?this._o.toString?this._o.toString(this._d,n):this.hasMoment?this.moment(this._d).format(n):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(n,e){this.hasMoment&&this.moment.isMoment(n)&&this.setDate(n.toDate(),e)},useMoment:function(n){this.hasMoment=!0,this.moment=n},getDate:function(){return Hi(this._d)?new Date(this._d.getTime()):null},setDate:function(n,e){if(!n)return this._d=null,this._o.field&&(this._o.field.value="",$L(this._o.field,"change",{firedBy:this})),this.draw();if(typeof n=="string"&&(n=new Date(Date.parse(n))),!Hi(n))return;let t=this._o.minDate,r=this._o.maxDate;Hi(t)&&n<t?n=t:Hi(r)&&n>r&&(n=r),this._d=new Date(n.getTime()),Dp(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),$L(this._o.field,"change",{firedBy:this})),!e&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(n){let e=!0;if(Hi(n)){if(this.calendars){let t=new Date(this.calendars[0].year,this.calendars[0].month,1),r=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),i=n.getTime();r.setMonth(r.getMonth()+1),r.setDate(r.getDate()-1),e=i<t.getTime()||r.getTime()<i}e&&(this.calendars=[{month:n.getMonth(),year:n.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(n,e){let t=this.getDate()||new Date,r=parseInt(e)*24*60*60*1e3,i;n==="add"?i=new Date(t.valueOf()+r):n==="subtract"&&(i=new Date(t.valueOf()-r)),this.setDate(i)},adjustCalendars:function(){this.calendars[0]=GL(this.calendars[0]);for(let n=1;n<this._o.numberOfMonths;n++)this.calendars[n]=GL({month:this.calendars[0].month+n,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(n){isNaN(n)||(this.calendars[0].month=parseInt(n,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(n){isNaN(n)||(this.calendars[0].year=parseInt(n,10),this.adjustCalendars())},setMinDate:function(n){n instanceof Date?(Dp(n),this._o.minDate=n,this._o.minYear=n.getFullYear(),this._o.minMonth=n.getMonth()):(this._o.minDate=So.minDate,this._o.minYear=So.minYear,this._o.minMonth=So.minMonth,this._o.startRange=So.startRange),this.draw()},setMaxDate:function(n){n instanceof Date?(Dp(n),this._o.maxDate=n,this._o.maxYear=n.getFullYear(),this._o.maxMonth=n.getMonth()):(this._o.maxDate=So.maxDate,this._o.maxYear=So.maxYear,this._o.maxMonth=So.maxMonth,this._o.endRange=So.endRange),this.draw()},setStartRange:function(n){this._o.startRange=n},setEndRange:function(n){this._o.endRange=n},draw:function(n){if(!this._v&&!n)return;let e=this._o,t=e.minYear,r=e.maxYear,i=e.minMonth,s=e.maxMonth,o="",a;this._y<=t&&(this._y=t,!isNaN(i)&&this._m<i&&(this._m=i)),this._y>=r&&(this._y=r,!isNaN(s)&&this._m>s&&(this._m=s));for(let l=0;l<e.numberOfMonths;l++)a="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),o+='<div class="pika-lendar">'+UZ(this,l,this.calendars[l].year,this.calendars[l].month,this.calendars[0].year,a)+this.render(this.calendars[l].year,this.calendars[l].month,a)+"</div>";this.el.innerHTML=o,e.bound&&e.field.type!=="hidden"&&zA(function(){e.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),e.bound&&e.field.setAttribute("aria-label",e.ariaLabel)},adjustPosition:function(){let n,e,t,r,i,s,o,a,l,u,h;this._o.container||(this.el.style.position="absolute",n=this._o.trigger,e=this.el.offsetWidth,t=this.el.offsetHeight,r=Wl().innerWidth||as().documentElement.clientWidth,i=Wl().innerHeight||as().documentElement.clientHeight,s=as().body.scrollTop||as().documentElement.scrollTop,u=!0,h=!0,l=n.getBoundingClientRect(),o=l.left+Wl().pageXOffset,a=l.bottom+Wl().pageYOffset,(this._o.reposition&&o+e>r||this._o.position.indexOf("right")>-1&&o-e+n.offsetWidth>0)&&(o=o-e+n.offsetWidth,u=!1),(this._o.reposition&&a+t>i+s||this._o.position.indexOf("top")>-1&&a-t-n.offsetHeight>0)&&(a=a-t-n.offsetHeight,h=!1),o<0&&(o=0),a<0&&(a=0),this.el.style.left=o+"px",this.el.style.top=a+"px",Tb(this.el,u?"left-aligned":"right-aligned"),Tb(this.el,h?"bottom-aligned":"top-aligned"),Ab(this.el,u?"right-aligned":"left-aligned"),Ab(this.el,h?"top-aligned":"bottom-aligned"))},render:function(n,e,t){let r=this._o,i=new Date,s=WL(n,e),o=new Date(n,e,1).getDay(),a=[],l=[];Dp(i),r.firstDay>0&&(o-=r.firstDay,o<0&&(o+=7));let u=e===0?11:e-1,h=e===11?0:e+1,c=e===0?n-1:n,d=e===11?n+1:n,f=WL(c,u),g=s+o,p=g;for(;p>7;)p-=7;g+=7-p;let v=!1;for(let y=0,S=0;y<g;y++){let R=new Date(n,e,1+(y-o)),A=Hi(this._d)?Fp(R,this._d):!1,O=Fp(R,i),V=r.events.indexOf(R.toDateString())!==-1,B=y<o||y>=s+o,Y=1+(y-o),q=e,G=n,Z=r.startRange&&Fp(r.startRange,R),ee=r.endRange&&Fp(r.endRange,R),ne=r.startRange&&r.endRange&&r.startRange<R&&R<r.endRange,re=r.minDate&&R<r.minDate||r.maxDate&&R>r.maxDate||r.disableWeekends&&PZ(R)||r.disableDayFn&&r.disableDayFn(R);B&&(y<o?(Y=f+Y,q=u,G=c):(Y=Y-s,q=h,G=d));let ae={day:Y,month:q,year:G,hasEvent:V,isSelected:A,isToday:O,isDisabled:re,isEmpty:B,isStartRange:Z,isEndRange:ee,isInRange:ne,showDaysInNextAndPreviousMonths:r.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:r.enableSelectionDaysInNextAndPreviousMonths};r.pickWholeWeek&&A&&(v=!0),l.push(LZ(ae)),++S===7&&(r.showWeekNumber&&l.unshift(DZ(this,y-o,e,n,r.firstWeekOfYearMinDays)),a.push(FZ(l,r.isRTL,r.pickWholeWeek,v)),l=[],S=0,v=!1)}return BZ(r,a,t)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),Ab(this.el,"is-hidden"),this._o.bound&&(Ho(as(),"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){let n=this._v;n!==!1&&(this._o.bound&&Ca(as(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),Tb(this.el,"is-hidden"),this._v=!1,n!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){let n=this._o;this.hide(),Ca(this.el,"mousedown",this._onMouseDown,!0),Ca(this.el,"touchend",this._onMouseDown,!0),Ca(this.el,"change",this._onChange),n.keyboardInput&&Ca(as(),"keydown",this._onKeyChange),n.field&&(Ca(n.field,"change",this._onInputChange),n.bound&&(Ca(n.trigger,"click",this._onInputClick),Ca(n.trigger,"focus",this._onInputFocus),Ca(n.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};function Nb(n,e,t){return(e=WZ(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function WZ(n){var e=$Z(n,"string");return typeof e=="symbol"?e:e+""}function $Z(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const RB="date",zL="dateEditor";class EB extends Yh{constructor(){super(...arguments),Nb(this,"defaultDateFormat","DD/MM/YYYY"),Nb(this,"parentDestroyed",!1),Nb(this,"$datePicker",null)}static get EDITOR_TYPE(){return RB}init(){if(typeof se!="function")throw new Error("You need to include moment.js to your project.");if(typeof YA!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),ie(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",e=>{je(e.target,"pika-day")&&this.hideDatepicker(),e.stopPropagation()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,t,r,i,s,o){super.prepare(e,t,r,i,s,o)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const r=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(e),super.open(),r.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:zL})}close(){var e;this._opened=!1,(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{const i=this.hot._getEditorManager();i.closeEditor(),this.hot.view.render(),i.prepareEditor()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(zL),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.finishEditing(e,t)}showDatepicker(e){const t=this.cellProperties.dateFormat||this.defaultDateFormat,r=this.hot.view.isMouseDown(),i=e?ZM(e.keyCode):!1;let s;this.datePicker.style.display="block",this.$datePicker=new YA(this.getDatePickerConfig()),typeof this.$datePicker.useMoment=="function"&&this.$datePicker.useMoment(se),this.$datePicker._onInputFocus=function(){},this.originalValue?(s=this.originalValue,se(s,t,!0).isValid()&&this.$datePicker.setMoment(se(s,t),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!i&&!r&&this.setValue("")):this.cellProperties.defaultDate?(s=this.cellProperties.defaultDate,se(s,t,!0).isValid()&&this.$datePicker.setMoment(se(s,t),!0),!i&&!r&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){const e=this.TEXTAREA,t={};this.cellProperties&&this.cellProperties.datePickerConfig&&Ig(t,this.cellProperties.datePickerConfig);const r=t.onSelect,i=t.onClose;return t.field=e,t.trigger=e,t.container=this.datePicker,t.bound=!1,t.keyboardInput=!1,t.format=t.format||this.defaultDateFormat,t.reposition=t.reposition||!1,t.isRTL=!1,t.onSelect=s=>{let o=s;isNaN(o.getTime())||(o=se(o).format(this.cellProperties.dateFormat||this.defaultDateFormat)),this.setValue(o),r&&r()},t.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),i&&i()},t}refreshDimensions(e){var t;if(super.refreshDimensions(e),this.state!==xn.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.hideDatepicker();return}const{rowIndexMapper:r,columnIndexMapper:i}=this.hot,{wtOverlays:s}=this.hot.view._wt,{wtTable:o}=(t=s.getParentOverlay(this.TD))!==null&&t!==void 0?t:this.hot.view._wt,a=r.getVisualFromRenderableIndex(o.getFirstPartiallyVisibleRow()),l=r.getVisualFromRenderableIndex(o.getLastPartiallyVisibleRow()),u=i.getVisualFromRenderableIndex(o.getFirstPartiallyVisibleColumn()),h=i.getVisualFromRenderableIndex(o.getLastPartiallyVisibleColumn());if(this.row>=a&&this.row<=l&&this.col>=u&&this.col<=h){const c=this.TD.getBoundingClientRect();this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+c.top+Dn(this.TD)}px`;let d=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?d+=c.right-rn(this.datePicker):d+=c.left,this.datePickerStyle.left=`${d}px`}else this.hideDatepicker()}}const GZ="dropdown";class QI extends qI{static get EDITOR_TYPE(){return GZ}prepare(e,t,r,i,s,o){super.prepare(e,t,r,i,s,o),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}be.getSingleton().add("beforeValidate",function(n,e,t){const r=this.propToCol(t);if(Number.isInteger(r)){const i=this.getCellMeta(e,r);i.editor===QI&&i.strict===void 0&&(i.filter=!1,i.strict=!0)}});const jZ="numeric";class bB extends Yh{static get EDITOR_TYPE(){return jZ}}const zZ="password";class TB extends Yh{static get EDITOR_TYPE(){return zZ}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,so(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const Mb="ht_editor_visible",YL="selectEditor",YZ="select";class AB extends Hd{static get EDITOR_TYPE(){return YZ}init(){this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.select.style.display="none",ie(this.select,"htSelectEditor"),this.hot.rootElement.appendChild(this.select),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.select.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.select.style.display="none",je(this.select,Mb)&&Xe(this.select,Mb),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,t,r,i,s,o){super.prepare(e,t,r,i,s,o);const a=this.cellProperties.selectOptions;let l;typeof a=="function"?l=this.prepareOptions(a(this.row,this.col,this.prop)):l=this.prepareOptions(a),so(this.select),at(l,(u,h)=>{const c=this.hot.rootDocument.createElement("OPTION");c.value=h,jh(c,u),this.select.appendChild(c)})}prepareOptions(e){let t={};if(Array.isArray(e))for(let r=0,i=e.length;r<i;r++)t[e[r]]=e[r];else typeof e=="object"&&(t=e);return t}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==xn.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:t,width:r,height:i}=this.getEditedCellRect(),s=this.select.style;s.height=`${i}px`,s.width=`${r}px`,s.top=`${e}px`,s[this.hot.isRtl()?"right":"left"]=`${t}px`,s.margin="0px",ie(this.select,Mb)}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("editor"),r={group:YL};this.isInFullEditMode()&&t.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const i=this.select.selectedIndex-1;i>=0&&(this.select[i].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const i=this.select.selectedIndex+1;i<=this.select.length-1&&(this.select[i].selected=!0)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(YL)}}const KZ="time";class NB extends Yh{static get EDITOR_TYPE(){return KZ}prepare(e,t,r,i,s,o){super.prepare(e,t,r,i,s,o),this.TEXTAREA.dir="ltr"}}function qZ(){fi(Hd),fi(qI),fi(SB),fi(EB),fi(QI),fi(KI),fi(bB),fi(TB),fi(AB),fi(Yh),fi(NB)}const XZ="html";function ZI(n,e,t,r,i,s,o){Hg.apply(this,[n,e,t,r,i,s,o]),jh(e,s??"",!1)}ZI.RENDERER_TYPE=XZ;const QZ="autocomplete";function Dd(n,e,t,r,i,s,o){const{rootDocument:a}=n,l=o.allowHtml?ZI:al,u=a.createElement("DIV"),h=n.getSettings().ariaTags;if(u.className="htAutocompleteArrow",h&&u.setAttribute(...$h()),u.appendChild(a.createTextNode("â¼")),l.apply(this,[n,e,t,r,i,s,o]),e.firstChild||e.appendChild(a.createTextNode("Â ")),e.insertBefore(u,e.firstChild),ie(e,"htAutocomplete"),!n.acArrowListener){const c=new ys(n);n.acArrowListener=function(d){je(d.target,"htAutocompleteArrow")&&n.view._wt.getSetting("onCellDblClick",null,n._createCellCoords(t,r),e)},c.addEventListener(n.rootElement,"mousedown",n.acArrowListener),n.addHookOnce("afterDestroy",()=>{c.destroy()})}}Dd.RENDERER_TYPE=QZ;const ZZ="dropdown";function JI(n,e,t,r,i,s,o){Dd.apply(this,[n,e,t,r,i,s,o])}JI.RENDERER_TYPE=ZZ;const KL=new WeakMap,qL=new WeakMap,JZ="htBadValue",Sd="data-row",Rd="data-col",eJ="checkboxRenderer",MB="checkbox";be.getSingleton().add("modifyAutoColumnSizeSeed",function(n,e,t){const{label:r,type:i,row:s,column:o,prop:a}=e;if(i===MB){if(r){const{value:l,property:u}=r;let h=t;if(l)h=typeof l=="function"?l(s,o,a,t):l;else if(u){const c=this.getDataAtRowProp(s,u);h=c!==null?c:t}n=h}return n}});function eO(n,e,t,r,i,s,o){const{rootDocument:a}=n,l=n.getSettings().ariaTags;Hg.apply(this,[n,e,t,r,i,s,o]),tJ(n);let u=nJ(a);const h=o.label;let c=!1;if(typeof o.checkedTemplate>"u"&&(o.checkedTemplate=!0),typeof o.uncheckedTemplate>"u"&&(o.uncheckedTemplate=!1),so(e),s===o.checkedTemplate||Tn(s).toLocaleLowerCase(o.locale)===Tn(o.checkedTemplate).toLocaleLowerCase(o.locale)?u.checked=!0:s===o.uncheckedTemplate||Tn(s).toLocaleLowerCase(o.locale)===Tn(o.uncheckedTemplate).toLocaleLowerCase(o.locale)?u.checked=!1:An(s)?ie(u,"noValue"):(u.style.display="none",ie(u,JZ),c=!0),Ge(u,[[Sd,t],[Rd,r]]),l&&Ge(u,[kv(u.checked?n.getTranslatedPhrase($I):n.getTranslatedPhrase(GI)),kV(u.checked),M4()]),!c&&h){let p="";if(h.value)p=typeof h.value=="function"?h.value.call(this,t,r,i,s):h.value;else if(h.property){const y=n.getDataAtRowProp(t,h.property);p=y!==null?y:""}const v=rJ(a,p,h.separated!==!0);h.position==="before"?h.separated?(e.appendChild(v),e.appendChild(u)):(v.appendChild(u),u=v):(!h.position||h.position==="after")&&(h.separated?(e.appendChild(u),e.appendChild(v)):(v.insertBefore(u,v.firstChild),u=v))}(!h||h&&!h.separated)&&e.appendChild(u),c&&e.appendChild(a.createTextNode("#bad-value#")),KL.has(n)||(KL.set(n,!0),d());function d(){const v=n.getShortcutManager().getContext("grid"),y={group:eJ,relativeToGroup:hu,position:"before"};v.addShortcuts([{keys:[["space"]],callback:()=>(f(),!g()),runOnlyIf:()=>{var S;return(S=n.getSelectedRangeLast())===null||S===void 0?void 0:S.highlight.isCell()}},{keys:[["enter"]],callback:()=>(f(),!g()),runOnlyIf:()=>{const S=n.getSelectedRangeLast();return n.getSettings().enterBeginsEditing&&S?.isSingle()&&S.highlight.isCell()}},{keys:[["delete"],["backspace"]],callback:()=>(f(!0),!g()),runOnlyIf:()=>{var S;return(S=n.getSelectedRangeLast())===null||S===void 0?void 0:S.highlight.isCell()}}],y)}function f(){let p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const v=n.getSelectedRange(),y=[],S=new Map;let R=[],A=0;if(v){for(let O=0;O<v.length;O++){const{row:V,col:B}=v[O].getTopStartCorner(),{row:Y,col:q}=v[O].getBottomEndCorner();for(let G=V;G<=Y;G+=1)for(let Z=B;Z<=q;Z+=1){const ee=n.getCellMeta(G,Z),ne={checkedTemplate:ee.checkedTemplate,uncheckedTemplate:ee.uncheckedTemplate};if(ee.type!=="checkbox"){p===!0&&!ee.readOnly&&(S.has(y.length)?S.set(y.length,[...S.get(y.length),[G,Z,null]]):S.set(y.length,[[G,Z,null]]));continue}if(ee.readOnly===!0)continue;typeof ee.checkedTemplate>"u"&&(ee.checkedTemplate=!0),typeof ee.uncheckedTemplate>"u"&&(ee.uncheckedTemplate=!1);const re=n.getDataAtCell(G,Z);p===!1?[ee.checkedTemplate,ee.checkedTemplate.toString()].includes(re)?R.push([G,Z,ee.uncheckedTemplate,ne]):[ee.uncheckedTemplate,ee.uncheckedTemplate.toString(),null,void 0].includes(re)&&R.push([G,Z,ee.checkedTemplate,ne]):R.push([G,Z,ee.uncheckedTemplate,ne]),A+=1}y.push(A),A=0}R.every(O=>{let[,,V]=O;return V===R[0][2]})?R=R.map(O=>{let[V,B,Y]=O;return[V,B,Y]}):R=R.map(O=>{let[V,B,,Y]=O;return[V,B,Y.checkedTemplate]}),R.length>0&&y.forEach((O,V)=>{let B=R.splice(0,O);S.size&&S.has(V)&&(B=[...B,...S.get(V)]),n.setDataAtCell(B)})}}function g(){const p=n.getSelectedRange();if(p){for(let v=0;v<p.length;v++){const y=p[v].getTopStartCorner(),S=p[v].getBottomEndCorner();for(let R=y.row;R<=S.row;R++)for(let A=y.col;A<=S.col;A++){const O=n.getCellMeta(R,A),V=n.getCell(R,A);if(V==null)return!0;if(V.querySelectorAll("input[type=checkbox]").length>0&&!O.readOnly)return!0}}return!1}}}eO.RENDERER_TYPE=MB;function tJ(n){let e=qL.get(n);if(!e){const{rootElement:t}=n;e=new ys(n),e.addEventListener(t,"click",r=>sJ(r,n)),e.addEventListener(t,"mouseup",r=>iJ(r,n)),e.addEventListener(t,"change",r=>oJ(r,n)),qL.set(n,e)}return e}function nJ(n){const e=n.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function rJ(n,e,t){const r=n.createElement("label");return r.className=`htCheckboxRendererLabel ${t?"fullWidth":""}`,r.appendChild(n.createTextNode(e)),r.cloneNode(!0)}function iJ(n,e){const{target:t}=n;tO(t)&&(!t.hasAttribute(Sd)||!t.hasAttribute(Rd)||setTimeout(e.listen,10))}function sJ(n,e){const{target:t}=n;if(!tO(t)||!t.hasAttribute(Sd)||!t.hasAttribute(Rd))return;const r=parseInt(t.getAttribute(Sd),10),i=parseInt(t.getAttribute(Rd),10);e.getCellMeta(r,i).readOnly&&n.preventDefault()}function oJ(n,e){const{target:t}=n;if(!tO(t)||!t.hasAttribute(Sd)||!t.hasAttribute(Rd))return;const r=parseInt(t.getAttribute(Sd),10),i=parseInt(t.getAttribute(Rd),10),s=e.getCellMeta(r,i);if(!s.readOnly){let o=null;n.target.checked?o=s.uncheckedTemplate===void 0?!0:s.checkedTemplate:o=s.uncheckedTemplate===void 0?!1:s.uncheckedTemplate,e.setDataAtCell(r,i,o)}}function tO(n){return n.tagName==="INPUT"&&n.getAttribute("type")==="checkbox"}const aJ="handsontable";function nO(n,e,t,r,i,s,o){Dd.apply(this,[n,e,t,r,i,s,o])}nO.RENDERER_TYPE=aJ;function kp(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Ib={exports:{}},XL;function lJ(){return XL||(XL=1,(function(n,e){(function(t){n.exports=t()})(function(){return(function t(r,i,s){function o(u,h){if(!i[u]){if(!r[u]){var c=typeof kp=="function"&&kp;if(!h&&c)return c(u,!0);if(a)return a(u,!0);var d=new Error("Cannot find module '"+u+"'");throw d.code="MODULE_NOT_FOUND",d}var f=i[u]={exports:{}};r[u][0].call(f.exports,function(g){return o(r[u][1][g]||g)},f,f.exports,t,r,i,s)}return i[u].exports}for(var a=typeof kp=="function"&&kp,l=0;l<s.length;l++)o(s[l]);return o})({1:[function(t,r,i){(function(s){var o,a=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,l=Math.ceil,u=Math.floor,h="[BigNumber Error] ",c=h+"Number primitive has more than 15 significant digits: ",d=1e14,f=14,g=9007199254740991,p=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],v=1e7,y=1e9;function S(q){var G=0|q;return 0<q||q===G?G:G-1}function R(q){for(var G,Z,ee=1,ne=q.length,re=q[0]+"";ee<ne;){for(G=q[ee++]+"",Z=f-G.length;Z--;G="0"+G);re+=G}for(ne=re.length;re.charCodeAt(--ne)===48;);return re.slice(0,ne+1||1)}function A(q,G){var Z,ee,ne=q.c,re=G.c,ae=q.s,ze=G.s,Le=q.e,Se=G.e;if(!ae||!ze)return null;if(Z=ne&&!ne[0],ee=re&&!re[0],Z||ee)return Z?ee?0:-ze:ae;if(ae!=ze)return ae;if(Z=ae<0,ee=Le==Se,!ne||!re)return ee?0:!ne^Z?1:-1;if(!ee)return Se<Le^Z?1:-1;for(ze=(Le=ne.length)<(Se=re.length)?Le:Se,ae=0;ae<ze;ae++)if(ne[ae]!=re[ae])return ne[ae]>re[ae]^Z?1:-1;return Le==Se?0:Se<Le^Z?1:-1}function O(q,G,Z,ee){if(q<G||Z<q||q!==(q<0?l(q):u(q)))throw Error(h+(ee||"Argument")+(typeof q=="number"?q<G||Z<q?" out of range: ":" not an integer: ":" not a primitive number: ")+String(q))}function V(q){var G=q.c.length-1;return S(q.e/f)==G&&q.c[G]%2!=0}function B(q,G){return(1<q.length?q.charAt(0)+"."+q.slice(1):q)+(G<0?"e":"e+")+G}function Y(q,G,Z){var ee,ne;if(G<0){for(ne=Z+".";++G;ne+=Z);q=ne+q}else if(++G>(ee=q.length)){for(ne=Z,G-=ee;--G;ne+=Z);q+=ne}else G<ee&&(q=q.slice(0,G)+"."+q.slice(G));return q}(o=(function q(G){var Z,ee,ne,re,ae,ze,Le,Se,ye,We,w=X.prototype={constructor:X,toString:null,valueOf:null},C=new X(1),b=20,P=4,H=-7,W=21,J=-1e7,te=1e7,ce=!1,ge=1,oe=0,Ue={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"Â ",suffix:""},$e="0123456789abcdefghijklmnopqrstuvwxyz";function X(T,I){var x,j,D,K,U,F,z,$,Q=this;if(!(Q instanceof X))return new X(T,I);if(I==null){if(T instanceof X)return Q.s=T.s,Q.e=T.e,void(Q.c=(T=T.c)?T.slice():T);if((F=typeof T=="number")&&0*T==0){if(Q.s=1/T<0?(T=-T,-1):1,T===~~T){for(K=0,U=T;10<=U;U/=10,K++);return Q.e=K,void(Q.c=[T])}$=String(T)}else{if($=String(T),!a.test($))return ne(Q,$,F);Q.s=$.charCodeAt(0)==45?($=$.slice(1),-1):1}-1<(K=$.indexOf("."))&&($=$.replace(".","")),0<(U=$.search(/e/i))?(K<0&&(K=U),K+=+$.slice(U+1),$=$.substring(0,U)):K<0&&(K=$.length)}else{if(O(I,2,$e.length,"Base"),$=String(T),I==10)return qe(Q=new X(T instanceof X?T:$),b+Q.e+1,P);if(F=typeof T=="number"){if(0*T!=0)return ne(Q,$,F,I);if(Q.s=1/T<0?($=$.slice(1),-1):1,X.DEBUG&&15<$.replace(/^0\.0*|\./,"").length)throw Error(c+T);F=!1}else Q.s=$.charCodeAt(0)===45?($=$.slice(1),-1):1;for(x=$e.slice(0,I),K=U=0,z=$.length;U<z;U++)if(x.indexOf(j=$.charAt(U))<0){if(j=="."){if(K<U){K=z;continue}}else if(!D&&($==$.toUpperCase()&&($=$.toLowerCase())||$==$.toLowerCase()&&($=$.toUpperCase()))){D=!0,U=-1,K=0;continue}return ne(Q,String(T),F,I)}-1<(K=($=ee($,I,10,Q.s)).indexOf("."))?$=$.replace(".",""):K=$.length}for(U=0;$.charCodeAt(U)===48;U++);for(z=$.length;$.charCodeAt(--z)===48;);if($=$.slice(U,++z)){if(z-=U,F&&X.DEBUG&&15<z&&(g<T||T!==u(T)))throw Error(c+Q.s*T);if(te<(K=K-U-1))Q.c=Q.e=null;else if(K<J)Q.c=[Q.e=0];else{if(Q.e=K,Q.c=[],U=(K+1)%f,K<0&&(U+=f),U<z){for(U&&Q.c.push(+$.slice(0,U)),z-=f;U<z;)Q.c.push(+$.slice(U,U+=f));$=$.slice(U),U=f-$.length}else U-=z;for(;U--;$+="0");Q.c.push(+$)}}else Q.c=[Q.e=0]}function Ze(T,I,x,j){var D,K,U,F,z;if(x==null?x=P:O(x,0,8),!T.c)return T.toString();if(D=T.c[0],U=T.e,I==null)z=R(T.c),z=j==1||j==2&&(U<=H||W<=U)?B(z,U):Y(z,U,"0");else if(K=(T=qe(new X(T),I,x)).e,F=(z=R(T.c)).length,j==1||j==2&&(I<=K||K<=H)){for(;F<I;z+="0",F++);z=B(z,K)}else if(I-=U,z=Y(z,K,"0"),F<K+1){if(0<--I)for(z+=".";I--;z+="0");}else if(0<(I+=K-F))for(K+1==F&&(z+=".");I--;z+="0");return T.s<0&&D?"-"+z:z}function it(T,I){for(var x,j=1,D=new X(T[0]);j<T.length;j++){if(!(x=new X(T[j])).s){D=x;break}I.call(D,x)&&(D=x)}return D}function vt(T,I,x){for(var j=1,D=I.length;!I[--D];I.pop());for(D=I[0];10<=D;D/=10,j++);return(x=j+x*f-1)>te?T.c=T.e=null:T.c=x<J?[T.e=0]:(T.e=x,I),T}function qe(T,I,x,j){var D,K,U,F,z,$,Q,de=T.c,Re=p;if(de){e:{for(D=1,F=de[0];10<=F;F/=10,D++);if((K=I-D)<0)K+=f,U=I,Q=(z=de[$=0])/Re[D-U-1]%10|0;else if(($=l((K+1)/f))>=de.length){if(!j)break e;for(;de.length<=$;de.push(0));z=Q=0,U=(K%=f)-f+(D=1)}else{for(z=F=de[$],D=1;10<=F;F/=10,D++);Q=(U=(K%=f)-f+D)<0?0:z/Re[D-U-1]%10|0}if(j=j||I<0||de[$+1]!=null||(U<0?z:z%Re[D-U-1]),j=x<4?(Q||j)&&(x==0||x==(T.s<0?3:2)):5<Q||Q==5&&(x==4||j||x==6&&(0<K?0<U?z/Re[D-U]:0:de[$-1])%10&1||x==(T.s<0?8:7)),I<1||!de[0])return de.length=0,j?(I-=T.e+1,de[0]=Re[(f-I%f)%f],T.e=-I||0):de[0]=T.e=0,T;if(K==0?(de.length=$,F=1,$--):(de.length=$+1,F=Re[f-K],de[$]=0<U?u(z/Re[D-U]%Re[U])*F:0),j)for(;;){if($==0){for(K=1,U=de[0];10<=U;U/=10,K++);for(U=de[0]+=F,F=1;10<=U;U/=10,F++);K!=F&&(T.e++,de[0]==d&&(de[0]=1));break}if(de[$]+=F,de[$]!=d)break;de[$--]=0,F=1}for(K=de.length;de[--K]===0;de.pop());}T.e>te?T.c=T.e=null:T.e<J&&(T.c=[T.e=0])}return T}function He(T){var I,x=T.e;return x===null?T.toString():(I=R(T.c),I=x<=H||W<=x?B(I,x):Y(I,x,"0"),T.s<0?"-"+I:I)}return X.clone=q,X.ROUND_UP=0,X.ROUND_DOWN=1,X.ROUND_CEIL=2,X.ROUND_FLOOR=3,X.ROUND_HALF_UP=4,X.ROUND_HALF_DOWN=5,X.ROUND_HALF_EVEN=6,X.ROUND_HALF_CEIL=7,X.ROUND_HALF_FLOOR=8,X.EUCLID=9,X.config=X.set=function(T){var I,x;if(T!=null){if(typeof T!="object")throw Error(h+"Object expected: "+T);if(T.hasOwnProperty(I="DECIMAL_PLACES")&&(O(x=T[I],0,y,I),b=x),T.hasOwnProperty(I="ROUNDING_MODE")&&(O(x=T[I],0,8,I),P=x),T.hasOwnProperty(I="EXPONENTIAL_AT")&&((x=T[I])&&x.pop?(O(x[0],-y,0,I),O(x[1],0,y,I),H=x[0],W=x[1]):(O(x,-y,y,I),H=-(W=x<0?-x:x))),T.hasOwnProperty(I="RANGE"))if((x=T[I])&&x.pop)O(x[0],-y,-1,I),O(x[1],1,y,I),J=x[0],te=x[1];else{if(O(x,-y,y,I),!x)throw Error(h+I+" cannot be zero: "+x);J=-(te=x<0?-x:x)}if(T.hasOwnProperty(I="CRYPTO")){if((x=T[I])!==!!x)throw Error(h+I+" not true or false: "+x);if(x){if(typeof crypto>"u"||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw ce=!x,Error(h+"crypto unavailable");ce=x}else ce=x}if(T.hasOwnProperty(I="MODULO_MODE")&&(O(x=T[I],0,9,I),ge=x),T.hasOwnProperty(I="POW_PRECISION")&&(O(x=T[I],0,y,I),oe=x),T.hasOwnProperty(I="FORMAT")){if(typeof(x=T[I])!="object")throw Error(h+I+" not an object: "+x);Ue=x}if(T.hasOwnProperty(I="ALPHABET")){if(typeof(x=T[I])!="string"||/^.$|[+-.\s]|(.).*\1/.test(x))throw Error(h+I+" invalid: "+x);$e=x}}return{DECIMAL_PLACES:b,ROUNDING_MODE:P,EXPONENTIAL_AT:[H,W],RANGE:[J,te],CRYPTO:ce,MODULO_MODE:ge,POW_PRECISION:oe,FORMAT:Ue,ALPHABET:$e}},X.isBigNumber=function(T){return T instanceof X||T&&T._isBigNumber===!0||!1},X.maximum=X.max=function(){return it(arguments,w.lt)},X.minimum=X.min=function(){return it(arguments,w.gt)},X.random=(re=9007199254740992,ae=Math.random()*re&2097151?function(){return u(Math.random()*re)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(T){var I,x,j,D,K,U=0,F=[],z=new X(C);if(T==null?T=b:O(T,0,y),D=l(T/f),ce)if(crypto.getRandomValues){for(I=crypto.getRandomValues(new Uint32Array(D*=2));U<D;)9e15<=(K=131072*I[U]+(I[U+1]>>>11))?(x=crypto.getRandomValues(new Uint32Array(2)),I[U]=x[0],I[U+1]=x[1]):(F.push(K%1e14),U+=2);U=D/2}else{if(!crypto.randomBytes)throw ce=!1,Error(h+"crypto unavailable");for(I=crypto.randomBytes(D*=7);U<D;)9e15<=(K=281474976710656*(31&I[U])+1099511627776*I[U+1]+4294967296*I[U+2]+16777216*I[U+3]+(I[U+4]<<16)+(I[U+5]<<8)+I[U+6])?crypto.randomBytes(7).copy(I,U):(F.push(K%1e14),U+=7);U=D/7}if(!ce)for(;U<D;)(K=ae())<9e15&&(F[U++]=K%1e14);for(D=F[--U],T%=f,D&&T&&(K=p[f-T],F[U]=u(D/K)*K);F[U]===0;F.pop(),U--);if(U<0)F=[j=0];else{for(j=-1;F[0]===0;F.splice(0,1),j-=f);for(U=1,K=F[0];10<=K;K/=10,U++);U<f&&(j-=f-U)}return z.e=j,z.c=F,z}),X.sum=function(){for(var T=1,I=arguments,x=new X(I[0]);T<I.length;)x=x.plus(I[T++]);return x},ee=(function(){var T="0123456789";function I(x,j,D,K){for(var U,F,z=[0],$=0,Q=x.length;$<Q;){for(F=z.length;F--;z[F]*=j);for(z[0]+=K.indexOf(x.charAt($++)),U=0;U<z.length;U++)z[U]>D-1&&(z[U+1]==null&&(z[U+1]=0),z[U+1]+=z[U]/D|0,z[U]%=D)}return z.reverse()}return function(x,j,D,K,U){var F,z,$,Q,de,Re,De,st,Ct=x.indexOf("."),dt=b,Ye=P;for(0<=Ct&&(Q=oe,oe=0,x=x.replace(".",""),Re=(st=new X(j)).pow(x.length-Ct),oe=Q,st.c=I(Y(R(Re.c),Re.e,"0"),10,D,T),st.e=st.c.length),$=Q=(De=I(x,j,D,U?(F=$e,T):(F=T,$e))).length;De[--Q]==0;De.pop());if(!De[0])return F.charAt(0);if(Ct<0?--$:(Re.c=De,Re.e=$,Re.s=K,De=(Re=Z(Re,st,dt,Ye,D)).c,de=Re.r,$=Re.e),Ct=De[z=$+dt+1],Q=D/2,de=de||z<0||De[z+1]!=null,de=Ye<4?(Ct!=null||de)&&(Ye==0||Ye==(Re.s<0?3:2)):Q<Ct||Ct==Q&&(Ye==4||de||Ye==6&&1&De[z-1]||Ye==(Re.s<0?8:7)),z<1||!De[0])x=de?Y(F.charAt(1),-dt,F.charAt(0)):F.charAt(0);else{if(De.length=z,de)for(--D;++De[--z]>D;)De[z]=0,z||(++$,De=[1].concat(De));for(Q=De.length;!De[--Q];);for(Ct=0,x="";Ct<=Q;x+=F.charAt(De[Ct++]));x=Y(x,$,F.charAt(0))}return x}})(),Z=(function(){function T(j,D,K){var U,F,z,$,Q=0,de=j.length,Re=D%v,De=D/v|0;for(j=j.slice();de--;)Q=((F=Re*(z=j[de]%v)+(U=De*z+($=j[de]/v|0)*Re)%v*v+Q)/K|0)+(U/v|0)+De*$,j[de]=F%K;return Q&&(j=[Q].concat(j)),j}function I(j,D,K,U){var F,z;if(K!=U)z=U<K?1:-1;else for(F=z=0;F<K;F++)if(j[F]!=D[F]){z=j[F]>D[F]?1:-1;break}return z}function x(j,D,K,U){for(var F=0;K--;)j[K]-=F,F=j[K]<D[K]?1:0,j[K]=F*U+j[K]-D[K];for(;!j[0]&&1<j.length;j.splice(0,1));}return function(j,D,K,U,F){var z,$,Q,de,Re,De,st,Ct,dt,Ye,Et,wn,Xh,Is,Bd,zi,cn,Qn=j.s==D.s?1:-1,Cr=j.c,on=D.c;if(!(Cr&&Cr[0]&&on&&on[0]))return new X(j.s&&D.s&&(Cr?!on||Cr[0]!=on[0]:on)?Cr&&Cr[0]==0||!on?0*Qn:Qn/0:NaN);for(dt=(Ct=new X(Qn)).c=[],Qn=K+($=j.e-D.e)+1,F||(F=d,$=S(j.e/f)-S(D.e/f),Qn=Qn/f|0),Q=0;on[Q]==(Cr[Q]||0);Q++);if(on[Q]>(Cr[Q]||0)&&$--,Qn<0)dt.push(1),de=!0;else{for(Is=Cr.length,zi=on.length,Qn+=2,1<(Re=u(F/(on[Q=0]+1)))&&(on=T(on,Re,F),Cr=T(Cr,Re,F),zi=on.length,Is=Cr.length),Xh=zi,Et=(Ye=Cr.slice(0,zi)).length;Et<zi;Ye[Et++]=0);cn=on.slice(),cn=[0].concat(cn),Bd=on[0],on[1]>=F/2&&Bd++;do{if(Re=0,(z=I(on,Ye,zi,Et))<0){if(wn=Ye[0],zi!=Et&&(wn=wn*F+(Ye[1]||0)),1<(Re=u(wn/Bd)))for(F<=Re&&(Re=F-1),st=(De=T(on,Re,F)).length,Et=Ye.length;I(De,Ye,st,Et)==1;)Re--,x(De,zi<st?cn:on,st,F),st=De.length,z=1;else Re==0&&(z=Re=1),st=(De=on.slice()).length;if(st<Et&&(De=[0].concat(De)),x(Ye,De,Et,F),Et=Ye.length,z==-1)for(;I(on,Ye,zi,Et)<1;)Re++,x(Ye,zi<Et?cn:on,Et,F),Et=Ye.length}else z===0&&(Re++,Ye=[0]);dt[Q++]=Re,Ye[0]?Ye[Et++]=Cr[Xh]||0:(Ye=[Cr[Xh]],Et=1)}while((Xh++<Is||Ye[0]!=null)&&Qn--);de=Ye[0]!=null,dt[0]||dt.splice(0,1)}if(F==d){for(Q=1,Qn=dt[0];10<=Qn;Qn/=10,Q++);qe(Ct,K+(Ct.e=Q+$*f-1)+1,U,de)}else Ct.e=$,Ct.r=+de;return Ct}})(),ze=/^(-?)0([xbo])(?=\w[\w.]*$)/i,Le=/^([^.]+)\.$/,Se=/^\.([^.]+)$/,ye=/^-?(Infinity|NaN)$/,We=/^\s*\+(?=[\w.])|^\s+|\s+$/g,ne=function(T,I,x,j){var D,K=x?I:I.replace(We,"");if(ye.test(K))T.s=isNaN(K)?null:K<0?-1:1,T.c=T.e=null;else{if(!x&&(K=K.replace(ze,function(U,F,z){return D=(z=z.toLowerCase())=="x"?16:z=="b"?2:8,j&&j!=D?U:F}),j&&(D=j,K=K.replace(Le,"$1").replace(Se,"0.$1")),I!=K))return new X(K,D);if(X.DEBUG)throw Error(h+"Not a"+(j?" base "+j:"")+" number: "+I);T.c=T.e=T.s=null}},w.absoluteValue=w.abs=function(){var T=new X(this);return T.s<0&&(T.s=1),T},w.comparedTo=function(T,I){return A(this,new X(T,I))},w.decimalPlaces=w.dp=function(T,I){var x,j,D;if(T!=null)return O(T,0,y),I==null?I=P:O(I,0,8),qe(new X(this),T+this.e+1,I);if(!(x=this.c))return null;if(j=((D=x.length-1)-S(this.e/f))*f,D=x[D])for(;D%10==0;D/=10,j--);return j<0&&(j=0),j},w.dividedBy=w.div=function(T,I){return Z(this,new X(T,I),b,P)},w.dividedToIntegerBy=w.idiv=function(T,I){return Z(this,new X(T,I),0,1)},w.exponentiatedBy=w.pow=function(T,I){var x,j,D,K,U,F,z,$,Q=this;if((T=new X(T)).c&&!T.isInteger())throw Error(h+"Exponent not an integer: "+He(T));if(I!=null&&(I=new X(I)),U=14<T.e,!Q.c||!Q.c[0]||Q.c[0]==1&&!Q.e&&Q.c.length==1||!T.c||!T.c[0])return $=new X(Math.pow(+He(Q),U?2-V(T):+He(T))),I?$.mod(I):$;if(F=T.s<0,I){if(I.c?!I.c[0]:!I.s)return new X(NaN);(j=!F&&Q.isInteger()&&I.isInteger())&&(Q=Q.mod(I))}else{if(9<T.e&&(0<Q.e||Q.e<-1||(Q.e==0?1<Q.c[0]||U&&24e7<=Q.c[1]:Q.c[0]<8e13||U&&Q.c[0]<=9999975e7)))return K=Q.s<0&&V(T)?-0:0,-1<Q.e&&(K=1/K),new X(F?1/K:K);oe&&(K=l(oe/f+2))}for(z=U?(x=new X(.5),F&&(T.s=1),V(T)):(D=Math.abs(+He(T)))%2,$=new X(C);;){if(z){if(!($=$.times(Q)).c)break;K?$.c.length>K&&($.c.length=K):j&&($=$.mod(I))}if(D){if((D=u(D/2))===0)break;z=D%2}else if(qe(T=T.times(x),T.e+1,1),14<T.e)z=V(T);else{if((D=+He(T))==0)break;z=D%2}Q=Q.times(Q),K?Q.c&&Q.c.length>K&&(Q.c.length=K):j&&(Q=Q.mod(I))}return j?$:(F&&($=C.div($)),I?$.mod(I):K?qe($,oe,P,void 0):$)},w.integerValue=function(T){var I=new X(this);return T==null?T=P:O(T,0,8),qe(I,I.e+1,T)},w.isEqualTo=w.eq=function(T,I){return A(this,new X(T,I))===0},w.isFinite=function(){return!!this.c},w.isGreaterThan=w.gt=function(T,I){return 0<A(this,new X(T,I))},w.isGreaterThanOrEqualTo=w.gte=function(T,I){return(I=A(this,new X(T,I)))===1||I===0},w.isInteger=function(){return!!this.c&&S(this.e/f)>this.c.length-2},w.isLessThan=w.lt=function(T,I){return A(this,new X(T,I))<0},w.isLessThanOrEqualTo=w.lte=function(T,I){return(I=A(this,new X(T,I)))===-1||I===0},w.isNaN=function(){return!this.s},w.isNegative=function(){return this.s<0},w.isPositive=function(){return 0<this.s},w.isZero=function(){return!!this.c&&this.c[0]==0},w.minus=function(T,I){var x,j,D,K,U=this,F=U.s;if(I=(T=new X(T,I)).s,!F||!I)return new X(NaN);if(F!=I)return T.s=-I,U.plus(T);var z=U.e/f,$=T.e/f,Q=U.c,de=T.c;if(!z||!$){if(!Q||!de)return Q?(T.s=-I,T):new X(de?U:NaN);if(!Q[0]||!de[0])return de[0]?(T.s=-I,T):new X(Q[0]?U:P==3?-0:0)}if(z=S(z),$=S($),Q=Q.slice(),F=z-$){for((D=(K=F<0)?(F=-F,Q):($=z,de)).reverse(),I=F;I--;D.push(0));D.reverse()}else for(j=(K=(F=Q.length)<(I=de.length))?F:I,F=I=0;I<j;I++)if(Q[I]!=de[I]){K=Q[I]<de[I];break}if(K&&(D=Q,Q=de,de=D,T.s=-T.s),0<(I=(j=de.length)-(x=Q.length)))for(;I--;Q[x++]=0);for(I=d-1;F<j;){if(Q[--j]<de[j]){for(x=j;x&&!Q[--x];Q[x]=I);--Q[x],Q[j]+=d}Q[j]-=de[j]}for(;Q[0]==0;Q.splice(0,1),--$);return Q[0]?vt(T,Q,$):(T.s=P==3?-1:1,T.c=[T.e=0],T)},w.modulo=w.mod=function(T,I){var x,j,D=this;return T=new X(T,I),!D.c||!T.s||T.c&&!T.c[0]?new X(NaN):!T.c||D.c&&!D.c[0]?new X(D):(ge==9?(j=T.s,T.s=1,x=Z(D,T,0,3),T.s=j,x.s*=j):x=Z(D,T,0,ge),(T=D.minus(x.times(T))).c[0]||ge!=1||(T.s=D.s),T)},w.multipliedBy=w.times=function(T,I){var x,j,D,K,U,F,z,$,Q,de,Re,De,st,Ct,dt,Ye=this,Et=Ye.c,wn=(T=new X(T,I)).c;if(!(Et&&wn&&Et[0]&&wn[0]))return!Ye.s||!T.s||Et&&!Et[0]&&!wn||wn&&!wn[0]&&!Et?T.c=T.e=T.s=null:(T.s*=Ye.s,Et&&wn?(T.c=[0],T.e=0):T.c=T.e=null),T;for(j=S(Ye.e/f)+S(T.e/f),T.s*=Ye.s,(z=Et.length)<(de=wn.length)&&(st=Et,Et=wn,wn=st,D=z,z=de,de=D),D=z+de,st=[];D--;st.push(0));for(Ct=d,dt=v,D=de;0<=--D;){for(x=0,Re=wn[D]%dt,De=wn[D]/dt|0,K=D+(U=z);D<K;)x=(($=Re*($=Et[--U]%dt)+(F=De*$+(Q=Et[U]/dt|0)*Re)%dt*dt+st[K]+x)/Ct|0)+(F/dt|0)+De*Q,st[K--]=$%Ct;st[K]=x}return x?++j:st.splice(0,1),vt(T,st,j)},w.negated=function(){var T=new X(this);return T.s=-T.s||null,T},w.plus=function(T,I){var x,j=this,D=j.s;if(I=(T=new X(T,I)).s,!D||!I)return new X(NaN);if(D!=I)return T.s=-I,j.minus(T);var K=j.e/f,U=T.e/f,F=j.c,z=T.c;if(!K||!U){if(!F||!z)return new X(D/0);if(!F[0]||!z[0])return z[0]?T:new X(F[0]?j:0*D)}if(K=S(K),U=S(U),F=F.slice(),D=K-U){for((x=0<D?(U=K,z):(D=-D,F)).reverse();D--;x.push(0));x.reverse()}for((D=F.length)-(I=z.length)<0&&(x=z,z=F,F=x,I=D),D=0;I;)D=(F[--I]=F[I]+z[I]+D)/d|0,F[I]=d===F[I]?0:F[I]%d;return D&&(F=[D].concat(F),++U),vt(T,F,U)},w.precision=w.sd=function(T,I){var x,j,D;if(T!=null&&T!==!!T)return O(T,1,y),I==null?I=P:O(I,0,8),qe(new X(this),T,I);if(!(x=this.c))return null;if(j=(D=x.length-1)*f+1,D=x[D]){for(;D%10==0;D/=10,j--);for(D=x[0];10<=D;D/=10,j++);}return T&&this.e+1>j&&(j=this.e+1),j},w.shiftedBy=function(T){return O(T,-g,g),this.times("1e"+T)},w.squareRoot=w.sqrt=function(){var T,I,x,j,D,K=this,U=K.c,F=K.s,z=K.e,$=b+4,Q=new X("0.5");if(F!==1||!U||!U[0])return new X(!F||F<0&&(!U||U[0])?NaN:U?K:1/0);if((x=(F=Math.sqrt(+He(K)))==0||F==1/0?(((I=R(U)).length+z)%2==0&&(I+="0"),F=Math.sqrt(+I),z=S((z+1)/2)-(z<0||z%2),new X(I=F==1/0?"1e"+z:(I=F.toExponential()).slice(0,I.indexOf("e")+1)+z)):new X(F+"")).c[0]){for((F=(z=x.e)+$)<3&&(F=0);;)if(D=x,x=Q.times(D.plus(Z(K,D,$,1))),R(D.c).slice(0,F)===(I=R(x.c)).slice(0,F)){if(x.e<z&&--F,(I=I.slice(F-3,F+1))!="9999"&&(j||I!="4999")){+I&&(+I.slice(1)||I.charAt(0)!="5")||(qe(x,x.e+b+2,1),T=!x.times(x).eq(K));break}if(!j&&(qe(D,D.e+b+2,0),D.times(D).eq(K))){x=D;break}$+=4,F+=4,j=1}}return qe(x,x.e+b+1,P,T)},w.toExponential=function(T,I){return T!=null&&(O(T,0,y),T++),Ze(this,T,I,1)},w.toFixed=function(T,I){return T!=null&&(O(T,0,y),T=T+this.e+1),Ze(this,T,I)},w.toFormat=function(T,I,x){var j;if(x==null)T!=null&&I&&typeof I=="object"?(x=I,I=null):T&&typeof T=="object"?(x=T,T=I=null):x=Ue;else if(typeof x!="object")throw Error(h+"Argument not an object: "+x);if(j=this.toFixed(T,I),this.c){var D,K=j.split("."),U=+x.groupSize,F=+x.secondaryGroupSize,z=x.groupSeparator||"",$=K[0],Q=K[1],de=this.s<0,Re=de?$.slice(1):$,De=Re.length;if(F&&(D=U,U=F,De-=F=D),0<U&&0<De){for(D=De%U||U,$=Re.substr(0,D);D<De;D+=U)$+=z+Re.substr(D,U);0<F&&($+=z+Re.slice(D)),de&&($="-"+$)}j=Q?$+(x.decimalSeparator||"")+((F=+x.fractionGroupSize)?Q.replace(new RegExp("\\d{"+F+"}\\B","g"),"$&"+(x.fractionGroupSeparator||"")):Q):$}return(x.prefix||"")+j+(x.suffix||"")},w.toFraction=function(T){var I,x,j,D,K,U,F,z,$,Q,de,Re,De=this,st=De.c;if(T!=null&&(!(F=new X(T)).isInteger()&&(F.c||F.s!==1)||F.lt(C)))throw Error(h+"Argument "+(F.isInteger()?"out of range: ":"not an integer: ")+He(F));if(!st)return new X(De);for(I=new X(C),$=x=new X(C),j=z=new X(C),Re=R(st),K=I.e=Re.length-De.e-1,I.c[0]=p[(U=K%f)<0?f+U:U],T=!T||0<F.comparedTo(I)?0<K?I:$:F,U=te,te=1/0,F=new X(Re),z.c[0]=0;Q=Z(F,I,0,1),(D=x.plus(Q.times(j))).comparedTo(T)!=1;)x=j,j=D,$=z.plus(Q.times(D=$)),z=D,I=F.minus(Q.times(D=I)),F=D;return D=Z(T.minus(x),j,0,1),z=z.plus(D.times($)),x=x.plus(D.times(j)),z.s=$.s=De.s,de=Z($,j,K*=2,P).minus(De).abs().comparedTo(Z(z,x,K,P).minus(De).abs())<1?[$,j]:[z,x],te=U,de},w.toNumber=function(){return+He(this)},w.toPrecision=function(T,I){return T!=null&&O(T,1,y),Ze(this,T,I,2)},w.toString=function(T){var I,x=this,j=x.s,D=x.e;return D===null?j?(I="Infinity",j<0&&(I="-"+I)):I="NaN":(I=T==null?D<=H||W<=D?B(R(x.c),D):Y(R(x.c),D,"0"):T===10?Y(R((x=qe(new X(x),b+D+1,P)).c),x.e,"0"):(O(T,2,$e.length,"Base"),ee(Y(R(x.c),D,"0"),10,T,j,!0)),j<0&&x.c[0]&&(I="-"+I)),I},w.valueOf=w.toJSON=function(){return He(this)},w._isBigNumber=!0,typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(w[Symbol.toStringTag]="BigNumber",w[Symbol.for("nodejs.util.inspect.custom")]=w.valueOf),G!=null&&X.set(G),X})()).default=o.BigNumber=o,r!==void 0&&r.exports?r.exports=o:(s||(s=typeof self<"u"&&self?self:window),s.BigNumber=o)})(this)},{}],2:[function(t,r,i){r.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(s){var o=s%10;return~~(s%100/10)==1?"th":o===1?"st":o===2?"nd":o===3?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(t,r,i){function s(S,R){return(function(A){if(Array.isArray(A))return A})(S)||(function(A,O){var V=[],B=!0,Y=!1,q=void 0;try{for(var G,Z=A[Symbol.iterator]();!(B=(G=Z.next()).done)&&(V.push(G.value),!O||V.length!==O);B=!0);}catch(ee){Y=!0,q=ee}finally{try{B||Z.return==null||Z.return()}finally{if(Y)throw q}}return V})(S,R)||(function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")})()}var o=t("./globalState"),a=t("./validating"),l=t("./parsing"),u=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],h={general:{scale:1024,suffixes:u,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:u,marker:"d"}},c={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function d(S){var R=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},A=2<arguments.length?arguments[2]:void 0;if(typeof R=="string"&&(R=l.parseFormat(R)),!a.validateFormat(R))return"ERROR: invalid format";var O=R.prefix||"",V=R.postfix||"",B=(function(Y,q,G){switch(q.output){case"currency":return q=y(q,o.currentCurrencyDefaultFormat()),(function($e,X,Ze){var it=Ze.currentCurrency(),vt=Object.assign({},c,X),qe=void 0,He="",T=!!vt.totalLength||!!vt.forceAverage||vt.average,I=X.currencyPosition||it.position,x=X.currencySymbol||it.symbol;vt.spaceSeparated&&(He=" "),I==="infix"&&(qe=He+x+He);var j=v({instance:$e,providedFormat:X,state:Ze,decimalSeparator:qe});return I==="prefix"&&(j=$e._value<0&&vt.negative==="sign"?"-".concat(He).concat(x).concat(j.slice(1)):x+He+j),I&&I!=="postfix"||(j=j+(He=T?"":He)+x),j})(Y,q,o);case"percent":return q=y(q,o.currentPercentageDefaultFormat()),(function($e,X,Ze,it){var vt=X.prefixSymbol,qe=v({instance:it(100*$e._value),providedFormat:X,state:Ze}),He=Object.assign({},c,X);return vt?"%".concat(He.spaceSeparated?" ":"").concat(qe):"".concat(qe).concat(He.spaceSeparated?" ":"","%")})(Y,q,o,G);case"byte":return q=y(q,o.currentByteDefaultFormat()),C=Y,P=o,H=G,W=(b=q).base||"binary",J=h[W],te=f(C._value,J.suffixes,J.scale),ce=te.value,ge=te.suffix,oe=v({instance:H(ce),providedFormat:b,state:P,defaults:P.currentByteDefaultFormat()}),Ue=P.currentAbbreviations(),"".concat(oe).concat(Ue.spaced?" ":"").concat(ge);case"time":return q=y(q,o.currentTimeDefaultFormat()),Se=Y,ye=Math.floor(Se._value/60/60),We=Math.floor((Se._value-60*ye*60)/60),w=Math.round(Se._value-60*ye*60-60*We),"".concat(ye,":").concat(We<10?"0":"").concat(We,":").concat(w<10?"0":"").concat(w);case"ordinal":return q=y(q,o.currentOrdinalDefaultFormat()),Z=Y,ee=q,re=(ne=o).currentOrdinal(),ae=Object.assign({},c,ee),ze=v({instance:Z,providedFormat:ee,state:ne}),Le=re(Z._value),"".concat(ze).concat(ae.spaceSeparated?" ":"").concat(Le);case"number":default:return v({instance:Y,providedFormat:q})}var Z,ee,ne,re,ae,ze,Le,Se,ye,We,w,C,b,P,H,W,J,te,ce,ge,oe,Ue})(S,R,A);return B=(B=O+B)+V}function f(S,R,A){var O=R[0],V=Math.abs(S);if(A<=V){for(var B=1;B<R.length;++B){var Y=Math.pow(A,B),q=Math.pow(A,B+1);if(Y<=V&&V<q){O=R[B],S/=Y;break}}O===R[0]&&(S/=Math.pow(A,R.length-1),O=R[R.length-1])}return{value:S,suffix:O}}function g(S){for(var R="",A=0;A<S;A++)R+="0";return R}function p(S,R){return S.toString().indexOf("e")!==-1?(function(A,O){var V=A.toString(),B=s(V.split("e"),2),Y=B[0],q=B[1],G=s(Y.split("."),2),Z=G[0],ee=G[1],ne=ee===void 0?"":ee;if(0<+q)V=Z+ne+g(q-ne.length);else{var re=".";re=+Z<0?"-0".concat(re):"0".concat(re);var ae=(g(-q-1)+Math.abs(Z)+ne).substr(0,O);ae.length<O&&(ae+=g(O-ae.length)),V=re+ae}return 0<+q&&0<O&&(V+=".".concat(g(O))),V})(S,R):(Math.round(+"".concat(S,"e+").concat(R))/Math.pow(10,R)).toFixed(R)}function v(S){var R=S.instance,A=S.providedFormat,O=S.state,V=O===void 0?o:O,B=S.decimalSeparator,Y=S.defaults,q=Y===void 0?V.currentDefaults():Y,G=R._value;if(G===0&&V.hasZeroFormat())return V.getZeroFormat();if(!isFinite(G))return G.toString();var Z,ee,ne,re,ae,ze,Le,Se,ye=Object.assign({},c,q,A),We=ye.totalLength,w=We?0:ye.characteristic,C=ye.optionalCharacteristic,b=ye.forceAverage,P=!!We||!!b||ye.average,H=We?-1:P&&A.mantissa===void 0?0:ye.mantissa,W=!We&&(A.optionalMantissa===void 0?H===-1:ye.optionalMantissa),J=ye.trimMantissa,te=ye.thousandSeparated,ce=ye.spaceSeparated,ge=ye.negative,oe=ye.forceSign,Ue=ye.exponential,$e="";if(P){var X=(function(T){var I=T.value,x=T.forceAverage,j=T.abbreviations,D=T.spaceSeparated,K=D!==void 0&&D,U=T.totalLength,F=U===void 0?0:U,z="",$=Math.abs(I),Q=-1;if($>=Math.pow(10,12)&&!x||x==="trillion"?(z=j.trillion,I/=Math.pow(10,12)):$<Math.pow(10,12)&&$>=Math.pow(10,9)&&!x||x==="billion"?(z=j.billion,I/=Math.pow(10,9)):$<Math.pow(10,9)&&$>=Math.pow(10,6)&&!x||x==="million"?(z=j.million,I/=Math.pow(10,6)):($<Math.pow(10,6)&&$>=Math.pow(10,3)&&!x||x==="thousand")&&(z=j.thousand,I/=Math.pow(10,3)),z&&(z=(K?" ":"")+z),F){var de=I.toString().split(".")[0];Q=Math.max(F-de.length,0)}return{value:I,abbreviation:z,mantissaPrecision:Q}})({value:G,forceAverage:b,abbreviations:V.currentAbbreviations(),spaceSeparated:ce,totalLength:We});G=X.value,$e+=X.abbreviation,We&&(H=X.mantissaPrecision)}if(Ue){var Ze=(ee=(Z={value:G,characteristicPrecision:w}).value,ne=Z.characteristicPrecision,re=ne===void 0?0:ne,ae=s(ee.toExponential().split("e"),2),ze=ae[0],Le=ae[1],Se=+ze,re&&1<re&&(Se*=Math.pow(10,re-1),Le=0<=(Le=+Le-(re-1))?"+".concat(Le):Le),{value:Se,abbreviation:"e".concat(Le)});G=Ze.value,$e=Ze.abbreviation+$e}var it,vt,qe,He=(function(T,I,x,j,D){if(j===-1)return T;var K=p(I,j),U=s(K.toString().split("."),2),F=U[0],z=U[1],$=z===void 0?"":z;if($.match(/^0+$/)&&(x||D))return F;var Q=$.match(/0+$/);return D&&Q?"".concat(F,".").concat($.toString().slice(0,Q.index)):K.toString()})(G.toString(),G,W,H,J);return He=(function(T,I,x,j,D){var K=j.currentDelimiters(),U=K.thousands;D=D||K.decimal;var F=K.thousandsSize||3,z=T.toString(),$=z.split(".")[0],Q=z.split(".")[1];return x&&(I<0&&($=$.slice(1)),(function(de,Re){for(var De=[],st=0,Ct=de;0<Ct;Ct--)st===Re&&(De.unshift(Ct),st=0),st++;return De})($.length,F).forEach(function(de,Re){$=$.slice(0,de+Re)+U+$.slice(de+Re)}),I<0&&($="-".concat($))),z=Q?$+D+Q:$})(He=(function(T,I,x,j){var D=T,K=s(D.toString().split("."),2),U=K[0],F=K[1];if(U.match(/^-?0$/)&&x)return F?"".concat(U.replace("0",""),".").concat(F):U.replace("0","");if(U.length<j)for(var z=j-U.length,$=0;$<z;$++)D="0".concat(D);return D.toString()})(He,0,C,w),G,te,V,B),(P||Ue)&&(He=He+$e),(oe||G<0)&&(it=He,qe=ge,He=(vt=G)===0?it:+it==0?it.replace("-",""):0<vt?"+".concat(it):qe==="sign"?it:"(".concat(it.replace("-",""),")")),He}function y(S,R){if(!S)return R;var A=Object.keys(S);return A.length===1&&A[0]==="output"?R:S}r.exports=function(S){return{format:function(){for(var R=arguments.length,A=new Array(R),O=0;O<R;O++)A[O]=arguments[O];return d.apply(void 0,A.concat([S]))},getByteUnit:function(){for(var R=arguments.length,A=new Array(R),O=0;O<R;O++)A[O]=arguments[O];return function(V){var B=h.general;return f(V._value,B.suffixes,B.scale).suffix}.apply(void 0,A.concat([S]))},getBinaryByteUnit:function(){for(var R=arguments.length,A=new Array(R),O=0;O<R;O++)A[O]=arguments[O];return function(V){var B=h.binary;return f(V._value,B.suffixes,B.scale).suffix}.apply(void 0,A.concat([S]))},getDecimalByteUnit:function(){for(var R=arguments.length,A=new Array(R),O=0;O<R;O++)A[O]=arguments[O];return function(V){var B=h.decimal;return f(V._value,B.suffixes,B.scale).suffix}.apply(void 0,A.concat([S]))},formatOrDefault:y}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(t,r,i){var s=t("./en-US"),o=t("./validating"),a=t("./parsing"),l={},u=void 0,h={},c=null,d={};function f(p){u=p}function g(){return h[u]}l.languages=function(){return Object.assign({},h)},l.currentLanguage=function(){return u},l.currentCurrency=function(){return g().currency},l.currentAbbreviations=function(){return g().abbreviations},l.currentDelimiters=function(){return g().delimiters},l.currentOrdinal=function(){return g().ordinal},l.currentDefaults=function(){return Object.assign({},g().defaults,d)},l.currentOrdinalDefaultFormat=function(){return Object.assign({},l.currentDefaults(),g().ordinalFormat)},l.currentByteDefaultFormat=function(){return Object.assign({},l.currentDefaults(),g().byteFormat)},l.currentPercentageDefaultFormat=function(){return Object.assign({},l.currentDefaults(),g().percentageFormat)},l.currentCurrencyDefaultFormat=function(){return Object.assign({},l.currentDefaults(),g().currencyFormat)},l.currentTimeDefaultFormat=function(){return Object.assign({},l.currentDefaults(),g().timeFormat)},l.setDefaults=function(p){p=a.parseFormat(p),o.validateFormat(p)&&(d=p)},l.getZeroFormat=function(){return c},l.setZeroFormat=function(p){return c=typeof p=="string"?p:null},l.hasZeroFormat=function(){return c!==null},l.languageData=function(p){if(p){if(h[p])return h[p];throw new Error('Unknown tag "'.concat(p,'"'))}return g()},l.registerLanguage=function(p){var v=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(!o.validateLanguage(p))throw new Error("Invalid language data");h[p.languageTag]=p,v&&f(p.languageTag)},l.setLanguage=function(p){var v=1<arguments.length&&arguments[1]!==void 0?arguments[1]:s.languageTag;if(!h[p]){var y=p.split("-")[0],S=Object.keys(h).find(function(R){return R.split("-")[0]===y});return h[S]?void f(S):void f(v)}f(p)},l.registerLanguage(s),u=s.languageTag,r.exports=l},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(t,r,i){r.exports=function(s){return{loadLanguagesInNode:function(o){return a=s,void o.forEach(function(l){var u=void 0;try{u=t("../languages/".concat(l))}catch{console.error('Unable to load "'.concat(l,'". No matching language file found.'))}u&&a.registerLanguage(u)});var a}}}},{}],6:[function(t,r,i){var s=t("bignumber.js");function o(a,l,u){var h=new s(a._value),c=l;return u.isNumbro(l)&&(c=l._value),c=new s(c),a._value=h.minus(c).toNumber(),a}r.exports=function(a){return{add:function(l,u){return c=u,d=a,f=new s((h=l)._value),g=c,d.isNumbro(c)&&(g=c._value),g=new s(g),h._value=f.plus(g).toNumber(),h;var h,c,d,f,g},subtract:function(l,u){return o(l,u,a)},multiply:function(l,u){return c=u,d=a,f=new s((h=l)._value),g=c,d.isNumbro(c)&&(g=c._value),g=new s(g),h._value=f.times(g).toNumber(),h;var h,c,d,f,g},divide:function(l,u){return c=u,d=a,f=new s((h=l)._value),g=c,d.isNumbro(c)&&(g=c._value),g=new s(g),h._value=f.dividedBy(g).toNumber(),h;var h,c,d,f,g},set:function(l,u){return h=l,d=c=u,a.isNumbro(c)&&(d=c._value),h._value=d,h;var h,c,d},difference:function(l,u){return h=u,o(d=(c=a)(l._value),h,c),Math.abs(d._value);var h,c,d}}}},{"bignumber.js":1}],7:[function(t,r,i){function s(v,y){for(var S=0;S<y.length;S++){var R=y[S];R.enumerable=R.enumerable||!1,R.configurable=!0,"value"in R&&(R.writable=!0),Object.defineProperty(v,R.key,R)}}var o=t("./globalState"),a=t("./validating"),l=t("./loading")(p),u=t("./unformatting"),h=t("./formatting")(p),c=t("./manipulating")(p),d=t("./parsing"),f=(function(){function v(R){(function(A,O){if(!(A instanceof O))throw new TypeError("Cannot call a class as a function")})(this,v),this._value=R}var y,S;return y=v,(S=[{key:"clone",value:function(){return p(this._value)}},{key:"format",value:function(){var R=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return h.format(this,R)}},{key:"formatCurrency",value:function(R){return typeof R=="string"&&(R=d.parseFormat(R)),(R=h.formatOrDefault(R,o.currentCurrencyDefaultFormat())).output="currency",h.format(this,R)}},{key:"formatTime",value:function(){var R=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return R.output="time",h.format(this,R)}},{key:"binaryByteUnits",value:function(){return h.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return h.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return h.getByteUnit(this)}},{key:"difference",value:function(R){return c.difference(this,R)}},{key:"add",value:function(R){return c.add(this,R)}},{key:"subtract",value:function(R){return c.subtract(this,R)}},{key:"multiply",value:function(R){return c.multiply(this,R)}},{key:"divide",value:function(R){return c.divide(this,R)}},{key:"set",value:function(R){return c.set(this,g(R))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&s(y.prototype,S),v})();function g(v){var y=v;return p.isNumbro(v)?y=v._value:typeof v=="string"?y=p.unformat(v):isNaN(v)&&(y=NaN),y}function p(v){return new f(g(v))}p.version="2.1.2",p.isNumbro=function(v){return v instanceof f},p.language=o.currentLanguage,p.registerLanguage=o.registerLanguage,p.setLanguage=o.setLanguage,p.languages=o.languages,p.languageData=o.languageData,p.zeroFormat=o.setZeroFormat,p.defaultFormat=o.currentDefaults,p.setDefaults=o.setDefaults,p.defaultCurrencyFormat=o.currentCurrencyDefaultFormat,p.validate=a.validate,p.loadLanguagesInNode=l.loadLanguagesInNode,p.unformat=u.unformat,r.exports=p},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(t,r,i){r.exports={parseFormat:function(s){var o,a,l,u,h,c,d,f,g,p,v,y,S,R,A,O,V,B,Y,q,G=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return typeof s!="string"?s:(a=G,s=(l=(o=s).match(/^{([^}]*)}/))?(a.prefix=l[1],o.slice(l[0].length)):o,h=G,(function(Z,ee){if(Z.indexOf("$")===-1){if(Z.indexOf("%")===-1)return Z.indexOf("bd")!==-1?(ee.output="byte",ee.base="general"):Z.indexOf("b")!==-1?(ee.output="byte",ee.base="binary"):Z.indexOf("d")!==-1?(ee.output="byte",ee.base="decimal"):Z.indexOf(":")===-1?Z.indexOf("o")!==-1&&(ee.output="ordinal"):ee.output="time";ee.output="percent"}else ee.output="currency"})(s=(c=(u=s).match(/{([^}]*)}$/))?(h.postfix=c[1],u.slice(0,-c[0].length)):u,G),d=G,(f=s.match(/[1-9]+[0-9]*/))&&(d.totalLength=+f[0]),g=G,(p=s.split(".")[0].match(/0+/))&&(g.characteristic=p[0].length),(function(Z,ee){if(Z.indexOf(".")!==-1){var ne=Z.split(".")[0];ee.optionalCharacteristic=ne.indexOf("0")===-1}})(s,G),v=G,s.indexOf("a")!==-1&&(v.average=!0),S=G,(y=s).indexOf("K")!==-1?S.forceAverage="thousand":y.indexOf("M")!==-1?S.forceAverage="million":y.indexOf("B")!==-1?S.forceAverage="billion":y.indexOf("T")!==-1&&(S.forceAverage="trillion"),(function(Z,ee){var ne=Z.split(".")[1];if(ne){var re=ne.match(/0+/);re&&(ee.mantissa=re[0].length)}})(s,G),A=G,(R=s).match(/\[\.]/)?A.optionalMantissa=!0:R.match(/\./)&&(A.optionalMantissa=!1),O=G,s.indexOf(",")!==-1&&(O.thousandSeparated=!0),V=G,s.indexOf(" ")!==-1&&(V.spaceSeparated=!0),Y=G,(B=s).match(/^\+?\([^)]*\)$/)&&(Y.negative="parenthesis"),B.match(/^\+?-/)&&(Y.negative="sign"),q=G,s.match(/^\+/)&&(q.forceSign=!0),G)}}},{}],9:[function(t,r,i){var s=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function o(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function a(l,u){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",c=3<arguments.length?arguments[3]:void 0,d=4<arguments.length?arguments[4]:void 0,f=5<arguments.length?arguments[5]:void 0,g=6<arguments.length?arguments[6]:void 0;if(l!=="")return l===d?0:(function p(v,y){var S=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",R=3<arguments.length?arguments[3]:void 0,A=4<arguments.length?arguments[4]:void 0,O=5<arguments.length?arguments[5]:void 0,V=6<arguments.length?arguments[6]:void 0;if(!isNaN(+v))return+v;var B="",Y=v.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(Y!==v)return-1*p(Y,y,S,R,A,O,V);for(var q=0;q<s.length;q++){var G=s[q];if((B=v.replace(G.key,""))!==v)return p(B,y,S,R,A,O,V)*G.factor}if((B=v.replace("%",""))!==v)return p(B,y,S,R,A,O,V)/100;var Z=parseFloat(v);if(!isNaN(Z)){var ee=R(Z);if(ee&&ee!=="."&&(B=v.replace(new RegExp("".concat(o(ee),"$")),""))!==v)return p(B,y,S,R,A,O,V);var ne={};Object.keys(O).forEach(function(We){ne[O[We]]=We});for(var re=Object.keys(ne).sort().reverse(),ae=re.length,ze=0;ze<ae;ze++){var Le=re[ze],Se=ne[Le];if((B=v.replace(Le,""))!==v){var ye=void 0;switch(Se){case"thousand":ye=Math.pow(10,3);break;case"million":ye=Math.pow(10,6);break;case"billion":ye=Math.pow(10,9);break;case"trillion":ye=Math.pow(10,12)}return p(B,y,S,R,A,O,V)*ye}}}})((function(p,v){var y=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",S=p.replace(y,"");return S=(S=S.replace(new RegExp("([0-9])".concat(o(v.thousands),"([0-9])"),"g"),"$1$2")).replace(v.decimal,".")})(l,u,h),u,h,c,d,f,g)}r.exports={unformat:function(l,u){var h,c,d,f=t("./globalState"),g=f.currentDelimiters(),p=f.currentCurrency().symbol,v=f.currentOrdinal(),y=f.getZeroFormat(),S=f.currentAbbreviations(),R=void 0;if(typeof l=="string")R=(function(A,O){if(!A.indexOf(":")||O.thousands===":")return!1;var V=A.split(":");if(V.length!==3)return!1;var B=+V[0],Y=+V[1],q=+V[2];return!isNaN(B)&&!isNaN(Y)&&!isNaN(q)})(l,g)?(h=l.split(":"),c=+h[0],d=+h[1],+h[2]+60*d+3600*c):a(l,g,p,v,y,S,u);else{if(typeof l!="number")return;R=l}if(R!==void 0)return R}}},{"./globalState":4}],10:[function(t,r,i){function s(g){return(function(p){if(Array.isArray(p)){for(var v=0,y=new Array(p.length);v<p.length;v++)y[v]=p[v];return y}})(g)||(function(p){if(Symbol.iterator in Object(p)||Object.prototype.toString.call(p)==="[object Arguments]")return Array.from(p)})(g)||(function(){throw new TypeError("Invalid attempt to spread non-iterable instance")})()}function o(g){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(p){return typeof p}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":typeof p})(g)}var a=t("./unformatting"),l=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,u={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(g,p){return p.output==="byte"},message:"`base` must be provided only when the output is `byte`",mandatory:function(g){return g.output==="byte"}},characteristic:{type:"number",restriction:function(g){return 0<=g},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(g){return 0<=g},message:"value must be positive"},{restriction:function(g,p){return!p.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(g){return 0<=g},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(g,p){return p.output==="percent"},message:"`prefixSymbol` can be provided only when the output is `percent`"}},h={languageTag:{type:"string",mandatory:!0,restriction:function(g){return g.match(l)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function c(g){return!!a.unformat(g)}function d(g,p,v){var y=3<arguments.length&&arguments[3]!==void 0&&arguments[3],S=Object.keys(g).map(function(R){if(!p[R])return console.error("".concat(v," Invalid key: ").concat(R)),!1;var A=g[R],O=p[R];if(typeof O=="string"&&(O={type:O}),O.type==="format"){if(!d(A,u,"[Validate ".concat(R,"]"),!0))return!1}else if(o(A)!==O.type)return console.error("".concat(v," ").concat(R,' type mismatched: "').concat(O.type,'" expected, "').concat(o(A),'" provided')),!1;if(O.restrictions&&O.restrictions.length)for(var V=O.restrictions.length,B=0;B<V;B++){var Y=O.restrictions[B],q=Y.restriction,G=Y.message;if(!q(A,g))return console.error("".concat(v," ").concat(R," invalid value: ").concat(G)),!1}return O.restriction&&!O.restriction(A,g)?(console.error("".concat(v," ").concat(R," invalid value: ").concat(O.message)),!1):O.validValues&&O.validValues.indexOf(A)===-1?(console.error("".concat(v," ").concat(R," invalid value: must be among ").concat(JSON.stringify(O.validValues),', "').concat(A,'" provided')),!1):!(O.children&&!d(A,O.children,"[Validate ".concat(R,"]")))});return y||S.push.apply(S,s(Object.keys(p).map(function(R){var A=p[R];if(typeof A=="string"&&(A={type:A}),A.mandatory){var O=A.mandatory;if(typeof O=="function"&&(O=O(g)),O&&g[R]===void 0)return console.error("".concat(v,' Missing mandatory key "').concat(R,'"')),!1}return!0}))),S.reduce(function(R,A){return R&&A},!0)}function f(g){return d(g,u,"[Validate format]")}r.exports={validate:function(g,p){var v=c(g),y=f(p);return v&&y},validateFormat:f,validateInput:c,validateLanguage:function(g){return d(g,h,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)})})(Ib)),Ib.exports}var uJ=lJ();const Mu=Ij(uJ),hJ="numeric";function IB(n,e){if(Vr(n)){const t=e.numericFormat,r=t&&t.culture||"-",i=t&&t.pattern;if(typeof r<"u"&&!Mu.languages()[r]){const s=r.replace("-",""),o=Mu.allLanguages?Mu.allLanguages[r]:Mu[s];o&&Mu.registerLanguage(o)}Mu.setLanguage(r),n=Mu(n).format(i||"0")}return n}function rO(n,e,t,r,i,s,o){let a=s;if(Vr(a)){const l=o.className||"",u=l.length?l.split(" "):[];a=IB(a,o),u.indexOf("htLeft")<0&&u.indexOf("htCenter")<0&&u.indexOf("htRight")<0&&u.indexOf("htJustify")<0&&u.push("htRight"),u.indexOf("htNumeric")<0&&u.push("htNumeric"),o.className=u.join(" "),e.dir="ltr"}al(n,e,t,r,i,a,o)}rO.RENDERER_TYPE=hJ;const cJ="password";function iO(n,e,t,r,i,s,o){al.apply(this,[n,e,t,r,i,s,o]);const a=o.hashLength||e.innerHTML.length,l=o.hashSymbol||"*";let u="";Pe(a-1,()=>{u+=l}),jh(e,u)}iO.RENDERER_TYPE=cJ;const dJ="select";function sO(n,e,t,r,i,s,o){al.apply(this,[n,e,t,r,i,s,o])}sO.RENDERER_TYPE=dJ;const fJ="time";function oO(n,e,t,r,i,s,o){al.apply(this,[n,e,t,r,i,s,o]),e.dir="ltr"}oO.RENDERER_TYPE=fJ;function mJ(){Pi(Dd),Pi(Hg),Pi(eO),Pi(JI),Pi(nO),Pi(ZI),Pi(rO),Pi(iO),Pi(sO),Pi(al),Pi(oO)}const gJ="autocomplete";function WC(n,e){let t=n;if(t==null&&(t=""),this.allowEmpty&&t===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(t,QL(t,e)):QL(t,e)(this.source):e(!0)}WC.VALIDATOR_TYPE=gJ;function QL(n,e){const t=n;return function(r){let i=!1;for(let s=0,o=r.length;s<o;s++)if(t===r[s]){i=!0;break}e(i)}}function OB(n){const e=new Date(n);return isNaN(new Date(`${n}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const pJ=Object.freeze(Object.defineProperty({__proto__:null,getNormalizedDate:OB},Symbol.toStringTag,{value:"Module"})),wJ="date";function aO(n,e){const t=gU(RB,this.instance);let r=n,i=!0;r==null&&(r="");let s=se(r,this.dateFormat||t.defaultDateFormat,!0).isValid(),o=se(new Date(r)).isValid()||s;if(this.allowEmpty&&r===""&&(o=!0,s=!0),o||(i=!1),!o&&s&&(i=!0),o&&!s)if(this.correctFormat===!0){const a=vJ(r,this.dateFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,a,"dateValidator"),i=!0}else i=!1;e(i)}aO.VALIDATOR_TYPE=wJ;function vJ(n,e){const t=se(OB(n)),r=se(n,e),i=n.search(/[A-z]/g)>-1;let s;return t.isValid()&&t.format("x")===r.format("x")||!r.isValid()||i?s=t:s=r,s.format(e)}const yJ="dropdown";function lO(n,e){WC.apply(this,[n,e])}lO.VALIDATOR_TYPE=yJ;const CJ="numeric";function uO(n,e){let t=n;t==null&&(t=""),this.allowEmpty&&t===""?e(!0):e(t===""?!1:Vr(n))}uO.VALIDATOR_TYPE=CJ;const SJ=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],RJ="time";function hO(n,e){const t=this.timeFormat||"h:mm:ss a";let r=!0,i=n;i===null&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;const s=/^\d{1,2}$/.test(i);s&&(i+=":00");const o=se(i,SJ,!0).isValid()?se(i):se(i,t);let a=o.isValid(),l=se(i,t,!0).isValid()&&!s;if(this.allowEmpty&&i===""&&(a=!0,l=!0),a||(r=!1),!a&&l&&(r=!0),a&&!l)if(this.correctFormat===!0){const u=o.format(t);this.instance.setDataAtCell(this.visualRow,this.visualCol,u,"timeValidator"),r=!0}else r=!1;e(r)}hO.VALIDATOR_TYPE=RJ;function EJ(){ah(WC),ah(lO),ah(aO),ah(uO),ah(hO)}const bJ="autocomplete",TJ={CELL_TYPE:bJ,editor:qI,renderer:Dd,validator:WC},AJ="checkbox",NJ={CELL_TYPE:AJ,editor:SB,renderer:eO},MJ="date";function _B(n,e,t,r,i,s,o){Dd.apply(this,[n,e,t,r,i,s,o])}_B.RENDERER_TYPE=MJ;const IJ="date",OJ={CELL_TYPE:IJ,editor:EB,renderer:_B,validator:aO},_J="dropdown",PJ={CELL_TYPE:_J,editor:QI,renderer:JI,validator:lO},xJ="handsontable",LJ={CELL_TYPE:xJ,editor:KI,renderer:nO},HJ="numeric",DJ={CELL_TYPE:HJ,editor:bB,renderer:rO,validator:uO,dataType:"number"},FJ="password",kJ={CELL_TYPE:FJ,editor:TB,renderer:iO,copyable:!1},VJ="select",UJ={CELL_TYPE:VJ,editor:AB,renderer:sO},BJ="time",WJ={CELL_TYPE:BJ,editor:NB,renderer:oO,validator:hO};function $J(){ts(TJ),ts(NJ),ts(OJ),ts(PJ),ts(LJ),ts(DJ),ts(kJ),ts(UJ),ts(CB),ts(WJ)}function GJ(n,e){PB(n,e),e.add(n)}function jJ(n,e,t){PB(n,e),e.set(n,t)}function PB(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function uc(n,e,t){return(e=zJ(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function zJ(n){var e=YJ(n,"string");return typeof e=="symbol"?e:e+""}function YJ(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function hc(n,e){return n.get(xB(n,e))}function xB(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const ZL=new Map([["plugin",aX],["cell-type",cB],["editor",mU],["renderer",RU],["validator",EU]]),KJ="base",Ob=[];let Ro=null;var Iu=new WeakMap,JL=new WeakSet;class _t{static get PLUGIN_KEY(){return KJ}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}constructor(e){GJ(this,JL),uc(this,"eventManager",new ys(this)),uc(this,"pluginName",null),uc(this,"pluginsInitializedCallbacks",[]),uc(this,"isPluginsReady",!1),uc(this,"enabled",!1),uc(this,"initialized",!1),jJ(this,Iu,{}),ua(this,"hot",e,{writable:!1}),Ro=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",t=>this.onUpdateSettings(t)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,t=Array.isArray(e)?e:[];if(t.length>0){const i=[];if(t.forEach(s=>{const[o,a]=s.split(":");if(!ZL.has(o))throw new Error(`Unknown plugin dependency type "${o}" was found.`);ZL.get(o)(a)||i.push(` - ${a} (${o})`)}),i.length>0){const s=[`The ${this.pluginName} plugin requires the following modules:
`,`${i.join(`
`)}
`].join("");Ob.push(s)}}if(Ro||(Ro=i0()),Ro.indexOf("UndoRedo")>=0&&Ro.splice(Ro.indexOf("UndoRedo"),1),Ro.indexOf(this.pluginName)>=0&&Ro.splice(Ro.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),Ro.length===0){if(Ob.length>0){const i=[`${Ob.join(`
`)}
`,"You have to import and register them manually."].join("");throw new Error(i)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}addHook(e,t,r){hc(Iu,this)[e]=hc(Iu,this)[e]||[];const i=hc(Iu,this)[e];this.hot.addHook(e,t,r),i.push(t),hc(Iu,this)[e]=i}removeHooks(e){L(hc(Iu,this)[e]||[],t=>{this.hot.removeHook(e,t)})}clearHooks(){const e=hc(Iu,this);at(e,(t,r)=>this.removeHooks(r)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){L(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const t=xB(JL,this,qJ).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&t&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),at(this,(t,r)=>{r!=="hot"&&(this[r]=null)}),delete this.t,delete this.hot}}function qJ(n){if(!n)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let t=0;t<e.length;t++)if(n[e[t]]!==void 0)return!0;return!1}function Ou(n,e,t){return(e=XJ(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function XJ(n){var e=QJ(n,"string");return typeof e=="symbol"?e:e+""}function QJ(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}let cO=class{constructor(e){Ou(this,"hot",null),Ou(this,"container",null),Ou(this,"injected",!1),Ou(this,"rows",[]),Ou(this,"columns",[]),Ou(this,"samples",null),Ou(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,t){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={row:e};this.rows.push(r),this.samples=t,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}addColumnHeadersRow(e){const t=this.hot.getColHeader(0);if(t!=null){const r={row:-1};this.rows.push(r),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}}addColumn(e,t){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={col:e};this.columns.push(r),this.samples=t,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}getHeights(e){this.injected||this.injectTable(),L(this.rows,t=>{const{height:r}=t.table.getBoundingClientRect();e(t.row,Math.ceil(r)-1)})}getWidths(e){this.injected||this.injectTable(),L(this.columns,t=>{const{width:r}=t.table.getBoundingClientRect();e(t.col,Math.ceil(r))})}setSettings(e){this.settings=e}setSetting(e,t){this.settings||(this.settings={}),this.settings[e]=t}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const t=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&t.appendChild(this.createColElement(-1,-1)),this.samples.forEach(r=>{L(r.strings,i=>{t.appendChild(this.createColElement(i.col,e))})}),t}createRow(e){const{rootDocument:t}=this.hot,r=t.createDocumentFragment(),i=t.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,i),r.appendChild(i)),this.samples.forEach(s=>{L(s.strings,o=>{const a=o.col,l=this.hot.getCellMeta(e,a),u=this.hot.getCellRenderer(l),h=t.createElement("td");h.setAttribute("ghost-table",1),u(this.hot,h,e,a,this.hot.colToProp(a),o.value,l),r.appendChild(h)})}),r}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,t=e.createDocumentFragment(),r=[];if(this.hot.hasRowHeaders()){const i=e.createElement("th");r.push([-1,i]),t.appendChild(i)}this.samples.forEach(i=>{L(i.strings,s=>{const o=s.col,a=e.createElement("th");r.push([o,a]),t.appendChild(a)})}),this.table.tHead.appendChild(t),L(r,i=>{const[s,o]=i;this.hot.view.appendColHeader(s,o)})}createCol(e){const{rootDocument:t}=this.hot,r=t.createDocumentFragment();return this.samples.forEach(i=>{L(i.strings,s=>{const o=s.row,a=this.hot.getCellMeta(o,e),l=this.hot.getCellRenderer(a),u=t.createElement("td"),h=t.createElement("tr");u.setAttribute("ghost-table",1),l(this.hot,u,o,e,this.hot.colToProp(e),s.value,a),h.appendChild(u),r.appendChild(h)})}),r}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,t){const r=this.hot.rootDocument.createElement("col");let i=0;t>=0&&e>=0&&(i=this.hot.getCellMeta(t,e).colspan);let s=this.hot.getColWidth(e);if(i>1)for(let o=e+1;o<e+i;o++)s+=this.hot.getColWidth(o);return r.style.width=`${s}px`,r}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:t}=this.hot,r=t.createDocumentFragment(),i=t.createElement("table"),s=t.createElement("thead"),o=t.createElement("tbody"),a=t.createElement("colgroup"),l=t.createElement("tr"),u=t.createElement("th");return this.isVertical()&&i.appendChild(a),this.isHorizontal()&&(l.appendChild(u),s.appendChild(l),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(s),this.isVertical()&&o.appendChild(l),i.appendChild(o),ie(i,e),r.appendChild(i),{fragment:r,table:i,tHead:s,tBody:o,colGroup:a,tr:l,th:u}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:t}=this.hot,r=t.createDocumentFragment(),i=t.createElement("div"),s=`htGhostTable htAutoSize ${e.trim()}`;return ie(i,s),r.appendChild(i),{fragment:r,container:i}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};function Vp(n,e,t){return(e=ZJ(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function ZJ(n){var e=JJ(n,"string");return typeof e=="symbol"?e:e+""}function JJ(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class $C{static get SAMPLE_COUNT(){return 3}constructor(e){Vp(this,"samples",null),Vp(this,"dataFactory",null),Vp(this,"customSampleCount",null),Vp(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:$C.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,t){return this.generateSamples("row",t,e)}generateColumnSamples(e,t){return this.generateSamples("col",t,e)}generateSamples(e,t,r){const i=new Map,{from:s,to:o}=typeof r=="number"?{from:r,to:r}:r;return Pe(s,o,a=>{const l=this.generateSample(e,t,a);i.set(a,l)}),i}generateSample(e,t,r){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const i=new Map,s=e==="row"?"col":"row",o=[];return Pe(t.from,t.to,a=>{const l=e==="row"?this.dataFactory(r,a):this.dataFactory(a,r);if(l===!1)return;const{value:u,bundleSeed:h}=l,c=typeof h=="string"&&h.length>0;let d;c?d=h:ot(u)?d=`${Object.keys(u).length}`:Array.isArray(u)?d=`${u.length}`:d=`${Tn(u).length}`,i.has(d)||i.set(d,{needed:this.getSampleCount(),strings:[]});const f=i.get(d);f.needed&&(!(o.indexOf(u)>-1)||this.allowDuplicates||c)&&(f.strings.push({value:u,[s]:a}),o.push(u),f.needed-=1)}),i}}function eee(n,e){LB(n,e),e.add(n)}function eH(n,e,t){LB(n,e),e.set(n,t)}function LB(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pf(n,e,t){return(e=tee(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function tee(n){var e=nee(n,"string");return typeof e=="symbol"?e:e+""}function nee(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function dh(n,e){return n.get(Bo(n,e))}function dO(n,e,t){return n.set(Bo(n,e),t),t}function Bo(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}be.getSingleton().register("modifyAutoColumnSizeSeed");const wf="autoColumnSize",ree=10,iee="autoColumnSize";var Vc=new WeakMap,Ed=new WeakMap,Ma=new WeakSet;class cm extends _t{static get PLUGIN_KEY(){return wf}static get PLUGIN_PRIORITY(){return ree}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),eee(this,Ma),pf(this,"ghostTable",new cO(this.hot)),pf(this,"samplesGenerator",new $C((t,r)=>{const i=this.hot.toPhysicalRow(t),s=this.hot.toPhysicalColumn(r);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(s))return!1;const o=this.hot.getCellMeta(t,r);let a="";o.spanned||(a=this.hot.getDataAtCell(t,r));let l="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(l=this.hot.runHooks("modifyAutoColumnSizeSeed",l,o,a)),{value:a,bundleSeed:l}})),pf(this,"inProgress",!1),pf(this,"measuredColumns",0),pf(this,"columnWidthsMap",new uu),eH(this,Vc,[]),eH(this,Ed,[]),this.hot.columnIndexMapper.registerMap(iee,this.columnWidthsMap),this.addHook("beforeColumnResize",(t,r,i)=>Bo(Ma,this,tH).call(this,t,r,i))}isEnabled(){return this.hot.getSettings()[wf]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[wf];t&&t.useHeaders!==null&&t.useHeaders!==void 0&&this.ghostTable.setSetting("useHeaders",t.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Bo(Ma,e,aee).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Bo(Ma,e,lee).call(e,...i)}),this.addHook("afterFormulasValuesUpdate",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Bo(Ma,e,hee).call(e,...i)}),this.addHook("beforeRender",()=>Bo(Ma,this,oee).call(this)),this.addHook("modifyColWidth",(r,i)=>this.getColumnWidth(i,r)),this.addHook("init",()=>Bo(Ma,this,uee).call(this)),super.enablePlugin()}updatePlugin(){dO(Ed,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,t,r)=>Bo(Ma,this,tH).call(this,e,t,r))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.getFirstVisibleColumn(),t=this.getLastVisibleColumn();if(e===-1||t===-1)return;const r=this.hot.renderCall;this.calculateColumnsWidth({from:e,to:t},void 0,r)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,s=typeof t=="number"?{from:t,to:t}:t;Pe(i.from,i.to,o=>{let a=this.hot.toPhysicalColumn(o);a===null&&(a=o),(r||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a))&&this.samplesGenerator.generateColumnSamples(o,s).forEach((u,h)=>this.ghostTable.addColumn(h,u))}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((o,a)=>{const l=this.hot.toPhysicalColumn(o);this.columnWidthsMap.setValueAtIndex(l,a)})},!0),this.measuredColumns=i.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=0;const i=this.hot.countCols()-1;let s=null;this.inProgress=!0;const o=()=>{if(!this.hot){Gm(s),this.inProgress=!1;return}this.calculateColumnsWidth({from:r,to:Math.min(r+cm.CALCULATION_STEP,i)},e,t),r=r+cm.CALCULATION_STEP+1,r<i?s=MC(o):(Gm(s),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateColumnsWidth({from:0,to:a},e,t),r=a+1),r<i?o():this.inProgress=!1}setSamplingOptions(){const e=this.hot.getSettings()[wf],t=e&&pn(e,"samplingRatio")?e.samplingRatio:void 0,r=e&&pn(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),r&&this.samplesGenerator.setAllowDuplicates(r)}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[wf];let t=cm.SYNC_CALCULATION_LIMIT;const r=this.hot.countCols()-1;return ot(e)&&(t=e.syncLimit,LM(t)?t=n0(r,t):t>>=0),Math.min(t,r)}getColumnWidth(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=t;return i===void 0&&(i=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),r&&typeof i=="number"&&(i=Math.max(i,_C))),i}getFirstVisibleColumn(){var e;return(e=this.hot.view.getFirstRenderedVisibleColumn())!==null&&e!==void 0?e:-1}getLastVisibleColumn(){var e;return(e=this.hot.view.getLastRenderedVisibleColumn())!==null&&e!==void 0?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((r,i,s)=>{const o=dh(Vc,this).length;return(o-1<s||dh(Vc,this)[s]!==i)&&r.push(this.hot.toVisualColumn(s)),o-1<s?dh(Vc,this).push(i):dh(Vc,this)[s]=i,r},[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(t=>{this.columnWidthsMap.setValueAtIndex(t,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function see(n){const e={from:0,to:this.hot.countRows()-1};n.forEach(t=>{const r=this.hot.toPhysicalColumn(t);r!==null&&(this.hot._getColWidthFromSettings(r)||this.samplesGenerator.generateColumnSamples(t,e).forEach((s,o)=>this.ghostTable.addColumn(o,s)))}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((t,r)=>{const i=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(i,r)})},!0),this.ghostTable.clean())}function oee(){this.calculateVisibleColumnsWidth(),this.inProgress||(Bo(Ma,this,see).call(this,dh(Ed,this)),dO(Ed,this,[]))}function aee(n,e){e||this.recalculateAllColumnsWidth()}function lee(n){const e=n.reduce((t,r)=>{let[,i]=r;const s=this.hot.propToCol(i);return Number.isInteger(s)&&t.indexOf(s)===-1&&t.push(s),t},[]);dh(Ed,this).push(...e)}function tH(n,e,t){let r=n;return t&&(this.calculateColumnsWidth(e,void 0,!0),r=this.getColumnWidth(e,void 0,!1)),r}function uee(){dO(Vc,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth()}function hee(n){const e=n.reduce((t,r)=>{var i;const s=(i=r.address)===null||i===void 0?void 0:i.col;if(Number.isInteger(s)){const o=this.hot.toVisualColumn(s);t.indexOf(o)===-1&&t.push(o)}return t},[]);dh(Ed,this).push(...e)}const fh={horizontal:"horizontal",vertical:"vertical"};function cee(n,e,t){let r,i,s;return e[0]===n[0]&&e[1]<n[1]?(s="left",r=t(e[0],e[1]),i=t(e[2],n[1]-1)):e[2]===n[2]&&e[0]===n[0]&&e[3]>n[3]?(s="right",r=t(e[0],n[3]+1),i=t(e[2],e[3])):e[0]<n[0]&&e[1]===n[1]?(s="up",r=t(e[0],e[1]),i=t(n[0]-1,e[3])):e[2]>n[2]&&e[1]===n[1]&&(s="down",r=t(n[2]+1,e[1]),i=t(e[2],e[3])),r&&r.normalize(),i&&i.normalize(),{directionOfDrag:s,startOfDragCoords:r,endOfDragCoords:i}}function dee(n){const e={};return n===!0?(e.directions=Object.keys(fh),e.autoInsertRow=!0):ot(n)?(Ne(n.autoInsertRow)?n.direction===fh.horizontal?e.autoInsertRow=!1:e.autoInsertRow=n.autoInsertRow:e.autoInsertRow=!1,Ne(n.direction)?e.directions=[n.direction]:e.directions=Object.keys(fh)):typeof n=="string"?(e.directions=[n],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function fee(n,e){mee(n,e),e.add(n)}function mee(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cc(n,e,t){return(e=gee(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function gee(n){var e=pee(n,"string");return typeof e=="symbol"?e:e+""}function pee(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function vf(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}be.getSingleton().register("modifyAutofillRange");be.getSingleton().register("beforeAutofill");be.getSingleton().register("afterAutofill");const nH="autofill",wee=20,vee=["fillHandle"],yee="insert_row_below",Cee=200;var dc=new WeakSet;class See extends _t{constructor(){super(...arguments),fee(this,dc),cc(this,"addingStarted",!1),cc(this,"mouseDownOnCellCorner",!1),cc(this,"mouseDragOutside",!1),cc(this,"handleDraggedCells",0),cc(this,"directions",[]),cc(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return nH}static get PLUGIN_PRIORITY(){return wee}static get SETTING_KEYS(){return[nH,...vee]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>vf(dc,this,Eee).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>vf(dc,this,Ree).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,t)=>vf(dc,this,bee).call(this,t)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:t,col:r}=e.getTopStartCorner(),{row:i,col:s}=e.getBottomEndCorner(),o=this.hot.runHooks("modifyCopyableRange",[{startRow:t,startCol:r,endRow:i,endCol:s}]),a=[],l=[],u=[];return L(o,h=>{for(let c=h.startRow;c<=h.endRow;c+=1)a.indexOf(c)===-1&&a.push(c);for(let c=h.startCol;c<=h.endCol;c+=1)l.indexOf(c)===-1&&l.push(c)}),L(a,h=>{const c=[];L(l,d=>{c.push(this.hot.getCopyableData(h,d))}),u.push(c)}),u}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,t,r,i]=this.hot.selection.highlight.getFill().getVisualCorners(),s=this.hot.getSelectedRangeLast(),o=s.getTopStartCorner(),a=s.getBottomEndCorner();this.resetSelectionOfDraggedArea();const l=[o.row,o.col,a.row,a.col],u=this.hot.runHooks("modifyAutofillRange",[Math.min(o.row,e),Math.min(o.col,t),Math.max(a.row,r),Math.max(a.col,i)],l),{directionOfDrag:h,startOfDragCoords:c,endOfDragCoords:d}=cee(l,u,(f,g)=>this.hot._createCellCoords(f,g));if(c&&c.row>-1&&c.col>-1){const f=this.getSelectionData(),g=s.clone(),p=this.hot._createCellRange(c,c,d),v=this.hot.runHooks("beforeAutofill",f,g,p,h);if(v===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let y=v;const S=v;if(["up","left"].indexOf(h)>-1&&!(S.length===1&&S[0].length===0))if(y=[],h==="up"){const R=d.row-c.row+1,A=R%S.length;for(let O=0;O<R;O++)y.push(S[(O+(S.length-A))%S.length])}else{const R=d.col-c.col+1,A=R%S[0].length;for(let O=0;O<S.length;O++){y.push([]);for(let V=0;V<R;V++)y[O].push(S[O][(V+(S[O].length-A))%S[O].length])}}this.hot.populateFromArray(c.row,c.col,y,d.row,d.col,`${this.pluginName}.fill`,null),this.setSelection(u),this.hot.runHooks("afterAutofill",y,g,p,h),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const t=this.hot.getSelectedRangeLast(),r=t.getBottomEndCorner();let i=e;if(this.directions.includes(fh.vertical)&&this.directions.includes(fh.horizontal)){const s=t.getTopStartCorner();(r.col<=e.col||s.col>=e.col)&&(i=this.hot._createCellCoords(r.row,e.col)),(r.row<e.row||s.row>e.row)&&(i=this.hot._createCellCoords(e.row,r.col))}else if(this.directions.includes(fh.vertical))i=this.hot._createCellCoords(e.row,r.col);else if(this.directions.includes(fh.horizontal))i=this.hot._createCellCoords(r.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(i)}showBorder(e){const t=this.getCoordsOfDragAndDropBorders(e);t&&this.redrawBorders(t)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(yee,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},Cee)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),t=this.hot.selection.highlight.getFill().getVisualCorners(),r=this.hot.countRows();e[2]<r-1&&t[2]===r-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const t=this.hot.getData(),r=this.hot.countRows();let i;for(let s=e[2]+1;s<r;s++){for(let l=e[1];l<=e[3];l++){const u=t[s][l];if(!An(u))return-1}const o=t[s][e[1]-1],a=t[s][e[3]+1];(!An(o)||!An(a))&&(i=s)}return i}addSelectionFromStartAreaToSpecificRowIndex(e,t){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(t,e[3])).commit()}setSelection(e){this.hot.selectCell(...wt(e,t=>Math.max(t,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),t=this.getIndexOfLastAdjacentFilledInRow(e);return t===-1||t===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,t),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:t}=this.hot.rootDocument,r=ir(this.hot.table).top-(this.hot.rootWindow.pageYOffset||t.scrollTop)+Dn(this.hot.table),i=ir(this.hot.table).left-(this.hot.rootWindow.pageXOffset||t.scrollLeft)+rn(this.hot.table);return e.clientY>r&&e.clientX<=i}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>vf(dc,this,Tee).call(this)),this.eventManager.addEventListener(e,"mousemove",t=>vf(dc,this,Aee).call(this,t))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=dee(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function Ree(){this.selectAdjacent()&&this.fillIn()}function Eee(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function bee(n){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(n),this.addNewRowIfNeeded())}function Tee(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function Aee(n){const e=this.getIfMouseWasDraggedOutside(n);this.addingStarted===!1&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function Nee(n,e){HB(n,e),e.add(n)}function Mee(n,e,t){HB(n,e),e.set(n,t)}function HB(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fc(n,e,t){return(e=Iee(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Iee(n){var e=Oee(n,"string");return typeof e=="symbol"?e:e+""}function Oee(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function _ee(n,e,t){return n.set(Wo(n,e),t),t}function fO(n,e){return n.get(Wo(n,e))}function Wo(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const Up="autoRowSize",Pee=40,xee="autoRowSize";var qm=new WeakMap,Ia=new WeakSet;class dm extends _t{static get PLUGIN_KEY(){return Up}static get PLUGIN_PRIORITY(){return Pee}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),Nee(this,Ia),fc(this,"headerHeight",null),fc(this,"ghostTable",new cO(this.hot)),fc(this,"samplesGenerator",new $C((t,r)=>{const i=this.hot.toPhysicalRow(t),s=this.hot.toPhysicalColumn(r);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(s)||t>=0&&r>=0&&this.hot.getCellMeta(t,r).hidden)return!1;let o;return t>=0?o=this.hot.getDataAtCell(t,r):t===-1&&(o=this.hot.getColHeader(r)),{value:o}})),fc(this,"inProgress",!1),fc(this,"measuredRows",0),fc(this,"rowHeightsMap",new uu),Mee(this,qm,[]),this.hot.rowIndexMapper.registerMap(xee,this.rowHeightsMap),this.addHook("beforeRowResize",(t,r,i)=>Wo(Ia,this,rH).call(this,t,r,i))}isEnabled(){const e=this.hot.getSettings()[Up];return e===!0||ot(e)}enablePlugin(){var e=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Wo(Ia,e,Dee).call(e,...r)}),this.addHook("beforeChangeRender",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Wo(Ia,e,Fee).call(e,...r)}),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("afterFormulasValuesUpdate",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Wo(Ia,e,Vee).call(e,...r)}),this.addHook("beforeRender",()=>Wo(Ia,this,Hee).call(this)),this.addHook("modifyRowHeight",(t,r)=>this.getRowHeight(r,t)),this.addHook("init",()=>Wo(Ia,this,kee).call(this)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin())}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,t,r)=>Wo(Ia,this,rH).call(this,e,t,r))}calculateVisibleRowsHeight(){if(!this.hot.countCols())return;const e=this.getFirstVisibleRow(),t=this.getLastVisibleRow();if(e===-1||t===-1)return;const r=this.hot.renderCall;this.calculateRowsHeight({from:e,to:t},void 0,r)}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,s=typeof t=="number"?{from:t,to:t}:t;if(this.hot.getColHeader(0)!==null){const o=this.samplesGenerator.generateRowSamples(-1,s);this.ghostTable.addColumnHeadersRow(o.get(-1))}Pe(i.from,i.to,o=>{let a=this.hot.toPhysicalRow(o);a===null&&(a=o),(r||this.rowHeightsMap.getValueAtIndex(a)===null)&&this.samplesGenerator.generateRowSamples(o,s).forEach((u,h)=>this.ghostTable.addRow(h,u))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((o,a)=>{o<0?this.headerHeight=a:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(o),a)})},!0),this.measuredRows=i.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=0;const i=this.hot.countRows()-1;let s=null;this.inProgress=!0;const o=()=>{if(!this.hot){Gm(s),this.inProgress=!1;return}this.calculateRowsHeight({from:r,to:Math.min(r+dm.CALCULATION_STEP,i)},e,t),r=r+dm.CALCULATION_STEP+1,r<i?s=MC(o):(Gm(s),this.inProgress=!1,this.hot.view.adjustElementsSize(),this.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateRowsHeight({from:0,to:a},e,t),r=a+1),r<i?o():(this.inProgress=!1,this.hot.view.adjustElementsSize())}setSamplingOptions(){const e=this.hot.getSettings()[Up],t=e&&pn(e,"samplingRatio")?e.samplingRatio:void 0,r=e&&pn(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),r&&this.samplesGenerator.setAllowDuplicates(r)}recalculateAllRowsHeight(){this.hot.view.isVisible()&&this.calculateAllRowsHeight({from:0,to:this.hot.countCols()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[Up];let t=dm.SYNC_CALCULATION_LIMIT;const r=this.hot.countRows()-1;return ot(e)&&(t=e.syncLimit,LM(t)?t=n0(r,t):t>>=0),Math.min(t,r)}getRowHeight(e,t){const r=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let i=t;return r!==null&&r>(t||0)&&(i=r),i}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var e;return(e=this.hot.view.getFirstRenderedVisibleRow())!==null&&e!==void 0?e:-1}getLastVisibleRow(){var e;return(e=this.hot.view.getLastRenderedVisibleRow())!==null&&e!==void 0?e:-1}clearCache(e){this.headerHeight=null,Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(t=>{this.rowHeightsMap.setValueAtIndex(t,null)})},!0):this.rowHeightsMap.clear()}clearCacheByRange(e){const{from:t,to:r}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{Pe(Math.min(t,r),Math.max(t,r),i=>{this.rowHeightsMap.setValueAtIndex(i,null)})},!0)}isNeedRecalculate(){return!!this.rowHeightsMap.getValues().slice(0,this.measuredRows).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function Lee(n){const e={from:0,to:this.hot.countCols()-1};n.forEach(t=>{this.samplesGenerator.generateRowSamples(t,e).forEach((i,s)=>this.ghostTable.addRow(s,i))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((t,r)=>{const i=this.hot.toPhysicalRow(t);this.rowHeightsMap.setValueAtIndex(i,r)})},!0),this.ghostTable.clean())}function Hee(){this.calculateVisibleRowsHeight(),this.inProgress||(Wo(Ia,this,Lee).call(this,fO(qm,this)),_ee(qm,this,[]))}function rH(n,e,t){let r=n;return t&&(this.calculateRowsHeight(e,void 0,!0),r=this.getRowHeight(e)),r}function Dee(n,e){e||this.recalculateAllRowsHeight()}function Fee(n){const e=n.reduce((t,r)=>{let[i]=r;return t.indexOf(i)===-1&&t.push(i),t},[]);fO(qm,this).push(...e)}function kee(){this.recalculateAllRowsHeight()}function Vee(n){const e=n.reduce((t,r)=>{var i;const s=(i=r.address)===null||i===void 0?void 0:i.row;if(Number.isInteger(s)){const o=this.hot.toVisualRow(s);t.indexOf(o)===-1&&t.push(o)}return t},[]);fO(qm,this).push(...e)}const{getListWithInsertedItems:Uee,getListWithRemovedItems:Bee}=YU("physicallyIndexed");class Wee extends zh{constructor(){super(e=>e)}insert(e,t){const r=I0(this.indexedValues,t);this.indexedValues=Uee(r,e,t,this.initValueOrFn),super.insert(e,t)}remove(e){const t=Bee(this.indexedValues,e);this.indexedValues=M0(t,e),super.remove(e)}}const{getListWithInsertedItems:$ee,getListWithRemovedItems:Gee}=YU("physicallyIndexed");class jee extends zh{constructor(){super(e=>e)}insert(e,t){this.indexedValues=$ee(this.indexedValues,e,t,(r,i)=>this.getNextValue(i)),super.insert(e,t)}remove(e){this.indexedValues=Gee(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}function zee(n,e){Yee(n,e),e.add(n)}function Yee(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kee(n,e,t){return(e=qee(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function qee(n){var e=Xee(n,"string");return typeof e=="symbol"?e:e+""}function Xee(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Qee(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const _b="bindRowsWithHeaders",Zee=210,Jee="loose",ete=new Map([["loose",Wee],["strict",jee]]);var iH=new WeakSet;class tte extends _t{constructor(){super(...arguments),zee(this,iH),Kee(this,"headerIndexes",null)}static get PLUGIN_KEY(){return _b}static get PLUGIN_PRIORITY(){return Zee}isEnabled(){return!!this.hot.getSettings()[_b]}enablePlugin(){if(this.enabled)return;let e=this.hot.getSettings()[_b];typeof e!="string"&&(e=Jee);const t=ete.get(e);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new t),this.addHook("modifyRowHeader",r=>Qee(iH,this,nte).call(this,r)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function nte(n){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(n))}function rte(n,e){DB(n,e),e.add(n)}function ite(n,e,t){DB(n,e),e.set(n,t)}function DB(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sH(n,e,t){return(e=ste(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function ste(n){var e=ote(n,"string");return typeof e=="symbol"?e:e+""}function ote(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function oH(n,e){return n.get(Qc(n,e))}function Pb(n,e,t){return n.set(Qc(n,e),t),t}function Qc(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const ov="collapsibleColumns",ate=290,lte=["nestedHeaders"],ld="collapsibleIndicator",aH=ov,lH=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var mc=new WeakMap,yf=new WeakSet;class ute extends _t{constructor(){super(...arguments),rte(this,yf),sH(this,"nestedHeadersPlugin",null),sH(this,"headerStateManager",null),ite(this,mc,null)}static get PLUGIN_KEY(){return ov}static get PLUGIN_PRIORITY(){return ate}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[ov,...lte]}isEnabled(){return!!this.hot.getSettings()[ov]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:t}=this.hot.getSettings();t||Ut("You need to configure the Nested Headers plugin in order to use collapsible headers."),Pb(mc,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>Qc(yf,this,dte).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Qc(yf,e,fte).call(e,...i)}),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Qc(yf,e,hte).call(e,...i)}),this.addHook("beforeOnCellMouseDown",(r,i,s)=>Qc(yf,this,cte).call(this,r,i,s)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(t=>({collapsible:t.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Pb(mc,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:t,col:r}=this.hot.getSelectedRangeLast().highlight,{collapsible:i,isCollapsed:s,columnIndex:o}=(e=this.headerStateManager.getHeaderTreeNodeData(t,r))!==null&&e!==void 0?e:{};if(i)return s?this.expandSection({row:t,col:o}):this.collapseSection({row:t,col:o}),!1},runOnlyIf:()=>{var e,t;return((e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.isSingle())&&((t=this.hot.getSelectedRangeLast())===null||t===void 0?void 0:t.highlight.isHeader())},group:aH,relativeToGroup:hu,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(aH)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,t=this.hot.view._wt.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,s=function(o){o&&o.parentNode.removeChild(o)};Pe(0,e-1,o=>{const a=t.childNodes[o],l=r.childNodes[o],u=i?i.childNodes[o]:null;Pe(0,a.childNodes.length-1,h=>{let c=a.childNodes[h].querySelector(`.${ld}`);s(c),l&&l.childNodes[h]&&(c=l.childNodes[h].querySelector(`.${ld}`),s(c)),i&&u&&u.childNodes[h]&&(c=u.childNodes[h].querySelector(`.${ld}`),s(c))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const t=this.headerStateManager.mapNodes(r=>{const{collapsible:i,origColspan:s,headerLevel:o,columnIndex:a,isCollapsed:l}=r;if(i===!0&&s>1&&(l&&e==="expand"||!l&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(o),col:a}});this.toggleCollapsibleSection(t,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,t){if(!lH.has(t))throw new Error(`Unsupported action is passed (${t}).`);if(!Array.isArray(e))return;const r=Za(e,f=>{let{row:g}=f;return g<0});let i=r.length>0;L(r,f=>{var g;let{row:p,col:v}=f;const{collapsible:y,isCollapsed:S}=(g=this.headerStateManager.getHeaderSettings(p,v))!==null&&g!==void 0?g:{};if(!y||S&&t==="collapse"||!S&&t==="expand")return i=!1,!1});const s=[],o=[];i&&L(r,f=>{let{row:g,col:p}=f;const{colspanCompensation:v,affectedColumns:y,rollbackModification:S}=this.headerStateManager.triggerNodeModification(t,g,p);v>0&&(o.push(...y),s.push(S))});const a=this.getCollapsedColumns();let l=[];t==="collapse"?l=PM([...a,...o]):t==="expand"&&(l=Za(a,f=>!o.includes(f)));const u=lH.get(t);if(this.hot.runHooks(u.beforeHook,a,l,i)===!1){L(s,f=>{f()});return}this.hot.batchExecution(()=>{L(o,f=>{oH(mc,this).setValueAtIndex(this.hot.toPhysicalColumn(f),u.hideColumn)})},!0);const c=this.getCollapsedColumns().length!==a.length,d=this.hot.getSelectedRangeLast();if(t==="collapse"&&c&&d){const{row:f,col:g}=d.highlight;if((this.hot.rowIndexMapper.isHidden(f)||this.hot.columnIndexMapper.isHidden(g))&&o.includes(g)){const v=f>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(f,1,!0):f,y=g>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(g,1,!0):g;v!==null&&y!==null&&this.hot.selectCell(v,y)}}this.hot.runHooks(u.afterHook,a,l,i,c),this.hot.render(),this.hot.view.adjustElementsSize()}getCollapsedColumns(){return oH(mc,this).getHiddenIndexes()}destroy(){Pb(mc,this,null),super.destroy()}}function hte(n,e,t){var r;const{collapsible:i,origColspan:s,isCollapsed:o}=(r=this.headerStateManager.getHeaderSettings(t,n))!==null&&r!==void 0?r:{},a=i&&s>1&&n>=this.hot.getSettings().fixedColumnsStart,l=this.hot.getSettings().ariaTags;let u=e.querySelector(`.${ld}`);if(Gh(e,[gs("")[0]]),a)u||(u=this.hot.rootDocument.createElement("div"),ie(u,ld),e.querySelector("div:first-child").appendChild(u)),Xe(u,["collapsed","expanded"]),o?(ie(u,"collapsed"),ru(u,"+"),l&&Ge(e,...gs(!1))):(ie(u,"expanded"),ru(u,"-"),l&&Ge(e,...gs(!0))),l&&Ge(u,...$h());else{var h;(h=u)===null||h===void 0||h.remove()}}function cte(n,e){je(n.target,ld)&&(je(n.target,"expanded")?(this.eventManager.fireEvent(n.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):je(n.target,"collapsed")&&(this.eventManager.fireEvent(n.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),Ns(n))}function dte(){this.updatePlugin()}function fte(n,e){e||this.updatePlugin()}function _u(n,e,t){return(e=mte(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function mte(n){var e=gte(n,"string");return typeof e=="symbol"?e:e+""}function gte(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const pte=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],wte=!1,vte=!0,yte=!0;class Cte{constructor(e,t){_u(this,"hot",void 0),_u(this,"sortingStates",new DC),_u(this,"sortEmptyCells",wte),_u(this,"indicator",vte),_u(this,"headerAction",yte),_u(this,"compareFunctionFactory",void 0),_u(this,"mapName",void 0),this.hot=e,this.mapName=t,this.hot.columnIndexMapper.registerMap(t,this.sortingStates)}updateAllColumnsProperties(e){ot(e)&&at(e,(t,r)=>{pte.includes(r)&&(this[r]=t)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var t;return(t=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||t===void 0?void 0:t.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(t=>{let[r]=t;return r===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return ot(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(t=>{let[r,i]=t;return{column:this.hot.toVisualColumn(r),...i}})}getColumnSortState(e){const t=this.getSortOrderOfColumn(e);if(Ne(t))return{column:e,sortOrder:t}}setSortStates(e){this.sortingStates.clear();for(let t=0;t<e.length;t+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[t].column),{sortOrder:e[t].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}function FB(n,e,t){const r=e.locale;return function(i,s){const{sortEmptyCells:o}=t;return typeof i=="string"&&(i=i.toLocaleLowerCase(r)),typeof s=="string"&&(s=s.toLocaleLowerCase(r)),i===s?ea:An(i)?An(s)?ea:o&&n==="asc"?En:bn:An(s)?o&&n==="asc"?bn:En:isNaN(i)&&!isNaN(s)?n==="asc"?bn:En:!isNaN(i)&&isNaN(s)||(isNaN(i)||isNaN(s)||(i=parseFloat(i),s=parseFloat(s)),i<s)?n==="asc"?En:bn:i>s?n==="asc"?bn:En:ea}}const kB="default";function Ste(n,e,t){return function(r,i){const s=parseFloat(r),o=parseFloat(i),{sortEmptyCells:a}=t;if(s===o||isNaN(s)&&isNaN(o))return ea;if(a){if(An(r))return n==="asc"?En:bn;if(An(i))return n==="asc"?bn:En}return isNaN(s)?bn:isNaN(o)?En:s<o?n==="asc"?En:bn:s>o?n==="asc"?bn:En:ea}}const Rte="numeric";function Ete(n,e,t){const r=e.checkedTemplate,i=e.uncheckedTemplate,{sortEmptyCells:s}=t;return function(o,a){const l=An(o),u=An(a),h=l?i:o,c=u?i:a,d=h===i||h===r,f=c===i||c===r;if(s===!1){if(l&&u===!1)return bn;if(l===!1&&u)return En}return d===!1&&f?n==="asc"?En:bn:d&&f===!1?n==="asc"?bn:En:d===!1&&f===!1?FB(n,e,t)(o,a):h===i&&c===r?n==="asc"?En:bn:h===r&&c===i?n==="asc"?bn:En:ea}}const bte="checkbox";function Tte(n,e,t){return GB(n,e.dateFormat,t)}const Ate="date";function Nte(n,e,t){return GB(n,e.timeFormat,t)}const Mte="time",{register:Dg,getItem:uH,hasItem:Ite}=fo("sorting.compareFunctionFactory"),{register:VB,getItem:Ote}=fo("sorting.mainSortComparator");function UB(n){return Ite(n)?uH(n):uH(kB)}Dg(bte,Ete);Dg(Ate,Tte);Dg(kB,FB);Dg(Rte,Ste);Dg(Mte,Nte);const ea=0,En=-1,bn=1;function _te(n,e){const t=Ote(e);for(var r=arguments.length,i=new Array(r>2?r-2:0),s=2;s<r;s++)i[s-2]=arguments[s];n.sort(t(...i))}const ty="asc",ny="desc",BB="colHeader";function Pte(n){if(ot(n)===!1)return!1;const{column:e,sortOrder:t}=n;return Number.isInteger(e)&&[ty,ny].includes(t)}function xte(n){if(n.some(t=>Pte(t)===!1))return!1;const e=n.map(t=>{let{column:r}=t;return r});return new Set(e).size===e.length}function hH(n){if(n!==ny)return n===ty?ny:ty}function WB(n){return n.querySelector(`.${BB}`)}function $B(n,e){if(n<0||!e.parentNode)return!1;const t=e.parentNode.parentNode.childNodes;return Array.from(t).indexOf(e.parentNode)-t.length===-1}function mO(n,e,t){return n===-1&&e>=0&&iu(t)===!1}function GB(n,e,t){return function(r,i){const{sortEmptyCells:s}=t;if(r===i)return ea;if(An(r))return An(i)?ea:s&&n==="asc"?En:bn;if(An(i))return s&&n==="asc"?bn:En;const o=se(r,e),a=se(i,e);return o.isValid()?a.isValid()?a.isAfter(o)?n==="asc"?En:bn:a.isBefore(o)?n==="asc"?bn:En:ea:En:bn}}const Lte="ascending",Hte="descending",jB="indicatorDisabled",zB="columnSorting",YB="sortAction",KB=new Map([[ty,Lte],[ny,Hte]]);function Dte(n,e,t,r){const i=[zB];if(r&&i.push(YB),t===!1)return i.push(jB),i;const s=n.getSortOrderOfColumn(e);return Ne(s)&&i.push(KB.get(s)),i}function Fte(){return Array.from(KB.values()).concat(YB,jB,zB)}function kte(n,e){return function(t,r){const[,...i]=t,[,...s]=r;return(function(a){const l=n[a],u=e[a],h=i[a],c=s[a],d=u.columnSorting;return(d.compareFunctionFactory?d.compareFunctionFactory:UB(u.type))(l,u,d)(h,c)})(0)}}function Vte(n,e){Ute(n,e),e.add(n)}function Ute(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bp(n,e,t){return(e=Bte(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Bte(n){var e=Wte(n,"string");return typeof e=="symbol"?e:e+""}function Wte(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Uc(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const ry="columnSorting",$te=50,iy="append",Gte="replace",cH=ry;VB(ry,kte);be.getSingleton().register("beforeColumnSort");be.getSingleton().register("afterColumnSort");var ih=new WeakSet;class qB extends _t{constructor(){super(...arguments),Vte(this,ih),Bp(this,"columnStatesManager",null),Bp(this,"columnMetaCache",null),Bp(this,"pluginKey",ry),Bp(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return ry}static get PLUGIN_PRIORITY(){return $te}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;this.enabled||(this.columnStatesManager=new Cte(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new uu(t=>{let r=this.hot.toVisualColumn(t);return r===null&&(r=t),this.getMergedPluginSettings(r)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(t,r)=>Uc(ih,this,jte).call(this,t,r)),this.addHook("beforeOnCellMouseDown",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Uc(ih,e,Yte).call(e,...r)}),this.addHook("afterOnCellMouseDown",(t,r)=>this.onAfterOnCellMouseDown(t,r)),this.addHook("afterInit",()=>Uc(ih,this,KA).call(this)),this.addHook("afterLoadData",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Uc(ih,e,zte).call(e,...r)}),this.hot.view&&Uc(ih,this,KA).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(t,r)=>{const i=WB(r);$B(t,r)===!1||i===null||this.updateHeaderClasses(i)};this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.indexesSequenceCache=null)},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return this.sort(this.getColumnNextConfig(e.col)),!1},runOnlyIf:()=>{var e,t;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((t=this.hot.getSelectedRangeLast())===null||t===void 0?void 0:t.isSingle())&&this.hot.selection.isCellVisible(r)&&r.row===-1&&r.col>=0},relativeToGroup:hu,position:"before",group:cH})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(cH)}sort(e){const t=this.getSortConfig(),r=this.getNormalizedSortConfigs(e),i=this.areValidSortConfigs(r);this.hot.runHooks("beforeColumnSort",t,r,i)!==!1&&(t.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new KU),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),i&&(this.columnStatesManager.setSortStates(r),this.sortByPresetSortStates(r),this.saveAllSortSettings(r)),this.hot.runHooks("afterColumnSort",t,i?r:t,i),i&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return Ne(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const t=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(t)&&this.columnStatesManager.setSortStates(t)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const t=this.hot.countCols();return xte(e)&&e.every(r=>{let{column:i}=r;return i<=t&&i>=0})}saveAllSortSettings(e){const t=this.columnStatesManager.getAllColumnsProperties(),r=i=>{let{column:s,...o}=i;return{column:this.hot.toPhysicalColumn(s),...o}};t.initialConfig=wt(e,r),this.hot.runHooks("persistentStateSave","columnSorting",t)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const t=e.value,r=i=>{let{column:s,...o}=i;return{column:this.hot.toVisualColumn(s),...o}};return Ne(t)&&Array.isArray(t.initialConfig)&&(t.initialConfig=wt(t.initialConfig,r)),t}getColumnNextConfig(e){const t=this.columnStatesManager.getSortOrderOfColumn(e);if(Ne(t)){const i=hH(t);return Ne(i)?{column:e,sortOrder:i}:void 0}const r=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<r)return{column:e,sortOrder:hH()}}getNextSortConfig(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:iy;const r=this.columnStatesManager.getIndexOfColumnInSortQueue(e),i=r!==-1,s=this.getSortConfig(),o=this.getColumnNextConfig(e);if(i){if(nn(o))return[...s.slice(0,r),...s.slice(r+1)];if(t===iy)return[...s.slice(0,r),...s.slice(r+1),o];if(t===Gte)return[...s.slice(0,r),o,...s.slice(r+1)]}return Ne(o)?s.concat(o):s}getPluginColumnConfig(e){if(ot(e)){const t=e[this.pluginKey];if(ot(t))return t}return{}}getMergedPluginSettings(e){const t=this.hot.getSettings()[this.pluginKey],r=this.columnStatesManager.getAllColumnsProperties(),i=this.hot.getCellMeta(0,e),s=Object.getPrototypeOf(i);return Array.isArray(s.columns)?Object.assign(r,t,this.getPluginColumnConfig(s.columns[e])):Jt(s.columns)?Object.assign(r,t,this.getPluginColumnConfig(s.columns(e))):Object.assign(r,t)}getFirstCellSettings(e){const t=this.hot.getCellMeta(0,e),r=Object.create(t);return r[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),r}getNumberOfRowsToSort(e){const t=this.hot.getSettings();return t.maxRows<=e?t.maxRows:e-t.minSpareRows}sortByPresetSortStates(e){if(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),e.length===0)return;const t=[],r=this.hot.countRows(),i=u=>wt(e,h=>this.hot.getDataAtCell(u,h.column));for(let u=0;u<this.getNumberOfRowsToSort(r);u+=1)t.push([this.hot.toPhysicalRow(u)].concat(i(u)));const s=wt(t,u=>u[0]);_te(t,this.pluginKey,wt(e,u=>u.sortOrder),wt(e,u=>this.getFirstCellSettings(u.column)));for(let u=t.length;u<r;u+=1)t.push([u].concat(i(u)));const o=wt(t,u=>u[0]),a=new Map(wt(s,(u,h)=>[u,o[h]])),l=wt(this.hot.rowIndexMapper.getIndexesSequence(),u=>a.has(u)?a.get(u):u);this.hot.rowIndexMapper.setIndexesSequence(l)}sortBySettings(e){if(ot(e)){this.columnStatesManager.updateAllColumnsProperties(e);const t=e.initialConfig;(Array.isArray(t)||ot(t))&&this.sort(t)}else this.hot.render()}updateHeaderClasses(e){if(Xe(e,Fte()),this.enabled!==!1){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];ie(e,Dte(...r))}}onUpdateSettings(e){super.onUpdateSettings(),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),Ne(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,t){return this.getFirstCellSettings(t)[this.pluginKey].headerAction&&je(e.target,BB)}onAfterOnCellMouseDown(e,t){if(mO(t.row,t.col,e)!==!1&&this.wasClickableHeaderClicked(e,t.col)){this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(t.col));const r=this.hot.getActiveEditor(),i=this.getColumnNextConfig(t.col);r!=null&&r.isOpened()&&this.hot.getCellValidator(r.row,r.col)?this.hot.addHookOnce("postAfterValidate",()=>{this.sort(i)}):this.sort(i)}}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}function KA(){const n=this.getAllSavedSortSettings();if(ot(n))this.sortBySettings(n);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function jte(n,e){const t=WB(e);if($B(n,e)===!1||t===null)return;const r=this.getFirstCellSettings(n)[this.pluginKey],i=r.indicator,s=r.headerAction;if(this.updateHeaderClasses(t,this.columnStatesManager,n,i,s),this.hot.getSettings().ariaTags){const o=this.columnStatesManager.getSortOrderOfColumn(n);Ge(e,...L4(o?`${o}ending`:"none"))}}function zte(n){n===!0&&this.hot.view&&Uc(ih,this,KA).call(this)}function Yte(n,e,t,r){mO(e.row,e.col,n)!==!1&&this.wasClickableHeaderClicked(n,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(r.column=!0)}function Pu(n,e,t){return(e=Kte(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Kte(n){var e=qte(n,"string");return typeof e=="symbol"?e:e+""}function qte(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Xte{constructor(e,t){Pu(this,"plugin",void 0),Pu(this,"hot",void 0),Pu(this,"endpoints",[]),Pu(this,"settings",void 0),Pu(this,"settingsType","array"),Pu(this,"currentEndpoint",null),Pu(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=t}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const t=[];let r=e;if(!r&&typeof this.settings=="function"){this.settingsType="function";return}return r||(r=this.settings),L(r,i=>{const s={};this.assignSetting(i,s,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(i,s,"reversedRowCoords",!1),this.assignSetting(i,s,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,s,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,s,"sourceColumn",i.destinationColumn),this.assignSetting(i,s,"type","sum"),this.assignSetting(i,s,"forceNumeric",!1),this.assignSetting(i,s,"suppressDataTypeErrors",!0),this.assignSetting(i,s,"customFunction",null),this.assignSetting(i,s,"readOnly",!0),this.assignSetting(i,s,"roundFloat",!1),t.push(s)}),t}assignSetting(e,t,r,i){if(r==="ranges"&&e[r]===void 0){t[r]=i;return}else if(r==="ranges"&&e[r].length===0)return;if(e[r]===void 0){if(i instanceof Error)throw i;t[r]=i}else r==="destinationRow"&&t.reversedRowCoords?t[r]=this.hot.countRows()-e[r]-1:t[r]=e[r]}resetSetupBeforeStructureAlteration(e,t,r){if(this.settingsType!=="function")return;const i=e.indexOf("row")>-1?"row":"col",s=this.getAllEndpoints();L(s,o=>{i==="row"&&o.destinationRow>=t&&(e==="insert_row"?o.alterRowOffset=r:e==="remove_row"&&(o.alterRowOffset=-1*r)),i==="col"&&o.destinationColumn>=t&&(e==="insert_col"?o.alterColumnOffset=r:e==="remove_col"&&(o.alterColumnOffset=-1*r))}),this.resetAllEndpoints(s,!1)}resetSetupAfterStructureAlteration(e,t,r,i,s){let o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const d=()=>(this.hot.removeHook("beforeViewRender",d),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",d);return}const a=e.indexOf("row")>-1?"row":"col",l=e.indexOf("remove")>-1?-1:1,u=this.getAllEndpoints(),h=e.indexOf("move_row")===0,c=t;L(u,d=>{a==="row"&&d.destinationRow>=c&&(d.alterRowOffset=l*r),a==="col"&&d.destinationColumn>=c&&(d.alterColumnOffset=l*r)}),this.resetAllEndpoints(u,!h),h?L(u,d=>{this.extendEndpointRanges(d,c,i[0],i.length),this.recreatePhysicalRanges(d),this.clearOffsetInformation(d)}):L(u,d=>{this.shiftEndpointCoordinates(d,c)}),o&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,t,r,i){L(e.ranges,s=>{s[1]&&(t>=s[0]&&t<=s[1]?r>s[1]?s[1]+=i:r<s[0]&&(s[0]-=i):r>=s[0]&&r<=s[1]&&(s[1]-=i,t<=s[0]&&(s[0]+=1,s[1]+=1)))})}recreatePhysicalRanges(e){const t=e.ranges,r=[],i=[];L(t,s=>{const o=[];if(s[1])for(let a=s[0];a<=s[1];a++)o.push(this.hot.toPhysicalRow(a));else o.push(this.hot.toPhysicalRow(s[0]));i.push(o)}),L(i,s=>{let o=[];L(s,(a,l)=>{l===0?o.push(a):s[l]!==s[l-1]+1&&(o.push(s[l-1]),r.push(o),o=[],o.push(a)),l===s.length-1&&(o.push(a),r.push(o))})}),e.ranges=r}shiftEndpointCoordinates(e,t){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,L(e.ranges,r=>{L(r,(i,s)=>{i>=t&&(r[s]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(i=>{const s=i.alterRowOffset||0,o=i.alterColumnOffset||0;return i.destinationRow+s>=this.hot.countRows()||i.destinationColumn+o>=this.hot.countCols()})||(this.cellsToSetCache=[],L(e,i=>{this.resetEndpointValue(i,t)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],L(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const t=[];this.cellsToSetCache=[],L(e,(r,i,s)=>{`${r[2]||""}`!=`${r[3]}`&&L(this.getAllEndpoints(),(o,a)=>{this.hot.propToCol(s[i][1])===o.sourceColumn&&t.indexOf(a)===-1&&t.push(a)})}),L(t,r=>{this.refreshEndpoint(this.getEndpoint(r))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach(e=>{const t=this.hot.toVisualRow(e.destinationRow);if(t!==null){const r=this.hot.getCellMeta(t,e.destinationColumn);r.readOnly=e.readOnly,r.className="columnSummaryResult"}})}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=e.alterRowOffset||0,i=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(t?r:0)),this.hot.toVisualColumn(e.destinationColumn+(t?i:0)),""])}setEndpointValue(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const s=this.hot.toVisualRow(e.destinationRow);if(s!==null){const o=this.hot.getCellMeta(s,e.destinationColumn);(t==="init"||o.readOnly!==e.readOnly)&&(o.readOnly=e.readOnly,o.className="columnSummaryResult")}if((e.roundFloat===!0||Number.isInteger(e.roundFloat))&&!isNaN(e.result)){const o=e.roundFloat;let a=0;Number.isInteger(o)&&(a=Math.min(Math.max(0,o),100)),e.result=e.result.toFixed(a)}r?this.hot.setDataAtCell(i,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){Ut("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}function xb(n){return n==null||isNaN(n)}function Qte(n,e){Zte(n,e),e.add(n)}function Zte(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Jte(n,e,t){return(e=ene(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function ene(n){var e=tne(n,"string");return typeof e=="symbol"?e:e+""}function tne(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Wp(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const Lb="columnSummary",nne=220;var Cf=new WeakSet;class rne extends _t{constructor(){super(...arguments),Qte(this,Cf),Jte(this,"endpoints",null)}static get PLUGIN_KEY(){return Lb}static get PLUGIN_PRIORITY(){return nne}isEnabled(){return!!this.hot.getSettings()[Lb]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[Lb],this.endpoints=new Xte(this,this.settings),this.addHook("afterInit",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Wp(Cf,e,ine).call(e,...r)}),this.addHook("afterChange",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Wp(Cf,e,one).call(e,...r)}),this.addHook("afterUpdateSettings",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Wp(Cf,e,sne).call(e,...r)}),this.addHook("beforeCreateRow",(t,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",t,r,null,i)),this.addHook("beforeCreateCol",(t,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",t,r,null,i)),this.addHook("beforeRemoveRow",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...r)}),this.addHook("beforeRemoveCol",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...r)}),this.addHook("afterCreateRow",(t,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",t,r,null,i)),this.addHook("afterCreateCol",(t,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",t,r,null,i)),this.addHook("afterRemoveRow",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...r)}),this.addHook("afterRemoveCol",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...r)}),this.addHook("afterRowMove",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Wp(Cf,e,ane).call(e,...r)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let t=0;return at(e.ranges,r=>{t+=this.getPartialSum(r,e.sourceColumn)}),t}getPartialSum(e,t){let r=0,i=e[1]||e[0],s=null,o=0;do{if(s=this.getCellValue(i,t),s=xb(s)?null:s,s!==null){const a=(`${s}`.split(".")[1]||[]).length||1;a>o&&(o=a)}r+=s||0,i-=1}while(i>=e[0]);return Math.round(r*10**o)/10**o}calculateMinMax(e,t){let r=null;return at(e.ranges,i=>{const s=this.getPartialMinMax(i,e.sourceColumn,t);if(r===null&&s!==null&&(r=s),s!==null)switch(t){case"min":r=Math.min(r,s);break;case"max":r=Math.max(r,s);break}}),r===null?"Not enough data":r}getPartialMinMax(e,t,r){let i=null,s=e[1]||e[0],o;do{if(o=this.getCellValue(s,t),o=xb(o)?null:o,i===null)i=o;else if(o!==null)switch(r){case"min":i=Math.min(i,o);break;case"max":i=Math.max(i,o);break}s-=1}while(s>=e[0]);return i}countEmpty(e,t){let r,i=0,s=e[1]||e[0];do r=this.getCellValue(s,t),r=xb(r)?null:r,r===null&&(i+=1),s-=1;while(s>=e[0]);return i}countEntries(e){let t=0;const r=e.ranges;return at(r,i=>{const s=i[1]===void 0?1:i[1]-i[0]+1,o=this.countEmpty(i,e.sourceColumn);t+=s,t-=o}),t}calculateAverage(e){const t=this.calculateSum(e),r=this.countEntries(e);return t/r}getCellValue(e,t){const r=this.hot.toVisualRow(e),i=this.hot.toVisualColumn(t);let s=this.hot.getSourceDataAtCell(e,t),o="";if(r!==null&&i!==null&&(o=this.hot.getCellMeta(r,i).className||""),o.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof s=="string"&&(s=s.replace(/,/,".")),s=parseFloat(s)),isNaN(s)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(Bt`ColumnSummary plugin: cell at (${e}, ${t}) is not in a\x20
          numeric format. Cannot do the calculation.`);return s}}function ine(){this.endpoints.initEndpoints()}function sne(n){n.columns!==void 0&&this.endpoints.refreshCellMetas()}function one(n,e){n&&e!=="ColumnSummary.reset"&&e!=="ColumnSummary.set"&&e!=="loadData"&&this.endpoints.refreshChangedEndpoints(n)}function ane(n,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",n[0],n.length,n,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,n.length,n,this.pluginName)}function lne(n,e){XB(n,e),e.add(n)}function Hb(n,e,t){XB(n,e),e.set(n,t)}function XB(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bc(n,e){return n.get(gO(n,e))}function qA(n,e,t){return n.set(gO(n,e),t),t}function gO(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var sy=new WeakMap,$p=new WeakMap,Gp=new WeakMap,dH=new WeakSet;class QB{constructor(){lne(this,dH),Hb(this,sy,!0),Hb(this,$p,null),Hb(this,Gp,new ResizeObserver(e=>gO(dH,this,une).call(this,e)))}setObservedElement(e){qA($p,this,e)}unobserve(){Bc(Gp,this).unobserve(Bc($p,this))}observe(){qA(sy,this,!0),Bc(Gp,this).observe(Bc($p,this))}destroy(){Bc(Gp,this).disconnect()}}function une(n){if(Bc(sy,this)||!Array.isArray(n)||!n.length){qA(sy,this,!1);return}n.forEach(e=>{let{borderBoxSize:t}=e;const{inlineSize:r,blockSize:i}=t[0];this.runLocalHooks("resize",r,i)})}Wt(QB,Or);function xu(n,e,t){hne(n,e),e.set(n,t)}function hne(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yt(n,e){return n.get(ZB(n,e))}function Sa(n,e,t){return n.set(ZB(n,e),t),t}function ZB(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Lu=new WeakMap,Db=new WeakMap,Ra=new WeakMap,Hu=new WeakMap,dl=new WeakMap,jp=new WeakMap,gc=new WeakMap;class mh{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,t){var r=this;xu(this,Lu,void 0),xu(this,Db,!1),xu(this,Ra,null),xu(this,Hu,void 0),xu(this,dl,void 0),xu(this,jp,!0),xu(this,gc,new QB),Sa(Lu,this,e),Sa(Db,this,t),Sa(Hu,this,this.createEditor()),Sa(dl,this,Yt(Hu,this).style),Yt(gc,this).setObservedElement(this.getInputElement()),Yt(gc,this).addLocalHook("resize",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("resize",...s)}),this.hide()}setPosition(e,t){Yt(dl,this).left=`${e}px`,Yt(dl,this).top=`${t}px`}setSize(e,t){if(e&&t){const r=this.getInputElement();r.style.width=`${e}px`,r.style.height=`${t}px`}}getSize(){return{width:rn(this.getInputElement()),height:Dn(this.getInputElement())}}observeSize(){Yt(gc,this).observe()}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const t=this.getInputElement();t.readOnly=e}show(){Yt(dl,this).display="block",Sa(jp,this,!1)}hide(){Yt(gc,this).unobserve(),Yt(jp,this)||(Yt(dl,this).display="none"),Sa(jp,this,!0)}isVisible(){return Yt(dl,this).display==="block"}setValue(){const t=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=t}getValue(){return this.getInputElement().value}isFocused(){return Yt(Lu,this).activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=Yt(Lu,this).createElement("div"),t=Yt(Lu,this).createElement("textarea");return e.style.display="none",Sa(Ra,this,Yt(Lu,this).createElement("div")),Yt(Ra,this).setAttribute("dir",Yt(Db,this)?"rtl":"ltr"),ie(Yt(Ra,this),mh.CLASS_EDITOR_CONTAINER),Yt(Lu,this).body.appendChild(Yt(Ra,this)),ie(e,mh.CLASS_EDITOR),ie(t,mh.CLASS_INPUT),t.setAttribute("data-hot-input",!0),e.appendChild(t),Yt(Ra,this).appendChild(e),e}getInputElement(){return Yt(Hu,this).querySelector(`.${mh.CLASS_INPUT}`)}destroy(){const e=Yt(Ra,this)?Yt(Ra,this).parentNode:null;Yt(Hu,this).parentNode.removeChild(Yt(Hu,this)),Sa(Hu,this,null),Sa(dl,this,null),Yt(gc,this).destroy(),e&&e.removeChild(Yt(Ra,this))}}Wt(mh,Or);function Fb(n,e,t){return(e=cne(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function cne(n){var e=dne(n,"string");return typeof e=="symbol"?e:e+""}function dne(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const fne=250,mne=250;class JB{constructor(e){Fb(this,"wasLastActionShow",!0),Fb(this,"showDebounced",null),Fb(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},mne)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:fne;this.showDebounced=TC(t=>{this.wasLastActionShow&&this.runLocalHooks("show",t.from.row,t.from.col)},e)}destroy(){this.clearLocalHooks()}}Wt(JB,Or);function gne(n,e){return n.indexOf(e)!==-1?n:`${n.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function pne(n,e){return n.indexOf(e)!==-1?n:`${n.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function Du(n,e){const t={};return L(n,r=>{r.forAll((i,s)=>{i>=0&&s>=0&&(t[i]||(t[i]=[]),t[i][s]=e(i,s))})}),t}function Tl(n,e,t,r,i){L(n,s=>{s.forAll((o,a)=>{o>=0&&a>=0&&wne(o,a,e,t,r,i)})})}function wne(n,e,t,r,i,s){const o=i(n,e);let a=r;o.className&&(t==="vertical"?a=gne(o.className,r):a=pne(o.className,r)),s(n,e,"className",a)}function Pa(n){return`<span class="selected">â</span>${n}`}function fm(n,e){let t=!1;return Array.isArray(n)&&L(n,r=>(r.forAll((i,s)=>{if(i>=0&&s>=0&&e(i,s))return t=!0,!1}),t)),t}function GC(n,e){const t={top:0,left:0};if(e!==n.ownerDocument){const{frameElement:r}=e.defaultView,{top:i,left:s}=r.getBoundingClientRect();t.top=i,t.left=s}return t}function vne(n){return function(e,t){const r=this.getCellMeta(e,t).className;return r&&r.indexOf(n)!==-1}}function ai(n,e){return fm(n.getSelectedRange(),vne(e).bind(n))}const ut="---------";function yne(){return{name:ut}}const ss="alignment";function Cne(){return{key:ss,name(){return this.getTranslatedPhrase(eI)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const n=this.getSelectedRangeLast();return!n||n.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${ss}:left`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(jv)},ariaChecked(){return ai(this,"htLeft")},name(){let n=this.getTranslatedPhrase(jv);return ai(this,"htLeft")&&(n=Pa(n)),n},callback(){const n=this.getSelectedRange(),e=Du(n,(i,s)=>this.getCellMeta(i,s).className),t="horizontal",r="htLeft";this.runHooks("beforeCellAlignment",e,n,t,r),Tl(n,t,r,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{key:`${ss}:center`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(zv)},ariaChecked(){return ai(this,"htCenter")},name(){let n=this.getTranslatedPhrase(zv);return ai(this,"htCenter")&&(n=Pa(n)),n},callback(){const n=this.getSelectedRange(),e=Du(n,(i,s)=>this.getCellMeta(i,s).className),t="horizontal",r="htCenter";this.runHooks("beforeCellAlignment",e,n,t,r),Tl(n,t,r,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{key:`${ss}:right`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(Yv)},ariaChecked(){return ai(this,"htRight")},name(){let n=this.getTranslatedPhrase(Yv);return ai(this,"htRight")&&(n=Pa(n)),n},callback(){const n=this.getSelectedRange(),e=Du(n,(i,s)=>this.getCellMeta(i,s).className),t="horizontal",r="htRight";this.runHooks("beforeCellAlignment",e,n,t,r),Tl(n,t,r,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{key:`${ss}:justify`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(Kv)},ariaChecked(){return ai(this,"htJustify")},name(){let n=this.getTranslatedPhrase(Kv);return ai(this,"htJustify")&&(n=Pa(n)),n},callback(){const n=this.getSelectedRange(),e=Du(n,(i,s)=>this.getCellMeta(i,s).className),t="horizontal",r="htJustify";this.runHooks("beforeCellAlignment",e,n,t,r),Tl(n,t,r,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{name:ut},{key:`${ss}:top`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(qv)},ariaChecked(){return ai(this,"htTop")},name(){let n=this.getTranslatedPhrase(qv);return ai(this,"htTop")&&(n=Pa(n)),n},callback(){const n=this.getSelectedRange(),e=Du(n,(i,s)=>this.getCellMeta(i,s).className),t="vertical",r="htTop";this.runHooks("beforeCellAlignment",e,n,t,r),Tl(n,t,r,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{key:`${ss}:middle`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(Xv)},ariaChecked(){return ai(this,"htMiddle")},name(){let n=this.getTranslatedPhrase(Xv);return ai(this,"htMiddle")&&(n=Pa(n)),n},callback(){const n=this.getSelectedRange(),e=Du(n,(i,s)=>this.getCellMeta(i,s).className),t="vertical",r="htMiddle";this.runHooks("beforeCellAlignment",e,n,t,r),Tl(n,t,r,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{key:`${ss}:bottom`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(Qv)},ariaChecked(){return ai(this,"htBottom")},name(){let n=this.getTranslatedPhrase(Qv);return ai(this,"htBottom")&&(n=Pa(n)),n},callback(){const n=this.getSelectedRange(),e=Du(n,(i,s)=>this.getCellMeta(i,s).className),t="vertical",r="htBottom";this.runHooks("beforeCellAlignment",e,n,t,r),Tl(n,t,r,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1}]}}}const jC="clear_column";function Sne(){return{key:jC,name(){return this.getTranslatedPhrase(U0)},callback(n,e){const t=e[0].start.col,r=e[0].end.col;this.countRows()&&this.populateFromArray(0,t,[[null]],Math.max(e[0].start.row,e[0].end.row),r,"ContextMenu.clearColumn")},disabled(){const n=this.getSelectedRangeLast();return!n||n.isSingleHeader()&&n.highlight.col<0?!0:!this.selection.isSelectedByColumnHeader()}}}const Fg="col_left";function Rne(){return{key:Fg,name(){return this.getTranslatedPhrase(L0)},callback(){const n=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,n.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const n=this.getSelectedRangeLast();return!n||n.isSingleHeader()&&n.highlight.col<0?!0:this.selection.isSelectedByCorner()?this.countCols()===0:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const kg="col_right";function Ene(){return{key:kg,name(){return this.getTranslatedPhrase(H0)},callback(){const n=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,n.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const n=this.getSelectedRangeLast();return!n||n.isSingleHeader()&&n.highlight.col<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const Vg="make_read_only";function bne(){return{key:Vg,checkable:!0,ariaChecked(){return fm(this.getSelectedRange(),(e,t)=>this.getCellMeta(e,t).readOnly)},ariaLabel(){return this.getTranslatedPhrase(Gv)},name(){let n=this.getTranslatedPhrase(Gv);return fm(this.getSelectedRange(),(t,r)=>this.getCellMeta(t,r).readOnly)&&(n=Pa(n)),n},callback(){const n=this.getSelectedRange(),e=fm(n,(t,r)=>this.getCellMeta(t,r).readOnly);L(n,t=>{t.forAll((r,i)=>{r>=0&&i>=0&&this.setCellMeta(r,i,"readOnly",!e)})}),this.render()},disabled(){const n=this.getSelectedRangeLast();return!!(!n||n.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const zC="redo";function Tne(){return{key:zC,name(){return this.getTranslatedPhrase(V0)},callback(){this.redo()},hidden(){const n=this.getPlugin("undoRedo");return!n||!n.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const Ug="remove_col";function Ane(){return{key:Ug,name(){const n=this.getSelected();let e=0;if(n)if(n.length>1)e=1;else{const[,t,,r]=n[0];t-r!==0&&(e=1)}return this.getTranslatedPhrase(F0,e)},callback(){this.alter("remove_col",f7(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const n=this.getSelectedRangeLast();if(!n||n.isSingleHeader()&&n.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const YC="remove_row";function Nne(){return{key:YC,name(){const n=this.getSelected();let e=0;if(n)if(n.length>1)e=1;else{const[t,,r]=n[0];t-r!==0&&(e=1)}return this.getTranslatedPhrase(D0,e)},callback(){this.alter("remove_row",m7(this),1,"ContextMenu.removeRow")},disabled(){const n=this.getSelectedRangeLast();if(!n||n.isSingleHeader()&&n.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const KC="row_above";function Mne(){return{key:KC,name(){return this.getTranslatedPhrase(P0)},callback(){const n=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",n.row,1,"ContextMenu.rowAbove")},disabled(){const n=this.getSelectedRangeLast();return!n||n.isSingleHeader()&&n.highlight.row<0?!0:this.selection.isSelectedByCorner()?this.countRows()===0:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const qC="row_below";function Ine(){return{key:qC,name(){return this.getTranslatedPhrase(x0)},callback(){const n=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",n.row,1,"ContextMenu.rowBelow")},disabled(){const n=this.getSelectedRangeLast();return!n||n.isSingleHeader()&&n.highlight.row<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const Xm="no_items";function One(){return{key:Xm,name(){return this.getTranslatedPhrase(_0)},disabled:!0,isCommand:!1}}const XC="undo";function _ne(){return{key:XC,name(){return this.getTranslatedPhrase(k0)},callback(){this.undo()},hidden(){const n=this.getPlugin("undoRedo");return!n||!n.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const Pne=[KC,qC,Fg,kg,jC,YC,Ug,XC,zC,Vg,ss,ut,Xm],xne={[ut]:yne,[Xm]:One,[KC]:Mne,[qC]:Ine,[Fg]:Rne,[kg]:Ene,[jC]:Sne,[YC]:Nne,[Ug]:Ane,[XC]:_ne,[zC]:Tne,[Vg]:bne,[ss]:Cne};function eW(){const n={};return at(xne,(e,t)=>{n[t]=e()}),n}function Lne(n){return{key:"commentsAddEdit",name(){var e;const t=(e=this.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return t!=null&&t.isCell()&&n.getCommentAtCell(t.row,t.col)?this.getTranslatedPhrase(Q0):this.getTranslatedPhrase(X0)},callback(){const e=this.getSelectedRangeLast();n.setRange(e),n.show(),n.focusEditor()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function Hne(n){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(Z0)},callback(){this.getSelectedRangeLast().forAll((t,r)=>{t>=0&&r>=0&&n.removeCommentAtCell(t,r,!1)}),this.render()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function Dne(n){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(J0);return fm(this.getSelectedRange(),(r,i)=>n.getCommentMeta(r,i,av))?Pa(e):e},callback(){this.getSelectedRangeLast().forAll((t,r)=>{if(t>=0&&r>=0){const i=!!n.getCommentMeta(t,r,av);n.updateCommentMeta(t,r,{[av]:!i})}})},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!n.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function Fne(n,e){tW(n,e),e.add(n)}function pc(n,e,t){tW(n,e),e.set(n,t)}function tW(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kne(n,e,t){return(e=Vne(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Vne(n){var e=Une(n,"string");return typeof e=="symbol"?e:e+""}function Une(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function $l(n,e,t){return n.set(Ws(n,e),t),t}function pt(n,e){return n.get(Ws(n,e))}function Ws(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const mm="comments",Bne=60,xa="comment",Xf="value",nW="style",av="readOnly",zp=mm,XA=`plugin:${mm}`;var qt=new WeakMap,Fo=new WeakMap,QC=new WeakMap,lv=new WeakMap,QA=new WeakMap,oy=new WeakMap,Eo=new WeakSet;class Wne extends _t{constructor(){super(...arguments),Fne(this,Eo),kne(this,"range",{}),pc(this,qt,null),pc(this,Fo,null),pc(this,QC,!1),pc(this,lv,!1),pc(this,QA,null),pc(this,oy,"")}static get PLUGIN_KEY(){return mm}static get PLUGIN_PRIORITY(){return Bne}isEnabled(){return!!this.hot.getSettings()[mm]}enablePlugin(){var e=this;this.enabled||(pt(qt,this)||($l(qt,this,new mh(this.hot.rootDocument,this.hot.isRtl())),pt(qt,this).addLocalHook("resize",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Ws(Eo,e,qne).call(e,...r)})),pt(Fo,this)||$l(Fo,this,new JB(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",t=>this.addToContextMenu(t)),this.addHook("afterRenderer",(t,r,i,s,o,a)=>Ws(Eo,this,zne).call(this,t,a)),this.addHook("afterScroll",()=>Ws(Eo,this,Qne).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",t=>Ws(Eo,this,Xne).call(this,t)),pt(Fo,this).addLocalHook("hide",()=>this.hide()),pt(Fo,this).addLocalHook("show",(t,r)=>this.showAtCell(t,r)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){pt(Fo,this).updateDelay(this.getDisplayDelaySetting()),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),t=e.getContext("grid"),r=e.addContext(XA);t.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const i=this.hot.getSelectedRangeLast();$l(lv,this,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(i),this.show(),this.focusEditor(),e.setActiveContextName(XA),this.hot._registerTimeout(()=>{$l(lv,this,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var i;return((i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell())&&!pt(qt,this).isVisible()},group:zp}),r.addShortcut({keys:[["Escape"]],callback:()=>{pt(qt,this).setValue(pt(oy,this)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>pt(qt,this).isVisible()&&pt(qt,this).isFocused(),group:zp}),r.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>pt(qt,this).isVisible()&&pt(qt,this).isFocused(),group:zp})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(zp)}registerListeners(){const{rootDocument:e}=this.hot,t=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",r=>Ws(Eo,this,Gne).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>Ws(Eo,this,$ne).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>Ws(Eo,this,jne).call(this)),this.eventManager.addEventListener(t,"focus",()=>Ws(Eo,this,Kne).call(this)),this.eventManager.addEventListener(t,"blur",()=>Ws(Eo,this,Yne).call(this))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const t=nu(e.target,"TD","TBODY");return!!(t&&je(t,"htCommentCell")&&nu(t,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const t=pt(qt,this).getValue();let r="";e!=null?r=e:t!=null&&(r=t);const i=this.range.from.row,s=this.range.from.col;this.updateCommentMeta(i,s,{[Xf]:r}),this.hot.render()}setCommentAtCell(e,t,r){this.setRange({from:this.hot._createCellCoords(e,t)}),this.setComment(r)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,xa),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,t)}),this.removeComment(r)}getComment(){const e=this.range.from.row,t=this.range.from.col;return this.getCommentMeta(e,t,Xf)}getCommentAtCell(e,t){return this.getCommentMeta(e,t,Xf)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:t,col:r}}=this.range;if(t<0||t>this.hot.countSourceRows()-1||r<0||r>this.hot.countSourceCols()-1)return!1;const i=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return pt(Fo,this).cancelHiding(),pt(qt,this).setValue((e=i[xa]?i[xa][Xf]:null)!==null&&e!==void 0?e:""),pt(qt,this).show(),this.refreshEditor(!0),!0}showAtCell(e,t){return this.setRange({from:this.hot._createCellCoords(e,t)}),this.show()}hide(){pt(qt,this).hide()}refreshEditor(){var e,t;if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!pt(qt,this).isVisible()))return;const{rowIndexMapper:i,columnIndexMapper:s}=this.hot,{row:o,col:a}=this.range.from;let l=i.getRenderableFromVisualIndex(o),u=s.getRenderableFromVisualIndex(a);const h=l===null;pt(qt,this).setPosition(0,0),l===null&&(l=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(o,-1))),u===null&&(u=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(a,-1)));const c=l===null,d=u===null;l=(e=l)!==null&&e!==void 0?e:0,u=(t=u)!==null&&t!==void 0?t:0;const{rootWindow:f,view:{_wt:g}}=this.hot,{wtTable:p}=g,v=g.getCell({row:l,col:u},!0),y=this.getCommentMeta(o,a,nW);y?pt(qt,this).setSize(y.width,y.height):pt(qt,this).resetSize();const S=d?0:p.getStretchedColumnWidth(u),R=h&&!c?Dn(v):0,{left:A,top:O,width:V,height:B}=v.getBoundingClientRect(),{width:Y,height:q}=pt(qt,this).getSize(),{innerWidth:G,innerHeight:Z}=this.hot.rootWindow,ee=this.hot.rootDocument.documentElement;let ne=A+f.scrollX+S,re=O+f.scrollY+R;this.hot.isRtl()&&(ne-=Y+S),this.hot.isLtr()&&A+V+Y>G?ne=A+f.scrollX-Y-1:this.hot.isRtl()&&ne<-(ee.scrollWidth-ee.clientWidth)&&(ne=A+f.scrollX+S+1),O+q>Z&&(re-=q-B+1),pt(qt,this).setPosition(ne,re),pt(qt,this).setReadOnlyState(this.getCommentMeta(o,a,av)),pt(qt,this).observeSize()}focusEditor(){pt(qt,this).focus()}updateCommentMeta(e,t,r){const i=this.hot.getCellMeta(e,t)[xa];let s;i?(s=Gr(i),Ig(s,r)):s=r,this.hot.setCellMeta(e,t,xa,s)}getCommentMeta(e,t,r){const i=this.hot.getCellMeta(e,t);if(i[xa])return i[xa][r]}addToContextMenu(e){e.items.push({name:ut},Lne(this),Hne(this),Dne(this))}getDisplayDelaySetting(){const e=this.hot.getSettings()[mm];if(ot(e))return e.displayDelay}getEditorInputElement(){return pt(qt,this).getInputElement()}destroy(){var e,t;(e=pt(qt,this))===null||e===void 0||e.destroy(),(t=pt(Fo,this))===null||t===void 0||t.destroy(),super.destroy()}}function $ne(n){if(!(!this.hot.view||!this.hot.view._wt)&&!pt(QC,this)&&!this.targetIsCommentTextArea(n)){const e=nu(n.target,"TD","TBODY");let t=null;e&&(t=this.hot.getCoords(e)),(!e||this.range.from&&t&&(this.range.from.row!==t.row||this.range.from.col!==t.col))&&this.hide()}}function Gne(n){const{rootDocument:e}=this.hot;if(!(pt(QC,this)||pt(qt,this).isFocused()||je(n.target,"wtBorder")||pt(QA,this)===n.target||!pt(qt,this)))if($l(QA,this,e.elementFromPoint(n.clientX,n.clientY)),this.targetIsCellWithComment(n)){const t=this.hot._createCellRange(this.hot.getCoords(n.target));pt(Fo,this).show(t)}else ql(n.target,e)&&!this.targetIsCommentTextArea(n)&&pt(Fo,this).hide()}function jne(){$l(QC,this,!1)}function zne(n,e){e[xa]&&e[xa][Xf]&&ie(n,e.commentedCellClassName)}function Yne(){$l(oy,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function Kne(){$l(oy,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(XA)}function qne(n,e){this.updateCommentMeta(this.range.from.row,this.range.from.col,{[nW]:{width:n,height:e}})}function Xne(n){pt(qt,this).isVisible()&&Ns(n)}function Qne(){pt(lv,this)||this.hide()}var fH={},kb,mH;function Zne(){if(mH)return kb;mH=1;var n=iC(),e=TypeError;return kb=function(t,r){if(!delete t[r])throw new e("Cannot delete property "+n(r)+" of "+n(t))},kb}var gH;function Jne(){if(gH)return fH;gH=1;var n=Ir(),e=wg(),t=Cg(),r=Nk(),i=Zne(),s=Mk(),o=[].unshift(0)!==1,a=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(u){return u instanceof TypeError}},l=o||!a();return n({target:"Array",proto:!0,arity:1,forced:l},{unshift:function(h){var c=e(this),d=t(c),f=arguments.length;if(f){s(d+f);for(var g=d;g--;){var p=g+f;g in c?c[p]=c[g]:i(c,p)}for(var v=0;v<f;v++)c[v]=arguments[v]}return r(c,d+f)}}),fH}Jne();function Vb(n,e,t){return(e=ere(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function ere(n){var e=tre(n,"string");return typeof e=="symbol"?e:e+""}function tre(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class rW{constructor(e){Vb(this,"hot",void 0),Vb(this,"commands",{}),Vb(this,"commonCallback",null),this.hot=e}registerCommand(e,t){this.commands[e]=t}setCommonCallback(e){this.commonCallback=e}execute(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];const s=e.split(":"),o=s[0],a=s.length===2?s[1]:null;let l=this.commands[o];if(!l)throw new Error(`Menu command '${o}' not exists.`);if(a&&l.submenu&&(l=nre(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||pn(l,"submenu"))return;const u=[];typeof l.callback=="function"&&u.push(l.callback),typeof this.commonCallback=="function"&&u.push(this.commonCallback),r.unshift(s.join(":")),L(u,h=>h.apply(this.hot,r))}}function nre(n,e){let t;return L(e,r=>{const i=r.key?r.key.split(":"):null;if(Array.isArray(i)&&i[1]===n)return t=r,!1}),t}function Ub(n,e,t){return(e=rre(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function rre(n){var e=ire(n,"string");return typeof e=="symbol"?e:e+""}function ire(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class iW{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;Ub(this,"hot",void 0),Ub(this,"predefinedItems",eW()),Ub(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=t}setPredefinedItems(e){const t={};this.defaultOrderPattern.length=0,at(e,(r,i)=>{let s="";r.name===ut?(t[ut]=r,s=ut):isNaN(parseInt(i,10))?(r.key=r.key===void 0?i:r.key,t[i]=r,s=r.key):(t[r.key]=r,s=r.key),this.defaultOrderPattern.push(s)}),this.predefinedItems=t}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return sre(e,this.defaultOrderPattern,this.predefinedItems)}}function sre(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=[];let i=n;return i&&i.items?i=i.items:Array.isArray(i)||(i=e),ot(i)?at(i,(s,o)=>{let a=t[typeof s=="string"?s:o];a||(a=s),ot(s)?Gn(a,s):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=o),r.push(a)}):L(i,(s,o)=>{let a=t[s];!a&&Pne.indexOf(s)>=0||(a||(a={name:s,key:`${o}`}),ot(s)&&Gn(a,s),a.key===void 0&&(a.key=o),r.push(a))}),r}function fl(n,e,t){return(e=ore(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function ore(n){var e=are(n,"string");return typeof e=="symbol"?e:e+""}function are(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class lre{constructor(e,t){fl(this,"top",void 0),fl(this,"topRelative",void 0),fl(this,"left",void 0),fl(this,"leftRelative",void 0),fl(this,"scrollTop",void 0),fl(this,"scrollLeft",void 0),fl(this,"cellHeight",void 0),fl(this,"cellWidth",void 0);const r=t.scrollY,i=t.scrollX;let s,o,a,l,u,h;this.rootWindow=t,this.type=this.getSourceType(e),this.type==="literal"?(s=parseInt(e.top,10),a=parseInt(e.left,10),u=e.height||0,h=e.width||0,o=s,l=a,s+=r,a+=i):this.type==="event"&&(s=parseInt(e.pageY,10),a=parseInt(e.pageX,10),u=e.target.clientHeight,h=e.target.clientWidth,o=s-r,l=a-i),this.top=s,this.topRelative=o,this.left=a,this.leftRelative=l,this.scrollTop=r,this.scrollLeft=i,this.cellHeight=u,this.cellWidth=h}getSourceType(e){let t="literal";return e instanceof Event&&(t="event"),t}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=t}fitsOnRight(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=t}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function Sf(n,e,t){ure(n,e),e.set(n,t)}function ure(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yt(n,e){return n.get(sW(n,e))}function Yp(n,e,t){return n.set(sW(n,e),t),t}function sW(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Yr=new WeakMap,ml=new WeakMap,li=new WeakMap,Bb=new WeakMap,wc=new WeakMap;class hre{constructor(e){Sf(this,Yr,void 0),Sf(this,ml,void 0),Sf(this,li,void 0),Sf(this,Bb,!1),Sf(this,wc,{above:0,below:0,left:0,right:0}),Yp(Bb,this,e)}setOffset(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return yt(wc,this)[e]=t,this}setElement(e){return Yp(Yr,this,e),this}setParentElement(e){return Yp(ml,this,e),this}updatePosition(e){Yp(li,this,new lre(e,yt(Yr,this).ownerDocument.defaultView)),yt(Bb,this)?(yt(li,this).fitsBelow(yt(Yr,this))?this.setPositionBelowCursor():yt(li,this).fitsAbove(yt(Yr,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){yt(Yr,this).dir==="rtl"?yt(li,this).fitsOnLeft(yt(Yr,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():yt(li,this).fitsOnRight(yt(Yr,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=yt(wc,this).above+yt(li,this).top-yt(Yr,this).offsetHeight;yt(ml,this)&&(e=yt(li,this).top+yt(li,this).cellHeight-yt(Yr,this).offsetHeight+3),yt(Yr,this).style.top=`${e}px`}setPositionBelowCursor(){let e=yt(wc,this).below+yt(li,this).top+1;yt(ml,this)&&(e=yt(li,this).top-1),yt(Yr,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=yt(li,this).left;if(yt(ml,this)){const t=Number.parseInt(getComputedStyle(yt(ml,this).querySelector(".htCore")).borderRightWidth,10);e+=yt(li,this).cellWidth+t}else e+=yt(wc,this).right;yt(Yr,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=yt(wc,this).left+yt(li,this).left-yt(Yr,this).offsetWidth;if(yt(ml,this)){const t=Number.parseInt(getComputedStyle(yt(ml,this).querySelector(".htCore")).borderLeftWidth,10);e-=t}yt(Yr,this).style.left=`${e}px`}}function oW(n){let{initialPage:e=-1,size:t=()=>0,onItemSelect:r=()=>{},onClear:i=()=>{}}=n;const s=new Set;let o=Vt(e,-1,g()-1);function a(v,y){const S=g()-1;return v<0&&(v=S),v>S&&(v=0),s.has(v)?-1:(s.add(v),r(v,!1)===!1&&(v=a(y===1?++v:--v,y)),v)}function l(v){v>-1&&v<g()&&r(v,!0)!==!1&&(o=v)}function u(){return o}function h(){g()>0&&(s.clear(),o=a(0,1))}function c(){g()>0&&(s.clear(),o=a(g()-1,-1))}function d(){g()>0&&(s.clear(),o=a(++o,1))}function f(){g()>0&&(s.clear(),o=a(--o,-1))}function g(){return Math.max(t(),0)}function p(){s.clear(),o=e,i()}return{setCurrentPage:l,getCurrentPage:u,toFirstItem:h,toLastItem:c,toNextItem:d,toPreviousItem:f,getSize:g,clear:p}}function cre(n){return wt(n,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function ZA(n){return pn(n,"submenu")}function JA(n){return new RegExp(ut,"i").test(n.name)}function uv(n,e){return n.disabled===!0||typeof n.disabled=="function"&&n.disabled.call(e)===!0}function pH(n){return pn(n,"disableSelection")}function dre(n){return je(n,"htSeparator")}function fre(n){return je(n,"htSubmenu")}function mre(n){return je(n,"htDisabled")}function gre(n){return je(n,"htSelectionDisabled")}function pre(n,e){return!n.hidden||!(typeof n.hidden=="function"&&n.hidden.call(e))}function aW(n,e){const t=n.slice(0);for(let r=0;r<t.length&&t[r].name===e;)t.shift();return t}function wre(n,e){let t=n.slice(0);return t.reverse(),t=aW(t,e),t.reverse(),t}function vre(n){const e=[];return L(n,(t,r)=>{r>0?e[e.length-1].name!==t.name&&e.push(t):e.push(t)}),e}function yre(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ut,t=n.slice(0);return t=aW(t,e),t=wre(t,e),t=vre(t),t}function Cre(n){return n.checkable===!0}function Sre(n){return oW({size:()=>n.countRows(),onItemSelect(e,t){const r=n.getCell(e,0);if(!r||dre(r)||mre(r)||gre(r))return!1;n.selectCell(e,0,...t?[e,0,!1,!1]:[])},onClear(){n.deselectCell()}})}function Rre(n){const{hot:e,hotMenu:t}=n;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>n.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(r,i)=>{const s=e.getSettings(),o=typeof s.tabMoves=="function"?s.tabMoves(r):s.tabMoves;i.includes("shift")?e.selection.transformStart(-o.row,-o.col):e.selection.transformStart(o.row,o.col),n.close(!0)}},{keys:[["Escape"]],callback:()=>n.close()},{keys:[["ArrowDown"]],callback:()=>n.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>n.getNavigator().toPreviousItem()},{keys:[["ArrowRight"]],callback:()=>{const r=t.getSelectedLast();if(r){const i=n.openSubMenu(r[0]);i&&i.getNavigator().toFirstItem()}}},{keys:[["ArrowLeft"]],callback:()=>{t.getSelectedLast()&&n.isSubMenu()&&(n.close(),n.isSubMenu()&&n.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>n.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>n.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:r=>{const i=t.getSelectedLast();i&&(t.getSourceDataAtRow(i[0]).submenu?n.openSubMenu(i[0]).getNavigator().toFirstItem():(n.executeCommand(r),n.close(!0)))}},{keys:[["PageUp"]],callback:()=>{t.getSelectedLast()?t.selection.transformStart(-t.countVisibleRows(),0):n.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{t.getSelectedLast()?t.selection.transformStart(t.countVisibleRows(),0):n.getNavigator().toLastItem()}}]}const lW="menu",wH=lW;function Ere(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const t=[];r(Rre(n)),e.forEach(u=>{let{shortcuts:h,contextName:c}=u;i(h,c)});function r(u,h){a(h).addShortcuts(u,{group:lW})}function i(u,h){const c=a(h);u.forEach(d=>{let{keys:f}=d;f.forEach(g=>c.removeShortcutsByKeys(g))}),t.push({shortcuts:u,contextName:h}),r(u,h)}function s(){return[...t]}function o(u){return u?`${wH}:${u}`:wH}function a(u){var h;const c=n.hotMenu.getShortcutManager(),d=o(u);return(h=c.getContext(d))!==null&&h!==void 0?h:c.addContext(d)}function l(u){n.hotMenu.getShortcutManager().setActiveContextName(o(u))}return{addCustomShortcuts:i,getCustomShortcuts:s,getContext:a,listen:l}}function bre(n){return(e,t,r,i,s,o)=>{const a=e.getSourceDataAtRow(r),l=n.rootDocument.createElement("div"),u=typeof o=="function"?o.call(n):o,h=typeof a.ariaLabel=="function"?a.ariaLabel.call(n):a.ariaLabel,c=typeof a.ariaChecked=="function"?a.ariaChecked.call(n):a.ariaChecked;if(so(t),ie(l,"htItemWrapper"),n.getSettings().ariaTags){const d=!uv(a,n)&&!pH(a)&&!JA(a);Ge(t,[...Cre(a)?[T4(),kv(h),kV(c)]:[b4(),kv(u)],...d?[_d(-1)]:[],...uv(a,n)?[P4()]:[],...ZA(a)?[gs(!1)]:[]])}t.className="",t.appendChild(l),JA(a)?ie(t,"htSeparator"):typeof a.renderer=="function"?(ie(t,"htCustomMenuRenderer"),t.appendChild(a.renderer(e,l,r,i,s,u))):jh(l,u),uv(a,n)?ie(t,"htDisabled"):pH(a)?ie(t,"htSelectionDisabled"):ZA(a)&&ie(t,"htSubmenu")}}function Wb(n,e,t){Tre(n,e),e.set(n,t)}function Tre(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bo(n,e,t){return(e=Are(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Are(n){var e=Nre(n,"string");return typeof e=="symbol"?e:e+""}function Nre(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function $b(n,e,t){return n.set(uW(n,e),t),t}function Fu(n,e){return n.get(uW(n,e))}function uW(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const vH=215;var Rf=new WeakMap,Kp=new WeakMap,qp=new WeakMap;class Fd{get tableBorderWidth(){return Fu(qp,this)===void 0&&this.hotMenu&&$b(qp,this,parseInt(ra(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),Fu(qp,this)}constructor(e,t){var r=this;bo(this,"hot",void 0),bo(this,"options",void 0),bo(this,"eventManager",new ys(this)),bo(this,"container",void 0),bo(this,"positioner",void 0),bo(this,"hotMenu",null),bo(this,"hotSubMenus",{}),bo(this,"parentMenu",void 0),bo(this,"menuItems",null),bo(this,"origOutsideClickDeselects",null),Wb(this,Rf,void 0),Wb(this,Kp,void 0),Wb(this,qp,void 0),this.hot=e,this.options=t||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:vH,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new hre(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.parentMenu.runLocalHooks("afterSelectionChange",...s)})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",t=>this.onDocumentMouseDown(t)),this.eventManager.addEventListener(e.document,"touchstart",t=>this.onDocumentMouseDown(t)),this.eventManager.addEventListener(e.document,"contextmenu",t=>this.onDocumentContextMenu(t)),e=Eh(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return Fu(Rf,this)}getKeyboardShortcutsCtrl(){return Fu(Kp,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=TC(a=>this.openSubMenu(a),300),t=this.options.minWidth||vH;let r=!1,i=Za(this.menuItems,a=>(a.key===Xm&&(r=!0),pre(a,this.hot)));if(i.length<1&&!r)i.push(eW()[Xm]);else if(i.length===0)return;i=yre(i,ut);let s=!1;const o={data:i,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(a){return Ne(a)&&a<t?t:a},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:bre(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,beforeOnCellMouseOver:(a,l)=>{Fu(Rf,this).setCurrentPage(l.row)},afterOnCellMouseOver:(a,l)=>{this.isAllSubMenusClosed()?e(l.row):this.openSubMenu(l.row)},rowHeights:a=>i[a].name===ut?1:void 0,afterOnCellContextMenu:a=>{a.preventDefault(),_A()&&s&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,l,u,h,c)=>{this.hotMenu.view.isMouseDown()&&(c.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(s=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!_A()||!iu(a))&&s&&this.hasSelectedItem()&&(Ba()||QM()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,o),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),$b(Rf,this,Sre(this.hotMenu)),$b(Kp,this,Ere(this)),Fu(Kp,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(Fu(Rf,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const t=this.parentMenu.hotMenu.getSelectedLast();if(t){const r=this.parentMenu.hotMenu.getCell(t[0],0);Ge(r,[gs(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const t=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!t||!fre(t))return!1;const r=this.hotMenu.getSourceDataAtRow(e),i=new Fd(this.hot,{parent:this,name:r.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(r.submenu.items),i.open(),i.setPosition(t.getBoundingClientRect()),this.hotSubMenus[r.key]=i,this.hot.getSettings().ariaTags&&Ge(t,[gs(!0)]),i}closeSubMenu(e){const t=this.hotMenu.getSourceDataAtRow(e),r=this.hotSubMenus[t.key];if(r){r.destroy(),delete this.hotSubMenus[t.key];const i=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&Ge(i,[gs(!1)])}}closeAllSubMenus(){L(this.hotMenu.getData(),(e,t)=>this.closeSubMenu(t))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const t=this.getSelectedItem();if(this.runLocalHooks("select",t,e),this.isCommandPassive(t))return;const r=this.hot.getSelectedRange(),i=r?cre(r):[];this.runLocalHooks("executeCommand",t.key,i,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",t.key,i,e)}isCommandPassive(e){return e.isCommand===!1||JA(e)||uv(e,this.hot)||ZA(e)}setOffset(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,t)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}updateMenuDimensions(){const{wtTable:e}=this.hotMenu.view._wt,t=this.hotMenu.getSettings().data,r=e.hider.style,i=e.holder.style,s=parseInt(r.width,10),o=jn(t,(a,l,u)=>{const c=this.hotMenu.getCell(u,0)?Dn(this.hotMenu.getCell(u,0)):0;return a+(l.name===ut?1:c)},0);i.width=`${s+3}px`,i.height=`${o+3}px`,r.height=i.height}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const t=this.options.container.ownerDocument;let r=e,i;return r&&(Jt(r)&&(r=r.call(this.hot),r===null||nn(r)?r="":r=r.toString()),r=r.replace(/[^A-z0-9]/g,"_"),r=`${this.options.className}Sub_${r}`,i=t.querySelector(`.${this.options.className}.${r}`)),i||(i=t.createElement("div"),ie(i,`htMenu ${this.options.className}`),r&&ie(i,r),this.options.container.appendChild(i)),i}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&Ge(this.hotMenu.rootElement,[E4(),_d(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!ql(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!ql(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&je(e.target,"htCore")&&ql(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}Wt(Fd,Or);function Mre(n,e){Ire(n,e),e.add(n)}function Ire(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Gb(n,e,t){return(e=Ore(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Ore(n){var e=_re(n,"string");return typeof e=="symbol"?e:e+""}function _re(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Xp(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const Qf="contextMenu",Pre=70,yH=Qf;be.getSingleton().register("afterContextMenuDefaultOptions");be.getSingleton().register("beforeContextMenuShow");be.getSingleton().register("afterContextMenuShow");be.getSingleton().register("afterContextMenuHide");be.getSingleton().register("afterContextMenuExecute");var Ef=new WeakSet;class ZC extends _t{constructor(){super(...arguments),Mre(this,Ef),Gb(this,"commandExecutor",new rW(this.hot)),Gb(this,"itemsFactory",null),Gb(this,"menu",null)}static get PLUGIN_KEY(){return Qf}static get PLUGIN_PRIORITY(){return Pre}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[KC,qC,ut,Fg,kg,ut,YC,Ug,ut,XC,zC,ut,Vg,ut,ss]}isEnabled(){return!!this.hot.getSettings()[Qf]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[Qf];typeof t.callback=="function"&&this.commandExecutor.setCommonCallback(t.callback),this.menu=new Fd(this.hot,{className:"htContextMenu",keepInViewport:!0,container:t.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>Xp(Ef,this,Lre).call(this)),this.menu.addLocalHook("afterOpen",()=>Xp(Ef,this,Hre).call(this)),this.menu.addLocalHook("afterClose",()=>Xp(Ef,this,Dre).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return e.executeCommand.call(e,...i)}),this.addHook("afterOnCellContextMenu",r=>Xp(Ef,this,xre).call(this,r)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const t=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),r=GC(this.menu.container,this.hot.rootDocument);this.open({left:t.left+r.left,top:t.top+r.top-1+t.height},{left:t.width,above:-t.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const t=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return t&&this.hot.selection.isCellVisible(t)&&!this.menu.isOpened()},group:yH})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(yH)}open(e){var t;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};if((t=this.menu)!==null&&t!==void 0&&t.isOpened())return;this.prepareMenuItems(),this.menu.open(),this.menu.tableBorderWidth>0||(r.below+=1,r.right+=1,r.above-=1,r.left-=1),at(r,(s,o)=>{this.menu.setOffset(o,s)}),this.menu.setPosition(e)}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}prepareMenuItems(){this.itemsFactory=new iW(this.hot,ZC.DEFAULT_ITEMS);const e=this.hot.getSettings()[Qf],t={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",t),this.itemsFactory.setPredefinedItems(t.items);const r=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",r),this.menu.setMenuItems(r),L(r,i=>this.commandExecutor.registerCommand(i.key,i))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function xre(n){const e=this.hot.getSettings(),t=e.rowHeaders,r=e.colHeaders;function i(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const s=n.target;if(this.close(),je(s,"handsontableInput")||(n.preventDefault(),n.stopPropagation(),!(t||r)&&!i(s)&&!(je(s,"current")&&je(s,"wtBorder"))))return;const o=GC(this.menu.container,this.hot.rootDocument);this.open({top:n.clientY+o.top,left:n.clientX+o.left})}function Lre(){this.hot.runHooks("beforeContextMenuShow",this)}function Hre(){this.hot.runHooks("afterContextMenuShow",this)}function Dre(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}ZC.SEPARATOR={name:ut};function Fre(n){return{key:"copy",name(){return this.getTranslatedPhrase(B0)},callback(){n.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}function kre(n){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),t=e?Vt(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(G0,t)},callback(){n.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}function Vre(n){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),t=e?Vt(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase($0,t)},callback(){n.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}function Ure(n){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),t=e?Vt(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(W0,t)},callback(){n.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}function Bre(n){return{key:"cut",name(){return this.getTranslatedPhrase(j0)},callback(){n.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}class Wre{constructor(){this.data={}}setData(e,t){this.data[e]=t}getData(e){return this.data[e]||void 0}}class $re{constructor(){this.clipboardData=new Wre}preventDefault(){}}function Gre(n,e){hW(n,e),e.add(n)}function vc(n,e,t){hW(n,e),e.set(n,t)}function hW(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xr(n,e){return n.get(Zc(n,e))}function yc(n,e,t){return n.set(Zc(n,e),t),t}function Zc(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var gl=new WeakMap,jb=new WeakMap,bf=new WeakMap,eN=new WeakMap,tN=new WeakMap,Tf=new WeakMap,Af=new WeakSet;class jre{constructor(e){let{countRows:t,countColumns:r,rowsLimit:i,columnsLimit:s,countColumnHeaders:o}=e;Gre(this,Af),vc(this,gl,void 0),vc(this,jb,void 0),vc(this,bf,void 0),vc(this,eN,void 0),vc(this,tN,void 0),vc(this,Tf,void 0),yc(jb,this,t),yc(bf,this,r),yc(eN,this,i),yc(tN,this,s),yc(Tf,this,o)}setSelectedRange(e){yc(gl,this,e)}getCellsRange(){if(Xr(jb,this).call(this)===0||Xr(bf,this).call(this)===0)return null;const{row:e,col:t}=Xr(gl,this).getTopStartCorner(),{row:r,col:i}=Xr(gl,this).getBottomEndCorner(),s=Zc(Af,this,zre).call(this,e,r),o=Zc(Af,this,zb).call(this,t,i);return{isRangeTrimmed:r!==s||i!==o,startRow:e,startCol:t,endRow:s,endCol:o}}getMostBottomColumnHeadersRange(){if(Xr(bf,this).call(this)===0||Xr(Tf,this).call(this)===0)return null;const{col:e}=Xr(gl,this).getTopStartCorner(),{col:t}=Xr(gl,this).getBottomEndCorner(),r=Zc(Af,this,zb).call(this,e,t);return{isRangeTrimmed:t!==r,startRow:-1,startCol:e,endRow:-1,endCol:r}}getAllColumnHeadersRange(){if(Xr(bf,this).call(this)===0||Xr(Tf,this).call(this)===0)return null;const{col:e}=Xr(gl,this).getTopStartCorner(),{col:t}=Xr(gl,this).getBottomEndCorner(),r=Zc(Af,this,zb).call(this,e,t);return{isRangeTrimmed:t!==r,startRow:-Xr(Tf,this).call(this),startCol:e,endRow:-1,endCol:r}}}function zb(n,e){return Math.min(e,Math.max(n+Xr(tN,this).call(this)-1,n))}function zre(n,e){return Math.min(e,Math.max(n+Xr(eN,this).call(this)-1,n))}function cW(n){const e=[],t=[];return L(n,r=>{const i=Math.min(r.startRow,r.endRow),s=Math.max(r.startRow,r.endRow);Pe(i,s,l=>{e.indexOf(l)===-1&&e.push(l)});const o=Math.min(r.startCol,r.endCol),a=Math.max(r.startCol,r.endCol);Pe(o,a,l=>{t.indexOf(l)===-1&&t.push(l)})}),{rows:e,columns:t}}function Yre(n,e){dW(n,e),e.add(n)}function pl(n,e,t){dW(n,e),e.set(n,t)}function dW(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Nf(n,e,t){return(e=Kre(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Kre(n){var e=qre(n,"string");return typeof e=="symbol"?e:e+""}function qre(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function gi(n,e){return n.get(pi(n,e))}function Bs(n,e,t){return n.set(pi(n,e),t),t}function pi(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}be.getSingleton().register("afterCopyLimit");be.getSingleton().register("modifyCopyableRange");be.getSingleton().register("beforeCut");be.getSingleton().register("afterCut");be.getSingleton().register("beforePaste");be.getSingleton().register("afterPaste");be.getSingleton().register("beforeCopy");be.getSingleton().register("afterCopy");const Qp="copyPaste",Xre=80,Qre=["fragmentSelection"],CH=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var nN=new WeakMap,rN=new WeakMap,iN=new WeakMap,Cc=new WeakMap,Zp=new WeakMap,Jp=new WeakMap,Sc=new WeakMap,ay=new WeakMap,Li=new WeakSet;class Zre extends _t{constructor(){super(...arguments),Yre(this,Li),Nf(this,"columnsLimit",1/0),Nf(this,"rowsLimit",1/0),Nf(this,"pasteMode","overwrite"),Nf(this,"uiContainer",this.hot.rootDocument.body),pl(this,nN,!1),pl(this,rN,!1),pl(this,iN,!1),pl(this,Cc,"cells-only"),pl(this,Zp,!1),pl(this,Jp,!1),pl(this,Sc,new jre({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),pl(this,ay,!1),Nf(this,"copyableRanges",[])}static get PLUGIN_KEY(){return Qp}static get SETTING_KEYS(){return[Qp,...Qre]}static get PLUGIN_PRIORITY(){return Xre}isEnabled(){return!!this.hot.getSettings()[Qp]}enablePlugin(){var e=this;if(this.enabled)return;const{[Qp]:t}=this.hot.getSettings();if(typeof t=="object"){var r,i;this.pasteMode=(r=t.pasteMode)!==null&&r!==void 0?r:this.pasteMode,this.rowsLimit=isNaN(t.rowsLimit)?this.rowsLimit:t.rowsLimit,this.columnsLimit=isNaN(t.columnsLimit)?this.columnsLimit:t.columnsLimit,Bs(nN,this,!!t.copyColumnHeaders),Bs(rN,this,!!t.copyColumnGroupHeaders),Bs(iN,this,!!t.copyColumnHeadersOnly),this.uiContainer=(i=t.uiContainer)!==null&&i!==void 0?i:this.uiContainer}this.addHook("afterContextMenuDefaultOptions",s=>pi(Li,this,tie).call(this,s)),this.addHook("afterSelection",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return pi(Li,e,nie).call(e,...o)}),this.addHook("afterSelectionEnd",()=>pi(Li,this,rie).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return e.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return e.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return e.onPaste(...arguments)}),qM()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return pi(Li,e,iie).call(e,...o)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return pi(Li,e,sie).call(e,...o)}),this.addHook("afterSelection",()=>pi(Li,this,oie).call(this))),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";Bs(Cc,this,e),Bs(Zp,this,!0),pi(Li,this,SH).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){Bs(Jp,this,!0),pi(Li,this,SH).call(this,"cut")}getRangedCopyableData(e){return hm(this.getRangedData(e))}getRangedData(e){const t=[],{rows:r,columns:i}=cW(e);return L(r,s=>{const o=[];L(i,a=>{s<0?o.push(this.hot.getColHeader(a,s)):o.push(this.hot.getCopyableData(s,a))}),t.push(o)}),t}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!t)return;const r=new $re;e&&r.clipboardData.setData("text/plain",e),t&&r.clipboardData.setData("text/html",t),this.onPaste(r)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}gi(Sc,this).setSelectedRange(e);const t=new Map([["headers",null],["cells",null]]);gi(Cc,this)==="column-headers-only"?t.set("headers",gi(Sc,this).getMostBottomColumnHeadersRange()):(gi(Cc,this)==="with-column-headers"?t.set("headers",gi(Sc,this).getMostBottomColumnHeadersRange()):gi(Cc,this)==="with-column-group-headers"&&t.set("headers",gi(Sc,this).getAllColumnHeadersRange()),t.set("cells",gi(Sc,this).getCellsRange())),this.copyableRanges=Array.from(t.values()).filter(i=>i!==null).map(i=>{let{startRow:s,startCol:o,endRow:a,endCol:l}=i;return{startRow:s,startCol:o,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const r=t.get("cells");if(r!==null&&r.isRangeTrimmed){const{startRow:i,startCol:s,endRow:o,endCol:a}=r;this.hot.runHooks("afterCopyLimit",o-i+1,a-s+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const r=e.length,i=e[0].length,s=[],{row:o,col:a}=t.getTopStartCorner(),{row:l,col:u}=t.getBottomEndCorner();let h=o,c=a,d=o,f=a;for(;s.length<r||h<=l;){const{skipRowOnPaste:g,visualRow:p}=this.hot.getCellMeta(h,a);if(h=p+1,g===!0)continue;d=p,c=a;const v=[],y=s.length%r;for(;v.length<i||c<=u;){const{skipColumnOnPaste:S,visualCol:R}=this.hot.getCellMeta(o,c);if(c=R+1,S===!0)continue;f=R;const A=v.length%i;v.push(e[y][A])}s.push(v)}return Bs(ay,this,!0),this.hot.populateFromArray(o,a,s,void 0,void 0,"CopyPaste.paste",this.pasteMode),[o,a,d,f]}onCopy(e){var t,r;const i=this.hot.getFocusManager().getRefocusElement(),s=(t=e.target)===null||t===void 0?void 0:t.hasAttribute("data-hot-input"),o=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight,a=o?this.hot.getCell(o.row,o.col,!0):null;if(!this.hot.isListening()&&!gi(Zp,this)||this.isEditorOpened()||e.target instanceof HTMLElement&&(s&&e.target!==i||!s&&e.target!==this.hot.rootDocument.body&&a!==e.target))return;e.preventDefault(),this.setCopyableText(),Bs(Zp,this,!1);const l=this.getRangedData(this.copyableRanges),u=pi(Li,this,Jre).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",l,this.copyableRanges,u)){const c=hm(l);if(e&&e.clipboardData){const d=HA(l,this.hot.rootDocument);e.clipboardData.setData("text/plain",c),e.clipboardData.setData("text/html",[CH,d].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",c);this.hot.runHooks("afterCopy",l,this.copyableRanges,u)}Bs(Cc,this,"cells-only")}onCut(e){var t,r;const i=this.hot.getFocusManager().getRefocusElement(),s=(t=e.target)===null||t===void 0?void 0:t.hasAttribute("data-hot-input"),o=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight,a=o?this.hot.getCell(o.row,o.col,!0):null;if(!this.hot.isListening()&&!gi(Jp,this)||this.isEditorOpened()||e.target instanceof HTMLElement&&(s&&e.target!==i||!s&&e.target!==this.hot.rootDocument.body&&a!==e.target))return;e.preventDefault(),this.setCopyableText(),Bs(Jp,this,!1);const l=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",l,this.copyableRanges)){const h=hm(l);if(e&&e.clipboardData){const c=HA(l,this.hot.rootDocument);e.clipboardData.setData("text/plain",h),e.clipboardData.setData("text/html",[CH,c].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",h);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",l,this.copyableRanges)}}onPaste(e){var t,r;const i=this.hot.getFocusManager().getRefocusElement(),s=(t=e.target)===null||t===void 0?void 0:t.hasAttribute("data-hot-input"),o=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight,a=o?this.hot.getCell(o.row,o.col,!0):null;if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||e.target instanceof HTMLElement&&(s&&e.target!==i||!s&&e.target!==this.hot.rootDocument.body&&a!==e.target))return;e.preventDefault();let l;if(e&&typeof e.clipboardData<"u"){const f=yC(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});f&&/(<table)|(<TABLE)/g.test(f)?l=vU(f,this.hot.rootDocument).data:l=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(l=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof l=="string"&&(l=y7(l)),l===void 0||l&&l.length===0||this.hot.runHooks("beforePaste",l,this.copyableRanges)===!1)return;const[u,h,c,d]=this.populateValues(l);this.hot.selectCell(u,h,Math.min(this.hot.countRows()-1,c),Math.min(this.hot.countCols()-1,d)),this.hot.runHooks("afterPaste",l,this.copyableRanges)}destroy(){super.destroy()}}function SH(n){if(qM()){const e=this.hot.getSelectedRangeLast();if(e){const{row:t,col:r}=e.highlight,i=this.hot.getCell(t,r,!0);i&&ZV(i,()=>{this.hot.rootDocument.execCommand(n)})}}else this.hot.rootDocument.execCommand(n)}function Jre(n){const{rows:e}=cW(n);let t=0;for(let r=0;r<e.length&&!(e[r]>=0);r++)t+=1;return{columnHeadersCount:t}}function eie(){if(this.hot.isListening()){const n=this.hot.getSelectedRangeLast();if(n){const{row:e,col:t}=n.highlight,r=this.hot.getCell(e,t,!0);r&&GM(r)}}}function fW(){if(this.hot.isListening()){const n=this.hot.getSelectedRangeLast();if(n){const{row:e,col:t}=n.highlight,r=this.hot.getCell(e,t,!0);r!=null&&r.hasAttribute("contenteditable")&&jM(r)}}}function tie(n){n.items.push({name:"---------"},Fre(this)),gi(nN,this)&&n.items.push(Ure(this)),gi(rN,this)&&n.items.push(Vre(this)),gi(iN,this)&&n.items.push(kre(this)),n.items.push(Bre(this))}function nie(n,e,t,r,i){gi(ay,this)&&(i.value=!0),Bs(ay,this,!1)}function rie(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function iie(){pi(Li,this,fW).call(this)}function sie(){pi(Li,this,eie).call(this)}function oie(){pi(Li,this,fW).call(this)}function mW(n,e){return`border_row${n}col${e}`}function Zf(){return{width:1,color:"#000"}}function Wa(){return{hide:!0}}function aie(){return{width:1,color:"#000",cornerVisible:!1}}function Yb(n){if(Ne(n.start)||Ne(n.left)){var e;n.start=(e=n.start)!==null&&e!==void 0?e:n.left}if(Ne(n.end)||Ne(n.right)){var t;n.end=(t=n.end)!==null&&t!==void 0?t:n.right}return delete n.left,delete n.right,n}function Mf(n){return Ne(n.start)&&(n.left=n.start),Ne(n.end)&&(n.right=n.end),n}function Kb(n,e){return{id:mW(n,e),border:aie(),row:n,col:e,top:Wa(),bottom:Wa(),start:Wa(),end:Wa()}}function lie(n,e){return pn(e,"border")&&e.border&&(n.border=e.border),pn(e,"top")&&Ne(e.top)&&(e.top?(ot(e.top)||(e.top=Zf()),n.top=e.top):(e.top=Wa(),n.top=e.top)),pn(e,"bottom")&&Ne(e.bottom)&&(e.bottom?(ot(e.bottom)||(e.bottom=Zf()),n.bottom=e.bottom):(e.bottom=Wa(),n.bottom=e.bottom)),pn(e,"start")&&Ne(e.start)&&(e.start?(ot(e.start)||(e.start=Zf()),n.start=e.start):(e.start=Wa(),n.start=e.start)),pn(e,"end")&&Ne(e.end)&&(e.end?(ot(e.end)||(e.end=Zf()),n.end=e.end):(e.end=Wa(),n.end=e.end)),n}function Ja(n,e){let t=!1;return L(n.getSelectedRange(),r=>{r.forAll((i,s)=>{if(i<0||s<0)return;const o=n.getCellMeta(i,s).borders;if(o)if(e){if(!pn(o[e],"hide")||o[e].hide===!1)return t=!0,!1}else return t=!0,!1})}),t}function JC(n){return`<span class="selected">â</span>${n}`}function uie(n){return n.some(e=>Ne(e.left)||Ne(e.right))}function hie(n){return n.some(e=>Ne(e.start)||Ne(e.end))}const cie=new Map([["left","start"],["right","end"]]);function die(n){var e;return(e=cie.get(n))!==null&&e!==void 0?e:n}function fie(n){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(iI);return Ja(this,"bottom")&&(e=JC(e)),e},callback(e,t){const r=Ja(this,"bottom");n.prepareBorder(t,"bottom",r)}}}function mie(n){const e=n.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let t=this.getTranslatedPhrase(sI);return Ja(this,e)&&(t=JC(t)),t},callback(t,r){const i=Ja(this,e);n.prepareBorder(r,e,i)}}}function gie(n){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(oI)},callback(e,t){n.prepareBorder(t,"noBorders")},disabled(){return!Ja(this)}}}function pie(n){const e=n.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let t=this.getTranslatedPhrase(rI);return Ja(this,e)&&(t=JC(t)),t},callback(t,r){const i=Ja(this,e);n.prepareBorder(r,e,i)}}}function wie(n){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(nI);return Ja(this,"top")&&(e=JC(e)),e},callback(e,t){const r=Ja(this,"top");n.prepareBorder(t,"top",r)}}}function vie(n,e){yie(n,e),e.add(n)}function yie(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Cie(n,e,t){return(e=Sie(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Sie(n){var e=Rie(n,"string");return typeof e=="symbol"?e:e+""}function Rie(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function RH(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const hv="customBorders",Eie=90;var qb=new WeakSet;class bie extends _t{constructor(){super(...arguments),vie(this,qb),Cie(this,"savedBorders",[])}static get PLUGIN_KEY(){return hv}static get PLUGIN_PRIORITY(){return Eie}isEnabled(){return!!this.hot.getSettings()[hv]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>RH(qb,this,Tie).call(this,e)),this.addHook("init",()=>RH(qb,this,Aie).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,t){let r=["top","bottom","start","end"],i=null;t&&(this.checkSettingsCohesion([t]),r=Object.keys(t),i=Yb(t));const s=Cd(e),o=Km(s,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});L(e,a=>{o(a).forAll((l,u)=>{L(r,h=>{this.prepareBorderFromCustomAdded(l,u,i,die(h))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const t=Cd(e),r=Km(t,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),i=[];return L(e,s=>{r(s).forAll((o,a)=>{L(this.savedBorders,l=>{l.row===o&&l.col===a&&i.push(Mf(l))})})}),i}clearBorders(e){e?this.setBorders(e):(L(this.savedBorders,t=>{this.clearBordersFromSelectionSettings(t.id),this.clearNullCellRange(),this.hot.removeCellMeta(t.row,t.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,t){this.checkSavedBorders(e)||this.savedBorders.push(e);const i=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,i,t)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:i})}prepareBorderFromCustomAdded(e,t,r,i){const s=this.hot.countRows(),o=this.hot.countCols();if(e>=s||t>=o)return;let a=Kb(e,t);r&&(a=lie(a,r),L(this.hot.selection.highlight.customSelections,l=>{if(a.id===l.settings.id)return Object.assign(l.settings,r),a.id=l.settings.id,a.top=l.settings.top,a.bottom=l.settings.bottom,a.start=l.settings.start,a.end=l.settings.end,!1})),this.hot.setCellMeta(e,t,"borders",Mf(a)),this.insertBorderIntoSettings(a,i)}prepareBorderFromCustomAddedRange(e,t){const r=Math.min(e.to.row,this.hot.countRows()-1),i=Math.min(e.to.col,this.hot.countCols()-1);Pe(e.from.row,r,s=>{Pe(e.from.col,i,o=>{const a=Kb(s,o);let l=0;s===e.from.row&&pn(t,"top")&&(l+=1,a.top=t.top),s===e.to.row&&pn(t,"bottom")&&(l+=1,a.bottom=t.bottom),o===e.from.col&&pn(t,"start")&&(l+=1,a.start=t.start),o===e.to.col&&pn(t,"end")&&(l+=1,a.end=t.end),l>0&&(this.hot.setCellMeta(s,o,"borders",Mf(a)),this.insertBorderIntoSettings(a))})})}removeAllBorders(e,t){const r=mW(e,t);this.spliceBorder(r),this.clearBordersFromSelectionSettings(r),this.clearNullCellRange(),this.hot.removeCellMeta(e,t,"borders")}setBorder(e,t,r,i){let s=this.hot.getCellMeta(e,t).borders;!s||s.border===void 0?s=Kb(e,t):s=Yb(s),i?(s[r]=Wa(),this.countHide(s)===4?this.removeAllBorders(e,t):(this.checkCustomSelectionsFromContextMenu(s,r,i)||this.insertBorderIntoSettings(s),this.hot.setCellMeta(e,t,"borders",Mf(s)))):(s[r]=Zf(),this.checkCustomSelectionsFromContextMenu(s,r,i)||this.insertBorderIntoSettings(s),this.hot.setCellMeta(e,t,"borders",Mf(s)))}prepareBorder(e,t,r){L(e,i=>{let{start:s,end:o}=i;if(s.row===o.row&&s.col===o.col)t==="noBorders"?this.removeAllBorders(s.row,s.col):this.setBorder(s.row,s.col,t,r);else switch(t){case"noBorders":Pe(s.col,o.col,a=>{Pe(s.row,o.row,l=>{this.removeAllBorders(l,a)})});break;case"top":Pe(s.col,o.col,a=>{this.setBorder(s.row,a,t,r)});break;case"bottom":Pe(s.col,o.col,a=>{this.setBorder(o.row,a,t,r)});break;case"start":Pe(s.row,o.row,a=>{this.setBorder(a,s.col,t,r)});break;case"end":Pe(s.row,o.row,a=>{this.setBorder(a,o.col,t,r)});break}})}createCustomBorders(e){L(e,t=>{const r=Yb(t);t.range?this.prepareBorderFromCustomAddedRange(t.range,r):this.prepareBorderFromCustomAdded(t.row,t.col,r)})}countHide(e){const{top:t,bottom:r,start:i,end:s}=e;return jn([t,r,i,s],(a,l)=>{let u=a;return l&&l.hide&&(u+=1),u},0)}clearBordersFromSelectionSettings(e){const t=wt(this.hot.selection.highlight.customSelections,r=>r.settings.id).indexOf(e);t>-1&&this.hot.selection.highlight.customSelections[t].clear()}clearNullCellRange(){L(this.hot.selection.highlight.customSelections,(e,t)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[t].destroy(),this.hot.selection.highlight.customSelections.splice(t,1),!1})}hideBorders(){L(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const t=wt(this.savedBorders,r=>r.id).indexOf(e);t>-1&&this.savedBorders.splice(t,1)}checkSavedBorders(e){let t=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),t=!0):L(this.savedBorders,(i,s)=>{if(e.id===i.id)return this.savedBorders[s]=e,t=!0,!1}),t}checkCustomSelectionsFromContextMenu(e,t,r){let i=!1;return L(this.hot.selection.highlight.customSelections,s=>{if(e.id===s.settings.id){const o=this.hot.view._wt.selectionManager.getBorderInstances(s);return L(o,a=>{a.toggleHiddenClass(t,r)}),i=!0,!1}}),i}checkCustomSelections(e,t,r){const i=this.countHide(e);let s=!1;return i===4?(this.removeAllBorders(e.row,e.col),s=!0):L(this.hot.selection.highlight.customSelections,o=>{if(e.id===o.settings.id){if(o.visualCellRange=t,o.commit(),r){const a=this.hot.view._wt.selectionManager.getBorderInstances(o);L(a,l=>{l.changeBorderStyle(r,e)})}return s=!0,!1}}),s}changeBorderSettings(){const e=this.hot.getSettings()[hv];if(Array.isArray(e)){const t=Gr(e);this.checkSettingsCohesion(t),t.length||(this.savedBorders=t),this.createCustomBorders(t)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const t=uie(e),r=hie(e);if(t&&r)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&t)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function Tie(n){this.hot.getSettings()[hv]&&n.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(tI)},disabled(){const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[wie(this),pie(this),fie(this),mie(this),gie(this)]}})}function Aie(){this.changeBorderSettings()}function Nie(n,e){Mie(n,e),e.add(n)}function Mie(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xb(n,e,t){return(e=Iie(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Iie(n){var e=Oie(n,"string");return typeof e=="symbol"?e:e+""}function Oie(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function EH(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const bH="dragToScroll",_ie=100;var Qb=new WeakSet;class Pie extends _t{constructor(){super(...arguments),Nie(this,Qb),Xb(this,"boundaries",null),Xb(this,"callback",null),Xb(this,"listening",!1)}static get PLUGIN_KEY(){return bH}static get PLUGIN_PRIORITY(){return _ie}isEnabled(){return!!this.hot.getSettings()[bH]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>EH(Qb,this,TH).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>EH(Qb,this,TH).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=e}setCallback(e){this.callback=e}check(e,t){let r=0,i=0;t<this.boundaries.top?i=t-this.boundaries.top:t>this.boundaries.bottom&&(i=t-this.boundaries.bottom),e<this.boundaries.left?r=e-this.boundaries.left:e>this.boundaries.right&&(r=e-this.boundaries.right),this.callback(r,i)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let t=e;for(;t;)this.eventManager.addEventListener(t.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(t.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(t.document,"mousemove",r=>this.onMouseMove(r)),t=Eh(t)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function TH(n){if(iu(n))return;const e=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(e!==this.hot.rootWindow?e.getBoundingClientRect():void 0),this.setCallback((t,r)=>{var i,s;const o=(i=e.scrollLeft)!==null&&i!==void 0?i:e.scrollX,a=(s=e.scrollTop)!==null&&s!==void 0?s:e.scrollY;e.scroll(o+Math.sign(t)*50,a+Math.sign(r)*20)}),this.listen()}function xie(n,e){gW(n,e),e.add(n)}function Lie(n,e,t){gW(n,e),e.set(n,t)}function gW(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zb(n,e,t){return(e=Hie(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Hie(n){var e=Die(n,"string");return typeof e=="symbol"?e:e+""}function Die(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Fie(n,e){return n.get(os(n,e))}function pW(n,e,t){return n.set(os(n,e),t),t}function os(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}be.getSingleton().register("afterDropdownMenuDefaultOptions");be.getSingleton().register("beforeDropdownMenuShow");be.getSingleton().register("afterDropdownMenuShow");be.getSingleton().register("afterDropdownMenuHide");be.getSingleton().register("afterDropdownMenuExecute");const cv="dropdownMenu",kie=230,Qm="changeType",Jb=cv;var eS=new WeakMap,$s=new WeakSet;class tS extends _t{static get PLUGIN_KEY(){return cv}static get PLUGIN_PRIORITY(){return kie}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[Fg,kg,ut,Ug,ut,jC,ut,Vg,ut,ss]}constructor(e){super(e),xie(this,$s),Zb(this,"commandExecutor",new rW(this.hot)),Zb(this,"itemsFactory",null),Zb(this,"menu",null),Lie(this,eS,!1),this.hot.addHook("afterGetColHeader",(t,r)=>os($s,this,Uie).call(this,t,r))}isEnabled(){return this.hot.getSettings()[cv]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new iW(this.hot,tS.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return os($s,e,zie).call(e,...s)}),this.addHook("beforeViewportScrollHorizontally",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return os($s,e,jie).call(e,...s)});const t=this.hot.getSettings()[cv],r={items:this.itemsFactory.getItems(t)};this.registerEvents(),typeof t.callback=="function"&&this.commandExecutor.setCommonCallback(t.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);const i=this.itemsFactory.getItems(t);this.menu&&this.menu.destroy(),this.menu=new Fd(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:t.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",i),this.menu.setMenuItems(i),this.menu.addLocalHook("beforeOpen",()=>os($s,this,Bie).call(this)),this.menu.addLocalHook("afterOpen",()=>os($s,this,Wie).call(this)),this.menu.addLocalHook("afterSubmenuOpen",s=>os($s,this,$ie).call(this,s)),this.menu.addLocalHook("afterClose",()=>os($s,this,Gie).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return e.executeCommand.call(e,...o)}),L(i,s=>this.commandExecutor.registerCommand(s.key,s))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),t=()=>{const{highlight:r}=this.hot.getSelectedRangeLast();if((r.isHeader()&&r.row===-1||r.isCell())&&r.col>=0){this.hot.selectColumns(r.col,r.col,-1);const{from:i}=this.hot.getSelectedRangeLast(),s=GC(this.menu.container,this.hot.rootDocument),o=this.hot.getCell(-1,i.col,!0).querySelector(`.${Qm}`),a=o.getBoundingClientRect();this.open({left:a.left+s.left,top:a.top+o.offsetHeight+s.top},{left:a.width,right:0,above:0,below:3}),this.menu.getNavigator().toFirstItem()}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:t,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:Jb},{keys:[["Shift","Alt","ArrowDown"]],callback:t,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isCell()&&!this.menu.isOpened()},group:Jb}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Jb)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>os($s,this,Vie).call(this,e))}open(e){var t;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(t=this.menu)!==null&&t!==void 0&&t.isOpened()||(this.menu.open(),at(r,(i,s)=>{this.menu.setOffset(s,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function wW(n){n.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function Vie(n){if(je(n.target,Qm)){const e=GC(this.menu.container,this.hot.rootDocument),t=n.target.getBoundingClientRect();n.stopPropagation(),pW(eS,this,!1),this.open({left:t.left+e.left,top:t.top+n.target.offsetHeight+e.top},{left:t.width,right:0,above:0,below:3})}}function Uie(n,e){const t=e.parentNode;if(!t)return;const r=t.parentNode.childNodes,i=Array.prototype.indexOf.call(r,t);if(n<0||i!==r.length-1)return;const s=e.querySelector(`.${Qm}`);if(this.enabled&&s)return;if(!this.enabled){s&&s.parentNode.removeChild(s);return}const o=this.hot.rootDocument.createElement("button");o.className=Qm,o.type="button",o.tabIndex=-1,this.hot.getSettings().ariaTags&&(Ge(o,[$h(),kv(" ")]),Ge(e,[HV("menu")])),o.onclick=function(){return!1},e.firstChild.insertBefore(o,e.firstChild.firstChild)}function Bie(){this.hot.runHooks("beforeDropdownMenuShow",this)}function Wie(){this.hot.runHooks("afterDropdownMenuShow",this),os($s,this,wW).call(this,this.menu)}function $ie(n){os($s,this,wW).call(this,n)}function Gie(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function jie(n){return Fie(eS,this)?null:n}function zie(n){je(n.target,Qm)&&pW(eS,this,!0)}tS.SEPARATOR={name:ut};function AH(n,e,t){return(e=Yie(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Yie(n){var e=Kie(n,"string");return typeof e=="symbol"?e:e+""}function Kie(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class qie{constructor(e){AH(this,"hot",void 0),AH(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:t,endRow:r,endCol:i}=this._getDataRange(),s=this.options,o=[];return Pe(e,r,a=>{const l=[];!s.exportHiddenRows&&this._isHiddenRow(a)||(Pe(t,i,u=>{!s.exportHiddenColumns&&this._isHiddenColumn(u)||l.push(this.hot.getDataAtCell(a,u))}),o.push(l))}),o}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:t,endRow:r}=this._getDataRange(),i=this.hot.getRowHeader();Pe(t,r,s=>{!this.options.exportHiddenRows&&this._isHiddenRow(s)||e.push(i[s])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:t,endCol:r}=this._getDataRange(),i=this.hot.getColHeader();Pe(t,r,s=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(s)||e.push(i[s])})}return e}_getDataRange(){const e=this.hot.countCols()-1,t=this.hot.countRows()-1;let[r=0,i=0,s=t,o=e]=this.options.range;return r=Math.max(r,0),i=Math.max(i,0),s=Math.min(s,t),o=Math.min(o,e),{startRow:r,startCol:i,endRow:s,endCol:o}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}function NH(n,e,t){return(e=Xie(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Xie(n){var e=Qie(n,"string");return typeof e=="symbol"?e:e+""}function Qie(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class pO{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,t){NH(this,"dataProvider",void 0),NH(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(t),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let t=oo(this.constructor.DEFAULT_OPTIONS);const r=new Date;return t=Gn(oo(pO.DEFAULT_OPTIONS),t),t=Gn(t,e),t.filename=HM(t.filename,{YYYY:r.getFullYear(),MM:`${r.getMonth()+1}`.padStart(2,"0"),DD:`${r.getDate()}`.padStart(2,"0")}),t}}const Zie="\r",Jie='"',ese=`
`;class tse extends pO{static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}export(){const e=this.options,t=this.dataProvider.getData();let r=this.dataProvider.getColumnHeaders();const i=r.length>0,s=this.dataProvider.getRowHeaders(),o=s.length>0;let a=e.bom?"\uFEFF":"";return i&&(r=wt(r,l=>this._escapeCell(l,!0)),o&&(a+=e.columnDelimiter),a+=r.join(e.columnDelimiter),a+=e.rowDelimiter),L(t,(l,u)=>{u>0&&(a+=e.rowDelimiter),o&&(a+=this._escapeCell(s[u])+e.columnDelimiter),a+=l.map(h=>this._escapeCell(h)).join(e.columnDelimiter)}),a}_escapeCell(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=Tn(e);return r!==""&&(t||r.indexOf(Zie)>=0||r.indexOf(Jie)>=0||r.indexOf(ese)>=0||r.indexOf(this.options.columnDelimiter)>=0)&&(r=r.replace(new RegExp('"',"g"),'""'),r=`"${r}"`),r}}const nse="csv",sN={[nse]:tse};function rse(n,e,t){return typeof sN[n]=="function"?new sN[n](e,t):null}const ise="exportFile",sse=240;class ose extends _t{static get PLUGIN_KEY(){return ise}static get PLUGIN_PRIORITY(){return sse}isEnabled(){return!0}exportAsString(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,t).export()}exportAsBlob(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,t))}downloadFile(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:r,rootWindow:i}=this.hot,s=this._createTypeFormatter(e,t),o=this._createBlob(s),a=i.URL||i.webkitURL,l=r.createElement("a"),u=`${s.options.filename}.${s.options.fileExtension}`;if(l.download!==void 0){const h=a.createObjectURL(o);l.style.display="none",l.setAttribute("href",h),l.setAttribute("download",u),r.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),r.body.removeChild(l),setTimeout(()=>{a.revokeObjectURL(h)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(o,u)}_createTypeFormatter(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!sN[e])throw new Error(`Export format type "${e}" is not supported.`);return rse(e,new qie(this.hot),t)}_createBlob(e){let t=null;return typeof Blob<"u"&&(t=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),t}}function Rc(n,e,t){return(e=ase(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function ase(n){var e=lse(n,"string");return typeof e=="symbol"?e:e+""}function lse(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Bg{constructor(e,t){let{id:r,stateless:i=!0}=t;Rc(this,"hot",void 0),Rc(this,"id",void 0),Rc(this,"elements",[]),Rc(this,"hidden",!1),Rc(this,"stateId",""),Rc(this,"state",void 0),this.hot=e,this.id=r,this.stateId=`Filters.component.${this.id}`,this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new DC)}getElements(){return this.elements}reset(){L(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),L(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}Wt(Bg,Or);const Zm={};function su(n,e){if(!Zm[n])throw Error(`Filter condition "${n}" does not exist.`);const{condition:t,descriptor:r}=Zm[n];let i=e;return r.inputValuesDecorator&&(i=r.inputValuesDecorator(i)),function(s){return t.apply(s.meta.instance,[].concat([s],[i]))}}function gh(n){if(!Zm[n])throw Error(`Filter condition "${n}" does not exist.`);return Zm[n].descriptor}function zn(n,e,t){t.key=n,Zm[n]={condition:e,descriptor:t}}const mr="none";function use(){return!0}zn(mr,use,{name:FC,inputsCount:0,showOperators:!1});const gm="empty";function hse(n){return An(n.value)}zn(gm,hse,{name:fI,inputsCount:0,showOperators:!0});const dv="not_empty";function cse(n,e){return!su(gm,e)(n)}zn(dv,cse,{name:mI,inputsCount:0,showOperators:!0});const pm="eq";function dse(n,e){let[t]=e;return Tn(n.value).toLocaleLowerCase(n.meta.locale)===Tn(t)}zn(pm,dse,{name:gI,inputsCount:1,showOperators:!0});const fv="neq";function fse(n,e){return!su(pm,e)(n)}zn(fv,fse,{name:pI,inputsCount:1,showOperators:!0});const vW="gt";function mse(n,e){let[t]=e,r=t;return n.meta.type==="numeric"&&(r=parseFloat(r,10)),n.value>r}zn(vW,mse,{name:SI,inputsCount:1,showOperators:!0});const yW="gte";function gse(n,e){let[t]=e,r=t;return n.meta.type==="numeric"&&(r=parseFloat(r,10)),n.value>=r}zn(yW,gse,{name:RI,inputsCount:1,showOperators:!0});const CW="lt";function pse(n,e){let[t]=e,r=t;return n.meta.type==="numeric"&&(r=parseFloat(r,10)),n.value<r}zn(CW,pse,{name:EI,inputsCount:1,showOperators:!0});const SW="lte";function wse(n,e){let[t]=e,r=t;return n.meta.type==="numeric"&&(r=parseFloat(r,10)),n.value<=r}zn(SW,wse,{name:bI,inputsCount:1,showOperators:!0});const wO="date_after";function vse(n,e){let[t]=e;const r=se(n.value,n.meta.dateFormat),i=se(t,n.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)>=0}zn(wO,vse,{name:NI,inputsCount:1,showOperators:!0});const vO="date_before";function yse(n,e){let[t]=e;const r=se(n.value,n.meta.dateFormat),i=se(t,n.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)<=0}zn(vO,yse,{name:MI,inputsCount:1,showOperators:!0});const ly="between";function Cse(n,e){let[t,r]=e,i=t,s=r;if(n.meta.type==="numeric"){const o=parseFloat(i,10),a=parseFloat(s,10);i=Math.min(o,a),s=Math.max(o,a)}else if(n.meta.type==="date"){const o=su(vO,[s]),a=su(wO,[i]);return o(n)&&a(n)}return n.value>=i&&n.value<=s}zn(ly,Cse,{name:TI,inputsCount:2,showOperators:!0});const RW="not_between";function Sse(n,e){return!su(ly,e)(n)}zn(RW,Sse,{name:AI,inputsCount:2,showOperators:!0});const EW="begins_with";function Rse(n,e){let[t]=e;return Tn(n.value).toLocaleLowerCase(n.meta.locale).startsWith(Tn(t))}zn(EW,Rse,{name:wI,inputsCount:1,showOperators:!0});const bW="ends_with";function Ese(n,e){let[t]=e;return Tn(n.value).toLocaleLowerCase(n.meta.locale).endsWith(Tn(t))}zn(bW,Ese,{name:vI,inputsCount:1,showOperators:!0});const yO="contains";function bse(n,e){let[t]=e;return Tn(n.value).toLocaleLowerCase(n.meta.locale).indexOf(Tn(t))>=0}zn(yO,bse,{name:yI,inputsCount:1,showOperators:!0});const TW="not_contains";function Tse(n,e){return!su(yO,e)(n)}zn(TW,Tse,{name:CI,inputsCount:1,showOperators:!0});const AW="date_tomorrow";function Ase(n){const e=se(n.value,n.meta.dateFormat);return e.isValid()?e.isSame(se().subtract(-1,"days").startOf("day"),"d"):!1}zn(AW,Ase,{name:OI,inputsCount:0});const NW="date_today";function Nse(n){const e=se(n.value,n.meta.dateFormat);return e.isValid()?e.isSame(se().startOf("day"),"d"):!1}zn(NW,Nse,{name:II,inputsCount:0});const MW="date_yesterday";function Mse(n){const e=se(n.value,n.meta.dateFormat);return e.isValid()?e.isSame(se().subtract(1,"days").startOf("day"),"d"):!1}zn(MW,Mse,{name:_I,inputsCount:0});rU();function Ise(n,e){let t=n;return t===""&&(t=`(${e})`),t}const oN=new Set([1]).has(1),Ose=oN&&typeof Array.from=="function";function Wg(n){let e=n;return oN&&(e=new Set(e)),function(t){let r;return oN?r=e.has(t):r=!!~e.indexOf(t),r}}function IW(n){return n??""}function aN(n){let e=n;return Ose?e=Array.from(new Set(e)):e=PM(e),e=e.sort((t,r)=>typeof t=="number"&&typeof r=="number"?t-r:t===r?0:t>r?1:-1),e}function MH(n,e,t,r){const i=[],s=n===e;let o;return s||(o=Wg(e)),L(n,a=>{let l=!1;(s||o(a))&&(l=!0);const u={checked:l,value:a,visualValue:Ise(a,t)};r&&r(u),i.push(u)}),i}const ph="by_value";function _se(n,e){let[t]=e;return t(n.value)}zn(ph,_se,{name:"By value",inputsCount:0,inputValuesDecorator(n){let[e]=n;return[Wg(e)]},showOperators:!1});const Jm={};function Pse(n){if(!Jm[n])throw Error(`Operation with id "${n}" does not exist.`);const e=Jm[n].func;return function(t,r){return e(t,r)}}function xse(n){return Jm[n].name}function CO(n,e,t){Jm[n]={name:e,func:t}}const Ql="conjunction",Lse=LI;function Hse(n,e){return n.every(t=>t.func(e))}CO(Ql,Lse,Hse);const uy="disjunction",Dse=kC;function Fse(n,e){return n.some(t=>t.func(e))}CO(uy,Dse,Fse);const SO="disjunctionWithExtraCondition",kse=kC;function Vse(n,e){if(n.length<3)throw Error("Operation doesn't work on less then three conditions.");return n.slice(0,n.length-1).some(t=>t.func(e))&&n[n.length-1].func(e)}CO(SO,kse,Vse);const Use="numeric",OW="text",Bse="date",IH={[Use]:[mr,ut,gm,dv,ut,pm,fv,ut,vW,yW,CW,SW,ly,RW],[OW]:[mr,ut,gm,dv,ut,pm,fv,ut,EW,bW,ut,yO,TW],[Bse]:[mr,ut,gm,dv,ut,pm,fv,ut,vO,wO,ly,ut,AW,NW,MW]};function Wse(n){const e=[];let t=n;return IH[t]||(t=OW),L(IH[t],r=>{let i;r===ut?i={name:ut}:i=oo(gh(r)),e.push(i)}),e}function If(n,e,t){return(e=$se(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function $se(n){var e=Gse(n,"string");return typeof e=="symbol"?e:e+""}function Gse(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const eT="built",tT="building",OH=["click","input","keydown","keypress","keyup","focus","blur","change"];let to=class _W{static get DEFAULTS(){return oo({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,t){If(this,"hot",void 0),If(this,"eventManager",new ys(this)),If(this,"options",void 0),If(this,"_element",void 0),If(this,"buildState",void 0),this.hot=e,this.options=Gn(_W.DEFAULTS,t),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===tT?this._element:this.buildState===eT?(this.update(),this._element):(this.buildState=tT,this.build(),this.buildState=eT,this._element)}isBuilt(){return this.buildState===eT}translateIfPossible(e){return typeof e=="string"&&e.startsWith(ri)?this.hot.getTranslatedPhrase(e):e}build(){const e=(t,r)=>{this.eventManager.addEventListener(t,r,i=>this.runLocalHooks(r,i,this))};if(this.buildState||(this.buildState=tT),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&ie(this._element,this.options.className),this.options.children.length)L(this.options.children,t=>this._element.appendChild(t.element));else if(this.options.wrapIt){const t=this.hot.rootDocument.createElement(this.options.tagName);t.setAttribute("data-hot-input",!0),at(this.options,(r,i)=>{t[i]!==void 0&&i!=="className"&&i!=="tagName"&&i!=="children"&&(t[i]=this.translateIfPossible(r))}),this._element.appendChild(t),L(OH,r=>e(t,r))}else L(OH,t=>e(this._element,t))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};Wt(to,Or);function jse(n,e){PW(n,e),e.add(n)}function zse(n,e,t){PW(n,e),e.set(n,t)}function PW(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ew(n,e){return n.get(RO(n,e))}function Yse(n,e,t){return n.set(RO(n,e),t),t}function RO(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Ec=new WeakMap,_H=new WeakSet;class Zl extends to{static get DEFAULTS(){return oo({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,t){super(e,Gn(Zl.DEFAULTS,t)),jse(this,_H),zse(this,Ec,void 0),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>RO(_H,this,Kse).call(this,e))}build(){super.build();const e=this.hot.rootDocument.createElement("div");Yse(Ec,this,this._element.firstChild),ie(this._element,"htUIInput"),ie(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(ew(Ec,this).type=this.options.type,ew(Ec,this).placeholder=this.translateIfPossible(this.options.placeholder),ew(Ec,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&ew(Ec,this).focus()}}function Kse(n){this.options.value=n.target.value}function qse(n,e){xW(n,e),e.add(n)}function Of(n,e,t){xW(n,e),e.set(n,t)}function xW(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bc(n,e,t){return n.set(wm(n,e),t),t}function vn(n,e){return n.get(wm(n,e))}function wm(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var er=new WeakMap,tw=new WeakMap,nw=new WeakMap,nT=new WeakMap,rw=new WeakMap,iw=new WeakSet;class eg extends to{static get DEFAULTS(){return oo({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,t){super(e,Gn(eg.DEFAULTS,t)),qse(this,iw),Of(this,er,null),Of(this,tw,[]),Of(this,nw,void 0),Of(this,nT,void 0),Of(this,rw,void 0),this.registerHooks()}getMenu(){return vn(er,this)}registerHooks(){this.addLocalHook("click",()=>wm(iw,this,Zse).call(this))}setItems(e){bc(tw,this,this.translateNames(e)),vn(er,this)&&vn(er,this).setMenuItems(vn(tw,this))}translateNames(e){return L(e,t=>{t.name=this.translateIfPossible(t.name)}),e}build(){super.build(),bc(er,this,new Fd(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),vn(er,this).setMenuItems(vn(tw,this));const e=new to(this.hot,{className:"htUISelectCaption"}),t=new to(this.hot,{className:"htUISelectDropdown"});bc(nw,this,e),bc(nT,this,e.element),bc(rw,this,t),this.hot.getSettings().ariaTags&&(Ge(t.element,[$h()]),Ge(this._element,[LV()])),L([e,t],r=>this._element.appendChild(r.element)),vn(er,this).addLocalHook("select",r=>wm(iw,this,Xse).call(this,r)),vn(er,this).addLocalHook("afterClose",()=>wm(iw,this,Qse).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=vn(er,this).hot.getTranslatedPhrase(FC),vn(nT,this).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();vn(er,this)&&(vn(er,this).open(),vn(er,this).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),vn(er,this).getNavigator().toFirstItem(),vn(er,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:t=>{this.closeOptions(),this.runLocalHooks("tabKeydown",t)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){vn(er,this)&&vn(er,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){vn(er,this)&&(vn(er,this).destroy(),bc(er,this,null)),vn(nw,this)&&vn(nw,this).destroy(),vn(rw,this)&&vn(rw,this).destroy(),super.destroy()}}function Xse(n){n.name!==ut&&(this.options.value=n,this.update(),this.runLocalHooks("select",this.options.value))}function Qse(){this.runLocalHooks("afterClose")}function Zse(){this.openOptions()}function Jse(n,e){eoe(n,e),e.add(n)}function eoe(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function PH(n,e,t){return(e=toe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function toe(n){var e=noe(n,"string");return typeof e=="symbol"?e:e+""}function noe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function xH(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var rT=new WeakSet;class lN extends Bg{constructor(e,t){super(e,{id:t.id,stateless:!1}),Jse(this,rT),PH(this,"name",""),PH(this,"addSeparator",!1),this.name=t.name,this.addSeparator=t.addSeparator,this.elements.push(new eg(this.hot,{menuContainer:t.menuContainer})),this.elements.push(new Zl(this.hot,{placeholder:UI})),this.elements.push(new Zl(this.hot,{placeholder:BI})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>xH(rT,this,roe).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),L(this.getInputElements(),e=>{e.addLocalHook("keydown",t=>xH(rT,this,ioe).call(this,t))})}setState(e){if(this.reset(),!e)return;const t=oo(e.command);t.name.startsWith(Mn)&&(t.name=this.hot.getTranslatedPhrase(t.name)),this.getSelectElement().setValue(t),L(e.args,(r,i)=>{if(i>t.inputsCount-1)return!1;const s=this.getInputElement(i);s.setValue(r),s[t.inputsCount>i?"show":"hide"](),i||this.hot._registerTimeout(()=>s.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||gh(mr),t=[];return L(this.getInputElements(),(r,i)=>{e.inputsCount>i&&t.push(r.getValue())}),{command:e,args:t}}updateState(e,t){const r=gh(e?e.name:mr);this.state.setValueAtIndex(t,{command:r,args:e?e.args:[]}),e||L(this.getInputElements(),i=>i.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof eg)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof Zl)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t,r,i,s,o)=>{ie(t.parentNode,"htFiltersMenuCondition"),this.addSeparator&&ie(t.parentNode,"border");const a=this.hot.rootDocument.createElement("div");return ie(a,"htFiltersMenuLabel"),a.textContent=o,t.appendChild(a),t.parentElement.hasAttribute("ghost-table")||L(this.elements,l=>t.appendChild(l.element)),t}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let t=[gh(mr)];if(e!==null){const{visualIndex:r}=e;t=Wse(this.hot.getDataType(0,r,this.hot.countRows(),r))}L(this.getInputElements(),r=>r.hide()),this.getSelectElement().setItems(t),super.reset(),this.getSelectElement().setValue(t[0])}}function roe(n){L(this.getInputElements(),(e,t)=>{e[n.inputsCount>t?"show":"hide"](),t===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",n)}function ioe(n){xd(n.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Ns(n))}function LH(n,e,t){soe(n,e),e.set(n,t)}function soe(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _f(n,e){return n.get(LW(n,e))}function HH(n,e,t){return n.set(LW(n,e),t),t}function LW(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Tc=new WeakMap,iT=new WeakMap;class hy extends to{static get DEFAULTS(){return oo({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,t){super(e,Gn(hy.DEFAULTS,t)),LH(this,Tc,void 0),LH(this,iT,void 0)}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),HH(iT,this,e),HH(Tc,this,this._element.firstChild),_f(Tc,this).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(_f(iT,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return this.isBuilt()?_f(Tc,this).checked:!1}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(_f(Tc,this).checked=e)}focus(){this.isBuilt()&&_f(Tc,this).focus()}}function ooe(n,e){aoe(n,e),e.add(n)}function aoe(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function loe(n,e,t){return(e=uoe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function uoe(n){var e=hoe(n,"string");return typeof e=="symbol"?e:e+""}function hoe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function coe(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const DH=0;var FH=new WeakSet;class doe extends Bg{constructor(e,t){super(e,{id:t.id,stateless:!1}),ooe(this,FH),loe(this,"name",""),this.name=t.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t)=>(ie(t.parentNode,"htFiltersMenuOperators"),L(this.elements,r=>t.appendChild(r.element)),t)}}buildOperatorsElement(){const e=[Ql,uy];L(e,t=>{const r=new hy(this.hot,{name:"operator",label:{htmlFor:t,textContent:xse(t)},value:t,checked:t===e[DH],id:t});r.addLocalHook("change",i=>coe(FH,this,foe).call(this,i)),this.elements.push(r)})}setChecked(e){if(this.elements.length<e)throw Error(Bt`Radio button with index ${e} doesn't exist.`);L(this.elements,(t,r)=>{t.setChecked(r===e)})}getActiveOperationId(){const e=this.elements.find(t=>t instanceof hy&&t.isChecked());return e?e.getValue():Ql}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&L(this.elements,t=>{t.setChecked(t.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ql,t=arguments.length>1?arguments[1]:void 0,r=e;r===SO&&(r=uy),this.state.setValueAtIndex(t,r)}reset(){this.setChecked(DH)}}function foe(n){this.setState(n.target.value)}function moe(n,e,t){goe(n,e),e.set(n,t)}function goe(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sT(n,e){return n.get(HW(n,e))}function poe(n,e,t){return n.set(HW(n,e),t),t}function HW(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Pf=new WeakMap;class tg extends to{static get DEFAULTS(){return oo({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,t){super(e,Gn(tg.DEFAULTS,t)),moe(this,Pf,void 0)}build(){super.build(),poe(Pf,this,this._element.firstChild)}update(){this.isBuilt()&&(sT(Pf,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&sT(Pf,this).focus()}activate(){sT(Pf,this).click()}}function woe(n,e){DW(n,e),e.add(n)}function Ac(n,e,t){DW(n,e),e.set(n,t)}function DW(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nt(n,e){return n.get(Jc(n,e))}function Fs(n,e,t){return n.set(Jc(n,e),t),t}function Jc(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const kH="multipleSelect.itemBox";var Gs=new WeakMap,Vn=new WeakMap,oT=new WeakMap,Ea=new WeakMap,wl=new WeakMap,vl=new WeakMap,xf=new WeakSet;class ng extends to{static get DEFAULTS(){return oo({className:"htUIMultipleSelect",value:[]})}constructor(e,t){super(e,Gn(ng.DEFAULTS,t)),woe(this,xf),Ac(this,Gs,[]),Ac(this,Vn,void 0),Ac(this,oT,void 0),Ac(this,Ea,void 0),Ac(this,wl,void 0),Ac(this,vl,void 0),Fs(Ea,this,new Zl(this.hot,{placeholder:VI,className:"htUIMultipleSelectSearch"})),Fs(wl,this,new tg(this.hot,{textContent:HI,className:"htUISelectAll"})),Fs(vl,this,new tg(this.hot,{textContent:DI,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return nt(Vn,this)}registerHooks(){nt(Ea,this).addLocalHook("keydown",e=>Jc(xf,this,yoe).call(this,e)),nt(Ea,this).addLocalHook("input",e=>Jc(xf,this,voe).call(this,e)),nt(wl,this).addLocalHook("click",e=>Jc(xf,this,Coe).call(this,e)),nt(vl,this).addLocalHook("click",e=>Jc(xf,this,Soe).call(this,e))}setItems(e){var t;Fs(Gs,this,e),(t=nt(Vn,this))===null||t===void 0||t.loadData(nt(Gs,this))}setLocale(e){Fs(oT,this,e)}getLocale(){return nt(oT,this)}getItems(){return[...nt(Gs,this)]}getValue(){return Eoe(nt(Gs,this))}getSearchInputElement(){return nt(Ea,this)}getSelectAllElement(){return nt(wl,this)}getClearAllElement(){return nt(vl,this)}isSelectedAllValues(){return nt(Gs,this).length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,t=e.createElement("div"),r=new to(this.hot,{className:"htUISelectionControls",children:[nt(wl,this),nt(vl,this)]});this._element.appendChild(nt(Ea,this).element),this._element.appendChild(r.element),this._element.appendChild(t);const i=s=>{var o;if(!this._element)return;(o=nt(Vn,this))===null||o===void 0||o.destroy(),ie(s,"htUIMultipleSelectHot"),Fs(Vn,this,new this.hot.constructor(s,{data:nt(Gs,this),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(u,h,c,d,f,g)=>{u.title=g.instance.getDataAtRowProp(h,g.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{nt(Vn,this).listen()},colWidths:()=>nt(Vn,this).container.scrollWidth-or(e),maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),nt(Vn,this).init();const l=nt(Vn,this).getShortcutManager().getContext("grid");l.removeShortcutsByKeys(["Tab"]),l.removeShortcutsByKeys(["Shift","Tab"]),l.addShortcut({keys:[["Escape"]],callback:u=>{this.runLocalHooks("keydown",u,this)},group:kH}),l.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:u=>{nt(Vn,this).deselectCell(),this.runLocalHooks("keydown",u,this),this.runLocalHooks("listTabKeydown",u,this)},group:kH})};i(t),this.hot._registerTimeout(()=>i(t),100)}focus(){this.isBuilt()&&nt(Vn,this).listen()}reset(){nt(Ea,this).reset(),nt(wl,this).reset(),nt(vl,this).reset()}update(){this.isBuilt()&&(nt(Vn,this).loadData(Roe(nt(Gs,this),this.options.value)),super.update())}destroy(){var e;(e=nt(Vn,this))===null||e===void 0||e.destroy(),nt(Ea,this).destroy(),nt(vl,this).destroy(),nt(wl,this).destroy(),Fs(Ea,this,null),Fs(vl,this,null),Fs(wl,this,null),Fs(Vn,this,null),Fs(Gs,this,null),super.destroy()}}function voe(n){const e=n.target.value.toLocaleLowerCase(this.getLocale());let t;e===""?t=[...nt(Gs,this)]:t=nt(Gs,this).filter(r=>`${r.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),nt(Vn,this).loadData(t)}function yoe(n){this.runLocalHooks("keydown",n,this),zM(xd,n.keyCode)("ARROW_DOWN")&&(n.preventDefault(),Ns(n),nt(Vn,this).listen(),nt(Vn,this).selectCell(0,0))}function Coe(n){const e=[];n.preventDefault(),nt(Vn,this).getSourceData().forEach((t,r)=>{t.checked=!0,e.push(E0(t,r)[0])}),nt(Vn,this).setSourceDataAtCell(e)}function Soe(n){const e=[];n.preventDefault(),nt(Vn,this).getSourceData().forEach((t,r)=>{t.checked=!1,e.push(E0(t,r)[0])}),nt(Vn,this).setSourceDataAtCell(e)}function Roe(n,e){const t=Wg(e);return n.map(r=>(r.checked=t(r.value),r))}function Eoe(n){const e=[];return n.forEach(t=>{t.checked&&e.push(t.value)}),e}function boe(n,e){Toe(n,e),e.add(n)}function Toe(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Aoe(n,e,t){return(e=Noe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Noe(n){var e=Moe(n,"string");return typeof e=="symbol"?e:e+""}function Moe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function sw(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Lf=new WeakSet;class Ioe extends Bg{constructor(e,t){super(e,{id:t.id,stateless:!1}),boe(this,Lf),Aoe(this,"name",""),this.name=t.name,this.elements.push(new ng(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>sw(Lf,this,Ooe).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e)),this.hot.addHook("modifyFiltersMultiSelectValue",(e,t)=>sw(Lf,this,_oe).call(this,e,t))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===ph){const t=this.getMultipleSelectElement();t.setItems(e.itemsSnapshot),t.setValue(e.args[0]),t.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),t=e.getItems();return{command:{key:e.isSelectedAllValues()||!t.length?mr:ph},args:[e.getValue()],itemsSnapshot:t}}updateState(e){const t=(r,i,s,o,a)=>{const[l]=Za(i,c=>c.name===ph),u={},h=this.hot.getTranslatedPhrase(Zv);if(l){const c=o(r,a),d=wt(c,S=>S.value),f=new Map(c.map(S=>[S.value,this.hot.getCellMeta(S.meta.visualRow,S.meta.visualCol)])),g=aN(d);s&&(l.args[0]=s);const p=[],v=MH(g,l.args[0],h,S=>{S.checked&&p.push(S.value),sw(Lf,this,VH).call(this,S,f)}),y=e.editedConditionStack.column;u.locale=this.hot.getCellMeta(0,y).locale,u.args=[p],u.command=gh(ph),u.itemsSnapshot=v}else u.args=[],u.command=gh(mr);this.state.setValueAtIndex(r,u)};t(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&t(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof ng)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t,r,i,s,o)=>{ie(t.parentNode,"htFiltersMenuValue");const a=this.hot.rootDocument.createElement("div");return ie(a,"htFiltersMenuLabel"),a.textContent=o,t.appendChild(a),t.parentElement.hasAttribute("ghost-table")||L(this.elements,l=>t.appendChild(l.element)),t}}}reset(){const e=this.hot.getTranslatedPhrase(Zv),t=this._getColumnVisibleValues(),r=t.map(l=>l.value),i=new Map(t.map(l=>[l.value,l.meta])),s=aN(r),o=MH(s,s,e,l=>{sw(Lf,this,VH).call(this,l,i)});this.getMultipleSelectElement().setItems(o),super.reset(),this.getMultipleSelectElement().setValue(s);const a=this.hot.getPlugin("filters").getSelectedColumn();a!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,a.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:wt(this.hot.getDataAtCol(e.visualIndex),(t,r)=>({value:IW(t),meta:this.hot.getCellMeta(r,e.visualIndex)}))}}function Ooe(n){xd(n.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Ns(n))}function VH(n,e){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(n.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",n.visualValue,e.get(n.value)))}function _oe(n,e){switch(e.type){case"numeric":return IB(n,e);default:return n}}var FW;function Poe(n,e){xoe(n,e),e.add(n)}function xoe(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Loe(n,e,t){return(e=Hoe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Hoe(n){var e=Doe(n,"string");return typeof e=="symbol"?e:e+""}function Doe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Foe(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var UH=new WeakSet;class rg extends Bg{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,t){super(e,{id:t.id,stateless:!0}),Poe(this,UH),Loe(this,"name",""),this.name=t.name,this.elements.push(new Zl(this.hot,{type:"button",value:FI,className:"htUIButton htUIButtonOK",identifier:rg.BUTTON_OK})),this.elements.push(new Zl(this.hot,{type:"button",value:kI,className:"htUIButton htUIButtonCancel",identifier:rg.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){L(this.elements,e=>{e.addLocalHook("click",(t,r)=>Foe(UH,this,koe).call(this,t,r))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t)=>(ie(t.parentNode,"htFiltersMenuActionBar"),L(this.elements,r=>t.appendChild(r.element)),t)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}FW=rg;function koe(n,e){e.options.identifier===FW.BUTTON_OK?this.accept():this.cancel()}function ow(n,e,t){return(e=Voe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Voe(n){var e=Uoe(n,"string");return typeof e=="symbol"?e:e+""}function Uoe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const BH="ConditionCollection.filteringStates";class EO{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;ow(this,"hot",void 0),ow(this,"isMapRegistrable",void 0),ow(this,"filteringStates",new DC),ow(this,"previousConditionStack",null),this.hot=e,this.isMapRegistrable=t,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(BH,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,t){var r;const i=this.filteringStates.getValueAtIndex(t),s=(r=i?.conditions)!==null&&r!==void 0?r:[],o=i?.operation;return this.isMatchInConditions(s,e,o)}isMatchInConditions(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ql;return e.length?Pse(r)(e,t):!0}addCondition(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ql,i=arguments.length>3?arguments[3]:void 0;const s=this.hot.getCellMeta(0,e).locale,o=wt(t.args,h=>typeof h=="string"?h.toLocaleLowerCase(s):h),a=t.name||t.command.key;this.previousConditionStack===null&&this.setPreviousConditionStack(this.exportAllConditions()),this.runLocalHooks("beforeAdd",e);const l=this.getOperation(e);if(l){if(l!==r)throw Error(Bt`The column of index ${e} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(nn(Jm[r]))throw new Error(Bt`Unexpected operation named \`${r}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const u=this.getConditions(e);u.length===0?this.filteringStates.setValueAtIndex(e,{operation:r,conditions:[{name:a,args:o,func:su(a,o)}]},i):u.push({name:a,args:o,func:su(a,o)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var t,r;return(t=(r=this.filteringStates.getValueAtIndex(e))===null||r===void 0?void 0:r.conditions)!==null&&t!==void 0?t:[]}getOperation(e){var t;return(t=this.filteringStates.getValueAtIndex(e))===null||t===void 0?void 0:t.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[t]=e;return t})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return jn(this.filteringStates.getEntries(),(e,t)=>{let[r,{operation:i,conditions:s}]=t;return e.push({column:r,operation:i,conditions:wt(s,o=>{let{name:a,args:l}=o;return{name:a,args:l}})}),e},[])}importAllConditions(e){this.clean(),L(e,t=>{L(t.conditions,r=>this.addCondition(t.column,r))})}removeConditions(e){this.setPreviousConditionStack(this.exportAllConditions()),this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,t){const r=this.getConditions(e);return t?r.some(i=>i.name===t):r.length>0}setPreviousConditionStack(e){this.previousConditionStack=e}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(BH),this.filteringStates=null,this.clearLocalHooks()}}Wt(EO,Or);function WH(n,e,t){return(e=Boe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Boe(n){var e=Woe(n,"string");return typeof e=="symbol"?e:e+""}function Woe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class kW{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];WH(this,"conditionCollection",void 0),WH(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=t}filter(){let e=[];return L(this.conditionCollection.getFilteredColumns(),(t,r)=>{let i=this.columnDataFactory(t);r&&(i=this._getIntersectData(i,e)),e=this.filterByColumn(t,i)}),e}filterByColumn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=[];return L(t,i=>{i!==void 0&&this.conditionCollection.isMatch(i,e)&&r.push(i)}),r}_getIntersectData(e,t){const r=[];return L(t,i=>{const s=i.meta.visualRow;e[s]!==void 0&&(r[s]=e[s])}),r}}function $oe(n,e){Goe(n,e),e.add(n)}function Goe(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ku(n,e,t){return(e=joe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function joe(n){var e=zoe(n,"string");return typeof e=="symbol"?e:e+""}function zoe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function aT(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var aw=new WeakSet;class VW{constructor(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];$oe(this,aw),ku(this,"hot",void 0),ku(this,"conditionCollection",void 0),ku(this,"columnDataFactory",void 0),ku(this,"changes",[]),ku(this,"grouping",!1),ku(this,"latestEditedColumnPosition",-1),ku(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=t,this.columnDataFactory=r,this.conditionCollection.addLocalHook("beforeRemove",i=>aT(aw,this,Yoe).call(this,i)),this.conditionCollection.addLocalHook("afterRemove",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("afterAdd",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("beforeClean",()=>aT(aw,this,Koe).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>aT(aw,this,qoe).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,L(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,t){var r=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const i=this.conditionCollection.exportAllConditions();let s=this.conditionCollection.getColumnStackPosition(e);s===-1&&(s=this.latestEditedColumnPosition);const o=i.slice(0,s),a=i.slice(s);a.length&&a[0].column===e&&a.shift();const l=eU(function(h,c){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const f=new EO(r.hot,!1),g=[].concat(h,d);f.importAllConditions(g);const p=r.columnDataFactory(c);let v;f.isEmpty()?v=p:v=new kW(f,S=>r.columnDataFactory(S)).filter(),v=wt(v,S=>S.meta.visualRow);const y=Wg(v);return f.destroy(),Za(p,S=>y(S.meta.visualRow))})(o),u=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:u},dependentConditionStacks:a,filteredRowsFactory:l,conditionArgsChange:t})}destroy(){this.clearLocalHooks(),at(this,(e,t)=>{this[t]=null})}}function Yoe(n){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(n)}function Koe(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function qoe(){L(this.latestOrderStack,n=>{this.updateStatesAtColumn(n)})}Wt(VW,Or);function Xoe(n){return oW({initialPage:0,size:()=>n.length,onItemSelect:(t,r)=>{const i=n[t];if(i instanceof ng)return r;if(i.element&&!bh(i.element))return!1;i.focus()}})}const Hf="filters";function Qoe(n,e){let t=-1;const r=Xoe(e),i=l=>()=>{n.isOpened()&&n.getKeyboardShortcutsCtrl().listen(Hf),r.setCurrentPage(e.indexOf(l))};e.forEach(l=>{l instanceof to&&(l.addLocalHook("click",i(l)),l.addLocalHook("focus",i(l)),l.addLocalHook("afterClose",i(l)))}),n.addLocalHook("afterSelectionChange",l=>{l.key.startsWith("filter_")||r.clear()});function s(l){const u=n.getKeyboardShortcutsCtrl(),h=l.getKeyboardShortcutsCtrl();r.clear(),h.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:u.getContext(Hf),callback:()=>{l.isSubMenu()&&l.close(),u.listen(Hf)}}]),!l.isSubMenu()&&u.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:c=>{const d=n.getNavigator();d.getCurrentPage()>-1&&(t=d.getCurrentPage()),d.clear(),c.shiftKey?r.toPreviousItem():r.toNextItem()}},{keys:[["Escape"]],callback:()=>{n.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:c=>{const d=e[r.getCurrentPage()];d instanceof eg&&(d.openOptions(),c.preventDefault()),d instanceof tg&&(d.activate(),c.preventDefault()),d instanceof to||c.preventDefault()}}],Hf)}n.addLocalHook("afterSubmenuOpen",s),n.addLocalHook("afterOpen",s);function o(){n.focus(),n.getKeyboardShortcutsCtrl().listen(Hf)}function a(){return t}return{...r,listen:o,getLastMenuPage:a}}function Zoe(n,e){UW(n,e),e.add(n)}function Joe(n,e,t){UW(n,e),e.set(n,t)}function UW(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Df(n,e,t){return(e=eae(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function eae(n){var e=tae(n,"string");return typeof e=="symbol"?e:e+""}function tae(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function nae(n,e,t){return n.set(xi(n,e),t),t}function Ff(n,e){return n.get(xi(n,e))}function xi(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const uN="filters",rae=250,$H=uN;var Vu=new WeakMap,Ji=new WeakSet;class iae extends _t{static get PLUGIN_KEY(){return uN}static get PLUGIN_PRIORITY(){return rae}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){super(e),Zoe(this,Ji),Df(this,"dropdownMenuPlugin",null),Df(this,"conditionCollection",null),Df(this,"conditionUpdateObserver",null),Df(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),Df(this,"filtersRowsMap",null),Joe(this,Vu,void 0),this.hot.addHook("afterGetColHeader",(t,r)=>xi(Ji,this,hae).call(this,t,r))}isEnabled(){return!!this.hot.getSettings()[uN]}enablePlugin(){if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new Lg),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const e=this.hot.getSettings().dropdownMenu,t=e&&e.uiContainer||this.hot.rootDocument.body,r=o=>(o.addLocalHook("accept",()=>xi(Ji,this,GH).call(this,"accept")),o.addLocalHook("cancel",()=>xi(Ji,this,GH).call(this,"cancel")),o.addLocalHook("change",a=>xi(Ji,this,uae).call(this,o,a)),o),i=()=>`${this.hot.getTranslatedPhrase(PI)}:`,s=()=>`${this.hot.getTranslatedPhrase(xI)}:`;if(!this.components.get("filter_by_condition")){const o=new lN(this.hot,{id:"filter_by_condition",name:i,addSeparator:!1,menuContainer:t});o.addLocalHook("afterClose",()=>xi(Ji,this,jH).call(this)),this.components.set("filter_by_condition",r(o))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new doe(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const o=new lN(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:t});o.addLocalHook("afterClose",()=>xi(Ji,this,jH).call(this)),this.components.set("filter_by_condition2",r(o))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",r(new Ioe(this.hot,{id:"filter_by_value",name:s}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",r(new rg(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new EO(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new VW(this.hot,this.conditionCollection,o=>this.getDataMapAtColumn(o)),this.conditionUpdateObserver.addLocalHook("update",o=>xi(Ji,this,cae).call(this,o))),this.components.forEach(o=>o.show()),this.addHook("afterDropdownMenuDefaultOptions",o=>xi(Ji,this,lae).call(this,o)),this.addHook("afterDropdownMenuShow",()=>xi(Ji,this,oae).call(this)),this.addHook("afterDropdownMenuHide",()=>xi(Ji,this,aae).call(this)),this.addHook("afterChange",o=>xi(Ji,this,sae).call(this,o)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!Ff(Vu,this)&&this.dropdownMenuPlugin.enabled){const o=this.dropdownMenuPlugin.menu,a=[{focus:()=>{const u=o.getNavigator(),h=Ff(Vu,this).getLastMenuPage();o.focus(),h>0?u.setCurrentPage(h):u.toFirstItem()}},...Array.from(this.components).map(u=>{let[,h]=u;return h.getElements()}).flat()];nae(Vu,this,Qoe(o,a));const l=u=>{Ff(Vu,this).listen(),u.preventDefault(),xd(u.keyCode,"TAB")&&(u.shiftKey?Ff(Vu,this).toPreviousItem():Ff(Vu,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",l),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",l)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((t,r)=>{t.destroy(),this.components.set(r,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:$H})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup($H)}addCondition(e,t,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Ql;const s=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(s,{command:{key:t},args:r},i)}removeConditions(e){const t=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(t)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const t=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(t)}}filter(){const{navigableHeaders:e}=this.hot.getSettings(),t=this._createDataFilter(),r=!this.conditionCollection.isEmpty();let i=[];const s=this.conditionCollection.exportAllConditions();if(this.hot.runHooks("beforeFilter",s,this.conditionCollection.previousConditionStack)!==!1)if(r){const a=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),i=wt(t.filter(),u=>u.meta.visualRow);const l=Wg(i);Pe(this.hot.countSourceRows()-1,u=>{l(u)||a.push(u)}),L(a,u=>{this.filtersRowsMap.setValueAtIndex(u,!0)})},!0),!e&&!i.length&&this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",s),this.conditionCollection.setPreviousConditionStack(null),this.hot.view.adjustElementsSize(),this.hot.render(),this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col)}getSelectedColumn(){var e;const t=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return t?{visualIndex:t.col,physicalIndex:this.hot.toPhysicalColumn(t.col)}:null}getDataMapAtColumn(e){const t=this.hot.toVisualColumn(e),r=[];return L(this.hot.getSourceDataAtCol(t),(i,s)=>{var o;const{row:a,col:l,visualCol:u,visualRow:h,type:c,instance:d,dateFormat:f,locale:g}=this.hot.getCellMeta(s,t),p=(o=this.hot.getDataAtCell(this.hot.toVisualRow(s),t))!==null&&o!==void 0?o:i;r.push({meta:{row:a,col:l,visualCol:u,visualRow:h,type:c,instance:d,dateFormat:f,locale:g},value:IW(p)})}),r}updateValueComponentCondition(e){const t=this.hot.getDataAtCol(e),r=aN(t);this.conditionUpdateObserver.updateStatesAtColumn(e,r)}restoreComponents(e){var t;const r=(t=this.getSelectedColumn())===null||t===void 0?void 0:t.physicalIndex;e.forEach(i=>{i.isHidden()||i.restoreState(r)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,t,r,i){let s=e;return s===uy&&t.command.key!==mr&&r.command.key!==mr&&i.command.key!==mr?s=SO:i.command.key!==mr&&(t.command.key===mr||r.command.key===mr)&&(s=Ql),s}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:t}=e.getState(),r=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];t.showOperators?this.showComponents(...r):this.hideComponents(...r)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new kW(e,t=>this.getDataMapAtColumn(t))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const t=this.dropdownMenuPlugin.menu;for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return L(i,o=>{L(t.menuItems,(a,l)=>{a.key===o.getMenuItemDescriptor().key&&e.push(l)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const r=this.dropdownMenuPlugin.menu.hotMenu,i=r.getPlugin("hiddenRows");for(var s=arguments.length,o=new Array(s>1?s-1:0),a=1;a<s;a++)o[a-1]=arguments[a];const l=this.getIndexesOfComponents(...o);e?i.showRows(l):i.hideRows(l),r.render()}hideComponents(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.changeComponentsVisibility(!1,...t)}showComponents(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.changeComponentsVisibility(!0,...t)}destroy(){this.enabled&&(this.components.forEach((e,t)=>{e!==null&&(e.destroy(),this.components.set(t,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function sae(n){n&&L(n,e=>{const[,t]=e,r=this.hot.propToCol(t);this.conditionCollection.hasConditions(r)&&this.updateValueComponentCondition(r)})}function oae(){const n=this.dropdownMenuPlugin.menu;this.restoreComponents(Array.from(this.components.values())),n.updateMenuDimensions()}function aae(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function lae(n){n.items.push({name:ut}),this.components.forEach(e=>{n.items.push(e.getMenuItemDescriptor())})}function GH(n){var e;if(n==="accept"){const r=this.getSelectedColumn();if(r===null){var t;(t=this.dropdownMenuPlugin)===null||t===void 0||t.close();return}const{physicalIndex:i}=r,s=this.components.get("filter_by_condition").getState(),o=this.components.get("filter_by_condition2").getState(),a=this.components.get("filter_by_value").getState(),l=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),s,o,a);this.conditionUpdateObserver.groupChanges();let u=this.conditionCollection.getColumnStackPosition(i);u===-1&&(u=void 0),this.conditionCollection.removeConditions(i),s.command.key!==mr&&(this.conditionCollection.addCondition(i,s,l,u),o.command.key!==mr&&this.conditionCollection.addCondition(i,o,l,u)),a.command.key!==mr&&this.conditionCollection.addCondition(i,a,l,u),this.conditionUpdateObserver.flush(),this.components.forEach(h=>h.saveState(i)),this.filtersRowsMap.clear(),this.filter()}(e=this.dropdownMenuPlugin)===null||e===void 0||e.close()}function uae(n,e){this.updateDependentComponentsVisibility(),n.constructor===lN&&!e.inputsCount&&this.setListeningDropdownMenu()}function jH(){this.setListeningDropdownMenu()}function hae(n,e){const t=this.hot.toPhysicalColumn(n);this.enabled&&this.conditionCollection.hasConditions(t)?ie(e,"htFiltersActive"):Xe(e,"htFiltersActive")}function cae(n){var e;if(!((e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled))return;const{editedConditionStack:{conditions:t,column:r}}=n,i=t.filter(o=>o.name===ph),s=t.filter(o=>o.name!==ph);if(i.length>=2||s.length>=3)Ut(Bt`The filter conditions have been applied properly, but couldnât be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const o=this.conditionCollection.getOperation(r);this.components.get("filter_by_condition").updateState(s[0],r),this.components.get("filter_by_condition2").updateState(s[1],r),this.components.get("filter_operators").updateState(o,r),this.components.get("filter_by_value").updateState(n)}}const BW="internal-use-in-handsontable",hN={licenseKey:BW,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function WW(n){var e;return{maxColumns:n.maxColumns,maxRows:n.maxRows,language:(e=n[Ur])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function $W(n){return Object.keys(n).reduce((e,t)=>(t!=="hyperformula"&&(e[t]=n[t]),e),{})}function dae(n){var e;const t=n[Ur],r=$W(t!=null&&(e=t.engine)!==null&&e!==void 0&&e.hyperformula?t.engine:{}),i=WW(n);return{...hN,...r,...i}}function fae(n){var e;const t=n[Ur],r=$W(t!=null&&(e=t.engine)!==null&&e!==void 0&&e.hyperformula?t.engine:{}),i=WW(n);return{...r,...i}}function mae(n,e){return Object.keys(e).some(t=>e[t]!==void 0&&e[t]!==n[t])}function nS(){const n="engine_relationship",e=fo(Ur);return e.hasItem(n)||e.register(n,new Map),e.getItem(n)}function bO(){const n="shared_engine_usage",e=fo(Ur);return e.hasItem(n)||e.register(n,new Map),e.getItem(n)}function gae(n){const e=n.getSettings(),t=e[Ur],r=t?.engine;if(t===!0||nn(r))return null;if(typeof r.hyperformula=="function"||typeof r=="function"){var i;return pae((i=r.hyperformula)!==null&&i!==void 0?i:r,e,n)}else if(typeof r=="object"&&nn(r.hyperformula)){const s=nS(),o=bO().get(r);return s.has(r)||s.set(r,[]),s.get(r).push(n),o&&o.push(n.guid),r.getConfig().licenseKey||r.updateConfig({licenseKey:BW}),(r.getConfig().leapYear1900!==hN.leapYear1900||AC(r.getConfig().nullDate,hN.nullDate)===!1)&&Ut(Bt`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),r}return null}function pae(n,e,t){const r=e[Ur],i=dae(e),s=nS(),o=bO();wae(n,r.functions),vae(n,r.language);const a=n.buildEmpty(i);return s.set(a,[t]),o.set(a,[t.guid]),yae(a,r.namedExpressions),a.on("sheetAdded",()=>{a.rebuildAndRecalculate()}),a.on("sheetRemoved",()=>{a.rebuildAndRecalculate()}),a}function zH(n){var e;const t=nS(),r=t.size===0?[]:Array.from((e=t.get(n))!==null&&e!==void 0?e:[]);return new Map(r.map(i=>[i.getPlugin("formulas").sheetId,i]))}function YH(n,e){if(n){const t=nS(),r=t.get(n),i=bO(),s=i.get(n);r&&r.includes(e)&&(r.splice(r.indexOf(e),1),r.length===0&&t.delete(n)),s&&s.includes(e.guid)&&(s.splice(s.indexOf(e.guid),1),s.length===0&&(i.delete(n),n.destroy()))}}function wae(n,e){e&&e.forEach(t=>{const{name:r,plugin:i,translations:s}=t;try{n.registerFunction(r,i,s)}catch(o){Ut(o.message)}})}function vae(n,e){if(e){const{langCode:t}=e;try{n.registerLanguage(t,e)}catch(r){Ut(r.message)}}}function yae(n,e){e&&(n.suspendEvaluation(),e.forEach(t=>{const{name:r,expression:i,scope:s,options:o}=t;try{n.addNamedExpression(r,i,s,o)}catch(a){Ut(a.message)}}),n.resumeEvaluation())}function Cae(n,e){return(nn(e)||!n.doesSheetExist(e))&&(e=n.addSheet(e)),e}const GW="DD/MM/YYYY";function jW(n){return typeof n=="string"&&n.charAt(0)==="'"&&n.charAt(1)==="="}function Sae(n){return jW(n)?n.substr(1):n}function Rae(n){return typeof n=="string"&&n.startsWith("=")}function TO(n,e){return typeof n=="string"&&e==="date"}function zW(n,e){return se(n,e,!0).isValid()}function YW(n,e){return se(n,e,!0).format(GW)}function Eae(n,e){return se(n,GW,!0).format(e)}function KW(n,e){const r=new Date(Date.UTC(0,0,n+-1));return se(r).format(e)}function bae(n,e,t){const r=Array.from(Array(t).keys()).filter(s=>n.includes(s)===!1);if(e===0){var i;return(i=r[e])!==null&&i!==void 0?i:0}return r[e-1]+1}function Tae(n,e){const t=[];return n.forEach(r=>{const i={from:r,to:e};t.forEach(s=>{const o=s.from>s.to,a=s.to<=i.from;s.from>i.from&&a&&o&&(i.from+=1)}),i.from>=e&&(e+=1),t.push(i)}),t}function Aae(n){return n.forEach((e,t)=>{n.slice(t+1).forEach(i=>{const s=i.from<i.to;i.from>e.from&&s&&(i.from-=1)})}),n}function AO(n,e,t){const r=Tae(n,bae(n,e,t));return Aae(r)}function Uu(n,e,t){Nae(n,e),e.set(n,t)}function Nae(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ln(n,e){return n.get(qW(n,e))}function yl(n,e,t){return n.set(qW(n,e),t),t}function qW(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var kf=new WeakMap,Cl=new WeakMap,Mi=new WeakMap,lw=new WeakMap,lT=new WeakMap,uT=new WeakMap,uw=new WeakMap;class KH{constructor(e,t,r){Uu(this,kf,void 0),Uu(this,Cl,void 0),Uu(this,Mi,void 0),Uu(this,lw,[]),Uu(this,lT,[]),Uu(this,uT,void 0),Uu(this,uw,[]),yl(kf,this,e),yl(Cl,this,t),yl(Mi,this,r)}setRemovedHfIndexes(e){return yl(uw,this,e.map(t=>{const r=ln(Cl,this).getVisualFromPhysicalIndex(t);return this.getHfIndexFromVisualIndex(r)})),ln(uw,this)}getRemovedHfIndexes(){return ln(uw,this)}getHfIndexFromVisualIndex(e){const t=ln(Cl,this).getIndexesSequence(),r=ln(Cl,this).getNotTrimmedIndexes();return t.indexOf(r[e])}syncMoves(e){const r=`move${$r(ln(kf,this))}s`;ln(Mi,this).getEngine().batch(()=>{e.forEach(i=>{const s=i.from!==i.to,o=i.from+1!==i.to;s&&o&&ln(Mi,this).getEngine()[r](ln(Mi,this).getSheetId(),i.from,1,i.to)})})}storeMovesInformation(e,t,r){r!==!1&&(yl(lT,this,e.map(i=>this.getHfIndexFromVisualIndex(i))),yl(uT,this,this.getHfIndexFromVisualIndex(t)))}calculateAndSyncMoves(e,t){if(ln(Mi,this).isPerformingUndoRedo()||e===!1||t===!1)return;const r=AO(ln(lT,this),ln(uT,this),ln(Cl,this).getNumberOfIndexes());ln(Mi,this).getSheetId()===null?ln(Mi,this).getPostponeAction(()=>this.syncMoves(r)):this.syncMoves(r)}getIndexesChangeSyncMethod(){const e=`set${$r(ln(kf,this))}Order`;return t=>{if(ln(Mi,this).isPerformingUndoRedo())return;const r=ln(Cl,this).getIndexesSequence();if(t==="update"&&r.length>0){const i=ln(lw,this).map(l=>r.indexOf(l)),s=ln(Mi,this).getEngine().getSheetDimensions(ln(Mi,this).getSheetId());let o;ln(kf,this)==="row"?o=s.height:o=s.width;const a=i.length;for(let l=a;l<o;l+=1)i.push(l);ln(Mi,this).getEngine()[e](ln(Mi,this).getSheetId(),i)}yl(lw,this,r)}}init(){yl(lw,this,ln(Cl,this).getIndexesSequence())}}function Bu(n,e,t){Mae(n,e),e.set(n,t)}function Mae(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ba(n,e){return n.get(XW(n,e))}function Wu(n,e,t){return n.set(XW(n,e),t),t}function XW(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var hw=new WeakMap,cw=new WeakMap,hT=new WeakMap,cT=new WeakMap,dT=new WeakMap,fT=new WeakMap,mT=new WeakMap;class Iae{constructor(e,t,r){Bu(this,hw,void 0),Bu(this,cw,void 0),Bu(this,hT,void 0),Bu(this,cT,!1),Bu(this,dT,!1),Bu(this,fT,null),Bu(this,mT,null),Wu(hw,this,new KH("row",e,this)),Wu(cw,this,new KH("column",t,this)),Wu(hT,this,r)}getForAxis(e){return e==="row"?ba(hw,this):ba(cw,this)}setPerformUndo(e){Wu(cT,this,e)}setPerformRedo(e){Wu(dT,this,e)}isPerformingUndoRedo(){return ba(cT,this)||ba(dT,this)}getSheetId(){return ba(mT,this)}getEngine(){return ba(fT,this)}getPostponeAction(){return ba(hT,this)}setupSyncEndpoint(e,t){Wu(fT,this,e),Wu(mT,this,t),ba(hw,this).init(),ba(cw,this).init()}}function Oae(n,e){QW(n,e),e.add(n)}function Nc(n,e,t){return(e=_ae(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function _ae(n){var e=Pae(n,"string");return typeof e=="symbol"?e:e+""}function Pae(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function gT(n,e,t){QW(n,e),e.set(n,t)}function QW(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ou(n,e,t){return n.set(Gt(n,e),t),t}function ud(n,e){return n.get(Gt(n,e))}function Gt(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const Ur="formulas",xae=["maxRows","maxColumns","language"],Lae=260;be.getSingleton().register("afterNamedExpressionAdded");be.getSingleton().register("afterNamedExpressionRemoved");be.getSingleton().register("afterSheetAdded");be.getSingleton().register("afterSheetRemoved");be.getSingleton().register("afterSheetRenamed");be.getSingleton().register("afterFormulasValuesUpdate");const kd=n=>n==="UndoRedo.undo"||n==="UndoRedo.redo"||n==="auto";var el=new WeakMap,NO=new WeakMap,Vf=new WeakMap,Kt=new WeakSet;class Hae extends _t{constructor(){var e;super(...arguments),e=this,Oae(this,Kt),gT(this,el,!1),gT(this,NO,!1),gT(this,Vf,[["valuesUpdated",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Gt(Kt,e,Qae).call(e,...r)}],["namedExpressionAdded",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Gt(Kt,e,Zae).call(e,...r)}],["namedExpressionRemoved",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Gt(Kt,e,Jae).call(e,...r)}],["sheetAdded",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Gt(Kt,e,ele).call(e,...r)}],["sheetRenamed",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Gt(Kt,e,tle).call(e,...r)}],["sheetRemoved",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Gt(Kt,e,nle).call(e,...r)}]]),Nc(this,"staticRegister",fo("formulas")),Nc(this,"engine",null),Nc(this,"sheetName",null),Nc(this,"indexSyncer",null),Nc(this,"rowAxisSyncer",null),Nc(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return Ur}static get PLUGIN_PRIORITY(){return Lae}static get SETTING_KEYS(){return[Ur,...xae]}get sheetId(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}isEnabled(){return!!this.hot.getSettings()[Ur]}enablePlugin(){var e,t=this;if(!this.enabled){if(this.engine=(e=gae(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){Ut("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const r=this.addSheet(this.sheetName,this.hot.getSourceDataArray());r!==!1&&(this.sheetName=r)}this.addHook("beforeLoadData",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Gt(Kt,t,qH).call(t,...i)}),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Gt(Kt,t,XH).call(t,...i)}),this.addHook("beforeUpdateData",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Gt(Kt,t,qH).call(t,...i)}),this.addHook("afterUpdateData",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Gt(Kt,t,XH).call(t,...i)}),this.addHook("modifyData",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Gt(Kt,t,Vae).call(t,...i)}),this.addHook("modifySourceData",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Gt(Kt,t,Uae).call(t,...i)}),this.addHook("beforeValidate",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Gt(Kt,t,Dae).call(t,...i)}),this.addHook("afterSetSourceDataAtCell",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Gt(Kt,t,Bae).call(t,...i)}),this.addHook("afterSetDataAtCell",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Gt(Kt,t,QH).call(t,...i)}),this.addHook("afterSetDataAtRowProp",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Gt(Kt,t,QH).call(t,...i)}),this.addHook("beforeCreateRow",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Gt(Kt,t,Wae).call(t,...i)}),this.addHook("beforeCreateCol",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Gt(Kt,t,$ae).call(t,...i)}),this.addHook("afterCreateRow",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Gt(Kt,t,zae).call(t,...i)}),this.addHook("afterCreateCol",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Gt(Kt,t,Yae).call(t,...i)}),this.addHook("beforeRemoveRow",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Gt(Kt,t,Gae).call(t,...i)}),this.addHook("beforeRemoveCol",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Gt(Kt,t,jae).call(t,...i)}),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Gt(Kt,t,Kae).call(t,...i)}),this.addHook("afterRemoveCol",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Gt(Kt,t,qae).call(t,...i)}),this.indexSyncer=new Iae(this.hot.rowIndexMapper,this.hot.columnIndexMapper,r=>{this.hot.addHookOnce("init",()=>{r()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(r,i,s,o)=>{this.rowAxisSyncer.storeMovesInformation(r,i,o)}),this.hot.addHook("beforeColumnMove",(r,i,s,o)=>{this.columnAxisSyncer.storeMovesInformation(r,i,o)}),this.hot.addHook("afterRowMove",(r,i,s,o,a)=>{this.rowAxisSyncer.calculateAndSyncMoves(o,a)}),this.hot.addHook("afterColumnMove",(r,i,s,o,a)=>{this.columnAxisSyncer.calculateAndSyncMoves(o,a)}),this.hot.addHook("beforeColumnFreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart,i)}),this.hot.addHook("afterColumnFreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.hot.addHook("beforeColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart-1,i)}),this.hot.addHook("afterColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.addHook("afterCellMetaReset",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Gt(Kt,t,kae).call(t,...i)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Gt(Kt,t,Xae).call(t,...i)}),this.addHook("beforeAutofill",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Gt(Kt,t,Fae).call(t,...i)}),ud(Vf,this).forEach(r=>{let[i,s]=r;return this.engine.on(i,s)}),super.enablePlugin()}}disablePlugin(){ud(Vf,this).forEach(e=>{let[t,r]=e;return this.engine.off(t,r)}),YH(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const t=fae(this.hot.getSettings());mae(this.engine.getConfig(),t)&&this.engine.updateConfig(t);const r=this.hot.getSettings()[Ur];if(Ne(r)&&Ne(r.sheetName)&&r.sheetName!==this.sheetName&&this.switchSheet(r.sheetName),!e.data&&this.sheetName===null){const i=this.hot.getSettings()[Ur].sheetName;i&&this.engine.doesSheetExist(i)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(i??void 0,this.hot.getSourceDataArray())}super.updatePlugin(e)}destroy(){ud(Vf,this).forEach(e=>{var t;let[r,i]=e;return(t=this.engine)===null||t===void 0?void 0:t.off(r,i)}),ou(Vf,this,null),YH(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,t){if(Ne(t)&&!jU(t))return Ut("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return Ut("Sheet with the provided name already exists."),!1;try{const r=this.engine.addSheet(e??void 0);return t&&this.engine.setSheetContent(this.engine.getSheetId(r),t),r}catch(r){return Ut(r.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){e0(`The sheet named \`${e}\` does not exist, switch aborted.`);return}this.sheetName=e;const t=this.engine.getSheetSerialized(this.sheetId);t.length>0&&this.hot.loadData(t,`${$r(Ur)}.switchSheet`)}getCellType(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const i=this.hot.toPhysicalRow(e),s=this.hot.toPhysicalColumn(t);return i!==null&&s!==null?this.engine.getCellType({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t)}):"EMPTY"}isFormulaCellType(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t)})}renderDependentSheets(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=new Set;e.forEach(i=>{var s;const o=i==null||(s=i.address)===null||s===void 0?void 0:s.sheet;o!==void 0&&(r.has(o)||r.add(o))}),zH(this.engine).forEach((i,s)=>{if((t||s!==this.sheetId)&&r.has(s)){var o;i.render(),(o=i.view)===null||o===void 0||o.adjustElementsSize()}})}validateDependentCells(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=s=>{var o;const{row:a,col:l,sheet:u}=(o=s?.address)!==null&&o!==void 0?o:{};return Ne(u)?`${u}:${a}x${l}`:""},i=new Set(t.map(s=>r(s)));e.forEach(s=>{var o,a;const{row:l,col:u}=(o=s.address)!==null&&o!==void 0?o:{};if(Ne(l)===!1||Ne(u)===!1||l>=this.hot.countRows()||u>=this.hot.countCols())return;const h=s==null||(a=s.address)===null||a===void 0?void 0:a.sheet,c=r(s);if(h!==void 0&&!i.has(c)){const d=zH(this.engine).get(h);if(!d)return;d.validateCell(d.getDataAtCell(l,u),d.getCellMeta(l,u),()=>{})}})}syncChangeWithEngine(e,t,r){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(i)){Ut(`Not possible to set cell data at ${JSON.stringify(i)}`);return}const s=this.hot.getCellMeta(e,t);return TO(r,s.type)&&(zW(r,s.dateFormat)?r=YW(r,s.dateFormat):Rae(r)===!1&&(r=`'${r}`)),this.engine.setCellContents(i,r)}}function Dae(n,e,t){const r=this.hot.propToCol(t);if(this.isFormulaCellType(e,r)){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId},s=this.hot.getCellMeta(e,r);let o=this.engine.getCellValue(i);return s.type==="date"&&Vr(o)&&(o=KW(o,s.dateFormat)),typeof o=="object"&&o!==null?o.value:o}return n}function Fae(n,e,t){const{row:r,col:i}=e.getTopStartCorner(),{row:s,col:o}=e.getBottomEndCorner(),{row:a,col:l}=t.getTopStartCorner(),{row:u,col:h}=t.getBottomEndCorner(),c={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId}},d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(u),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(h),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(d)===!1)return!1;const f=this.engine.getFillRangeData(c,d),{row:g,col:p}=c.start,{row:v,col:y}=c.end,S=v-g+1,R=y-p+1;for(let A=0;A<f.length;A+=1)for(let O=0;O<f[A].length;O+=1){const V=f[A][O],B=g+A%S,Y=p+O%R,q=this.hot.getCellMeta(B,Y);TO(V,q.type)&&(V.startsWith("'")?f[A][O]=V.slice(1):this.isFormulaCellType(B,Y,this.sheetId)===!1&&(f[A][O]=Eae(V,q.dateFormat)))}return f}function qH(n,e){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes($r(Ur))||ou(NO,this,nn(this.hot.getSettings().data))}function kae(){const n=this.hot.getSourceDataArray();let e=!1;n.forEach((t,r)=>{t.forEach((i,s)=>{const o=this.hot.getCellMeta(r,s),a=o.dateFormat;TO(i,o.type)&&(e=!0,zW(i,a)?n[r][s]=YW(i,a):this.isFormulaCellType(r,s)===!1&&(n[r][s]=`'${i}`))})}),e===!0&&(ou(el,this,!0),this.engine.setSheetContent(this.sheetId,n),ou(el,this,!1))}function XH(n,e){if(!(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes($r(Ur)))if(this.sheetName=Cae(this.engine,this.hot.getSettings()[Ur].sheetName),ud(NO,this))this.switchSheet(this.sheetName);else{const r=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,r)){ou(el,this,!0);const i=this.engine.setSheetContent(this.sheetId,r);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(i),ou(el,this,!1)}}}function Vae(n,e,t,r){if(r!=="get"||ud(el,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(n);if(i===null||e===null)return;if(!this.isFormulaCellType(i,e)&&this.getCellType(i,e)!=="ARRAY"){jW(t.value)&&(t.value=Sae(t.value));return}const o={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let a=this.engine.getCellValue(o),l=this.hot.getCellsMeta().find(h=>h.visualRow===i&&h.visualCol===e);l===void 0&&(l={}),l.type==="date"&&Vr(a)&&(a=KW(a,l.dateFormat));const u=typeof a=="object"&&a!==null?a.value:a;t.value=u}function Uae(n,e,t,r){if(r!=="get"||ud(el,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(n),s=this.hot.propToCol(e);if(i===null||s===null||!this.isFormulaCellType(i,s)&&this.getCellType(i,s)!=="ARRAY")return;const a=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(a.width===0&&a.height===0)return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId};t.value=this.engine.getCellSerialized(l)}function QH(n,e){if(kd(e))return;const t=[],r=[],i=this.engine.batch(()=>{n.forEach(s=>{let[o,a,,l]=s;const u=this.hot.propToCol(a),h=this.hot.toPhysicalRow(o),c=this.hot.toPhysicalColumn(u),d={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};h!==null&&c!==null?this.syncChangeWithEngine(o,u,l):t.push([o,u,l]),r.push({address:d})})});t.length&&this.hot.addHookOnce("afterChange",()=>{const s=this.engine.batch(()=>{t.forEach(o=>{let[a,l,u]=o;this.syncChangeWithEngine(a,l,u)})});this.renderDependentSheets(s,!0)}),this.renderDependentSheets(i),this.validateDependentCells(i,r)}function Bae(n,e){if(kd(e))return;const t=[],r=[];n.forEach(i=>{let[s,o,,a]=i;const l=this.hot.propToCol(o);if(!Vr(l))return;const u={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(u)){Ut(`Not possible to set source cell data at ${JSON.stringify(u)}`);return}r.push({address:u}),t.push(...this.engine.setCellContents(u,a))}),this.renderDependentSheets(t),this.validateDependentCells(t,r)}function Wae(n,e){let t=this.rowAxisSyncer.getHfIndexFromVisualIndex(n);if(n>=this.hot.countRows()&&(t=n),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[t,e]))return!1}function $ae(n,e){let t=this.columnAxisSyncer.getHfIndexFromVisualIndex(n);if(n>=this.hot.countCols()&&(t=n),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[t,e]))return!1}function Gae(n,e,t){return this.rowAxisSyncer.setRemovedHfIndexes(t).every(s=>this.engine.isItPossibleToRemoveRows(this.sheetId,[s,1]))===!1?!1:void 0}function jae(n,e,t){return this.columnAxisSyncer.setRemovedHfIndexes(t).every(s=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[s,1]))===!1?!1:void 0}function zae(n,e,t){if(kd(t))return;const r=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(n),e]);this.renderDependentSheets(r)}function Yae(n,e,t){if(kd(t))return;const r=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(n),e]);this.renderDependentSheets(r)}function Kae(n,e,t,r){if(kd(r))return;const i=this.rowAxisSyncer.getRemovedHfIndexes().sort((o,a)=>a-o),s=this.engine.batch(()=>{i.forEach(o=>{this.engine.removeRows(this.sheetId,[o,1])})});this.renderDependentSheets(s)}function qae(n,e,t,r){if(kd(r))return;const i=this.columnAxisSyncer.getRemovedHfIndexes().sort((o,a)=>a-o),s=this.engine.batch(()=>{i.forEach(o=>{this.engine.removeColumns(this.sheetId,[o,1])})});this.renderDependentSheets(s)}function Xae(n,e,t){var r;ou(el,this,!0);const i=this.hot.getSourceDataArray(t,0,t+(((r=e.__children)===null||r===void 0?void 0:r.length)||0),this.hot.countSourceCols());ou(el,this,!1),i.forEach((s,o)=>{s.forEach((a,l)=>{this.engine.setCellContents({col:l,row:t+o,sheet:this.sheetId},[[a]])})})}function Qae(n){this.hot.runHooks("afterFormulasValuesUpdate",n)}function Zae(n,e){this.hot.runHooks("afterNamedExpressionAdded",n,e)}function Jae(n,e){this.hot.runHooks("afterNamedExpressionRemoved",n,e)}function ele(n){this.hot.runHooks("afterSheetAdded",n)}function tle(n,e){this.sheetName=e,this.hot.runHooks("afterSheetRenamed",n,e)}function nle(n,e){this.hot.runHooks("afterSheetRemoved",n,e)}function rle(n){return{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let t=0;if(Array.isArray(e)){const[,r,,i]=e;r-i!==0&&(t=1)}return this.getTranslatedPhrase(uI,t)},callback(){const{from:e,to:t}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.col,t.col),0),i=Math.max(e.col,t.col),s=[];for(let l=r;l<=i;l+=1)s.push(l);n.hideColumns(s);const o=s[s.length-1],a=this.columnIndexMapper.getNearestNotHiddenIndex(o,1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function ile(n){const e=[];return{key:"hidden_columns_show",name(){const t=e.length>1?1:0;return this.getTranslatedPhrase(hI,t)},callback(){var t,r;if(e.length===0)return;let i=e[0],s=e[e.length-1];i=(t=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&t!==void 0?t:0,s=(r=this.columnIndexMapper.getNearestNotHiddenIndex(s+1,1))!==null&&r!==void 0?r:this.countCols()-1,n.showColumns(e),this.render(),this.view.adjustElementsSize(),s-i+1===this.countCols()||this.selectColumns(i,s)},disabled:!1,hidden(){const t=wt(n.getHiddenColumns(),c=>this.toPhysicalColumn(c));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||t.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().col,s=r.getBottomEndCorner().col,o=this.columnIndexMapper,a=o.getRenderableFromVisualIndex(i),l=o.getRenderableFromVisualIndex(s),u=o.getNotTrimmedIndexes(),h=[];if(i!==s){const c=s-i+1,d=l-a+1;if(c>d){const f=u.slice(i,s+1);h.push(...f.filter(g=>t.includes(g)))}}else if(a===0&&a<i)h.push(...u.slice(0,i));else if(a===null)h.push(...u.slice(0,this.countCols()));else{const c=this.countCols()-1,d=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(c,-1));l===d&&c>s&&h.push(...u.slice(s+1))}return L(h,c=>{e.push(this.toVisualColumn(c))}),e.length===0}}}function sle(n,e){ZW(n,e),e.add(n)}function ZH(n,e,t){ZW(n,e),e.set(n,t)}function ZW(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vi(n,e){return n.get(Nl(n,e))}function Uf(n,e,t){return n.set(Nl(n,e),t),t}function Nl(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}be.getSingleton().register("beforeHideColumns");be.getSingleton().register("afterHideColumns");be.getSingleton().register("beforeUnhideColumns");be.getSingleton().register("afterUnhideColumns");const pT="hiddenColumns",ole=310;var Qo=new WeakMap,To=new WeakMap,$u=new WeakSet;class ale extends _t{constructor(){super(...arguments),sle(this,$u),ZH(this,Qo,{}),ZH(this,To,null)}static get PLUGIN_KEY(){return pT}static get PLUGIN_PRIORITY(){return ole}isEnabled(){return!!this.hot.getSettings()[pT]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[pT];ot(t)&&(Uf(Qo,this,t),nn(t.copyPasteEnabled)&&(t.copyPasteEnabled=!0)),Uf(To,this,new HC),Vi(To,this).addLocalHook("init",()=>Nl($u,this,fle).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,Vi(To,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Nl($u,e,dle).call(e,...i)}),this.addHook("afterGetCellMeta",(r,i,s)=>Nl($u,this,ule).call(this,r,i,s)),this.addHook("modifyColWidth",(r,i)=>Nl($u,this,lle).call(this,r,i),2),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Nl($u,e,cle).call(e,...i)}),this.addHook("modifyCopyableRange",r=>Nl($u,this,hle).call(this,r)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Uf(Qo,this,{}),super.disablePlugin(),this.resetCellsMeta()}showColumns(e){const t=this.getHiddenColumns(),r=this.isValidConfig(e);let i=t;const s=Vi(To,this).getValues().slice(),o=e.length>0;if(r&&o){const l=e.map(u=>this.hot.toPhysicalColumn(u));L(l,u=>{s[u]=!1}),i=jn(s,(u,h,c)=>(h&&u.push(this.hot.toVisualColumn(c)),u),[])}this.hot.runHooks("beforeUnhideColumns",t,i,r&&o)!==!1&&(r&&o&&Vi(To,this).setValues(s),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",t,i,r&&o,r&&i.length<t.length))}showColumn(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.showColumns(t)}hideColumns(e){const t=this.getHiddenColumns(),r=this.isValidConfig(e);let i=t;r&&(i=Array.from(new Set(t.concat(e)))),this.hot.runHooks("beforeHideColumns",t,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{L(e,o=>{Vi(To,this).setValueAtIndex(this.hot.toPhysicalColumn(o),!0)})},!0),this.hot.runHooks("afterHideColumns",t,i,r,r&&i.length>t.length))}hideColumn(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.hideColumns(t)}getHiddenColumns(){return wt(Vi(To,this).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return Vi(To,this).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const t=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<t):!1}resetCellsMeta(){L(this.hot.getCellsMeta(),e=>{e&&(e.skipColumnOnPaste=!1)})}destroy(){Uf(Qo,this,null),Uf(To,this,null),super.destroy()}}function lle(n,e){if(this.isHidden(e))return 0;if(Vi(Qo,this).indicators&&(this.isHidden(e+1)||this.isHidden(e-1))&&typeof n=="number"&&this.hot.hasColHeaders())return n+15}function ule(n,e,t){if(Vi(Qo,this).copyPasteEnabled===!1&&this.isHidden(e)&&(t.skipColumnOnPaste=!0),this.isHidden(e-1))t.className=t.className||"",t.className.indexOf("afterHiddenColumn")===-1&&(t.className+=" afterHiddenColumn");else if(t.className){const r=t.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenColumn");i>-1&&r.splice(i,1),t.className=r.join(" ")}}}function hle(n){if(Vi(Qo,this).copyPasteEnabled)return n;const e=[],t=(r,i,s,o)=>{e.push({startRow:r,endRow:i,startCol:s,endCol:o})};return L(n,r=>{let i=!0,s=0;Pe(r.startCol,r.endCol,o=>{this.isHidden(o)?(i||t(r.startRow,r.endRow,s,o-1),i=!0):(i&&(s=o),o===r.endCol&&t(r.startRow,r.endRow,s,o),i=!1)})}),e}function cle(n,e){if(!Vi(Qo,this).indicators||n<0)return;const t=[];n>=1&&this.isHidden(n-1)&&t.push("afterHiddenColumn"),n<this.hot.countCols()-1&&this.isHidden(n+1)&&t.push("beforeHiddenColumn"),ie(e,t)}function dle(n){n.items.push({name:ut},rle(this),ile(this))}function fle(){Array.isArray(Vi(Qo,this).columns)&&this.hideColumns(Vi(Qo,this).columns)}function mle(n){return{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let t=0;if(Array.isArray(e)){const[r,,i]=e;r-i!==0&&(t=1)}return this.getTranslatedPhrase(cI,t)},callback(){const{from:e,to:t}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.row,t.row),0),i=Math.max(e.row,t.row),s=[];for(let l=r;l<=i;l+=1)s.push(l);n.hideRows(s);const o=s[s.length-1],a=this.rowIndexMapper.getNearestNotHiddenIndex(o,1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function gle(n){const e=[];return{key:"hidden_rows_show",name(){const t=e.length>1?1:0;return this.getTranslatedPhrase(dI,t)},callback(){var t,r;if(e.length===0)return;let i=e[0],s=e[e.length-1];i=(t=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&t!==void 0?t:0,s=(r=this.rowIndexMapper.getNearestNotHiddenIndex(s+1,1))!==null&&r!==void 0?r:this.countRows()-1,n.showRows(e),this.render(),this.view.adjustElementsSize(),s-i+1===this.countRows()||this.selectRows(i,s)},disabled:!1,hidden(){const t=wt(n.getHiddenRows(),c=>this.toPhysicalRow(c));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||t.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().row,s=r.getBottomEndCorner().row,o=this.rowIndexMapper,a=o.getRenderableFromVisualIndex(i),l=o.getRenderableFromVisualIndex(s),u=o.getNotTrimmedIndexes(),h=[];if(i!==s){const c=s-i+1,d=l-a+1;if(c>d){const f=u.slice(i,s+1);h.push(...f.filter(g=>t.includes(g)))}}else if(a===0&&a<i)h.push(...u.slice(0,i));else if(a===null)h.push(...u.slice(0,this.countRows()));else{const c=this.countRows()-1,d=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(c,-1));l===d&&c>s&&h.push(...u.slice(s+1))}return L(h,c=>{e.push(this.toVisualRow(c))}),e.length===0}}}function ple(n,e){JW(n,e),e.add(n)}function JH(n,e,t){JW(n,e),e.set(n,t)}function JW(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ls(n,e){return n.get(Ml(n,e))}function Bf(n,e,t){return n.set(Ml(n,e),t),t}function Ml(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}be.getSingleton().register("beforeHideRows");be.getSingleton().register("afterHideRows");be.getSingleton().register("beforeUnhideRows");be.getSingleton().register("afterUnhideRows");const wT="hiddenRows",wle=320;var $a=new WeakMap,Ao=new WeakMap,Gu=new WeakSet;class vle extends _t{constructor(){super(...arguments),ple(this,Gu),JH(this,$a,{}),JH(this,Ao,null)}static get PLUGIN_KEY(){return wT}static get PLUGIN_PRIORITY(){return wle}isEnabled(){return!!this.hot.getSettings()[wT]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[wT];ot(t)&&(Bf($a,this,t),nn(t.copyPasteEnabled)&&(t.copyPasteEnabled=!0)),Bf(Ao,this,new HC),ls(Ao,this).addLocalHook("init",()=>Ml(Gu,this,ble).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,ls(Ao,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Ml(Gu,e,Ele).call(e,...i)}),this.addHook("afterGetCellMeta",(r,i,s)=>Ml(Gu,this,Cle).call(this,r,i,s)),this.addHook("modifyRowHeight",(r,i)=>Ml(Gu,this,yle).call(this,r,i)),this.addHook("afterGetRowHeader",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Ml(Gu,e,Rle).call(e,...i)}),this.addHook("modifyCopyableRange",r=>Ml(Gu,this,Sle).call(this,r)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),Bf($a,this,{}),super.disablePlugin(),this.resetCellsMeta()}showRows(e){const t=this.getHiddenRows(),r=this.isValidConfig(e);let i=t;const s=ls(Ao,this).getValues().slice(),o=e.length>0;if(r&&o){const l=e.map(u=>this.hot.toPhysicalRow(u));L(l,u=>{s[u]=!1}),i=jn(s,(u,h,c)=>(h&&u.push(this.hot.toVisualRow(c)),u),[])}this.hot.runHooks("beforeUnhideRows",t,i,r&&o)!==!1&&(r&&o&&ls(Ao,this).setValues(s),this.hot.runHooks("afterUnhideRows",t,i,r&&o,r&&i.length<t.length))}showRow(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.showRows(t)}hideRows(e){const t=this.getHiddenRows(),r=this.isValidConfig(e);let i=t;r&&(i=Array.from(new Set(t.concat(e)))),this.hot.runHooks("beforeHideRows",t,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{L(e,o=>{ls(Ao,this).setValueAtIndex(this.hot.toPhysicalRow(o),!0)})},!0),this.hot.runHooks("afterHideRows",t,i,r,r&&i.length>t.length))}hideRow(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.hideRows(t)}getHiddenRows(){return wt(ls(Ao,this).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return ls(Ao,this).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const t=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<t):!1}resetCellsMeta(){L(this.hot.getCellsMeta(),e=>{e&&(e.skipRowOnPaste=!1)})}destroy(){Bf($a,this,null),Bf(Ao,this,null),super.destroy()}}function yle(n,e){return this.isHidden(e)?0:n}function Cle(n,e,t){if(ls($a,this).copyPasteEnabled===!1&&this.isHidden(n)&&(t.skipRowOnPaste=!0),this.isHidden(n-1))t.className=t.className||"",t.className.indexOf("afterHiddenRow")===-1&&(t.className+=" afterHiddenRow");else if(t.className){const r=t.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenRow");i>-1&&r.splice(i,1),t.className=r.join(" ")}}}function Sle(n){if(ls($a,this).copyPasteEnabled)return n;const e=[],t=(r,i,s,o)=>{e.push({startRow:r,endRow:i,startCol:s,endCol:o})};return L(n,r=>{let i=!0,s=0;Pe(r.startRow,r.endRow,o=>{this.isHidden(o)?(i||t(s,o-1,r.startCol,r.endCol),i=!0):(i&&(s=o),o===r.endRow&&t(s,o,r.startCol,r.endCol),i=!1)})}),e}function Rle(n,e){if(!ls($a,this).indicators||n<0)return;const t=[];n>=1&&this.isHidden(n-1)&&t.push("afterHiddenRow"),n<this.hot.countRows()-1&&this.isHidden(n+1)&&t.push("beforeHiddenRow"),ie(e,t)}function Ele(n){n.items.push({name:ut},mle(this),gle(this))}function ble(){Array.isArray(ls($a,this).rows)&&this.hideRows(ls($a,this).rows)}function Tle(n){return{key:"freeze_column",name(){return this.getTranslatedPhrase(z0)},callback(e,t){const[{start:{col:r}}]=t;n.freezeColumn(r),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let t=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(t=!0),t}}}function Ale(n){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(Y0)},callback(e,t){const[{start:{col:r}}]=t;n.unfreezeColumn(r),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let t=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(t=!0),t}}}function Nle(n,e){e$(n,e),e.add(n)}function Mle(n,e,t){e$(n,e),e.set(n,t)}function e$(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cN(n,e){return n.get(cy(n,e))}function vT(n,e,t){return n.set(cy(n,e),t),t}function cy(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}be.getSingleton().register("beforeColumnFreeze");be.getSingleton().register("afterColumnFreeze");be.getSingleton().register("beforeColumnUnfreeze");be.getSingleton().register("afterColumnUnfreeze");const eD="manualColumnFreeze",Ile=110;var sh=new WeakMap,yT=new WeakSet;class Ole extends _t{constructor(){super(...arguments),Nle(this,yT),Mle(this,sh,!1)}static get PLUGIN_KEY(){return eD}static get PLUGIN_PRIORITY(){return Ile}isEnabled(){return!!this.hot.getSettings()[eD]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>cy(yT,this,_le).call(this,e)),this.addHook("beforeColumnMove",(e,t)=>cy(yT,this,Ple).call(this,e,t)),super.enablePlugin())}disablePlugin(){vT(sh,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const t=this.hot.getSettings(),r=t.fixedColumnsStart<this.hot.countCols()&&e>t.fixedColumnsStart-1;cN(sh,this)||vT(sh,this,!0),this.hot.runHooks("beforeColumnFreeze",e,r)!==!1&&(r&&(this.hot.columnIndexMapper.moveIndexes(e,t.fixedColumnsStart),t._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,r))}unfreezeColumn(e){const t=this.hot.getSettings(),r=t.fixedColumnsStart>0&&e<=t.fixedColumnsStart-1;cN(sh,this)||vT(sh,this,!0),this.hot.runHooks("beforeColumnUnfreeze",e,r)!==!1&&(r&&(t._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,t.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,r))}}function _le(n){n.items.push({name:"---------"},Tle(this),Ale(this))}function Ple(n,e){if(cN(sh,this)){const t=this.hot.getSettings().fixedColumnsStart;if(e<t||n.some(r=>r<t))return!1}}function dw(n,e,t){return(e=xle(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function xle(n){var e=Lle(n,"string");return typeof e=="symbol"?e:e+""}function Lle(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const CT=0,tD=1,nD=2,Mc="px";let t$=class{constructor(e){dw(this,"hot",void 0),dw(this,"_element",null),dw(this,"state",CT),dw(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=nD}build(){this.state===CT&&(this._element=this.hot.rootDocument.createElement("div"),this.state=tD)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=CT}isAppended(){return this.state===nD}isBuilt(){return this.state>=tD}setPosition(e,t){Vr(e)&&(this._element.style.top=e+Mc),Vr(t)&&(this._element.style[this.inlineProperty]=t+Mc)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,t){Vr(e)&&(this._element.style.width=e+Mc),Vr(t)&&(this._element.style.height=t+Mc)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,t){Vr(e)&&(this._element.style.marginTop=e+Mc),Vr(t)&&(this._element.style[`margin${$r(this.inlineProperty)}`]=t+Mc)}getOffset(){const e=this._element.style,t=`margin${$r(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[t]?parseInt(e[t],10):0}}};const Hle="ht__manualColumnMove--backlight";let Dle=class extends t${build(){super.build(),ie(this._element,Hle)}};const Fle="ht__manualColumnMove--guideline";let kle=class extends t${build(){super.build(),ie(this._element,Fle)}};function Vle(n,e){n$(n,e),e.add(n)}function ks(n,e,t){n$(n,e),e.set(n,t)}function n$(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wi(n,e,t){return n.set(Il(n,e),t),t}function Ie(n,e){return n.get(Il(n,e))}function Il(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}be.getSingleton().register("beforeColumnMove");be.getSingleton().register("afterColumnMove");const ST="manualColumnMove",Ule=120,rD="ht__manualColumnMove",dy="show-ui",dN="on-moving--columns",fN="after-selection--columns";var Zr=new WeakMap,Dl=new WeakMap,Ga=new WeakMap,mv=new WeakMap,Gl=new WeakMap,Qr=new WeakMap,fw=new WeakMap,ns=new WeakMap,Wc=new WeakMap,fy=new WeakMap,vm=new WeakMap,ju=new WeakSet;class Ble extends _t{constructor(){super(...arguments),Vle(this,ju),ks(this,Zr,new Dle(this.hot)),ks(this,Dl,new kle(this.hot)),ks(this,Ga,[]),ks(this,mv,0),ks(this,Gl,!1),ks(this,Qr,{}),ks(this,fw,void 0),ks(this,ns,void 0),ks(this,Wc,void 0),ks(this,fy,void 0),ks(this,vm,void 0)}static get PLUGIN_KEY(){return ST}static get PLUGIN_PRIORITY(){return Ule}isEnabled(){return!!this.hot.getSettings()[ST]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Il(ju,e,Wle).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Il(ju,e,Gle).call(e,...r)}),this.addHook("afterScrollVertically",()=>Il(ju,this,zle).call(this)),this.addHook("afterLoadData",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Il(ju,e,Yle).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),ie(this.hot.rootElement,rD),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){Xe(this.hot.rootElement,rD),this.unregisterEvents(),Ie(Zr,this).destroy(),Ie(Dl,this).destroy(),super.disablePlugin()}moveColumn(e,t){return this.moveColumns([e],t)}moveColumns(e,t){const r=Ie(fw,this),i=this.isMovePossible(e,t),s=this.hot.runHooks("beforeColumnMove",e,t,r,i);if(wi(fw,this,void 0),s===!1)return;i&&this.hot.columnIndexMapper.moveIndexes(e,t);const o=i&&this.isColumnOrderChanged(e,t);return this.hot.runHooks("afterColumnMove",e,t,r,i,o),o}dragColumn(e,t){return this.dragColumns([e],t)}dragColumns(e,t){const r=this.countFinalIndex(e,t);return wi(fw,this,t),this.moveColumns(e,r)}isMovePossible(e,t){const r=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),i=e.length+t>r,s=t<0,o=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||s||o||a)}isColumnOrderChanged(e,t){return e.some((r,i)=>r-i!==t)}countFinalIndex(e,t){const r=jn(e,(i,s)=>(s<t&&(i+=1),i),0);return t-r}getColumnsWidth(e,t){const r=this.hot.columnIndexMapper;let i=0;for(let s=e;s<=t;s+=1){const o=r.getRenderableFromVisualIndex(s);s<0?i+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:o!==null&&(i+=this.hot.view._wt.wtTable.getStretchedColumnWidth(o)||0)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[ST];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const t=this.persistentStateLoad();t.length&&this.moveColumns(t,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,t){const r=[];return Pe(e,t,i=>{r.push(i)}),r}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(Ie(ns,this))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const t=this.hot.view._wt.wtTable,r=this.hot.view._wt.wtOverlays.scrollableElement,i=typeof r.scrollX=="number"?r.scrollX:r.scrollLeft;let s=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,Ie(ns,this)-1);const o=t.hider.offsetWidth,a=t.TBODY.offsetLeft,l=Ie(Zr,this).getOffset().start,u=Ie(Zr,this).getSize().width;let h=0,c=0;if(this.hot.isRtl()){const g=this.hot.rootWindow,p=rn(this.hot.rootElement),v=g.innerWidth-Ie(Wc,this)-p;c=g.innerWidth-Ie(Qr,this).eventPageX-v-(r.scrollX===void 0?i:0)}else c=Ie(Qr,this).eventPageX-(Ie(Wc,this)-(r.scrollX===void 0?i:0));if(Ie(fy,this)&&(h=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(Ie(ns,this))&&(s+=i),s+=h,Ie(ns,this)<0)Ie(vm,this)>0?Ie(Qr,this).col=0:Ie(Qr,this).col=e>0?e-1:e;else if(Ie(Qr,this).TD.offsetWidth/2+s<=c){const g=Ie(ns,this)>=Ie(mv,this)?Ie(mv,this)-1:Ie(ns,this);Ie(Qr,this).col=g+1,s+=Ie(Qr,this).TD.offsetWidth}else Ie(Qr,this).col=Ie(ns,this);let d=c,f=s;c+u+l>=o?d=o-u-l:c+l<a+h&&(d=a+h+Math.abs(l)),s>=o-1?f=o-1:f===0?f=1:r.scrollX!==void 0&&Ie(ns,this)<Ie(vm,this)&&(f-=Ie(Wc,this)<=r.scrollX?Ie(Wc,this):0),Ie(Zr,this).setPosition(null,d),Ie(Dl,this).setPosition(null,f)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",t=>Il(ju,this,$le).call(this,t)),this.eventManager.addEventListener(e,"mouseup",()=>Il(ju,this,jle).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){Ie(Zr,this).build(),Ie(Dl,this).build()}destroy(){Ie(Zr,this).destroy(),Ie(Dl,this).destroy(),super.destroy()}}function Wle(n,e,t,r){const i=this.hot.view._wt.wtTable,s=this.hot.selection.isSelectedByColumnHeader(),o=this.hot.getSelectedRangeLast(),a=je(n.target,"sortAction");if(!o||!s||Ie(Gl,this)||n.button!==0||a){wi(Gl,this,!1),Ie(Ga,this).length=0,Xe(this.hot.rootElement,[dN,dy]);return}const l=Ie(Dl,this).isBuilt()&&!Ie(Dl,this).isAppended(),u=Ie(Zr,this).isBuilt()&&!Ie(Zr,this).isAppended();l&&u&&(Ie(Dl,this).appendTo(i.hider),Ie(Zr,this).appendTo(i.hider));const{from:h,to:c}=o,d=Math.min(h.col,c.col),f=Math.max(h.col,c.col);if(e.row<0&&e.col>=d&&e.col<=f){r.column=!0,wi(Gl,this,!0);const g=t.firstChild?dU(n,t.firstChild).x:n.offsetX;Ie(Qr,this).eventPageX=n.pageX,wi(ns,this,e.col),Ie(Qr,this).TD=t,Ie(Qr,this).col=e.col,wi(Ga,this,this.prepareColumnsToMoving(d,f)),wi(fy,this,!!this.hot.getSettings().rowHeaders),wi(mv,this,this.hot.countCols()),wi(vm,this,this.hot.getSettings().fixedColumnsStart),wi(Wc,this,ir(this.hot.rootElement).left);const p=Ie(fy,this)?-1:0,v=i.holder.scrollTop+i.getColumnHeaderHeight(0)+1,y=e.col<Ie(vm,this),S=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),R=Math.abs(g-(this.hot.isRtl()?t.offsetWidth:0)),A=this.getColumnsWidth(d,e.col-1)+R,O=this.getColumnsWidth(p,d-1)+(y?S:0)+A;Ie(Zr,this).setPosition(v,O),Ie(Zr,this).setSize(this.getColumnsWidth(d,f),i.hider.offsetHeight-v),Ie(Zr,this).setOffset(null,-A),ie(this.hot.rootElement,dN)}else Xe(this.hot.rootElement,fN),wi(Gl,this,!1),Ie(Ga,this).length=0}function $le(n){Ie(Gl,this)&&(Ie(Qr,this).eventPageX=n.pageX,this.refreshPositions())}function Gle(n,e,t,r){!this.hot.getSelectedRangeLast()||!Ie(Gl,this)||(Ie(Ga,this).indexOf(e.col)>-1?Xe(this.hot.rootElement,dy):ie(this.hot.rootElement,dy),r.row=!0,r.column=!0,r.cell=!0,wi(ns,this,e.col),Ie(Qr,this).TD=t)}function jle(){const n=Ie(Qr,this).col,e=Ie(Ga,this).length;if(wi(ns,this,void 0),wi(Gl,this,!1),Xe(this.hot.rootElement,[dN,dy,fN]),this.hot.selection.isSelectedByColumnHeader()&&ie(this.hot.rootElement,fN),e<1||n===void 0)return;const t=Ie(Ga,this)[0],r=this.hot.toPhysicalColumn(t),i=this.dragColumns(Ie(Ga,this),n);if(Ie(Ga,this).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const s=this.hot.toVisualColumn(r),o=s+e-1;this.hot.selectColumns(s,o)}}function zle(){const n=this.hot.view._wt.wtTable,e=n.getColumnHeaderHeight(0)+1,t=n.holder.scrollTop,r=e+t;Ie(Zr,this).setPosition(r),Ie(Zr,this).setSize(null,n.hider.offsetHeight-r)}function Yle(){this.moveBySettingsOrLoad()}function Kle(n,e){r$(n,e),e.add(n)}function Lr(n,e,t){r$(n,e),e.set(n,t)}function r$(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ln(n,e,t){return n.set(js(n,e),t),t}function ve(n,e){return n.get(js(n,e))}function js(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const my="manualColumnResize",qle=130,iD="manualColumnWidths";var La=new WeakMap,mw=new WeakMap,Di=new WeakMap,gy=new WeakMap,Ko=new WeakMap,Xle=new WeakMap,hd=new WeakMap,gw=new WeakMap,ci=new WeakMap,Oa=new WeakMap,Oh=new WeakMap,py=new WeakMap,ym=new WeakMap,Cm=new WeakMap,ki=new WeakMap,Sm=new WeakMap,No=new WeakSet;class Qle extends _t{static get PLUGIN_KEY(){return my}static get PLUGIN_PRIORITY(){return qle}constructor(e){super(e),Kle(this,No),Lr(this,La,null),Lr(this,mw,null),Lr(this,Di,[]),Lr(this,gy,null),Lr(this,Ko,null),Lr(this,Xle,null),Lr(this,hd,null),Lr(this,gw,null),Lr(this,ci,this.hot.rootDocument.createElement("DIV")),Lr(this,Oa,this.hot.rootDocument.createElement("DIV")),Lr(this,Oh,null),Lr(this,py,!1),Lr(this,ym,0),Lr(this,Cm,null),Lr(this,ki,void 0),Lr(this,Sm,void 0),ie(ve(ci,this),"manualColumnResizer"),ie(ve(Oa,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[my]}enablePlugin(){this.enabled||(Ln(ki,this,new uu),ve(ki,this).addLocalHook("init",()=>js(No,this,Zle).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,ve(ki,this)),this.addHook("modifyColWidth",(e,t)=>js(No,this,iue).call(this,e,t),1),this.addHook("beforeStretchingColumnWidth",(e,t)=>js(No,this,sue).call(this,e,t)),this.addHook("beforeColumnResize",(e,t,r)=>js(No,this,oue).call(this,e,t,r)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Ln(Sm,this,ve(ki,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",iD,ve(ki,this).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",iD,e),e.value}setManualSize(e,t){const r=Math.max(t,20),i=this.hot.toPhysicalColumn(e);return ve(ki,this).setValueAtIndex(i,r),r}clearManualSize(e){const t=this.hot.toPhysicalColumn(e);ve(ki,this).setValueAtIndex(t,null)}setupHandlePosition(e){if(!e.parentNode)return;Ln(La,this,e);const{_wt:t}=this.hot.view,r=t.wtTable.getCoords(ve(La,this)),i=r.col;if(i<0)return;const s=Dn(ve(La,this)),o=ve(La,this).getBoundingClientRect(),a=i<t.getSetting("fixedColumnsStart");let l;a&&(l=t.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(ve(La,this),r.row,r.col)),l||(l=t.wtOverlays.topOverlay.getRelativeCellPosition(ve(La,this),r.row,r.col)),Ln(mw,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)),Ln(Di,this,[]);const u=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&u){const h=this.hot.getSelectedRange();L(h,c=>{const d=c.getTopStartCorner().col,f=c.getBottomEndCorner().col;Pe(d,f,g=>{ve(Di,this).includes(g)||ve(Di,this).push(g)})})}ve(Di,this).includes(ve(mw,this))||Ln(Di,this,[ve(mw,this)]),Ln(gw,this,l.start-6),Ln(hd,this,parseInt(o.width,10)),ve(ci,this).style.top=`${l.top}px`,ve(ci,this).style[this.inlineDir]=`${ve(gw,this)+ve(hd,this)}px`,ve(ci,this).style.height=`${s}px`,this.hot.rootElement.appendChild(ve(ci,this))}refreshHandlePosition(){ve(ci,this).style[this.inlineDir]=`${ve(gw,this)+ve(gy,this)}px`}setupGuidePosition(){const e=parseInt(Dn(ve(ci,this)),10),t=parseInt(ve(ci,this).style.top,10)+e,r=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);ie(ve(ci,this),"active"),ie(ve(Oa,this),"active"),ve(Oa,this).style.top=`${t}px`,this.refreshGuidePosition(),ve(Oa,this).style.height=`${r-e}px`,this.hot.rootElement.appendChild(ve(Oa,this))}refreshGuidePosition(){ve(Oa,this).style[this.inlineDir]=ve(ci,this).style[this.inlineDir]}hideHandleAndGuide(){Xe(ve(ci,this),"active"),Xe(ve(Oa,this),"active")}checkIfColumnHeader(e){const t=nu(e,["THEAD"],this.hot.rootElement),{topOverlay:r,topInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;return[r.clone.wtTable.THEAD,i.clone.wtTable.THEAD].includes(t)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},t=(r,i)=>{const s=this.hot.runHooks("beforeColumnResize",ve(Ko,this),r,!0);s!==void 0&&Ln(Ko,this,s),this.hot.getSettings().stretchH==="all"?this.clearManualSize(r):this.setManualSize(r,ve(Ko,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",ve(Ko,this),r,!0),i&&e()};ve(ym,this)>=2&&(ve(Di,this).length>1?(L(ve(Di,this),i=>{t(i)}),e()):L(ve(Di,this),i=>{t(i,!0)})),Ln(ym,this,0),Ln(Cm,this,null)}bindEvents(){const{rootWindow:e,rootElement:t}=this.hot;this.eventManager.addEventListener(t,"mouseover",r=>js(No,this,Jle).call(this,r)),this.eventManager.addEventListener(t,"mousedown",r=>js(No,this,eue).call(this,r)),this.eventManager.addEventListener(e,"mousemove",r=>js(No,this,tue).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>js(No,this,nue).call(this)),this.eventManager.addEventListener(ve(ci,this),"contextmenu",()=>js(No,this,rue).call(this))}destroy(){super.destroy()}}function Zle(){const n=this.hot.getSettings()[my],e=this.loadManualColumnWidths();typeof e<"u"?this.hot.batchExecution(()=>{e.forEach((t,r)=>{ve(ki,this).setValueAtIndex(r,t)})},!0):Array.isArray(n)?(this.hot.batchExecution(()=>{n.forEach((t,r)=>{ve(ki,this).setValueAtIndex(r,t)})},!0),Ln(Sm,this,n)):n===!0&&Array.isArray(ve(Sm,this))&&this.hot.batchExecution(()=>{ve(Sm,this).forEach((t,r)=>{ve(ki,this).setValueAtIndex(r,t)})},!0)}function Jle(n){if(!$M(n.target)&&ve(py,this)!==!0&&this.checkIfColumnHeader(n.target)){const e=this.getClosestTHParent(n.target);if(!e)return;const t=e.getAttribute("colspan");e&&(t===null||t==="1")&&(ve(Oh,this)||this.setupHandlePosition(e))}}function eue(n){n.target.parentNode===this.hot.rootElement&&je(n.target,"manualColumnResizer")&&(this.setupHandlePosition(ve(La,this)),this.setupGuidePosition(),Ln(Oh,this,!0),ve(Cm,this)===null&&(Ln(Cm,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(ve(Cm,this))),Ln(ym,this,ve(ym,this)+1),this.startX=n.pageX,Ln(Ko,this,ve(hd,this)))}function tue(n){if(ve(Oh,this)){const e=(n.pageX-this.startX)*this.hot.getDirectionFactor();Ln(gy,this,ve(hd,this)+e),L(ve(Di,this),t=>{Ln(Ko,this,this.setManualSize(t,ve(gy,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function nue(){const n=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},e=(t,r)=>{this.hot.runHooks("beforeColumnResize",ve(Ko,this),t,!1),r&&n(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",ve(Ko,this),t,!1)};ve(Oh,this)&&(this.hideHandleAndGuide(),Ln(Oh,this,!1),ve(Ko,this)!==ve(hd,this)&&(ve(Di,this).length>1?(L(ve(Di,this),r=>{e(r)}),n()):L(ve(Di,this),r=>{e(r,!0)})),this.setupHandlePosition(ve(La,this)))}function rue(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(ve(ci,this)),this.hot.rootElement.removeChild(ve(Oa,this)),Ln(Oh,this,!1),Ln(py,this,!0),this.hot._registerImmediate(()=>{Ln(py,this,!1)})}function iue(n,e){let t=n;if(this.enabled){const r=this.hot.toPhysicalColumn(e),i=ve(ki,this).getValueAtIndex(r);this.hot.getSettings()[my]&&i&&(t=i)}return t}function sue(n,e){let t=ve(ki,this).getValueAtIndex(e);return t===null&&(t=n),t}function oue(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function RT(n,e,t){return(e=aue(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function aue(n){var e=lue(n,"string");return typeof e=="symbol"?e:e+""}function lue(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const ET=0,sD=1,oD=2,Ic="px";let i$=class{constructor(e){RT(this,"hot",void 0),RT(this,"_element",null),RT(this,"state",ET),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=oD}build(){this.state===ET&&(this._element=this.hot.rootDocument.createElement("div"),this.state=sD)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=ET}isAppended(){return this.state===oD}isBuilt(){return this.state>=sD}setPosition(e,t){e!==void 0&&(this._element.style.top=e+Ic),t!==void 0&&(this._element.style.left=t+Ic)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,t){e&&(this._element.style.width=e+Ic),t&&(this._element.style.height=t+Ic)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,t){e&&(this._element.style.marginTop=e+Ic),t&&(this._element.style.marginLeft=t+Ic)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const uue="ht__manualRowMove--backlight";class hue extends i${build(){super.build(),ie(this._element,uue)}}const cue="ht__manualRowMove--guideline";class due extends i${build(){super.build(),ie(this._element,cue)}}function fue(n,e){s$(n,e),e.add(n)}function Oc(n,e,t){s$(n,e),e.set(n,t)}function s$(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wh(n,e,t){return n.set(Ol(n,e),t),t}function Je(n,e){return n.get(Ol(n,e))}function Ol(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}be.getSingleton().register("beforeRowMove");be.getSingleton().register("afterRowMove");const bT="manualRowMove",mue=140,aD="ht__manualRowMove",wy="show-ui",mN="on-moving--rows",gN="after-selection--rows";var Jr=new WeakMap,Fl=new WeakMap,ja=new WeakMap,jl=new WeakMap,vi=new WeakMap,pw=new WeakMap,zu=new WeakSet;class gue extends _t{constructor(){super(...arguments),fue(this,zu),Oc(this,Jr,new hue(this.hot)),Oc(this,Fl,new due(this.hot)),Oc(this,ja,[]),Oc(this,jl,void 0),Oc(this,vi,{}),Oc(this,pw,void 0)}static get PLUGIN_KEY(){return bT}static get PLUGIN_PRIORITY(){return mue}isEnabled(){return!!this.hot.getSettings()[bT]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Ol(zu,e,pue).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Ol(zu,e,vue).call(e,...r)}),this.addHook("afterScrollHorizontally",()=>Ol(zu,this,Cue).call(this)),this.addHook("afterLoadData",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Ol(zu,e,Sue).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),ie(this.hot.rootElement,aD),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){Xe(this.hot.rootElement,aD),this.unregisterEvents(),Je(Jr,this).destroy(),Je(Fl,this).destroy(),super.disablePlugin()}moveRow(e,t){return this.moveRows([e],t)}moveRows(e,t){const r=Je(pw,this),i=this.isMovePossible(e,t),s=this.hot.runHooks("beforeRowMove",e,t,r,i);if(wh(pw,this,void 0),s===!1)return;i&&this.hot.rowIndexMapper.moveIndexes(e,t);const o=i&&this.isRowOrderChanged(e,t);return this.hot.runHooks("afterRowMove",e,t,r,i,o),o}dragRow(e,t){return this.dragRows([e],t)}dragRows(e,t){const r=this.countFinalIndex(e,t);return wh(pw,this,t),this.moveRows(e,r)}isMovePossible(e,t){const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),i=e.length+t>r,s=t<0,o=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||s||o||a)}isRowOrderChanged(e,t){return e.some((r,i)=>r-i!==t)}countFinalIndex(e,t){const r=jn(e,(i,s)=>(s<t&&(i+=1),i),0);return t-r}getRowsHeight(e,t){const r=this.hot.rowIndexMapper;let i=0;for(let s=e;s<=t;s++){const o=r.getRenderableFromVisualIndex(s);o!==null&&(i+=this.hot.view._wt.wtTable.getRowHeight(o)||23)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[bT];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const t=this.persistentStateLoad();t.length&&this.moveRows(t,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),t=[];if(!e)return t;const{from:r,to:i}=e,s=Math.min(r.row,i.row),o=Math.max(r.row,i.row);return Pe(s,o,a=>{t.push(a)}),t}refreshPositions(){const e=Je(vi,this).coords,t=this.hot.view.getFirstFullyVisibleRow(),r=this.hot.view.getLastFullyVisibleRow(),i=this.hot.countRows();this.isFixedRowTop(e.row)&&t>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(t-1,-1)),this.isFixedRowBottom(e.row)&&r<i&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(r+1,1),void 0,!0);const s=this.hot.view._wt.wtTable,o=Je(vi,this).TD,a=this.hot.rootElement,l=ir(a),u=Th(a),h=s.holder.scrollTop,c=this.hot.rootWindow!==u?u.scrollTop:0,d=l.top-c,f=Je(vi,this).eventPageY-d+h,g=s.hider.offsetHeight,p=s.TBODY.offsetTop,v=Je(Jr,this).getOffset().top,y=Je(Jr,this).getSize().height,S=o.offsetHeight/2,R=o.offsetHeight;let A=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const O=f>=A+S;this.isFixedRowTop(e.row)&&(A+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?Je(vi,this).row=t>0?t-1:t:O?(Je(vi,this).row=e.row+1,A+=e.row===0?R-1:R):Je(vi,this).row=e.row;let V=f,B=A;f+y+v>=g?V=g-y-v:f+v<p&&(V=p+Math.abs(v)),A>=g-1&&(B=g-1),Je(Jr,this).setPosition(V),Je(Fl,this).setPosition(B)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",t=>Ol(zu,this,wue).call(this,t)),this.eventManager.addEventListener(e,"mouseup",()=>Ol(zu,this,yue).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){Je(Jr,this).build(),Je(Fl,this).build()}destroy(){Je(Jr,this).destroy(),Je(Fl,this).destroy(),super.destroy()}}function pue(n,e,t,r){const{wtTable:i,wtViewport:s}=this.hot.view._wt,o=this.hot.selection.isSelectedByRowHeader(),a=this.hot.getSelectedRangeLast();if(!a||!o||Je(jl,this)||n.button!==0){wh(jl,this,!1),Je(ja,this).length=0,Xe(this.hot.rootElement,[mN,wy]);return}const l=Je(Fl,this).isBuilt()&&!Je(Fl,this).isAppended(),u=Je(Jr,this).isBuilt()&&!Je(Jr,this).isAppended();l&&u&&(Je(Fl,this).appendTo(i.hider),Je(Jr,this).appendTo(i.hider));const{from:h,to:c}=a,d=Math.min(h.row,c.row),f=Math.max(h.row,c.row);if(e.col<0&&e.row>=d&&e.row<=f){r.row=!0,wh(jl,this,!0),Je(vi,this).eventPageY=n.pageY,Je(vi,this).coords=e,Je(vi,this).TD=t,wh(ja,this,this.prepareRowsToMoving());const g=i.holder.scrollLeft+s.getRowHeaderWidth(),p=this.getRowsHeight(d,e.row-1)+n.offsetY;Je(Jr,this).setPosition(null,g),Je(Jr,this).setSize(i.hider.offsetWidth-g,this.getRowsHeight(d,f)),Je(Jr,this).setOffset(-p,null),ie(this.hot.rootElement,mN),this.refreshPositions()}else Xe(this.hot.rootElement,gN),wh(jl,this,!1),Je(ja,this).length=0}function wue(n){Je(jl,this)&&(Je(vi,this).eventPageY=n.pageY,this.refreshPositions())}function vue(n,e,t,r){!this.hot.getSelectedRangeLast()||!Je(jl,this)||(Je(ja,this).indexOf(e.row)>-1?Xe(this.hot.rootElement,wy):ie(this.hot.rootElement,wy),r.row=!0,r.column=!0,r.cell=!0,Je(vi,this).coords=e,Je(vi,this).TD=t)}function yue(){const n=Je(vi,this).row,e=Je(ja,this).length;if(wh(jl,this,!1),Xe(this.hot.rootElement,[mN,wy,gN]),this.hot.selection.isSelectedByRowHeader()&&ie(this.hot.rootElement,gN),e<1||n===void 0)return;const t=Je(ja,this)[0],r=this.hot.toPhysicalRow(t),i=this.dragRows(Je(ja,this),n);if(Je(ja,this).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const s=this.hot.toVisualRow(r),o=s+e-1;this.hot.selectRows(s,o)}}function Cue(){const n=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),t=n.holder.scrollLeft,r=e+t;Je(Jr,this).setPosition(null,r),Je(Jr,this).setSize(n.hider.offsetWidth-r)}function Sue(){this.moveBySettingsOrLoad()}function Rue(n,e){o$(n,e),e.add(n)}function Hr(n,e,t){o$(n,e),e.set(n,t)}function o$(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Sn(n,e,t){return n.set(Ha(n,e),t),t}function pe(n,e){return n.get(Ha(n,e))}function Ha(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const vy="manualRowResize",Eue=30,lD="manualRowHeights";var ko=new WeakMap,ww=new WeakMap,Fi=new WeakMap,Rm=new WeakMap,kl=new WeakMap,MO=new WeakMap,cd=new WeakMap,vw=new WeakMap,qr=new WeakMap,Do=new WeakMap,_h=new WeakMap,yy=new WeakMap,Em=new WeakMap,bm=new WeakMap,Ks=new WeakMap,Tm=new WeakMap,Sl=new WeakSet;class bue extends _t{static get PLUGIN_KEY(){return vy}static get PLUGIN_PRIORITY(){return Eue}constructor(e){super(e),Rue(this,Sl),Hr(this,ko,null),Hr(this,ww,null),Hr(this,Fi,[]),Hr(this,Rm,null),Hr(this,kl,null),Hr(this,MO,null),Hr(this,cd,null),Hr(this,vw,null),Hr(this,qr,this.hot.rootDocument.createElement("DIV")),Hr(this,Do,this.hot.rootDocument.createElement("DIV")),Hr(this,_h,!1),Hr(this,yy,!1),Hr(this,Em,0),Hr(this,bm,null),Hr(this,Ks,void 0),Hr(this,Tm,void 0),ie(pe(qr,this),"manualRowResizer"),ie(pe(Do,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[vy]}enablePlugin(){this.enabled||(Sn(Ks,this,new uu),pe(Ks,this).addLocalHook("init",()=>Ha(Sl,this,_ue).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,pe(Ks,this)),this.addHook("modifyRowHeight",(e,t)=>Ha(Sl,this,Oue).call(this,e,t)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Sn(Tm,this,pe(Ks,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",lD,pe(Ks,this).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",lD,e),e.value}setManualSize(e,t){const r=this.hot.toPhysicalRow(e),i=Math.max(t,NU);return pe(Ks,this).setValueAtIndex(r,i),i}getLastDesiredRowHeight(){return pe(Rm,this)}setupHandlePosition(e){Sn(ko,this,e);const{view:t}=this.hot,{_wt:r}=t,i=r.wtTable.getCoords(pe(ko,this)),s=i.row;if(s<0)return;const o=rn(pe(ko,this)),a=pe(ko,this).getBoundingClientRect(),l=s<r.getSetting("fixedRowsTop"),u=s>=t.countNotHiddenRowIndexes(0,1)-r.getSetting("fixedRowsBottom");let h;l?h=r.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(pe(ko,this),i.row,i.col):u&&(h=r.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(pe(ko,this),i.row,i.col)),h||(h=r.wtOverlays.inlineStartOverlay.getRelativeCellPosition(pe(ko,this),i.row,i.col)),Sn(ww,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(s)),Sn(Fi,this,[]);const c=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&c){const d=this.hot.getSelectedRange();L(d,f=>{const g=f.getTopStartCorner().row,p=f.getBottomStartCorner().row;Pe(g,p,v=>{pe(Fi,this).includes(v)||pe(Fi,this).push(v)})})}pe(Fi,this).includes(pe(ww,this))||Sn(Fi,this,[pe(ww,this)]),Sn(vw,this,h.top-6),Sn(cd,this,parseInt(a.height,10)),pe(qr,this).style.top=`${pe(vw,this)+pe(cd,this)}px`,pe(qr,this).style[this.inlineDir]=`${h.start}px`,pe(qr,this).style.width=`${o}px`,this.hot.rootElement.appendChild(pe(qr,this))}refreshHandlePosition(){pe(qr,this).style.top=`${pe(vw,this)+pe(Rm,this)}px`}setupGuidePosition(){const e=parseInt(rn(pe(qr,this)),10),t=parseInt(pe(qr,this).style[this.inlineDir],10)+e,r=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);ie(pe(qr,this),"active"),ie(pe(Do,this),"active"),pe(Do,this).style.top=pe(qr,this).style.top,pe(Do,this).style[this.inlineDir]=`${t}px`,pe(Do,this).style.width=`${r-e}px`,this.hot.rootElement.appendChild(pe(Do,this))}refreshGuidePosition(){pe(Do,this).style.top=pe(qr,this).style.top}hideHandleAndGuide(){Xe(pe(qr,this),"active"),Xe(pe(Do,this),"active")}checkIfRowHeader(e){const t=nu(e,["TBODY"],this.hot.rootElement),{inlineStartOverlay:r,topInlineStartCornerOverlay:i,bottomInlineStartCornerOverlay:s}=this.hot.view._wt.wtOverlays;return[r.clone.wtTable.TBODY,i.clone.wtTable.TBODY,s.clone.wtTable.TBODY].includes(t)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const t=this.hot.view._wt.wtTable.getRowHeight(e);return t!==void 0&&pe(kl,this)<t?t:pe(kl,this)}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},t=(r,i)=>{const s=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(r),r,!0);s!==void 0&&Sn(kl,this,s),this.setManualSize(r,pe(kl,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(r),r,!0),i&&e()};pe(Em,this)>=2&&(pe(Fi,this).length>1?(L(pe(Fi,this),i=>{t(i)}),e()):L(pe(Fi,this),i=>{t(i,!0)})),Sn(Em,this,0),Sn(bm,this,null)}bindEvents(){const{rootElement:e,rootWindow:t}=this.hot;this.eventManager.addEventListener(e,"mouseover",r=>Ha(Sl,this,Tue).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>Ha(Sl,this,Aue).call(this,r)),this.eventManager.addEventListener(t,"mousemove",r=>Ha(Sl,this,Nue).call(this,r)),this.eventManager.addEventListener(t,"mouseup",()=>Ha(Sl,this,Mue).call(this)),this.eventManager.addEventListener(pe(qr,this),"contextmenu",()=>Ha(Sl,this,Iue).call(this))}destroy(){super.destroy()}}function Tue(n){if(!$M(n.target)&&pe(yy,this)!==!0&&this.checkIfRowHeader(n.target)){const e=this.getClosestTHParent(n.target);e&&(pe(_h,this)||this.setupHandlePosition(e))}}function Aue(n){je(n.target,"manualRowResizer")&&(this.setupHandlePosition(pe(ko,this)),this.setupGuidePosition(),Sn(_h,this,!0),pe(bm,this)===null&&(Sn(bm,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(pe(bm,this))),Sn(Em,this,pe(Em,this)+1),Sn(MO,this,n.pageY),Sn(kl,this,pe(cd,this)))}function Nue(n){pe(_h,this)&&(Sn(Rm,this,pe(cd,this)+(n.pageY-pe(MO,this))),L(pe(Fi,this),e=>{Sn(kl,this,this.setManualSize(e,pe(Rm,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function Mue(){const n=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},e=(t,r)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(t),t,!1),r&&n(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(t),t,!1)};pe(_h,this)&&(this.hideHandleAndGuide(),Sn(_h,this,!1),pe(kl,this)!==pe(cd,this)&&(pe(Fi,this).length>1?(L(pe(Fi,this),r=>{e(r)}),n()):L(pe(Fi,this),r=>{e(r,!0)})),this.setupHandlePosition(pe(ko,this)))}function Iue(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(pe(qr,this)),this.hot.rootElement.removeChild(pe(Do,this)),Sn(_h,this,!1),Sn(yy,this,!0),this.hot._registerImmediate(()=>{Sn(yy,this,!1)})}function Oue(n,e){let t=n;if(this.enabled){const r=this.hot.toPhysicalRow(e),i=pe(Ks,this).getValueAtIndex(r);this.hot.getSettings()[vy]&&i&&(t=i)}return t}function _ue(){const n=this.hot.getSettings()[vy],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e<"u"?e.forEach((t,r)=>{pe(Ks,this).setValueAtIndex(r,t)}):Array.isArray(n)?(n.forEach((t,r)=>{pe(Ks,this).setValueAtIndex(r,t)}),Sn(Tm,this,n)):n===!0&&Array.isArray(pe(Tm,this))&&pe(Tm,this).forEach((t,r)=>{pe(Ks,this).setValueAtIndex(r,t)})},!0)}function Pue(n,e,t){xue(n,e),e.set(n,t)}function xue(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yu(n,e,t){return(e=Lue(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Lue(n){var e=Hue(n,"string");return typeof e=="symbol"?e:e+""}function Hue(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function uD(n,e){return n.get(a$(n,e))}function yw(n,e,t){return n.set(a$(n,e),t),t}function a$(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Ku=new WeakMap;class Vo{constructor(e,t,r,i,s,o){Yu(this,"row",void 0),Yu(this,"col",void 0),Yu(this,"rowspan",void 0),Yu(this,"colspan",void 0),Yu(this,"removed",!1),Yu(this,"cellCoordsFactory",void 0),Yu(this,"cellRangeFactory",void 0),Pue(this,Ku,null),this.row=e,this.col=t,this.rowspan=r,this.colspan=i,this.cellCoordsFactory=s,this.cellRangeFactory=o}static NEGATIVE_VALUES_WARNING(e){let{row:t,col:r,rowspan:i,colspan:s}=e;return Bt`The merged cell declared with {row: ${t}, col: ${r},\x20
      rowspan: ${i}, colspan: ${s}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){let{row:t,col:r}=e;return Bt`The merged cell declared at [${t}, ${r}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){let{row:t,col:r}=e;return Bt`The merged cell declared at [${t}, ${r}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){let{row:t,col:r}=e;return Bt`The merged cell declared at [${t}, ${r}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){let{row:t,col:r,rowspan:i,colspan:s}=e;return t<0||r<0||i<0||s<0}static isSingleCell(e){let{rowspan:t,colspan:r}=e;return r===1&&t===1}static containsZeroSpan(e){let{rowspan:t,colspan:r}=e;return r===0||t===0}static isOutOfBounds(e,t,r){return e.row<0||e.col<0||e.row>=t||e.row+e.rowspan-1>=t||e.col>=r||e.col+e.colspan-1>=r}normalize(e){const t=e.countRows(),r=e.countCols();this.row<0?this.row=0:this.row>t-1&&(this.row=t-1),this.col<0?this.col=0:this.col>r-1&&(this.col=r-1),this.row+this.rowspan>t-1&&(this.rowspan=t-this.row),this.col+this.colspan>r-1&&(this.colspan=r-this.col),yw(Ku,this,null)}includes(e,t){return this.row<=e&&this.col<=t&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=t}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,t){const r=e[0]||e[1],i=t+Math.abs(e[0]||e[1])-1,s=e[0]?"colspan":"rowspan",o=e[0]?"col":"row",a=Math.min(t,i),l=Math.max(t,i),u=this[o],h=this[o]+this[s]-1;if(u>=t&&(this[o]+=r),r>0)t<=h&&t>u&&(this[s]+=r);else if(r<0){if(a<=u&&l>=h)return this.removed=!0,yw(Ku,this,null),!1;if(u>=a&&u<=l){const c=l-u+1,d=Math.abs(r)-c;this[o]-=d+r,this[s]-=c}else if(u<=a&&h>=l)this[s]+=r;else if(u<=a&&h>=a&&h<l){const c=h-a+1;this[s]-=c}}return yw(Ku,this,null),!0}isFarther(e,t){return e?t==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:t==="up"?e.row>this.row:t==="right"?e.col+e.colspan-1<this.col+this.colspan-1:t==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return uD(Ku,this)||yw(Ku,this,this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))),uD(Ku,this)}}function Due(n,e){Fue(n,e),e.add(n)}function Fue(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Cw(n,e,t){return(e=kue(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function kue(n){var e=Vue(n,"string");return typeof e=="symbol"?e:e+""}function Vue(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function qu(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Rl=new WeakSet;class Cy{constructor(e){Due(this,Rl),Cw(this,"plugin",void 0),Cw(this,"mergedCells",[]),Cw(this,"mergedCellsMatrix",new Map),Cw(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){let{row:t,col:r}=e;return Bt`The merged cell declared at [${t}, ${r}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,t){var r;return this.mergedCellsMatrix.has(e)&&(r=this.mergedCellsMatrix.get(e).get(t))!==null&&r!==void 0?r:!1}getByRange(e){let t=!1;return L(this.mergedCells,r=>r.row<=e.from.row&&r.row+r.rowspan-1>=e.to.row&&r.col<=e.from.col&&r.col+r.colspan-1>=e.to.col?(t=r,t):!0),t}filterOverlappingMergeCells(e){const t=new Set;return this.mergedCells.forEach(i=>{const{row:s,col:o,colspan:a,rowspan:l}=i;for(let u=s;u<s+l;u++)for(let h=o;h<o+a;h++)t.add(`r${u},c${h}`)}),e.filter(i=>{const{row:s,col:o,colspan:a,rowspan:l}=i,u=new Set;let h=!1;for(let c=s;c<s+l;c++){for(let d=o;d<o+a;d++){const f=`r${c},c${d}`;if(t.has(f)){Ut(Cy.IS_OVERLAPPING_WARNING(i)),h=!0;break}u.add(f)}if(h)break}return h||t.add(...u),!h})}getWithinRange(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{row:r,col:i}=e.getTopStartCorner(),{row:s,col:o}=e.getBottomEndCorner(),a=[];for(let l=r;l<=s;l++)for(let u=i;u<=o;u++){const h=this.get(l,u);h&&(t||!t&&h.row===l&&h.col===u)&&a.push(h)}return a}add(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=e.row,i=e.col,s=e.rowspan,o=e.colspan,a=new Vo(r,i,s,o,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(r,i),u=t?!1:this.isOverlapping(a);return!l&&!u?(this.hot&&a.normalize(this.hot),this.mergedCells.push(a),qu(Rl,this,hD).call(this,a),a):(Ut(Cy.IS_OVERLAPPING_WARNING(a)),!1)}remove(e,t){const r=this.get(e,t),i=r?this.mergedCells.indexOf(r):-1;return r&&i!==-1?(this.mergedCells.splice(i,1),qu(Rl,this,Uue).call(this,r),r):!1}clear(){L(this.mergedCells,e=>{let{row:t,col:r,rowspan:i,colspan:s}=e;Pe(t,t+i,o=>{Pe(r,r+s,a=>{const l=this.hot.getCell(o,a);l&&(l.removeAttribute("rowspan"),l.removeAttribute("colspan"),l.style.display="")})})}),this.mergedCells.length=0,this.mergedCellsMatrix=new Map}isOverlapping(e){const t=e.getRange();for(let r=0;r<this.mergedCells.length;r++)if(this.mergedCells[r].getRange().overlaps(t))return!0;return!1}isFirstRenderableMergedCell(e,t){const r=this.get(e,t);return r&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1)===t}getFirstRenderableCoords(e,t){const r=this.get(e,t);if(!r||this.isFirstRenderableMergedCell(e,t))return this.hot._createCellCoords(e,t);const i=this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1),s=this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1);return this.hot._createCellCoords(i,s)}getStartMostColumnIndex(e,t){const r=qu(Rl,this,Sw).call(this,e,"col",-1);let i=t;for(let s=0;s<r.length;s++)if(r[s]<=t){i=r[s];break}return i}getEndMostColumnIndex(e,t){const r=qu(Rl,this,Sw).call(this,e,"col",1);let i=t;for(let s=0;s<r.length;s++)if(r[s]>=t){i=r[s];break}return i}getTopMostRowIndex(e,t){const r=qu(Rl,this,Sw).call(this,e,"row",-1);let i=t;for(let s=0;s<r.length;s++)if(r[s]<=t){i=r[s];break}return i}getBottomMostRowIndex(e,t){const r=qu(Rl,this,Sw).call(this,e,"row",1);let i=t;for(let s=0;s<r.length;s++)if(r[s]>=t){i=r[s];break}return i}shiftCollections(e,t,r){const i=[0,0];switch(e){case"right":i[0]+=r;break;case"left":i[0]-=r;break;case"down":i[1]+=r;break;case"up":i[1]-=r;break}const s=[];this.mergedCells.forEach(o=>{o.shift(i,t),o.removed&&s.push(o)}),s.forEach(o=>{this.mergedCells.splice(this.mergedCells.indexOf(o),1)}),this.mergedCellsMatrix.clear(),this.mergedCells.forEach(o=>{qu(Rl,this,hD).call(this,o)})}}function Sw(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const r=new Map,i=t===1?n.getTopStartCorner():n.getBottomEndCorner(),s=t===1?n.getBottomEndCorner():n.getTopStartCorner();for(let o=i.row;t===1?o<=s.row:o>=s.row;o+=t)for(let a=i.col;t===1?a<=s.col:a>=s.col;a+=t){const l=e==="row"?o:a,u=this.get(o,a);let h=l;u&&(h=t===1?u[e]+u[`${e}span`]-1:u[e]),r.has(l)||r.set(l,new Set),r.get(l).add(h)}return Array.from(new Set(Array.from(r.entries()).filter(o=>{let[,a]=o;return a.size===1}).flatMap(o=>{let[,a]=o;return Array.from(a)})))}function hD(n){for(let e=n.row;e<n.row+n.rowspan;e++)for(let t=n.col;t<n.col+n.colspan;t++)this.mergedCellsMatrix.has(e)||this.mergedCellsMatrix.set(e,new Map),this.mergedCellsMatrix.get(e).set(t,n)}function Uue(n){for(let e=n.row;e<n.row+n.rowspan;e++)for(let t=n.col;t<n.col+n.colspan;t++)this.mergedCellsMatrix.get(e).delete(t)}function TT(n,e,t){return(e=Bue(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Bue(n){var e=Wue(n,"string");return typeof e=="symbol"?e:e+""}function Wue(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class $ue{constructor(e){TT(this,"plugin",void 0),TT(this,"mergedCellsCollection",void 0),TT(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}correctSelectionAreaSize(e){if(e[0]===e[2]&&e[1]===e[3]){const t=this.mergedCellsCollection.get(e[0],e[1]);t&&(e[2]=e[0]+t.rowspan-1,e[3]=e[1]+t.colspan-1)}}getDirection(e,t){let r=null;return t[0]===e[0]&&t[1]===e[1]&&t[3]===e[3]?r="down":t[2]===e[2]&&t[1]===e[1]&&t[3]===e[3]?r="up":t[1]===e[1]&&t[2]===e[2]?r="right":r="left",r}snapDragArea(e,t,r,i){const s=t.slice(0),o=this.getAutofillSize(e,t,r),[a,l,u,h]=e,d=["up","down"].indexOf(r)>-1?u-a+1:h-l+1,f=Math.floor(o/d)*d,g=o-f,p=this.getFarthestCollection(e,t,r,i);if(p){if(r==="down"){const v=p.row+p.rowspan-a-g;s[2]+v>=this.plugin.hot.countRows()?s[2]-=g:s[2]+=g?v:0}else if(r==="right"){const v=p.col+p.colspan-l-g;s[3]+v>=this.plugin.hot.countCols()?s[3]-=g:s[3]+=g?v:0}else if(r==="up"){const v=u-g-p.row+1;s[0]+v<0?s[0]+=g:s[0]-=g?v:0}else if(r==="left"){const v=h-g-p.col+1;s[1]+v<0?s[1]+=g:s[1]-=g?v:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:r,foundMergedCells:i,fillSize:o,dragArea:s,cycleLength:d}),s}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),Gn(this.currentFillData,e)}getAutofillSize(e,t,r){const[i,s,o,a]=e,[l,u,h,c]=t;switch(r){case"up":return i-l;case"down":return h-o;case"left":return s-u;case"right":return c-a;default:return null}}getDragArea(e,t,r){const[i,s,o,a]=e,[l,u,h,c]=t;switch(r){case"up":return[l,u,i-1,a];case"down":return[o+1,s,h,a];case"left":return[l,u,o,s-1];case"right":return[i,a+1,h,c];default:return null}}getFarthestCollection(e,t,r,i){const[s,o,a,l]=e,u=["up","down"].indexOf(r)>-1,h=u?a:l,c=u?s:o,d=this.getAutofillSize(e,t,r),f=u?a-s+1:l-o+1,g=Math.floor(d/f)*f,p=d-g;let v=null,y=null,S=null;switch(r){case"up":v="includesVertically",S=h-p+1;break;case"left":v="includesHorizontally",S=h-p+1;break;case"down":v="includesVertically",S=c+p-1;break;case"right":v="includesHorizontally",S=c+p-1;break}return L(i,R=>{R[v](S)&&R.isFarther(y,r)&&(y=R)}),y}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const t=this.getRangeFromChanges(e),r=this.currentFillData.foundMergedCells,i=this.currentFillData.dragDirection,s=(u,h)=>{switch(i){case"up":return u.row-h>=t.from.row;case"down":return u.row+u.rowspan-1+h<=t.to.row;case"left":return u.col-h>=t.from.column;case"right":return u.col+u.colspan-1+h<=t.to.column;default:return null}};let o=0,a=null,l=1;do for(let u=0;u<r.length;u+=1){if(a=r[u],o=l*this.currentFillData.cycleLength,s(a,o))switch(i){case"up":this.plugin.mergedCellsCollection.add({row:a.row-o,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+o,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-o,colspan:a.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+o,colspan:a.colspan});break}u===r.length-1&&(l+=1)}while(s(a,o));this.currentFillData=null,this.plugin.hot.render(),r.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const t={min:null,max:null},r={min:null,max:null};return L(e,i=>{const s=i[0],o=this.plugin.hot.propToCol(i[1]);(t.min===null||s<t.min)&&(t.min=s),(t.max===null||s>t.max)&&(t.max=s),(r.min===null||o<r.min)&&(r.min=o),(r.max===null||o>r.max)&&(r.max=o)}),{from:{row:t.min,column:r.min},to:{row:t.max,column:r.max}}}dragAreaOverlapsCollections(e,t,r){const i=this.getDragArea(e,t,r),[s,o,a,l]=i,u=this.plugin.hot._createCellCoords(s,o),h=this.plugin.hot._createCellCoords(a,l),c=this.plugin.hot._createCellRange(u,u,h);return this.mergedCellsCollection.getWithinRange(c,!0).length>0}}function AT(n,e,t){return(e=Gue(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Gue(n){var e=jue(n,"string");return typeof e=="symbol"?e:e+""}function jue(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class zue{constructor(e){AT(this,"plugin",void 0),AT(this,"hot",void 0),AT(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}getSelectedMergedCellClassName(e,t,r,i){const s=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]);if(i===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,t))return;const h=this.plugin.mergedCellsCollection.get(e,t);if(!h)return;const c=h.getLastRow(),d=h.getLastColumn();if(s<=h.row&&o<=h.col&&a>=c&&l>=d)return`${this.fullySelectedMergedCellClassName}-${i}`;if(this.isMergeCellFullySelected(h,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,t){const r=[];if(!t||!e)return!1;for(let i=0;i<e.rowspan;i+=1)for(let s=0;s<e.colspan;s+=1)r.push(this.hot._createCellCoords(e.row+i,e.col+s));for(let i=0;i<r.length;i+=1){const s=[];for(let o=0;o<t.length;o+=1)s[o]=t[o].includes(r[i]);if(!s.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let t=0;t<=7;t+=1)e.push(`${this.fullySelectedMergedCellClassName}-${t}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}function Yue(n){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const t=n.mergedCellsCollection.get(e[0],e[1]);if(t.row===e[0]&&t.col===e[1]&&t.row+t.rowspan-1===e[2]&&t.col+t.colspan-1===e[3])return this.getTranslatedPhrase(q0)}return this.getTranslatedPhrase(K0)},callback(){const e=this.getSelectedRangeLast();if(!e)return;e.setDirection(this.isRtl()?"NE-SW":"NW-SE");const{from:t,to:r}=e;n.toggleMerge(e),this.selectCell(t.row,t.col,r.row,r.col,!1)},disabled(){const e=this.getSelectedLast();return e?Vo.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}function Am(n,e,t){return(e=Kue(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Kue(n){var e=que(n,"string");return typeof e=="symbol"?e:e+""}function que(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class cD{constructor(e){Am(this,"data",void 0),Am(this,"next",null),Am(this,"prev",null),this.data=e}}class Rw{constructor(){Am(this,"first",null),Am(this,"last",null)}push(e){const t=new cD(e);if(this.first===null)this.first=t,this.last=t;else{const r=this.last;this.last=t,t.prev=r,r.next=t}return t}unshift(e){const t=new cD(e);if(this.first===null)this.first=t,this.last=t;else{const r=this.first;this.first=t,t.next=r,r.prev=t}}inorder(e){let t=this.first;for(;t;){const r=e(t);if(t===this.last||r===!0)break;t=t.next}}remove(e){if(this.first===null)return!1;let t=this.first,r,i;for(;t;){if(t.data===e)return r=t.next,i=t.prev,r&&(r.prev=i),i&&(i.next=r),t===this.first&&(this.first=r),t===this.last&&(this.last=i),!0;t=t.next}return!1}hasCycle(){let e=this.first,t=this.first;for(;;){if(e===null||(e=e.next,e===null))return!1;if(e=e.next,t=t.next,e===t)return!0}}pop(){if(this.last===null)return null;const e=this.last;return this.last=this.last.prev,e}shift(){if(this.first===null)return null;const e=this.first;return this.first=this.first.next,e}recursiveReverse(){function e(r,i){i&&(e(i,i.next),i.next=r)}if(!this.first)return;e(this.first,this.first.next),this.first.next=null;const t=this.first;this.first=this.last,this.last=t}reverse(){if(!this.first||!this.first.next)return;let e=this.first.next,t=this.first,r;for(;e;)r=e.next,e.next=t,t.prev=e,t=e,e=r;this.first.next=null,this.last.prev=null,r=this.first,this.first=t,this.last=r}}function Xue(n,e){l$(n,e),e.add(n)}function Xu(n,e,t){l$(n,e),e.set(n,t)}function l$(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Dt(n,e){return n.get(Sy(n,e))}function Ii(n,e,t){return n.set(Sy(n,e),t),t}function Sy(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Mo=new WeakMap,Io=new WeakMap,Oo=new WeakMap,_o=new WeakMap,pN=new WeakMap,Ew=new WeakMap,bw=new WeakMap,NT=new WeakSet;class Que{constructor(e){let{mergedCellsGetter:t,rowIndexMapper:r,columnIndexMapper:i}=e;Xue(this,NT),Xu(this,Mo,new Rw),Xu(this,Io,new Rw),Xu(this,Oo,null),Xu(this,_o,null),Xu(this,pN,null),Xu(this,Ew,null),Xu(this,bw,null),Ii(pN,this,t),Ii(Ew,this,r),Ii(bw,this,i)}getCurrentVerticalNode(){return Dt(_o,this).data}getFirstVerticalNode(){return Dt(Io,this).first.data}getNextVerticalNode(){return Dt(_o,this).next.data}getPrevVerticalNode(){return Dt(_o,this).prev.data}getCurrentHorizontalNode(){return Dt(Oo,this).data}getFirstHorizontalNode(){return Dt(Mo,this).first.data}getNextHorizontalNode(){return Dt(Oo,this).next.data}getPrevHorizontalNode(){return Dt(Oo,this).prev.data}setPrevNodeAsActive(){Ii(_o,this,Dt(_o,this).prev),Ii(Oo,this,Dt(Oo,this).prev)}setNextNodeAsActive(){Ii(_o,this,Dt(_o,this).next),Ii(Oo,this,Dt(Oo,this).next)}buildFocusOrder(e){const t=e.getTopStartCorner(),r=e.getBottomEndCorner(),i=new WeakSet;Ii(Mo,this,new Rw);for(let o=t.row;o<=r.row;o++)if(!Dt(Ew,this).isHidden(o))for(let a=t.col;a<=r.col;a++){if(Dt(bw,this).isHidden(a))continue;const l=Sy(NT,this,dD).call(this,e,Dt(Mo,this),i,o,a);l&&Ii(Oo,this,l)}Dt(Mo,this).first&&(Dt(Mo,this).first.prev=Dt(Mo,this).last,Dt(Mo,this).last.next=Dt(Mo,this).first);const s=new WeakSet;Ii(Io,this,new Rw);for(let o=t.col;o<=r.col;o++)if(!Dt(bw,this).isHidden(o))for(let a=t.row;a<=r.row;a++){if(Dt(Ew,this).isHidden(a))continue;const l=Sy(NT,this,dD).call(this,e,Dt(Io,this),s,a,o);l&&Ii(_o,this,l)}Dt(Io,this).first&&(Dt(Io,this).first.prev=Dt(Io,this).last,Dt(Io,this).last.next=Dt(Io,this).first)}setActiveNode(e,t){return Dt(Mo,this).inorder(r=>{const{rowStart:i,rowEnd:s,colStart:o,colEnd:a}=r.data;if(e>=i&&e<=s&&t>=o&&t<=a)return Ii(Oo,this,r),!1}),Dt(Io,this).inorder(r=>{const{rowStart:i,rowEnd:s,colStart:o,colEnd:a}=r.data;if(e>=i&&e<=s&&t>=o&&t<=a)return Ii(_o,this,r),!1}),this}}function dD(n,e,t,r,i){const s=n.getTopStartCorner(),o=n.getBottomEndCorner(),a=n.highlight.clone().normalize(),l=Dt(pN,this).call(this,r,i);if(l&&t.has(l))return null;const u={colStart:i,colEnd:i,rowStart:r,rowEnd:r};if(l){if(t.add(l),l.row<s.row||l.row+l.rowspan-1>o.row||l.col<s.col||l.col+l.colspan-1>o.col)return null;u.colStart=l.col,u.colEnd=l.col+l.colspan-1,u.rowStart=l.row,u.rowEnd=l.row+l.rowspan-1}const h=e.push(u);return r===a.row&&i===a.col||l&&a.row>=l.row&&a.row<=l.row+l.rowspan-1&&a.col>=l.col&&a.col<=l.col+l.colspan-1?h:null}function Zue(n){const{hot:e}=n,{rowIndexMapper:t,columnIndexMapper:r}=e;function i(){}function s(o,a,l){const u=n.mergedCellsCollection.get(a,l);if(!ot(u)){o.removeAttribute("rowspan"),o.removeAttribute("colspan"),o.style.display="";return}const{row:h,col:c,colspan:d,rowspan:f}=u,[g,p]=n.translateMergedCellToRenderable(h,f,c,d),v=t.getRenderableFromVisualIndex(a),y=r.getRenderableFromVisualIndex(l),S=g-v+1,R=p-y+1,A=t.getNearestNotHiddenIndex(h,1),O=r.getNearestNotHiddenIndex(c,1),V=Math.min(f,S),B=Math.min(d,R);A===a&&O===l?(o.setAttribute("rowspan",V),o.setAttribute("colspan",B)):(o.removeAttribute("rowspan"),o.removeAttribute("colspan"),o.style.display="none")}return{before:i,after:s}}function Jue(n,e){u$(n,e),e.add(n)}function Tw(n,e,t){u$(n,e),e.set(n,t)}function u$(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function MT(n,e,t){return(e=ehe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function ehe(n){var e=the(n,"string");return typeof e=="symbol"?e:e+""}function the(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function ig(n,e,t){return n.set(Ft(n,e),t),t}function en(n,e){return n.get(Ft(n,e))}function Ft(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}be.getSingleton().register("beforeMergeCells");be.getSingleton().register("afterMergeCells");be.getSingleton().register("beforeUnmergeCells");be.getSingleton().register("afterUnmergeCells");const Nm="mergeCells",nhe=150,fD=Nm;var cs=new WeakMap,ds=new WeakMap,qo=new WeakMap,mD=new WeakMap,$t=new WeakSet;class rhe extends _t{constructor(){super(...arguments),Jue(this,$t),MT(this,"mergedCellsCollection",null),MT(this,"autofillCalculations",null),MT(this,"selectionCalculations",null),Tw(this,cs,null),Tw(this,ds,{row:0,col:0}),Tw(this,qo,new Que({mergedCellsGetter:(e,t)=>this.mergedCellsCollection.get(e,t),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper})),Tw(this,mD,Zue(this))}static get PLUGIN_KEY(){return Nm}static get PLUGIN_PRIORITY(){return nhe}isEnabled(){return!!this.hot.getSettings()[Nm]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new Cy(this),this.autofillCalculations=new $ue(this),this.selectionCalculations=new zue(this),this.addHook("afterInit",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Ft($t,e,ihe).call(e,...r)}),this.addHook("modifyTransformFocus",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Ft($t,e,ohe).call(e,...r)}),this.addHook("modifyTransformStart",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Ft($t,e,ahe).call(e,...r)}),this.addHook("modifyTransformEnd",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Ft($t,e,lhe).call(e,...r)}),this.addHook("beforeSelectionHighlightSet",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Ft($t,e,uhe).call(e,...r)}),this.addHook("beforeSetRangeStart",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Ft($t,e,gD).call(e,...r)}),this.addHook("beforeSetRangeStartOnly",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Ft($t,e,gD).call(e,...r)}),this.addHook("beforeSelectionFocusSet",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Ft($t,e,dhe).call(e,...r)}),this.addHook("afterSelectionFocusSet",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Ft($t,e,fhe).call(e,...r)}),this.addHook("afterSelectionEnd",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Ft($t,e,mhe).call(e,...r)}),this.addHook("modifyGetCellCoords",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Ft($t,e,hhe).call(e,...r)}),this.addHook("afterIsMultipleSelection",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Ft($t,e,she).call(e,...r)}),this.addHook("afterRenderer",function(){return en(mD,e).after(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Ft($t,e,che).call(e,...r)}),this.addHook("afterGetCellMeta",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Ft($t,e,ghe).call(e,...r)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Ft($t,e,phe).call(e,...r)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Ft($t,e,whe).call(e,...r)}),this.addHook("modifyAutofillRange",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Ft($t,e,vhe).call(e,...r)}),this.addHook("afterCreateCol",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Ft($t,e,yhe).call(e,...r)}),this.addHook("afterRemoveCol",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Ft($t,e,Che).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Ft($t,e,She).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Ft($t,e,Rhe).call(e,...r)}),this.addHook("afterChange",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Ft($t,e,Ehe).call(e,...r)}),this.addHook("beforeDrawBorders",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Ft($t,e,bhe).call(e,...r)}),this.addHook("afterDrawSelection",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Ft($t,e,The).call(e,...r)}),this.addHook("beforeRemoveCellClassNames",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Ft($t,e,Ahe).call(e,...r)}),this.addHook("beforeBeginEditing",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Ft($t,e,Nhe).call(e,...r)}),this.addHook("modifyRowHeightByOverlayName",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Ft($t,e,Mhe).call(e,...r)}),this.addHook("beforeUndoStackChange",(t,r)=>{if(r==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){const e=this.hot.getSettings()[Nm];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(e),super.updatePlugin()}ifChromeForceRepaint(){if(!KM())return;const e=[];let t=[];this.mergedCellsCollection.mergedCells.forEach(r=>{const{row:i,rowspan:s}=r;for(let o=i+1;o<i+s;o++)t.push(o)}),t=[...new Set(t)],t.forEach(r=>{const i=this.hot.rowIndexMapper.getRenderableFromVisualIndex(r);this.hot.view._wt.wtOverlays.getOverlays(!0).map(s=>s?.name==="master"?s:s.clone.wtTable).forEach(s=>{const o=s.getRow(i);o&&(o.style.background=vd(o,"backgroundColor").replace(")",", 0.99)"),e.push(o))})}),this.hot._registerTimeout(()=>{e.forEach(r=>{r.style.background=vd(r,"backgroundColor").replace(", 0.99)",")")})},1)}validateSetting(e){return e?Vo.containsNegativeValues(e)?(Ut(Vo.NEGATIVE_VALUES_WARNING(e)),!1):Vo.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(Ut(Vo.IS_OUT_OF_BOUNDS_WARNING(e)),!1):Vo.isSingleCell(e)?(Ut(Vo.IS_SINGLE_CELL(e)),!1):Vo.containsZeroSpan(e)?(Ut(Vo.ZERO_SPAN_WARNING(e)),!1):!0:!1}generateFromSettings(e){if(!Array.isArray(e))return;const t=e.filter(s=>this.validateSetting(s)),r=this.mergedCellsCollection.filterOverlappingMergeCells(t),i=[];r.forEach(s=>{const{row:o,col:a,rowspan:l,colspan:u}=s,h=this.hot._createCellCoords(o,a),c=this.hot._createCellCoords(o+l-1,a+u-1),d=this.hot._createCellRange(h,h,c);this.mergeRange(d,!0,!0);for(let f=o;f<o+l;f++)for(let g=a;g<a+u;g++)(f!==o||g!==a)&&i.push([f,g,null])}),i.length!==0&&this.hot.setDataAtCell(i,void 0,void 0,this.pluginName)}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:t,to:r}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(t.row,t.col,r.row,r.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:t,to:r}=e;this.unmergeRange(e,!0),this.hot.selectCell(t.row,t.col,r.row,r.col,!1)}mergeRange(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=e.getTopStartCorner(),s=e.getBottomEndCorner(),o={row:i.row,col:i.col,rowspan:s.row-i.row+1,colspan:s.col-i.col+1},a=[];let l=null;return this.canMergeRange(o,t)?(this.hot.runHooks("beforeMergeCells",e,t),Pe(0,o.rowspan-1,h=>{Pe(0,o.colspan-1,c=>{let d=null;a[h]||(a[h]=[]),h===0&&c===0?d=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(o.row),this.hot.toPhysicalColumn(o.col)):this.hot.setCellMeta(o.row+h,o.col+c,"hidden",!0),a[h][c]=d})}),this.hot.setCellMeta(o.row,o.col,"spanned",!0),this.mergedCellsCollection.add(o,t)?(r?l=[o.row,o.col,a]:this.hot.populateFromArray(o.row,o.col,a,void 0,void 0,this.pluginName),t||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,o,t),l):!0):!1}unmergeRange(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.mergedCellsCollection.getWithinRange(e);r.length!==0&&(this.hot.runHooks("beforeUnmergeCells",e,t),L(r,i=>{this.mergedCellsCollection.remove(i.row,i.col),Pe(0,i.rowspan-1,s=>{Pe(0,i.colspan-1,o=>{this.hot.removeCellMeta(i.row+s,i.col+o,"hidden"),this.hot.removeCellMeta(i.row+s,i.col+o,"copyable")})}),this.hot.removeCellMeta(i.row,i.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,t),this.hot.render())}toggleMerge(e){const t=this.mergedCellsCollection.get(e.from.row,e.from.col);t.row===e.from.row&&t.col===e.from.col&&t.row+t.rowspan-1===e.to.row&&t.col+t.colspan-1===e.to.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,t,r,i){const s=this.hot._createCellCoords(e,t),o=this.hot._createCellCoords(r,i);this.mergeRange(this.hot._createCellRange(s,s,o))}unmerge(e,t,r,i){const s=this.hot._createCellCoords(e,t),o=this.hot._createCellCoords(r,i);this.unmergeRange(this.hot._createCellRange(s,s,o))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const r=this.hot.getSelectedRangeLast();r&&!r.isSingleHeader()&&(this.toggleMerge(r),this.hot.render())},runOnlyIf:r=>!r.altKey,group:fD})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(fD)}modifyViewportRowStart(e,t){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.startRow);for(let s=0;s<t;s+=1){const o=this.mergedCellsCollection.get(i,s);if(ot(o)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(o.row,1));if(a<e.startRow){e.startRow=a,this.modifyViewportRowStart(e,t);return}}}}modifyViewportRowEnd(e,t){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.endRow);for(let s=0;s<t;s+=1){const o=this.mergedCellsCollection.get(i,s);if(ot(o)){const a=o.row+o.rowspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endRow){e.endRow=l,this.modifyViewportRowEnd(e,t);return}}}}modifyViewportColumnStart(e,t){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.startColumn);for(let s=0;s<t;s+=1){const o=this.mergedCellsCollection.get(s,i);if(ot(o)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(o.col,1));if(a<e.startColumn){e.startColumn=a,this.modifyViewportColumnStart(e,t);return}}}}modifyViewportColumnEnd(e,t){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.endColumn);for(let s=0;s<t;s+=1){const o=this.mergedCellsCollection.get(s,i);if(ot(o)){const a=o.col+o.colspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endColumn){e.endColumn=l,this.modifyViewportColumnEnd(e,t);return}}}}translateMergedCellToRenderable(e,t,r,i){const{rowIndexMapper:s,columnIndexMapper:o}=this.hot;let a,l;t===0?a=s.getNearestNotHiddenIndex(e,1):a=s.getNearestNotHiddenIndex(e+t-1,-1),i===0?l=o.getNearestNotHiddenIndex(r,1):l=o.getNearestNotHiddenIndex(r+i-1,-1);const u=e>=0?s.getRenderableFromVisualIndex(a):e,h=r>=0?o.getRenderableFromVisualIndex(l):r;return[u,h]}}function ihe(){this.generateFromSettings(this.hot.getSettings()[Nm]),this.hot.render()}function she(n){if(n){const e=this.mergedCellsCollection.mergedCells,t=this.hot.getSelectedRangeLast(),r=t.getTopStartCorner(),i=t.getBottomEndCorner();for(let s=0;s<e.length;s+=1)if(r.row===e[s].row&&r.col===e[s].col&&i.row===e[s].row+e[s].rowspan-1&&i.col===e[s].col+e[s].colspan-1)return!1}return n}function ohe(n){en(ds,this).row=n.row,en(ds,this).col=n.col}function ahe(n){const e=this.hot.getSelectedRangeLast(),{highlight:t}=e,{columnIndexMapper:r,rowIndexMapper:i}=this.hot;en(cs,this)&&(i.getRenderableFromVisualIndex(en(cs,this).row)!==null&&(t.row=en(cs,this).row),r.getRenderableFromVisualIndex(en(cs,this).col)!==null&&(t.col=en(cs,this).col),ig(cs,this,null));const s=this.mergedCellsCollection.get(t.row,t.col);if(!s)return;const o=s.col,a=s.col+s.colspan-1;if(n.col<0){const h=t.col>=o&&t.col<=a?o-1:a,c=r.getNearestNotHiddenIndex(h,-1);c===null?n.col=-this.hot.view.countRenderableColumnsInRange(0,t.col):n.col=-Math.max(this.hot.view.countRenderableColumnsInRange(c,t.col)-1,1)}else if(n.col>0){const h=t.col>=o&&t.col<=a?a+1:o,c=r.getNearestNotHiddenIndex(h,1);c===null?n.col=this.hot.view.countRenderableColumnsInRange(t.col,this.hot.countCols()):n.col=Math.max(this.hot.view.countRenderableColumnsInRange(t.col,c)-1,1)}const l=s.row,u=s.row+s.rowspan-1;if(n.row<0){const h=t.row>=l&&t.row<=u?l-1:u,c=i.getNearestNotHiddenIndex(h,-1);c===null?n.row=-this.hot.view.countRenderableRowsInRange(0,t.row):n.row=-Math.max(this.hot.view.countRenderableRowsInRange(c,t.row)-1,1)}else if(n.row>0){const h=t.row>=l&&t.row<=u?u+1:l,c=i.getNearestNotHiddenIndex(h,1);c===null?n.row=this.hot.view.countRenderableRowsInRange(t.row,this.hot.countRows()):n.row=Math.max(this.hot.view.countRenderableRowsInRange(t.row,c)-1,1)}}function lhe(n){const e=this.hot.getSelectedRangeLast(),t=e.clone(),{to:r}=e,{columnIndexMapper:i,rowIndexMapper:s}=this.hot,o=(a,l)=>{t.expand(this.hot._createCellCoords(a,l));for(let u=0;u<this.mergedCellsCollection.mergedCells.length;u+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[u].getRange())};if(n.col<0){let a=this.mergedCellsCollection.getStartMostColumnIndex(e,r.col)+n.col;o(r.row,a),e.getHorizontalDirection()==="E-W"&&t.getHorizontalDirection()==="E-W"&&(a=t.getTopStartCorner().col);const l=i.getNearestNotHiddenIndex(a,1);l!==null&&(n.col=-Math.max(this.hot.view.countRenderableColumnsInRange(l,r.col)-1,1))}else if(n.col>0){let a=this.mergedCellsCollection.getEndMostColumnIndex(e,r.col)+n.col;o(r.row,a),e.getHorizontalDirection()==="W-E"&&t.getHorizontalDirection()==="W-E"&&(a=t.getBottomEndCorner().col);const l=i.getNearestNotHiddenIndex(a,-1);l!==null&&(n.col=Math.max(this.hot.view.countRenderableColumnsInRange(r.col,l)-1,1))}if(n.row<0){let a=this.mergedCellsCollection.getTopMostRowIndex(e,r.row)+n.row;o(a,r.col),e.getVerticalDirection()==="S-N"&&t.getVerticalDirection()==="S-N"&&(a=t.getTopStartCorner().row);const l=s.getNearestNotHiddenIndex(a,1);l!==null&&(n.row=-Math.max(this.hot.view.countRenderableRowsInRange(l,r.row)-1,1))}else if(n.row>0){let a=this.mergedCellsCollection.getBottomMostRowIndex(e,r.row)+n.row;o(a,r.col),e.getVerticalDirection()==="N-S"&&t.getVerticalDirection()==="N-S"&&(a=t.getBottomStartCorner().row);const l=s.getNearestNotHiddenIndex(a,-1);l!==null&&(n.row=Math.max(this.hot.view.countRenderableRowsInRange(r.row,l)-1,1))}}function uhe(){const n=this.hot.getSelectedRangeLast(),{highlight:e}=n;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()){ig(cs,this,e.clone());return}for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)n.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange(),!1);for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)n.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange(),!1);const t=this.mergedCellsCollection.get(e.row,e.col);ig(cs,this,e.clone()),t&&e.assign(t)}function hhe(n,e){if(n<0||e<0)return;const t=this.mergedCellsCollection.get(n,e);if(!t)return;const{row:r,col:i,colspan:s,rowspan:o}=t;return[r,i,r+o-1,i+s-1]}function che(n){n.items.push({name:"---------"},Yue(this))}function gD(){ig(cs,this,null)}function dhe(){if(en(cs,this).isCell())return;const n=this.hot.getSelectedRangeLast(),e=n.getVerticalDirection(),t=n.getHorizontalDirection(),r=en(cs,this).clone().normalize();en(qo,this).setActiveNode(r.row,r.col),en(ds,this).row>0||en(ds,this).col>0?en(qo,this).setPrevNodeAsActive():(t==="E-W"&&en(ds,this).col<0||e==="S-N"&&en(ds,this).row<0)&&en(qo,this).setNextNodeAsActive()}function fhe(n,e){const t=this.hot.getSelectedRangeLast(),{columnIndexMapper:r,rowIndexMapper:i}=this.hot;let s=null,o=null;if(en(ds,this).col<0){const{rowEnd:a,colEnd:l}=en(qo,this).getPrevHorizontalNode();o=r.getNearestNotHiddenIndex(l,-1),s=i.getNearestNotHiddenIndex(a,-1)}else if(en(ds,this).col>0){const{rowStart:a,colStart:l}=en(qo,this).getNextHorizontalNode();o=r.getNearestNotHiddenIndex(l,1),s=i.getNearestNotHiddenIndex(a,1)}else if(en(ds,this).row<0){const{rowEnd:a,colEnd:l}=en(qo,this).getPrevVerticalNode();o=r.getNearestNotHiddenIndex(l,-1),s=i.getNearestNotHiddenIndex(a,-1)}else if(en(ds,this).row>0){const{rowStart:a,colStart:l}=en(qo,this).getNextVerticalNode();o=r.getNearestNotHiddenIndex(l,1),s=i.getNearestNotHiddenIndex(a,1)}if(s!==null||o!==null){const a=this.hot._createCellCoords(s,o),l=this.mergedCellsCollection.get(a.row,a.col),u=this.hot.selection.highlight.getFocus();n=a.row,e=a.col,l?t.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(l.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(l.col,1)}):t.highlight.assign(a),u.clear(),u.add(a).commit()}en(qo,this).setActiveNode(n,e),ig(ds,this,{row:0,col:0})}function mhe(){this.hot.getSelectedRangeLast().isHeader()||en(qo,this).buildFocusOrder(this.hot.getSelectedRangeLast())}function ghe(n,e,t){const r=this.mergedCellsCollection.get(n,e);r&&(r.row!==n||r.col!==e?t.copyable=!1:(t.rowspan=r.rowspan,t.colspan=r.colspan))}function phe(n){const e=this.hot.countCols();this.modifyViewportRowStart(n,e),this.modifyViewportRowEnd(n,e)}function whe(n){const e=this.hot.countRows();this.modifyViewportColumnStart(n,e),this.modifyViewportColumnEnd(n,e)}function vhe(n,e){this.autofillCalculations.correctSelectionAreaSize(e);const t=this.autofillCalculations.getDirection(e,n);let r=n;if(this.autofillCalculations.dragAreaOverlapsCollections(e,r,t))return r=e,r;const i=this.hot._createCellCoords(e[0],e[1]),s=this.hot._createCellCoords(e[2],e[3]),o=this.hot._createCellRange(i,i,s),a=this.mergedCellsCollection.getWithinRange(o);return a.length===0||(r=this.autofillCalculations.snapDragArea(e,r,t,a)),r}function yhe(n,e){this.mergedCellsCollection.shiftCollections("right",n,e)}function Che(n,e){this.mergedCellsCollection.shiftCollections("left",n,e)}function She(n,e,t){t!=="auto"&&this.mergedCellsCollection.shiftCollections("down",n,e)}function Rhe(n,e){this.mergedCellsCollection.shiftCollections("up",n,e)}function Ehe(n,e){e==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(n)}function bhe(n,e){if(e&&e==="area"){const t=this.hot.getSelectedRangeLast(),r=this.mergedCellsCollection.getWithinRange(t);L(r,i=>{t.getBottomEndCorner().row===i.getLastRow()&&t.getBottomEndCorner().col===i.getLastColumn()&&(n[2]=i.row,n[3]=i.col)})}}function The(n,e,t,r){if(t)return this.selectionCalculations.getSelectedMergedCellClassName(n,e,t,r)}function Ahe(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function Nhe(n,e,t,r){if(!(r instanceof MouseEvent))return;const i=this.hot.getSelectedRangeLast(),s=this.mergedCellsCollection.getByRange(i);if(!s)return;const o=this.hot._createCellCoords(s.row,s.col),a=this.hot._createCellCoords(s.row+s.rowspan-1,s.col+s.colspan-1);return this.hot.selection.getLayerLevel()===0&&i.isEqual(this.hot._createCellRange(o,o,a))}function Mhe(n,e,t){if(this.hot.getSettings().rowHeaders||t==="bottom"||t==="bottom_inline_start_corner")return n;let r,i;if(t==="master")r=this.hot.view.getFirstRenderedVisibleColumn(),i=this.hot.view.getLastRenderedVisibleColumn();else{const d=this.hot.view.getOverlayByName(t);r=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getFirstRenderedColumn()),i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getLastRenderedColumn())}if(!this.mergedCellsCollection.get(e,r))return n;const o=this.hot._createCellCoords(e,r),a=this.hot._createCellCoords(e,i),l=this.hot._createCellRange(o,o,a),u=this.mergedCellsCollection.getWithinRange(l),h=u.reduce((d,f)=>{let{rowspan:g}=f;return Math.max(d,g)},1);let c=0;return u.length>1&&u[0].rowspan<h&&(c=h-u[0].rowspan),u.forEach(d=>{var f;let{rowspan:g}=d,p=0;t==="top"||t==="top_inline_start_corner"?p=Math.min(h,this.hot.view.countNotHiddenFixedRowsTop()-e):p=g-c,n=Math.max((f=n)!==null&&f!==void 0?f:0,Ft($t,this,Ihe).call(this,e,p))}),n}function Ihe(n,e){const t=this.hot.view._wt.wtSettings.getSettingPure("defaultRowHeight"),r=this.hot.getPlugin("autoRowSize");let i=0;for(let o=n;o<n+e;o++)if(!this.hot.rowIndexMapper.isHidden(o)){var s;i+=(s=r?.getRowHeight(o))!==null&&s!==void 0?s:t}return i}function Ohe(n,e){return function(t,r){const[,...i]=t,[,...s]=r;return(function o(a){const l=n[a],u=e[a],h=i[a],c=s[a],d=u.multiColumnSorting,g=(d.compareFunctionFactory?d.compareFunctionFactory:UB(u.type))(l,u,d)(h,c);if(g===ea){const p=a+1;if(typeof e[p]<"u")return o(p)}return g})(0)}}function pD(){Ut(Bt`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously. 
    Only \`multiColumnSorting\` will work. The \`columnSorting\` plugin will be disabled.`)}const h$="sort";function _he(n,e,t){const r=[];return t===!1||n.isColumnSorted(e)&&n.getNumberOfSortedColumns()>1&&r.push(`${h$}-${n.getIndexOfColumnInSortQueue(e)+1}`),r}function Phe(n){const e=n.className.split(" "),t=new RegExp(`^${h$}-[0-9]{1,2}$`);return e.filter(r=>t.test(r))}function xhe(n,e,t){return(e=Lhe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Lhe(n){var e=Hhe(n,"string");return typeof e=="symbol"?e:e+""}function Hhe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const Ry="multiColumnSorting",Dhe=170,IT="columnSorting",wD=Ry;VB(Ry,Ohe);class Fhe extends qB{constructor(){super(...arguments),xhe(this,"pluginKey",Ry)}static get PLUGIN_KEY(){return Ry}static get PLUGIN_PRIORITY(){return Dhe}isEnabled(){return super.isEnabled()}enablePlugin(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[IT]&&(pD(),this.hot.getPlugin(IT).disablePlugin()),super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,iy)),!1},runOnlyIf:()=>{var e,t;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((t=this.hot.getSelectedRangeLast())===null||t===void 0?void 0:t.isSingle())&&this.hot.selection.isCellVisible(r)&&r.isHeader()},relativeToGroup:hu,position:"before",group:wD})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(wD)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];super.updateHeaderClasses(e,...r),Xe(e,Phe(e)),this.enabled!==!1&&ie(e,_he(...r))}onUpdateSettings(e){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[IT]&&pD(),super.onUpdateSettings(e)}onAfterOnCellMouseDown(e,t){mO(t.row,t.col,e)!==!1&&this.wasClickableHeaderClicked(e,t.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(t.col),this.sort(this.getNextSortConfig(t.col,iy))):this.sort(this.getColumnNextConfig(t.col)))}}function vD(n,e,t){return(e=khe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function khe(n){var e=Vhe(n,"string");return typeof e=="symbol"?e:e+""}function Vhe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const Uhe="multipleSelectionHandles",Bhe=160;class Whe extends _t{constructor(){super(...arguments),vD(this,"dragged",[]),vD(this,"lastSetCell",null)}static get PLUGIN_KEY(){return Uhe}static get PLUGIN_PRIORITY(){return Bhe}isEnabled(){return Ba()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:t}=this.hot;function r(i){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const s=e.dragged.indexOf(i);if(s===-1)return!1;s===0?e.dragged=e.dragged.slice(0,1):s===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(t,"touchstart",i=>{let s;if(je(i.target,"topSelectionHandle-HitArea"))return s=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:s.getWidth(),height:s.getHeight(),direction:s.getDirection()},i.preventDefault(),!1;if(je(i.target,"bottomSelectionHandle-HitArea"))return s=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:s.getWidth(),height:s.getHeight(),direction:s.getDirection()},i.preventDefault(),!1}),this.eventManager.addEventListener(t,"touchend",i=>{if(je(i.target,"topSelectionHandle-HitArea"))return r.call(e,"top"),e.touchStartRange=void 0,i.preventDefault(),!1;if(je(i.target,"bottomSelectionHandle-HitArea"))return r.call(e,"bottom"),e.touchStartRange=void 0,i.preventDefault(),!1}),this.eventManager.addEventListener(t,"touchmove",i=>{const{rootDocument:s}=this.hot;let o,a,l,u,h,c;if(e.dragged.length===0)return;const d=s.elementFromPoint(i.touches[0].clientX,i.touches[0].clientY);!d||d===e.lastSetCell||((d.nodeName==="TD"||d.nodeName==="TH")&&(o=e.hot.getCoords(d),o.col===-1&&(o.col=0),a=e.hot.getSelectedRangeLast(),l=a.getWidth(),u=a.getHeight(),h=a.getDirection(),l===1&&u===1&&e.hot.selection.setRangeEnd(o),c=e.getCurrentRangeCoords(a,o,e.touchStartRange.direction,h,e.dragged[0]),c.start!==null&&e.hot.selection.setRangeStart(c.start),e.hot.selection.setRangeEnd(c.end),e.lastSetCell=d),i.preventDefault())})}getCurrentRangeCoords(e,t,r,i,s){const o=e.getTopStartCorner(),a=e.getBottomEndCorner(),l=e.getBottomStartCorner(),u=e.getTopEndCorner();let h={start:null,end:null};switch(r){case"NE-SW":switch(i){case"NE-SW":case"NW-SE":s==="top"?h={start:this.hot._createCellCoords(t.row,e.highlight.col),end:this.hot._createCellCoords(l.row,t.col)}:h={start:this.hot._createCellCoords(e.highlight.row,t.col),end:this.hot._createCellCoords(t.row,o.col)};break;case"SE-NW":s==="bottom"&&(h={start:this.hot._createCellCoords(a.row,t.col),end:this.hot._createCellCoords(t.row,o.col)});break}break;case"NW-SE":switch(i){case"NE-SW":s==="top"?h={start:t,end:l}:h.end=t;break;case"NW-SE":s==="top"?h={start:t,end:a}:h.end=t;break;case"SE-NW":s==="top"?h={start:t,end:o}:h.end=t;break;case"SW-NE":s==="top"?h={start:t,end:u}:h.end=t;break}break;case"SW-NE":switch(i){case"NW-SE":s==="bottom"?h={start:this.hot._createCellCoords(t.row,o.col),end:this.hot._createCellCoords(l.row,t.col)}:h={start:this.hot._createCellCoords(o.row,t.col),end:this.hot._createCellCoords(t.row,a.col)};break;case"SW-NE":s==="top"?h={start:this.hot._createCellCoords(e.highlight.row,t.col),end:this.hot._createCellCoords(t.row,a.col)}:h={start:this.hot._createCellCoords(t.row,o.col),end:this.hot._createCellCoords(o.row,t.col)};break;case"SE-NW":s==="bottom"?h={start:this.hot._createCellCoords(t.row,u.col),end:this.hot._createCellCoords(o.row,t.col)}:s==="top"&&(h={start:l,end:t});break}break;case"SE-NW":switch(i){case"NW-SE":case"NE-SW":case"SW-NE":s==="top"&&(h.end=t);break;case"SE-NW":s==="top"?h.end=t:h={start:t,end:o};break}break}return h}isDragged(){return this.dragged.length>0}}function wN(){let{label:n="",colspan:e=1,origColspan:t=1,collapsible:r=!1,crossHiddenColumns:i=[],isCollapsed:s=!1,isHidden:o=!1,isRoot:a=!1,isPlaceholder:l=!1,headerClassNames:u=[]}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:n,colspan:e,origColspan:t,collapsible:r,isCollapsed:s,crossHiddenColumns:i,isHidden:o,isRoot:a,isPlaceholder:l,headerClassNames:u}}function c$(){return{label:"",isPlaceholder:!0}}function $he(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const t=[];if(e===0)return t;L(n,i=>{const s=[];let o=0;t.push(s),L(i,a=>{const l=wN();if(ot(a)){const{label:h,colspan:c,headerClassName:d}=a;l.label=Tn(h),typeof c=="number"&&c>1&&(l.colspan=c,l.origColspan=c),typeof d=="string"&&(l.headerClassNames=[...d.split(" ")])}else l.label=Tn(a);o+=l.origColspan;let u=!1;if(o>=e&&(l.colspan=l.origColspan-(o-e),l.origColspan=l.colspan,u=!0),s.push(l),l.colspan>1)for(let h=0;h<l.colspan-1;h++)s.push(c$());return!u})});const r=Math.max(...wt(t,i=>i.length));return L(t,i=>{if(i.length<r){const s=wt(new Array(r-i.length),()=>wN());i.splice(i.length,0,...s)}}),t}function OT(n,e,t){Ghe(n,e),e.set(n,t)}function Ghe(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vs(n,e){return n.get(d$(n,e))}function Wf(n,e,t){return n.set(d$(n,e),t),t}function d$(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const yD=["label","collapsible"];var Ta=new WeakMap,Qu=new WeakMap,_T=new WeakMap;class jhe{constructor(){OT(this,Ta,[]),OT(this,Qu,0),OT(this,_T,1/0)}setColumnsLimit(e){Wf(_T,this,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];Wf(Ta,this,$he(e,Vs(_T,this))),Wf(Qu,this,Vs(Ta,this).length)}getData(){return Vs(Ta,this)}mergeWith(e){L(e,t=>{let{row:r,col:i,...s}=t;const o=this.getHeaderSettings(r,i);o!==null&&Gn(o,s,yD)})}map(e){L(Vs(Ta,this),t=>{L(t,r=>{const i=e({...r});ot(i)&&Gn(r,i,yD)})})}getHeaderSettings(e,t){var r;if(e>=Vs(Qu,this)||e<0)return null;const i=Vs(Ta,this)[e];return Array.isArray(i)===!1||t>=i.length?null:(r=i[t])!==null&&r!==void 0?r:null}getHeadersSettings(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=[];if(e>=Vs(Qu,this)||e<0)return i;const s=Vs(Ta,this)[e];let o=0;for(let a=t;a<s.length;a++){const l=s[a];if(l.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(o+=l.colspan,i.push(l),l.colspan>1&&(a+=l.colspan-1),o===r)break;if(o>r)throw new Error("The last column settings cannot overlap the other header layers")}return i}getLayersCount(){return Vs(Qu,this)}getColumnsCount(){return Vs(Qu,this)>0?Vs(Ta,this)[0].length:0}clear(){Wf(Ta,this,[]),Wf(Qu,this,0)}}function PT(n,e,t){return(e=zhe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function zhe(n){var e=Yhe(n,"string");return typeof e=="symbol"?e:e+""}function Yhe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const f$="DF-pre-order";function m$(n,e){let t=n.call(e,this);for(let r=0;r<this.childs.length;r++){if(t===!1)return!1;t=m$.call(this.childs[r],n,e)}return t}const Khe="DF-post-order";function g$(n,e){for(let t=0;t<this.childs.length;t++)if(g$.call(this.childs[t],n,e)===!1)return!1;return n.call(e,this)}const p$="BF";function qhe(n,e){const t=[this];function r(){if(t.length===0)return;const i=t.shift();t.push(...i.childs),n.call(e,i)!==!1&&r()}r()}const Xhe=p$,CD=new Map([[f$,m$],[Khe,g$],[p$,qhe]]);class Ey{constructor(e){PT(this,"data",{}),PT(this,"parent",null),PT(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const t=new Ey({...e.data});for(let r=0;r<e.childs.length;r++)t.addChild(this.cloneTree(e.childs[r]));return t}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let t=0;t<e.childs.length;t++)this.addChild(e.childs[t])}walkDown(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Xhe;if(!CD.has(t))throw new Error(`Traversal strategy "${t}" does not exist`);CD.get(t).call(this,e,this)}walkUp(e){const t=this,r=i=>{e.call(t,i)!==!1&&i.parent!==null&&r(i.parent)};r(this)}}function xT(n,e,t){Qhe(n,e),e.set(n,t)}function Qhe(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kr(n,e){return n.get(w$(n,e))}function Zhe(n,e,t){return n.set(w$(n,e),t),t}function w$(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var _c=new WeakMap,Zu=new WeakMap,Pc=new WeakMap;class Jhe{constructor(e){xT(this,_c,new Map),xT(this,Zu,new Map),xT(this,Pc,null),Zhe(Pc,this,e)}getRoots(){return Array.from(Kr(_c,this).values())}getRootByColumn(e){let t;return Kr(Zu,this).has(e)&&(t=Kr(_c,this).get(Kr(Zu,this).get(e))),t}getNode(e,t){const r=this.getRootByColumn(t);if(!r)return;const i=t-Kr(Zu,this).get(t);let s=0,o;return r.walkDown(a=>{const{data:{origColspan:l,headerLevel:u}}=a;if(e===u){if(i>=s&&i<=s+l-1)return o=a,o.data.isRoot=t===o.data.columnIndex,!1;s+=l}}),o}rebuildTreeIndex(){let e=0;Kr(Zu,this).clear(),L(Kr(_c,this),t=>{let[,{data:{colspan:r}}]=t;for(let i=e;i<e+r;i++)Kr(Zu,this).set(i,e);e+=r})}buildTree(){this.clear();const e=Kr(Pc,this).getColumnsCount();let t=0;for(;t<e;){const r=Kr(Pc,this).getHeaderSettings(0,t),i=new Ey;Kr(_c,this).set(t,i),this.buildLeaves(i,t,0,r.origColspan),t+=r.origColspan}this.rebuildTreeIndex()}buildLeaves(e,t,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const s=Kr(Pc,this).getHeadersSettings(r,t,i);r+=1,L(s,o=>{const a={...o,headerLevel:r-1,columnIndex:t};let l;r===1?(e.data=a,l=e):(l=new Ey(a),e.addChild(l)),r<Kr(Pc,this).getLayersCount()&&this.buildLeaves(l,t,r,o.origColspan),t+=o.origColspan})}clear(){Kr(_c,this).clear(),Kr(Zu,this).clear()}}function v$(n,e){n.walkDown(t=>{let{data:r,childs:i}=t;if(!r.isHidden&&(e(r.columnIndex),i.length===0))for(let s=1;s<r.colspan;s++)e(r.columnIndex+s)})}function by(n,e){let{childs:t}=n;if(t.length!==0)return t[0].data[e]}function Ty(n){return by(n,"origColspan")===n.data.origColspan}function IO(n){const{data:e,childs:t}=n;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(Ty(n))return IO(t[0]);e.isCollapsed=!1;const i=t.slice(1),s=new Set;let o=0;if(i.length>0)L(i,a=>{a.replaceTreeWith(a.data.clonedTree),a.data.clonedTree=null;const l=a.data;o+=l.colspan,v$(a,u=>{s.add(u)})});else{const{colspan:a,origColspan:l,columnIndex:u}=e;o=l-a;for(let h=1;h<l;h++)s.add(u+h)}return n.walkUp(a=>{const{data:l}=a;l.colspan+=o,l.colspan>=l.origColspan?(l.colspan=l.origColspan,l.isCollapsed=!1):Ty(a)&&(l.isCollapsed=by(a,"isCollapsed"))}),{rollbackModification:()=>OO(n),affectedColumns:Array.from(s),colspanCompensation:o}}function OO(n){var e;const{data:t,childs:r}=n;if(t.isCollapsed||t.isHidden||t.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(Ty(n))return OO(r[0]);t.isCollapsed=!0;const s=r.slice(1),o=new Set;if(s.length>0)L(s,l=>{v$(l,u=>{o.add(u)}),l.data.clonedTree=l.cloneTree(),l.walkDown(u=>{let{data:h}=u;h.isHidden=!0})});else{const{origColspan:l,columnIndex:u}=t;for(let h=1;h<l;h++){const c=u+h;o.add(c)}}const a=t.colspan-((e=by(n,"colspan"))!==null&&e!==void 0?e:1);return n.walkUp(l=>{const{data:u}=l;u.colspan-=a,u.colspan<=1?(u.colspan=1,u.isCollapsed=!0):Ty(l)&&(u.isCollapsed=by(l,"isCollapsed"))}),{rollbackModification:()=>IO(n),affectedColumns:Array.from(o),colspanCompensation:a}}function ece(n,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(n.childs.length>0)throw new Error(Bt`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:t}=n.data;if(t.includes(e))return;let r=!1;n.walkUp(i=>{const{data:{collapsible:s}}=i;if(s)return r=!0,!1}),!r&&n.walkUp(i=>{const{data:s}=i;s.crossHiddenColumns.push(e),s.colspan>1?s.colspan-=1:s.isHidden=!0})}function tce(n,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(n.childs.length>0)throw new Error(Bt`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:t}=n.data;if(!t.includes(e))return;let r=!1;n.walkUp(i=>{const{data:{collapsible:s}}=i;if(s)return r=!0,!1}),!r&&n.walkUp(i=>{const{data:s}=i;s.crossHiddenColumns.splice(s.crossHiddenColumns.indexOf(e),1),!s.isHidden&&s.colspan<s.origColspan&&(s.colspan+=1),s.isHidden=!1})}const SD=new Map([["collapse",OO],["expand",IO],["hide-column",ece],["show-column",tce]]);function nce(n,e,t){if(!SD.has(n))throw new Error(`The node modifier action ("${n}") does not exist.`);return SD.get(n)(e,t)}function Aw(n){const e=[];return L(n,t=>{t.walkDown(r=>{const i=r.data,{origColspan:s,columnIndex:o,headerLevel:a,crossHiddenColumns:l}=i,u=ice(e,a);let h=!1;for(let c=o;c<o+s;c++)if(l.includes(c)||h)u.push(c$());else{const f=rce(i);f.isRoot=!0,u.push(f),h=!0}})}),e}function rce(n){const{crossHiddenColumns:e,...t}=wN(n);return t}function ice(n,e){let t;return Array.isArray(n[e])?t=n[e]:(t=[],n[e]=t),t}function LT(n,e,t){sce(n,e),e.set(n,t)}function sce(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $f(n,e,t){return n.set(y$(n,e),t),t}function yn(n,e){return n.get(y$(n,e))}function y$(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Po=new WeakMap,ui=new WeakMap,Ju=new WeakMap;class oce{constructor(){LT(this,Po,new jhe),LT(this,ui,new Jhe(yn(Po,this))),LT(this,Ju,[[]])}setState(e){yn(Po,this).setData(e);let t=!1;try{yn(ui,this).buildTree()}catch{yn(ui,this).clear(),yn(Po,this).clear(),t=!0}return $f(Ju,this,Aw(yn(ui,this).getRoots())),t}setColumnsLimit(e){yn(Po,this).setColumnsLimit(e)}mergeStateWith(e){const t=wt(e,r=>{let{row:i,...s}=r;return{row:i<0?this.rowCoordsToLevel(i):i,...s}});yn(Po,this).mergeWith(t),yn(ui,this).buildTree(),$f(Ju,this,Aw(yn(ui,this).getRoots()))}mapState(e){yn(Po,this).map(e),yn(ui,this).buildTree(),$f(Ju,this,Aw(yn(ui,this).getRoots()))}mapNodes(e){return jn(yn(ui,this).getRoots(),(t,r)=>(r.walkDown(i=>{const s=e(i.data);s!==void 0&&t.push(s)}),t),[])}triggerNodeModification(e,t,r){t<0&&(t=this.rowCoordsToLevel(t));const i=yn(ui,this).getNode(t,r);let s;return i&&(s=nce(e,i,r),$f(Ju,this,Aw(yn(ui,this).getRoots()))),s}triggerColumnModification(e,t){return this.triggerNodeModification(e,-1,t)}rowCoordsToLevel(e){if(e>=0)return null;const t=e+Math.max(this.getLayersCount(),1);return t<0?null:t}levelToRowCoords(e){if(e<0)return null;const t=e-Math.max(this.getLayersCount(),1);return t>=0?null:t}getHeaderSettings(e,t){var r,i;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(r=(i=yn(Ju,this)[e])===null||i===void 0?void 0:i[t])!==null&&r!==void 0?r:null}getHeaderTreeNodeData(e,t){const r=this.getHeaderTreeNode(e,t);return r?{...r.data}:null}getHeaderTreeNode(e,t){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const r=yn(ui,this).getNode(e,t);return r||null}findTopMostEntireHeaderLevel(e){var t;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const i=r-e+1;let s=!1,o=null;for(let a=e;a<=r;a++){const l=yn(ui,this).getRootByColumn(a);if(!l)break;s=!0,l.walkDown(u=>{const{columnIndex:h,headerLevel:c,origColspan:d,isHidden:f}=u.data;f||d<=i&&h>=e&&h+d-1<=r&&(o===null||c<o)&&(o=c)},f$)}return s&&o===null?-1:this.levelToRowCoords((t=o)!==null&&t!==void 0?t:0)}findLeftMostColumnIndex(e,t){var r;const{isRoot:i}=(r=this.getHeaderSettings(e,t))!==null&&r!==void 0?r:{isRoot:!0};if(i)return t;let s=t-1;for(;s>=0;){var o;const{isRoot:a}=(o=this.getHeaderSettings(e,s))!==null&&o!==void 0?o:{isRoot:!0};if(a)break;s-=1}return s}findRightMostColumnIndex(e,t){var r;const{isRoot:i,origColspan:s}=(r=this.getHeaderSettings(e,t))!==null&&r!==void 0?r:{isRoot:!0,origColspan:1};if(i)return t+s-1;let o=t+1;for(;o<this.getColumnsCount();){var a;const{isRoot:l}=(a=this.getHeaderSettings(e,o))!==null&&a!==void 0?a:{isRoot:!0};if(l)break;o+=1}return o-1}getLayersCount(){return yn(Po,this).getLayersCount()}getColumnsCount(){return yn(Po,this).getColumnsCount()}clear(){$f(Ju,this,[]),yn(Po,this).clear(),yn(ui,this).clear()}}function Gf(n,e,t){return(e=ace(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function ace(n){var e=lce(n,"string");return typeof e=="symbol"?e:e+""}function lce(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class uce{constructor(e,t){Gf(this,"hot",void 0),Gf(this,"nestedHeaderSettingsGetter",void 0),Gf(this,"layersCount",0),Gf(this,"container",void 0),Gf(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=t,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const e=this.container.querySelectorAll("tr:last-of-type th"),t=e.length;this.widthsMap.clear();for(let r=0;r<t;r++){const i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(r),s=this.hot.toPhysicalColumn(i);this.widthsMap.setValueAtIndex(s,e[r].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:t,columnIndexMapper:r}=this.hot,i=t.createDocumentFragment(),s=t.createElement("table"),o=!!this.hot.getSettings().dropdownMenu,a=r.getRenderableIndexesLength();for(let l=0;l<this.layersCount;l++){const u=t.createElement("tr");for(let h=0;h<a;h++){let c=r.getVisualFromRenderableIndex(h);c===null&&(c=h);const d=t.createElement("th"),f=this.nestedHeaderSettingsGetter(l,c);if(f&&(!f.isPlaceholder||f.isHidden)){let g=f.label;o&&(g+='<button class="changeType"></button>'),jh(d,g),d.colSpan=f.colspan,u.appendChild(d)}}s.appendChild(u)}i.appendChild(s),e.appendChild(i)}clear(){this.widthsMap.clear(),this.container=null}}function hce(n,e){C$(n,e),e.add(n)}function RD(n,e,t){return(e=cce(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function cce(n){var e=dce(n,"string");return typeof e=="symbol"?e:e+""}function dce(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Nw(n,e,t){C$(n,e),e.set(n,t)}function C$(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vh(n,e,t){return n.set(Cn(n,e),t),t}function Tt(n,e){return n.get(Cn(n,e))}function Cn(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const ED="nestedHeaders",fce=280;var jt=new WeakMap,El=new WeakMap,Mm=new WeakMap,rS=new WeakMap,In=new WeakSet;class mce extends _t{constructor(){super(...arguments),hce(this,In),Nw(this,jt,new oce),Nw(this,El,null),Nw(this,Mm,null),Nw(this,rS,!1),RD(this,"ghostTable",new uce(this.hot,(e,t)=>this.getHeaderSettings(e,t))),RD(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return ED}static get PLUGIN_PRIORITY(){return fce}isEnabled(){return!!this.hot.getSettings()[ED]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:t}=this.hot.getSettings();(!Array.isArray(t)||!Array.isArray(t[0]))&&Ut(Bt`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>Cn(In,this,Oce).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Cn(In,e,_ce).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Cn(In,e,vce).call(e,...i)}),this.addHook("afterOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Cn(In,e,yce).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Cn(In,e,Cce).call(e,...i)}),this.addHook("beforeOnCellMouseUp",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Cn(In,e,Sce).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Cn(In,e,Rce).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Cn(In,e,Ece).call(e,...i)}),this.addHook("afterSelection",()=>Cn(In,this,Mw).call(this)),this.addHook("afterSelectionFocusSet",()=>Cn(In,this,Mw).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Cn(In,e,gce).call(e,...i)}),this.addHook("afterGetColumnHeaderRenderers",r=>Cn(In,this,Tce).call(this,r)),this.addHook("modifyColWidth",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Cn(In,e,Nce).call(e,...i)}),this.addHook("modifyColumnHeaderValue",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Cn(In,e,Mce).call(e,...i)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Cn(In,e,pce).call(e,...i)}),this.addHook("beforeCopy",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Cn(In,e,wce).call(e,...i)}),this.addHook("beforeSelectColumns",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Cn(In,e,bce).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Cn(In,e,Ace).call(e,...i)}),this.addHook("modifyFocusedElement",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Cn(In,e,Ice).call(e,...i)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>Cn(In,this,Mw).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>Cn(In,this,Mw).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();Tt(jt,this).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=Tt(jt,this).setState(e)),this.detectedOverlappedHeaders&&Ut(Bt`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((t,r)=>{const i=t===!0?"hide-column":"show-column";Tt(jt,this).triggerColumnModification(i,r)}),!Tt(El,this)&&this.enabled&&vh(El,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(t=>{t.forEach(r=>{let{op:i,index:s,newValue:o}=r;if(i==="replace"){const a=o===!0?"hide-column":"show-column";Tt(jt,this).triggerColumnModification(a,s)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),Tt(jt,this).clear(),Tt(El,this).unsubscribe(),vh(El,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return Tt(jt,this)}getLayersCount(){return Tt(jt,this).getLayersCount()}getHeaderSettings(e,t){return Tt(jt,this).getHeaderSettings(e,t)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,t=e.getSetting("columnHeaders").length,r=e.wtTable.THEAD,i=e.wtOverlays.topOverlay.clone.wtTable.THEAD,s=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let o=0;o<t;o++){const a=r.childNodes[o];if(!a)break;const l=i.childNodes[o],u=s?s.childNodes[o]:null;for(let h=0,c=a.childNodes.length;h<c;h++)a.childNodes[h].removeAttribute("colspan"),Xe(a.childNodes[h],"hiddenHeader"),l&&l.childNodes[h]&&(l.childNodes[h].removeAttribute("colspan"),Xe(l.childNodes[h],"hiddenHeader")),s&&u&&u.childNodes[h]&&(u.childNodes[h].removeAttribute("colspan"),Xe(u.childNodes[h],"hiddenHeader"))}}headerRendererFactory(e){var t=this;const r=this.hot.view._wt.getSetting("fixedColumnsStart");return(i,s)=>{var o;const{columnIndexMapper:a,view:l}=this.hot;let u=a.getVisualFromRenderableIndex(i);u===null&&(u=i),s.removeAttribute("colspan"),Xe(s,"hiddenHeader");const{colspan:h,isHidden:c,isPlaceholder:d,headerClassNames:f}=(o=Tt(jt,this).getHeaderSettings(e,u))!==null&&o!==void 0?o:{};if(d||c)ie(s,"hiddenHeader");else if(h>1){var g,p;const{wtOverlays:v}=l._wt,y=(g=v.topInlineStartCornerOverlay)===null||g===void 0?void 0:g.clone.wtTable.THEAD.contains(s),S=(p=v.inlineStartOverlay)===null||p===void 0?void 0:p.clone.wtTable.THEAD.contains(s),R=y||S?Math.min(h,r-i):h;R>1&&s.setAttribute("colspan",R)}if(this.hot.view.appendColHeader(u,s,function(){return t.getColumnHeaderValue(...arguments)},e),!d&&!c){const v=s.querySelector("div.relative");v&&f&&f.length>0&&(Xe(v,this.hot.getColumnMeta(u).headerClassName),ie(v,f))}}}getColumnHeaderValue(e,t){var r;const{isHidden:i,isPlaceholder:s}=(r=Tt(jt,this).getHeaderSettings(t,e))!==null&&r!==void 0?r:{};return s||i?"":this.hot.getColHeader(e,t)}destroy(){vh(jt,this,null),Tt(El,this)!==null&&(Tt(El,this).unsubscribe(),vh(El,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return Tt(jt,this).getHeaderTreeNodeData(e.row,e.col)}}function Mw(){var n;const e=(n=this.hot)===null||n===void 0?void 0:n.getSelectedRangeLast();if(!e)return;const{highlight:t}=e;if(t.isHeader()&&t.col>=0){const i=Tt(jt,this).findLeftMostColumnIndex(t.row,t.col),s=this.hot.selection.highlight.getFocus();s.visualCellRange.highlight.col=i,s.visualCellRange.from.col=i,s.visualCellRange.to.col=i,s.commit()}}function gce(n){const e=this.hot.getSelectedRangeLast();if(!e)return n;const{highlight:t}=e;if(!(t.isHeader()&&t.col>=0))return n;const i=this.hot.view.getFirstFullyVisibleColumn(),s=this.hot.view.getLastFullyVisibleColumn(),o=Tt(jt,this).findLeftMostColumnIndex(t.row,t.col),a=Tt(jt,this).findRightMostColumnIndex(t.row,t.col);return o<i&&a>s?n:o<i?o:a}function pce(n,e,t){const r=Tt(jt,this).getHeaderTreeNodeData(e,n);if(!r)return n;const{columnCursor:i,selectionType:s,selectionWidth:o}=t,{isRoot:a,colspan:l}=Tt(jt,this).getHeaderSettings(e,n);if(s===d0){if(!a)return r.columnIndex}else if(s===FU&&(l>o-i||!a))return null;return n}function wce(n,e,t){let{columnHeadersCount:r}=t;if(r!==0)for(let s=0;s<e.length;s++){const{startRow:o,startCol:a,endRow:l,endCol:u}=e[s],h=l-o+1,c=a-u+1;if(o>=0||c===1)break;for(let d=a;d<=u;d++)for(let f=o;f<=l;f++){var i;const g=h+f,p=d-a;if(p===0)continue;((i=Tt(jt,this).getHeaderTreeNodeData(f,d))===null||i===void 0?void 0:i.isRoot)===!1&&(n[g][p]="")}}}function vce(n,e,t,r){this._getHeaderTreeNodeDataByCoords(e)&&(r.column=!0)}function yce(n,e){const t=this._getHeaderTreeNodeDataByCoords(e);if(!t)return;vh(Mm,this,e.clone()),vh(rS,this,!0);const{selection:r}=this.hot,i=r.isSelected()?r.getSelectedRange().current():null,s=[],{columnIndex:o,origColspan:a}=t,l=!r.inInSelection(e);n.shiftKey&&i?e.col<i.from.col?s.push(i.getTopEndCorner().col,o,e.row):e.col>i.from.col?s.push(i.getTopStartCorner().col,o+a-1,e.row):s.push(o,o+a-1,e.row):(IC(n)||iu(n)&&l||cU(n))&&s.push(o,o+a-1,e.row),r.selectColumns(...s)}function Cce(n,e,t,r){if(!this.hot.view.isMouseDown())return;const i=this._getHeaderTreeNodeDataByCoords(e);if(!i)return;const{columnIndex:s,origColspan:o}=i,a=this.hot.getSelectedRangeLast(),l=a.getTopStartCorner(),u=a.getBottomEndCorner(),{from:h}=a;r.column=!0,r.cell=!0;const c=[],d=Vt(e.row,-1/0,-1);e.col<h.col?c.push(u.col,s,d):e.col>h.col?c.push(l.col,s+o-1,d):c.push(s,s+o-1,d),this.hot.selection.selectColumns(...c)}function Sce(){vh(rS,this,!1)}function Rce(){const{navigableHeaders:n}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!Tt(rS,this)||!n)return;const e=this.hot.getSelectedRangeLast(),t=e.getTopStartCorner().col,r=e.getBottomEndCorner().col,{columnIndex:i,origColspan:s}=Tt(jt,this).getHeaderTreeNodeData(Tt(Mm,this).row,Tt(Mm,this).col);if(e.setHighlight(Tt(Mm,this)),s>e.getWidth()||i<t||i+s-1>r){const o=Tt(jt,this).findTopMostEntireHeaderLevel(Vt(t,i,i+s-1),Vt(r,i,i+s-1));e.highlight.row=o,e.highlight.col=e.from.col}}function Ece(n){const{highlight:e}=this.hot.getSelectedRangeLast(),t=this.hot._createCellCoords(e.row+n.row,e.col+n.col);if(!(t.isHeader()&&t.col>=0))return;const i=Tt(jt,this).findLeftMostColumnIndex(t.row,t.col),s=Tt(jt,this).findRightMostColumnIndex(t.row,t.col);if(n.col<0){const o=e.col>=i&&e.col<=s?i-1:s,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(o,-1);a===null?n.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):n.col=-Math.max(this.hot.view.countRenderableColumnsInRange(a,e.col)-1,1)}else if(n.col>0){const o=e.col>=i&&e.col<=s?s+1:i,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(o,1);a===null?n.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):n.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,a)-1,1)}}function bce(n,e){const t=n.row,r=this._getHeaderTreeNodeDataByCoords({row:t,col:n.col}),i=this._getHeaderTreeNodeDataByCoords({row:t,col:e.col});e.col<n.col?(r&&(n.col=r.columnIndex+r.origColspan-1),i&&(e.col=i.columnIndex)):e.col>=n.col&&(r&&(n.col=r.columnIndex),i&&(e.col=i.columnIndex+i.origColspan-1))}function Tce(n){n.length=0;for(let e=0;e<Tt(jt,this).getLayersCount();e++)n.push(this.headerRendererFactory(e))}function Ace(n){const e=Tt(jt,this).getLayersCount();let t=n.startColumn,r=!!e;for(let i=0;i<e;i++){const s=Tt(jt,this).findLeftMostColumnIndex(i,n.startColumn),o=this.hot.columnIndexMapper.getRenderableFromVisualIndex(s);if(s>=0&&(r=!1),Vr(o)&&o<n.startColumn){t=o;break}}n.startColumn=r?Tt(jt,this).getHeaderTreeNodeData(0,t).columnIndex:t}function Nce(n,e){const t=this.ghostTable.getWidth(e);return n>t?n:t}function Mce(n,e,t){var r;const{label:i}=(r=Tt(jt,this).getHeaderTreeNodeData(t,e))!==null&&r!==void 0?r:{label:""};return i}function Ice(n,e){if(n<0)return this.hot.getCell(n,Tt(jt,this).findLeftMostColumnIndex(n,e),!0)}function Oce(){this.updatePlugin()}function _ce(n,e){e||this.updatePlugin()}function jf(n,e,t){return(e=Pce(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Pce(n){var e=xce(n,"string");return typeof e=="symbol"?e:e+""}function xce(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Lce{constructor(e,t){jf(this,"hot",void 0),jf(this,"data",null),jf(this,"plugin",void 0),jf(this,"parentReference",new WeakMap),jf(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=t,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},Pe(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,t,r){this.cache.levels[t]||(this.cache.levels[t]=[],this.cache.levelCount+=1),this.cache.levels[t].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:r,row:this.cache.rows.length-1,level:t}),this.hasChildren(e)&&L(e.__children,i=>{this.cacheNode(i,t+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,t,r,i){let s=!1,o=t;if(isNaN(o)&&o.end)return o;let a=e;return a||(a={__children:this.data},s=!0,o-=1),r!=null&&o===r?{result:a,end:!0}:i!=null&&a===i?{result:o,end:!0}:(o+=1,a.__children&&L(a.__children,l=>{if(this.parentReference.set(l,s?null:a),o=this.readTreeNodes(l,o,r,i),isNaN(o)&&o.end)return!1}),o)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return at(this.data[0],(t,r)=>{e[r]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let t=null;isNaN(e)?t=e:t=this.getDataObject(e);const r=this.getRowParent(e);return r==null?this.data.indexOf(t):r.__children.indexOf(t)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let t=0,r=e;return isNaN(r)||(r=this.getDataObject(r)),!r||!r.__children?0:(L(r.__children,i=>{t+=1,i.__children&&(t+=this.countChildren(i))}),t)}getRowParent(e){let t;return isNaN(e)?t=e:t=this.getDataObject(e),this.getRowObjectParent(t)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let t=null;return isNaN(e)?t=e:t=this.getDataObject(e),t?this.getRowObjectLevel(t):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let t=e;return isNaN(t)||(t=this.getDataObject(t)),!!(t.__children&&t.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,t){var r;return((r=e.__children)===null||r===void 0?void 0:r[t])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var t;let r=e;return isNaN(r)||(r=this.getDataObject(r)),r&&!!r.__children&&((t=r.__children)===null||t===void 0?void 0:t.length)!==0}addChild(e,t){let r=t;this.hot.runHooks("beforeAddChild",e,r);let i=null;e&&(i=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",i+this.countChildren(e)+1,1);let s=e;e||(s=this.mockParent()),s.__children||(s.__children=[]),r||(r=this.mockNode()),s.__children.push(r),this.rewriteCache();const o=this.getRowIndex(r);this.hot.rowIndexMapper.insertIndexes(o,1),this.hot.runHooks("afterCreateRow",o,1),this.hot.runHooks("afterAddChild",e,r)}addChildAtIndex(e,t,r){let i=r,s;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",e,i,t),e){const a=this.getRowIndex(e)+t+1;this.hot.runHooks("beforeCreateRow",a,1),e.__children.splice(t,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(a,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",a,1),s=a}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",t,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),s=this.getRowIndex(this.data[t]);i=this.getDataObject(s),this.hot.runHooks("afterAddChild",e,i,t)}addSibling(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const r=this.translateTrimmedRow(e),i=this.getRowParent(r),s=this.getRowIndexWithinParent(r);switch(t){case"below":this.addChildAtIndex(i,s+1,null);break;case"above":this.addChildAtIndex(i,s,null);break}}detachFromParent(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=null;const i=[];Array.isArray(e)?(Pe(e[0],e[2],d=>{const f=this.translateTrimmedRow(d);i.push(this.getDataObject(f))}),Pe(0,i.length-2,d=>{this.detachFromParent(i[d],!1)}),r=i[i.length-1]):r=e;const s=this.getRowIndex(r),o=this.countChildren(r),a=this.getRowIndexWithinParent(r),l=this.getRowParent(r),u=this.getRowParent(l),h=this.getRowIndex(u);let c=null;if(this.hot.runHooks("beforeDetachChild",l,r),a!=null){const d=Array.from(new Array(s+o+1).keys()).splice(-1*(o+1));if(this.hot.runHooks("beforeRemoveRow",s,o+1,d,this.plugin.pluginName),l.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",s,o+1,d,this.plugin.pluginName),u){c=h+this.countChildren(u);const f=this.getChild(u,this.countChildren(u)-1),g=this.getRowIndex(f);this.hot.runHooks("beforeCreateRow",g+1,o+1,this.plugin.pluginName),u.__children.push(r)}else c=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",c-2,o+1,this.plugin.pluginName),this.data.push(r)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",c-2,o+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,r,this.getRowIndex(r)),t&&this.hot.render()}filterData(e,t,r){const i=[];L(r,s=>{i.push(this.getDataObject(s))}),L(i,s=>{const o=this.getRowIndexWithinParent(s),a=this.getRowParent(s);a===null?this.data.splice(o,1):a.__children.splice(o,1)}),this.rewriteCache()}spliceData(e,t,r){const i=this.getDataObject(e-1);let s=null,o=e;i&&i.__children&&i.__children.length===0?(s=i,o=0):e<this.countAllRows()&&(s=this.getRowParent(e),o=this.getRowIndexWithinParent(e)),s?r?s.__children.splice(o,t,...r):s.__children.splice(o,t):r?this.data.splice(o,t,...r):this.data.splice(o,t),this.rewriteCache()}syncRowWithRawSource(e){let t=e,r=null;do r=this.getRowParent(r),r!==null&&(t=r);while(r!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(t),"__children",t.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,t,r,i){const s=t===this.hot.countRows(),o=this.getRowParent(e),a=this.getRowIndexWithinParent(e),l=o.__children.slice(a,a+1),u=e>t;let h=s?this.getRowParent(t-1):this.getRowParent(t);h==null&&(h=this.getRowParent(t-1)),h==null&&(h=this.getDataObject(t-1)),h?h.__children||(h.__children=[]):(h=this.getDataObject(t),h.__children=[]);const c=s||r||i?h.__children.length:this.getRowIndexWithinParent(t),d=o===h;h.__children.splice(c,0,l[0]),o.__children.splice(a+(u&&d?1:0),1),this.syncRowWithRawSource(o),d||this.syncRowWithRawSource(h)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}function bD(n,e,t){return(e=Hce(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Hce(n){var e=Dce(n,"string");return typeof e=="symbol"?e:e+""}function Dce(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class _O{constructor(e,t){bD(this,"hot",void 0),bD(this,"plugin",void 0),this.hot=t,this.plugin=e}}class $o extends _O{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,t){super(e,t),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,t){const r=this.hot.toPhysicalRow(e),i=this.dataManager.getRowLevel(r),s=this.dataManager.getDataObject(r),o=t.getElementsByTagName("DIV")[0],a=o.querySelector("span.rowHeader"),l=o.querySelectorAll('[class^="ht_nesting"]'),u=this.hot.getSettings().ariaTags;if(L(l,h=>{h&&o.removeChild(h)}),ie(t,$o.CSS_CLASSES.indicatorContainer),i){const{rootDocument:h}=this.hot,c=a.cloneNode(!0);o.innerHTML="",Pe(0,i-1,()=>{const d=h.createElement("SPAN");ie(d,$o.CSS_CLASSES.emptyIndicator),o.appendChild(d)}),o.appendChild(c)}if(this.dataManager.hasChildren(s)){const h=this.hot.rootDocument.createElement("DIV");u&&Ge(h,[$h()]),ie(t,$o.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(r)?(ie(h,`${$o.CSS_CLASSES.button} ${$o.CSS_CLASSES.expandButton}`),u&&Ge(t,[gs(!1)])):(ie(h,`${$o.CSS_CLASSES.button} ${$o.CSS_CLASSES.collapseButton}`),u&&Ge(t,[gs(!0)])),o.appendChild(h)}}updateRowHeaderWidth(e){let t=e;t||(t=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*t+25),this.hot.render()}}class Fce extends _O{constructor(e,t){var r;super(e,t),r=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;r.lastCollapsedRows=r.collapsedRows.slice(0),r.expandMultipleChildren(r.lastCollapsedRows,i)},shiftStash:function(i,s){let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;s==null&&(s=1/0),L(r.lastCollapsedRows,(a,l)=>{a>=i&&a<s&&(r.lastCollapsedRows[l]=a+o)})},applyStash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;r.collapseMultipleChildren(r.lastCollapsedRows,i),r.lastCollapsedRows=void 0},trimStash:(i,s)=>{Pe(i,i+s-1,o=>{const a=this.lastCollapsedRows.indexOf(o);a>-1&&this.lastCollapsedRows.splice(a,1)})}}}collapseChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let s=null,o=null,a=null;return isNaN(e)?(s=e,o=this.dataManager.getRowIndex(s)):(s=this.dataManager.getDataObject(e),o=e),this.dataManager.hasChildren(s)&&L(s.__children,l=>{i.push(this.dataManager.getRowIndex(l))}),a=this.collapseRows(i,!0,!1),r&&this.trimRows(a),t&&this.renderAndAdjust(),this.collapsedRows.indexOf(o)===-1&&this.collapsedRows.push(o),a}collapseMultipleChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];L(e,s=>{i.push(...this.collapseChildren(s,!1,!1))}),r&&this.trimRows(i),t&&this.renderAndAdjust()}collapseRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],t)}collapseRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return L(e,s=>{i.push(s),t&&this.collapseChildRows(s,i)}),r&&this.trimRows(i),i}collapseChildRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);L(i.__children,s=>{const o=this.dataManager.getRowIndex(s);t.push(o),this.collapseChildRows(o,t)})}r&&this.trimRows(t)}expandRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],t)}expandRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return L(e,s=>{i.push(s),t&&this.expandChildRows(s,i)}),r&&this.untrimRows(i),i}expandChildRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);L(i.__children,s=>{if(!this.isAnyParentCollapsed(s)){const o=this.dataManager.getRowIndex(s);t.push(o),this.expandChildRows(o,t)}})}r&&this.untrimRows(t)}expandChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let s=null,o=null,a=null;return isNaN(e)?(s=e,o=this.dataManager.getRowIndex(e)):(s=this.dataManager.getDataObject(e),o=e),this.collapsedRows.splice(this.collapsedRows.indexOf(o),1),this.dataManager.hasChildren(s)&&L(s.__children,l=>{const u=this.dataManager.getRowIndex(l);i.push(u)}),a=this.expandRows(i,!0,!1),r&&this.untrimRows(a),t&&this.renderAndAdjust(),a}expandMultipleChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];L(e,s=>{i.push(...this.expandChildren(s,!1,!1))}),r&&this.untrimRows(i),t&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),t=[];L(e,r=>{this.dataManager.hasChildren(r)&&t.push(r)}),this.collapseMultipleChildren(t),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),t=[];L(e,r=>{this.dataManager.hasChildren(r)&&t.push(r)}),this.expandMultipleChildren(t),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{L(e,t=>{this.plugin.collapsedRowsMap.setValueAtIndex(t,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{L(e,t=>{this.plugin.collapsedRowsMap.setValueAtIndex(t,!1)})},!0)}areChildrenCollapsed(e){let t=isNaN(e)?e:this.dataManager.getDataObject(e),r=!0;return t===null&&(t={__children:this.dataManager.data}),this.dataManager.hasChildren(t)&&L(t.__children,i=>{const s=this.dataManager.getRowIndex(i);if(!this.plugin.collapsedRowsMap.getValueAtIndex(s))return r=!1,!1}),r}isAnyParentCollapsed(e){let t=e;for(;t!==null;){t=this.dataManager.getRowParent(t);const r=this.dataManager.getRowIndex(t);if(this.collapsedRows.indexOf(r)>-1)return!0}return!1}toggleState(e,t){if(t.col>=0)return;const r=this.translateTrimmedRow(t.row);je(e.target,$o.CSS_CLASSES.button)&&(this.areChildrenCollapsed(r)?this.expandChildren(r):this.collapseChildren(r),Ns(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}function kce(n,e,t){Vce(n,e),e.set(n,t)}function Vce(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Uce(n,e,t){return(e=Bce(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Bce(n){var e=Wce(n,"string");return typeof e=="symbol"?e:e+""}function Wce(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function $ce(n,e){return n.get(Gce(n,e))}function Gce(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var TD=new WeakMap;class jce extends _O{constructor(){super(...arguments),Uce(this,"dataManager",this.plugin.dataManager),kce(this,TD,{row_above:(e,t)=>{const r=t[t.length-1];this.dataManager.addSibling(r.start.row,"above")},row_below:(e,t)=>{const r=t[t.length-1];this.dataManager.addSibling(r.start.row,"below")}})}appendOptions(e){const t=[{key:"add_child",name(){return this.getTranslatedPhrase(aI)},callback:()=>{const r=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),i=this.dataManager.getDataObject(r);this.dataManager.addChild(i)},disabled:()=>{const r=this.hot.getSelectedLast();return!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(lI)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const r=this.hot.getSelectedLast(),i=this.dataManager.translateTrimmedRow(r[0]);return!this.dataManager.getRowParent(i)||!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return Pe(0,e.items.length-1,r=>{if(r===0)return L(t,(i,s)=>{e.items.splice(r+s,0,i)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return Pe(0,e.items.length-1,t=>{const r=$ce(TD,this)[e.items[t].key];r!=null&&(e.items[t].callback=r)}),e}}function Iw(n,e,t){return(e=zce(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function zce(n){var e=Yce(n,"string");return typeof e=="symbol"?e:e+""}function Yce(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Kce{constructor(e){Iw(this,"plugin",void 0),Iw(this,"hot",void 0),Iw(this,"dataManager",void 0),Iw(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,t,r,i){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:t,dropIndex:r,movePossible:i}))return!1;this.movedToCollapsed=!1;const o=r===this.hot.countRows(),a=o?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(r);let l=!0;const u=e.map(g=>{if(!l)return!1;const p=this.dataManager.translateTrimmedRow(g);return l=this.shouldAllowMoving(p,a),p}),h=u.indexOf(a)===-1;if(!l||!h)return!1;const c=this.getBaseParent(u),d=this.getTargetParent(o,a),f=c===d;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(d),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(u,a,f),this.moveRows(u,a,d),this.dataManager.rewriteCache(),this.moveCellsMeta(u,a),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,t,r,i,i&&this.isRowOrderChanged(e,t)),this.hot.render(),this.selectCells(e,r),!1}displayAPICompatibilityWarning(e){const{rows:t,finalIndex:r,dropIndex:i,movePossible:s}=e;let o=!1;return nn(i)&&(Ut(Bt`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",t,r,i,s,!1),o=!0),o}shouldAllowMoving(e,t){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===t||t===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,t){let r=this.dataManager.getRowParent(e?t-1:t);return r==null&&(r=this.dataManager.getRowParent(t-1)),r}shiftCollapsibleParentsLocations(e,t,r){r||(Math.max(...e)<=t?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],t,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(t,e[0],e.length))}moveRows(e,t,r){const i=t===this.dataManager.getRowIndex(r)+this.dataManager.countChildren(r)+1;this.hot.batchRender(()=>{e.forEach(s=>{this.dataManager.moveRow(s,t,this.movedToCollapsed,i)})})}moveCellsMeta(e,t){const r=[],i=Math.max(...e)<t;e.forEach(s=>{r.push(this.hot.getCellMetaAtRow(s))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(t-(i?r.length:0),0,...r)}selectCells(e,t){const r=e.length;let i=0,s=0,o=null,a=null;if(this.movedToCollapsed){let l=null;e[r-1]<t?l=this.dataManager.translateTrimmedRow(t-r):l=this.dataManager.translateTrimmedRow(t);const u=this.dataManager.getRowParent(l===null?this.hot.countSourceRows()-1:l-1),h=this.dataManager.getRowIndex(u);i=this.dataManager.untranslateTrimmedRow(h),s=i}else e[r-1]<t?(s=t-1,i=s-r+1):(i=t,s=i+r-1);o=this.hot.selection,a=this.hot.countCols()-1,o.setRangeStart(this.hot._createCellCoords(i,0)),o.setRangeEnd(this.hot._createCellCoords(s,a),!0)}isRowOrderChanged(e,t){return e.some((r,i)=>r-i!==t)}}function qce(n,e){S$(n,e),e.add(n)}function AD(n,e,t){S$(n,e),e.set(n,t)}function S$(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function HT(n,e,t){return(e=Xce(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Xce(n){var e=Qce(n,"string");return typeof e=="symbol"?e:e+""}function Qce(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function gv(n,e){return n.get(nr(n,e))}function Ay(n,e,t){return n.set(nr(n,e),t),t}function nr(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const Ny="nestedRows",Zce=300,ND=Ny,Jce="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var iS=new WeakMap,xc=new WeakMap,hr=new WeakSet;class ede extends _t{constructor(){super(...arguments),qce(this,hr),HT(this,"dataManager",null),HT(this,"headersUI",null),HT(this,"collapsedRowsMap",null),AD(this,iS,!1),AD(this,xc,!1)}static get PLUGIN_KEY(){return Ny}static get PLUGIN_PRIORITY(){return Zce}isEnabled(){return!!this.hot.getSettings()[Ny]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new Lg),this.dataManager=new Lce(this,this.hot),this.collapsingUI=new Fce(this,this.hot),this.headersUI=new $o(this,this.hot),this.contextMenuUI=new jce(this,this.hot),this.rowMoveController=new Kce(this),this.addHook("afterInit",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return nr(hr,e,mde).call(e,...r)}),this.addHook("beforeViewRender",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return nr(hr,e,gde).call(e,...r)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return nr(hr,e,rde).call(e,...r)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return nr(hr,e,ide).call(e,...r)}),this.addHook("afterGetRowHeader",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return nr(hr,e,sde).call(e,...r)}),this.addHook("beforeOnCellMouseDown",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return nr(hr,e,nde).call(e,...r)}),this.addHook("beforeRemoveRow",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return nr(hr,e,lde).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return nr(hr,e,ade).call(e,...r)}),this.addHook("beforeAddChild",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return nr(hr,e,ude).call(e,...r)}),this.addHook("afterAddChild",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return nr(hr,e,hde).call(e,...r)}),this.addHook("beforeDetachChild",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return nr(hr,e,cde).call(e,...r)}),this.addHook("afterDetachChild",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return nr(hr,e,dde).call(e,...r)}),this.addHook("modifyRowHeaderWidth",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return nr(hr,e,ode).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return nr(hr,e,fde).call(e,...r)}),this.addHook("beforeRowMove",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return nr(hr,e,tde).call(e,...r)}),this.addHook("beforeLoadData",t=>nr(hr,this,MD).call(this,t)),this.addHook("beforeUpdateData",t=>nr(hr,this,MD).call(this,t)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast(),t=this.collapsingUI.translateTrimmedRow(e.row);return this.collapsingUI.areChildrenCollapsed(t)?this.collapsingUI.expandChildren(t):this.collapsingUI.collapseChildren(t),!1},runOnlyIf:()=>{var e,t;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((t=this.hot.getSelectedRangeLast())===null||t===void 0?void 0:t.isSingle())&&this.hot.selection.isCellVisible(r)&&r.col===-1&&r.row>=0},group:ND,relativeToGroup:hu,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(ND)}disableCoreAPIModifiers(){Ay(xc,this,!0)}enableCoreAPIModifiers(){Ay(xc,this,!1)}onModifyRowData(e){if(!gv(xc,this))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!gv(xc,this))return this.dataManager.countAllRows()}onBeforeDataSplice(e,t,r){return gv(xc,this)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,t,r),!1)}destroy(){super.destroy()}}function tde(n,e,t,r){return this.rowMoveController.onBeforeRowMove(n,e,t,r)}function nde(n,e,t){this.collapsingUI.toggleState(n,e,t)}function rde(n,e,t){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(t[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(t[0],null,-1*e),this.dataManager.filterData(n,e,t),Ay(iS,this,!0),this.dataManager.getData().slice()}function ide(n){return this.contextMenuUI.appendOptions(n)}function sde(n,e){this.headersUI.appendLevelIndicators(n,e)}function ode(n){return Math.max(this.headersUI.rowHeaderWidthCache,n)}function ade(n,e,t,r){r!==this.pluginName&&this.hot._registerTimeout(()=>{Ay(iS,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function lde(n,e,t){const r=Array.from(t.reduce((i,s)=>{if(this.dataManager.isParent(s)){const o=this.dataManager.getDataObject(s).__children;return i.add(s),Array.isArray(o)&&o.forEach(a=>i.add(this.dataManager.getRowIndex(a))),i}return i.add(s)},new Set));t.length=0,t.push(...r)}function ude(){this.collapsingUI.collapsedRowsStash.stash()}function hde(n,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function cde(){this.collapsingUI.collapsedRowsStash.stash()}function dde(n,e,t){this.collapsingUI.collapsedRowsStash.shiftStash(t,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function fde(){this.dataManager.rewriteCache()}function mde(){this.headersUI.updateRowHeaderWidth()}function gde(n,e){gv(iS,this)&&(e.skipRender=!0)}function MD(n){if(!zU(n)){e0(Jce),this.hot.getSettings()[Ny]=!1,this.disablePlugin();return}this.dataManager.setData(n),this.dataManager.rewriteCache()}function DT(n,e,t){return(e=pde(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function pde(n){var e=wde(n,"string");return typeof e=="symbol"?e:e+""}function wde(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class vde{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;DT(this,"rootWindow",void 0),DT(this,"prefix",void 0),DT(this,"savedKeys",[]),this.rootWindow=t,this.prefix=e,this.loadSavedKeys()}saveValue(e,t){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(t)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,t){const r=typeof e>"u"?t:e,i=this.rootWindow.localStorage.getItem(`${this.prefix}_${r}`);return i===null?void 0:JSON.parse(i)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){L(this.savedKeys,(e,t)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[t]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),t=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=t||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}function yde(n,e,t){return(e=Cde(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Cde(n){var e=Sde(n,"string");return typeof e=="symbol"?e:e+""}function Sde(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}be.getSingleton().register("persistentStateSave");be.getSingleton().register("persistentStateLoad");be.getSingleton().register("persistentStateReset");const ID="persistentState",Rde=0;class Ede extends _t{constructor(){super(...arguments),yde(this,"storage",void 0)}static get PLUGIN_KEY(){return ID}static get PLUGIN_PRIORITY(){return Rde}isEnabled(){return!!this.hot.getSettings()[ID]}enablePlugin(){this.enabled||(this.storage||(this.storage=new vde(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,t)=>this.saveValue(e,t)),this.addHook("persistentStateLoad",(e,t)=>this.loadValue(e,t)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,t){t.value=this.storage.loadValue(e)}saveValue(e,t){this.storage.saveValue(e,t)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function bde(n,e){Tde(n,e),e.add(n)}function Tde(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function FT(n,e,t){return(e=Ade(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Ade(n){var e=Nde(n,"string");return typeof e=="symbol"?e:e+""}function Nde(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function OD(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const kT="search",Mde=190,Ide="htSearchResult",Ode=function(n,e,t,r,i){n.getCellMeta(e,t).isSearchResult=i},_de=function(n,e,t){return nn(n)||n===null||!n.toLocaleLowerCase||n.length===0||nn(e)||e===null?!1:e.toString().toLocaleLowerCase(t.locale).indexOf(n.toLocaleLowerCase(t.locale))!==-1};var VT=new WeakSet;class Pde extends _t{constructor(){super(...arguments),bde(this,VT),FT(this,"callback",Ode),FT(this,"queryMethod",_de),FT(this,"searchResultClass",Ide)}static get PLUGIN_KEY(){return kT}static get PLUGIN_PRIORITY(){return Mde}isEnabled(){return this.hot.getSettings()[kT]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[kT];this.updatePluginSettings(t),this.addHook("beforeRenderer",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return OD(VT,e,_D).call(e,...i)}),super.enablePlugin()}disablePlugin(){var e=this;const t=function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return OD(VT,e,_D).call(e,...i)};this.hot.addHook("beforeRenderer",t),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",t)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const i=this.hot.countRows(),s=this.hot.countCols(),o=[],a=this.hot;return Pe(0,i-1,l=>{Pe(0,s-1,u=>{const h=this.hot.getDataAtCell(l,u),c=this.hot.getCellMeta(l,u),d=c.search.callback||t,g=(c.search.queryMethod||r)(e,h,c);if(g){const p={row:l,col:u,data:h};o.push(p)}d&&d(a,l,u,h,g)})}),o}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){ot(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function _D(n,e,t,r,i,s){const o=s.className||[];let a=[];typeof o=="string"?a=o.split(" "):a.push(...o),this.isEnabled()&&s.isSearchResult?a.includes(this.searchResultClass)||a.push(`${this.searchResultClass}`):a.includes(this.searchResultClass)&&a.splice(a.indexOf(this.searchResultClass),1),s.className=a.join(" ")}function xde(n,e){Lde(n,e),e.add(n)}function Lde(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ow(n,e,t){return(e=Hde(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Hde(n){var e=Dde(n,"string");return typeof e=="symbol"?e:e+""}function Dde(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function UT(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const Fde="touchScroll",kde=200;var _w=new WeakSet;class Vde extends _t{constructor(){super(...arguments),xde(this,_w),Ow(this,"scrollbars",[]),Ow(this,"clones",[]),Ow(this,"lockedCollection",!1),Ow(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return Fde}static get PLUGIN_PRIORITY(){return kde}static get SETTING_KEYS(){return!0}isEnabled(){return YM()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>UT(_w,this,Ude).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>UT(_w,this,Bde).call(this)),this.addHook("afterMomentumScroll",()=>UT(_w,this,Wde).call(this))}}function Ude(){if(this.lockedCollection)return;const{topOverlay:n,bottomOverlay:e,inlineStartOverlay:t,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(n),e.clone&&this.scrollbars.push(e),this.scrollbars.push(t),r&&this.scrollbars.push(r),i&&i.clone&&this.scrollbars.push(i),this.clones=[],n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),r&&this.clones.push(r.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}function Bde(){this.freezeOverlays=!0,L(this.clones,n=>{ie(n,"hide-tween")})}function Wde(){this.freezeOverlays=!1,L(this.clones,n=>{Xe(n,"hide-tween"),ie(n,"show-tween")}),this.hot._registerTimeout(()=>{L(this.clones,n=>{Xe(n,"show-tween")})},400),L(this.scrollbars,n=>{n.refresh(),n.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function $de(n,e){Gde(n,e),e.add(n)}function Gde(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jde(n,e,t){return(e=zde(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function zde(n){var e=Yde(n,"string");return typeof e=="symbol"?e:e+""}function Yde(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Kde(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const pv="trimRows",qde=330;var PD=new WeakSet;class Xde extends _t{constructor(){super(...arguments),$de(this,PD),jde(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return pv}static get PLUGIN_PRIORITY(){return qde}isEnabled(){return!!this.hot.getSettings()[pv]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new Lg),this.trimmedRowsMap.addLocalHook("init",()=>Kde(PD,this,Qde).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[pv];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),L(e,t=>{this.trimmedRowsMap.setValueAtIndex(t,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const t=this.getTrimmedRows(),r=this.isValidConfig(e);let i=t;r&&(i=Array.from(new Set(t.concat(e)))),this.hot.runHooks("beforeTrimRow",t,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{L(e,o=>{this.trimmedRowsMap.setValueAtIndex(o,!0)})},!0),this.hot.runHooks("afterTrimRow",t,i,r,r&&i.length>t.length))}trimRow(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.trimRows(t)}untrimRows(e){const t=this.getTrimmedRows(),r=this.isValidConfig(e);let i=t;const s=this.trimmedRowsMap.getValues().slice(),o=e.length>0;r&&o&&(L(e,l=>{s[l]=!1}),i=jn(s,(l,u,h)=>(u&&l.push(h),l),[])),this.hot.runHooks("beforeUntrimRow",t,i,r&&o)!==!1&&(r&&o&&this.trimmedRowsMap.setValues(s),this.hot.runHooks("afterUntrimRow",t,i,r&&o,r&&i.length<t.length))}untrimRow(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.untrimRows(t)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const t=this.hot.countSourceRows();return e.every(r=>Number.isInteger(r)&&r>=0&&r<t)}destroy(){super.destroy()}}function Qde(){const n=this.hot.getSettings()[pv];Array.isArray(n)&&this.hot.batchExecution(()=>{L(n,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}var xD={},BT,LD;function R$(){return LD||(LD=1,BT={}),BT}var WT,HD;function Zde(){if(HD)return WT;HD=1;var n=lu(),e=R$(),t=n("iterator"),r=Array.prototype;return WT=function(i){return i!==void 0&&(e.Array===i||r[t]===i)},WT}var $T,DD;function E$(){if(DD)return $T;DD=1;var n=Tk(),e=sC(),t=QN(),r=R$(),i=lu(),s=i("iterator");return $T=function(o){if(!t(o))return e(o,s)||e(o,"@@iterator")||r[n(o)]},$T}var GT,FD;function Jde(){if(FD)return GT;FD=1;var n=lo(),e=pg(),t=nl(),r=iC(),i=E$(),s=TypeError;return GT=function(o,a){var l=arguments.length<2?i(o):a;if(e(l))return t(n(l,o));throw new s(r(o)+" is not iterable")},GT}var jT,kD;function efe(){if(kD)return jT;kD=1;var n=Ok(),e=lo(),t=nl(),r=iC(),i=Zde(),s=Cg(),o=nC(),a=Jde(),l=E$(),u=lM(),h=TypeError,c=function(f,g){this.stopped=f,this.result=g},d=c.prototype;return jT=function(f,g,p){var v=p&&p.that,y=!!(p&&p.AS_ENTRIES),S=!!(p&&p.IS_RECORD),R=!!(p&&p.IS_ITERATOR),A=!!(p&&p.INTERRUPTED),O=n(g,v),V,B,Y,q,G,Z,ee,ne=function(ae){return V&&u(V,"normal"),new c(!0,ae)},re=function(ae){return y?(t(ae),A?O(ae[0],ae[1],ne):O(ae[0],ae[1])):A?O(ae,ne):O(ae)};if(S)V=f.iterator;else if(R)V=f;else{if(B=l(f),!B)throw new h(r(f)+" is not iterable");if(i(B)){for(Y=0,q=s(f);q>Y;Y++)if(G=re(f[Y]),G&&o(d,G))return G;return new c(!1)}V=a(f,B)}for(Z=S?f.next:V.next;!(ee=e(Z,V)).done;){try{G=re(ee.value)}catch(ae){u(V,"throw",ae)}if(typeof G=="object"&&G&&o(d,G))return G}return new c(!1)},jT}var zT,VD;function tfe(){if(VD)return zT;VD=1;var n=ao(),e=Fh(),t=eC();return zT=function(r,i,s){n?e.f(r,i,t(0,s)):r[i]=s},zT}var UD;function nfe(){if(UD)return xD;UD=1;var n=Ir(),e=efe(),t=tfe();return n({target:"Object",stat:!0},{fromEntries:function(i){var s={};return e(i,function(o,a){t(s,o,a)},{AS_ENTRIES:!0}),s}}),xD}nfe();const b$="undoRedo",rfe="undoRedo";function fe(n){const e=this;this.instance=n,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,n.addHook("afterChange",function(r,i){const s=r&&r.length;if(!s||!r.find(l=>{const[,,u,h]=l;return u!==h}))return;const a=()=>{const l=r.reduce((h,c)=>(h.push([...c]),h),[]);L(l,h=>{h[1]=n.propToCol(h[1])});const u=s>1?this.getSelected():[[l[0][0],l[0][1]]];return new fe.ChangeAction(l,u)};e.done(a,i)}),n.addHook("afterCreateRow",(r,i,s)=>{e.done(()=>new fe.CreateRowAction(r,i),s)});const t=(r,i,s,o)=>{const a=["visualRow","visualCol","row","col","prop"],l=a.length,u=[];return Pe(s,o,h=>{Pe(r,i,c=>{const d=n.getCellMeta(c,h);if(Object.keys(d).length!==l){const f=Object.fromEntries(Object.entries(d).filter(g=>{let[p]=g;return a.includes(p)===!1}));u.push([d.visualRow,d.visualCol,f])}})}),u};n.addHook("beforeRemoveRow",(r,i,s,o)=>{const a=()=>{const l=n.toPhysicalRow(r),u=l+i-1,h=Gr(e.instance.getSourceData(l,0,l+i-1,e.instance.countSourceCols()-1));return new fe.RemoveRowAction(l,h,n.getSettings().fixedRowsBottom,n.getSettings().fixedRowsTop,n.rowIndexMapper.getIndexesSequence(),t(l,u,0,n.countCols()-1))};e.done(a,o)}),n.addHook("afterCreateCol",(r,i,s)=>{e.done(()=>new fe.CreateColumnAction(r,i),s)}),n.addHook("beforeRemoveCol",(r,i,s,o)=>{const a=()=>{const l=e.instance.getSourceDataArray(),u=(e.instance.countCols()+r)%e.instance.countCols(),h=u+i-1,c=[],d=[],f=[];Pe(l.length-1,v=>{const y=[],S=l[v];Pe(u,h,R=>{y.push(S[n.toPhysicalColumn(R)])}),c.push(y)}),Pe(i-1,v=>{f.push(n.toPhysicalColumn(u+v))}),Array.isArray(n.getSettings().colHeaders)&&Pe(i-1,v=>{d.push(n.getSettings().colHeaders[n.toPhysicalColumn(u+v)]||null)});const g=n.columnIndexMapper.getIndexesSequence(),p=n.rowIndexMapper.getIndexesSequence();return new fe.RemoveColumnAction(u,f,c,d,g,p,n.getSettings().fixedColumnsStart,t(0,n.countRows(),u,h))};e.done(a,o)}),n.addHook("beforeCellAlignment",(r,i,s,o)=>{e.done(()=>new fe.CellAlignmentAction(r,i,s,o))}),n.addHook("beforeFilter",(r,i)=>{e.done(()=>new fe.FiltersAction(r,i))}),n.addHook("beforeRowMove",(r,i)=>{r!==!1&&e.done(()=>new fe.RowMoveAction(r,i))}),n.addHook("beforeColumnMove",(r,i)=>{r!==!1&&e.done(()=>new fe.ColumnMoveAction(r,i))}),n.addHook("beforeMergeCells",(r,i)=>{i||e.done(()=>new fe.MergeCellsAction(n,r))}),n.addHook("afterUnmergeCells",(r,i)=>{i||e.done(()=>new fe.UnmergeCellsAction(n,r))}),n.addHook("beforeColumnSort",(r,i,s)=>{s&&e.done(()=>new fe.ColumnSortAction(r,i))}),n.addHook("afterInit",()=>{e.init()})}fe.prototype.done=function(n,e){if(this.ignoreNewActions||e==="UndoRedo.undo"||e==="UndoRedo.redo"||e==="auto")return;const r=this.doneActions.slice();if(this.instance.runHooks("beforeUndoStackChange",r,e)===!1)return;const s=n(),o=this.undoneActions.slice();this.doneActions.push(s),this.instance.runHooks("afterUndoStackChange",r,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",o),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",o,this.undoneActions.slice())};fe.prototype.undo=function(){if(this.isUndoAvailable()){const n=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",n);const e=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",n,this.doneActions.slice());const t=Gr(e);if(this.instance.runHooks("beforeUndo",t)===!1)return;this.ignoreNewActions=!0;const i=this,s=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",s),e.undo(this.instance,()=>{i.ignoreNewActions=!1,i.undoneActions.push(e)}),this.instance.runHooks("afterRedoStackChange",s,this.undoneActions.slice()),this.instance.runHooks("afterUndo",t)}};fe.prototype.redo=function(){if(this.isRedoAvailable()){const n=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",n);const e=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",n,this.undoneActions.slice());const t=Gr(e);if(this.instance.runHooks("beforeRedo",t)===!1)return;this.ignoreNewActions=!0;const i=this,s=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",s),e.redo(this.instance,()=>{i.ignoreNewActions=!1,i.doneActions.push(e)}),this.instance.runHooks("afterUndoStackChange",s,this.doneActions.slice()),this.instance.runHooks("afterRedo",t)}};fe.prototype.isUndoAvailable=function(){return this.doneActions.length>0};fe.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};fe.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0};fe.prototype.isEnabled=function(){return this.enabled};fe.prototype.enable=function(){if(this.isEnabled())return;const n=this.instance;this.enabled=!0,ofe(n),this.registerShortcuts(),n.addHook("afterChange",T$)};fe.prototype.disable=function(){if(!this.isEnabled())return;const n=this.instance;this.enabled=!1,afe(n),this.unregisterShortcuts(),n.removeHook("afterChange",T$)};fe.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null};fe.Action=function(){};fe.Action.prototype.undo=function(){};fe.Action.prototype.redo=function(){};fe.ChangeAction=function(n,e){this.changes=n,this.selected=e,this.actionType="change"};co(fe.ChangeAction,fe.Action);fe.ChangeAction.prototype.undo=function(n,e){const t=Gr(this.changes),r=n.countEmptyRows(!0),i=n.countEmptyCols(!0);for(let o=0,a=t.length;o<a;o++)t[o].splice(3,1);n.addHookOnce("afterChange",e),n.setDataAtCell(t,null,null,"UndoRedo.undo");for(let o=0,a=t.length;o<a;o++){const[l,u]=t[o];n.getSettings().minSpareRows&&l+1+n.getSettings().minSpareRows===n.countRows()&&r===n.getSettings().minSpareRows&&(n.alter("remove_row",parseInt(l+1,10),n.getSettings().minSpareRows),n.undoRedo.doneActions.pop()),n.getSettings().minSpareCols&&u+1+n.getSettings().minSpareCols===n.countCols()&&i===n.getSettings().minSpareCols&&(n.alter("remove_col",parseInt(u+1,10),n.getSettings().minSpareCols),n.undoRedo.doneActions.pop())}const s=n.getSelectedLast();if(s!==void 0){const[o,a]=t[0],[l,u]=s,h=n.view.getFirstFullyVisibleRow(),c=n.view.getFirstFullyVisibleColumn(),d=o>=h,f=a>=c;if((d&&f)===!1&&(l!==o||u!==a)===!0){const v={row:o,col:a};d===!1&&(v.verticalSnap="top"),f===!1&&(v.horizontalSnap="start"),n.scrollViewportTo(v)}}n.selectCells(this.selected,!1,!1)};fe.ChangeAction.prototype.redo=function(n,e){const t=Gr(this.changes);for(let r=0,i=t.length;r<i;r++)t[r].splice(2,1);n.addHookOnce("afterChange",e),n.setDataAtCell(t,null,null,"UndoRedo.redo"),this.selected&&n.selectCells(this.selected,!1,!1)};fe.CreateRowAction=function(n,e){this.index=n,this.amount=e,this.actionType="insert_row"};co(fe.CreateRowAction,fe.Action);fe.CreateRowAction.prototype.undo=function(n,e){const t=n.countRows(),r=n.getSettings().minSpareRows;this.index>=t&&this.index-r<t&&(this.index-=r),n.addHookOnce("afterRemoveRow",e),n.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};fe.CreateRowAction.prototype.redo=function(n,e){n.addHookOnce("afterCreateRow",e),n.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")};fe.RemoveRowAction=function(n,e,t,r,i,s){this.index=n,this.data=e,this.actionType="remove_row",this.fixedRowsBottom=t,this.fixedRowsTop=r,this.rowIndexesSequence=i,this.removedCellMetas=s};co(fe.RemoveRowAction,fe.Action);fe.RemoveRowAction.prototype.undo=function(n,e){const t=n.getSettings(),r=[];t.fixedRowsBottom=this.fixedRowsBottom,t.fixedRowsTop=this.fixedRowsTop,this.data.forEach((i,s)=>{Object.keys(i).forEach(o=>{const a=parseInt(o,10);r.push([this.index+s,isNaN(a)?o:a,i[o]])})}),n.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),this.removedCellMetas.forEach(i=>{let[s,o,a]=i;n.setCellMetaObject(s,o,a)}),n.addHookOnce("afterViewRender",e),n.setSourceDataAtCell(r,null,null,"UndoRedo.undo"),n.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)};fe.RemoveRowAction.prototype.redo=function(n,e){n.addHookOnce("afterRemoveRow",e),n.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};fe.CreateColumnAction=function(n,e){this.index=n,this.amount=e,this.actionType="insert_col"};co(fe.CreateColumnAction,fe.Action);fe.CreateColumnAction.prototype.undo=function(n,e){n.addHookOnce("afterRemoveCol",e),n.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};fe.CreateColumnAction.prototype.redo=function(n,e){n.addHookOnce("afterCreateCol",e),n.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")};fe.RemoveColumnAction=function(n,e,t,r,i,s,o,a){this.index=n,this.indexes=e,this.data=t,this.amount=this.data[0].length,this.headers=r,this.columnPositions=i.slice(0),this.rowPositions=s.slice(0),this.actionType="remove_col",this.fixedColumnsStart=o,this.removedCellMetas=a};co(fe.RemoveColumnAction,fe.Action);fe.RemoveColumnAction.prototype.undo=function(n,e){const t=n.getSettings();t.fixedColumnsStart=this.fixedColumnsStart;const r=this.indexes.slice(0).sort(),i=(u,h,c)=>c[this.indexes.indexOf(r[h])],s=this.data.length,o=[];for(let u=0;u<s;u++)o.push(wt(this.data[u],i));const a=wt(this.headers,i),l=[];n.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),L(n.getSourceDataArray(),(u,h)=>{L(r,(c,d)=>{u[c]=o[h][d],l.push([h,c,u[c]])})}),n.setSourceDataAtCell(l,void 0,void 0,"UndoRedo.undo"),typeof this.headers<"u"&&L(a,(u,h)=>{n.getSettings().colHeaders[r[h]]=u}),this.removedCellMetas.forEach(u=>{let[h,c,d]=u;n.setCellMetaObject(h,c,d)}),n.batchExecution(()=>{n.rowIndexMapper.setIndexesSequence(this.rowPositions),n.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),n.addHookOnce("afterViewRender",e),n.render()};fe.RemoveColumnAction.prototype.redo=function(n,e){n.addHookOnce("afterRemoveCol",e),n.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};fe.CellAlignmentAction=function(n,e,t,r){this.stateBefore=n,this.range=e,this.type=t,this.alignment=r};fe.CellAlignmentAction.prototype.undo=function(n,e){L(this.range,t=>{t.forAll((r,i)=>{r>=0&&i>=0&&n.setCellMeta(r,i,"className",this.stateBefore[r][i]||" htLeft")})}),n.addHookOnce("afterViewRender",e),n.render()};fe.CellAlignmentAction.prototype.redo=function(n,e){Tl(this.range,this.type,this.alignment,(t,r)=>n.getCellMeta(t,r),(t,r,i,s)=>n.setCellMeta(t,r,i,s)),n.addHookOnce("afterViewRender",e),n.render()};fe.FiltersAction=function(n,e){this.previousConditionsStack=e,this.conditionsStack=n,this.actionType="filter"};co(fe.FiltersAction,fe.Action);fe.FiltersAction.prototype.undo=function(n,e){const t=n.getPlugin("filters");n.addHookOnce("afterViewRender",e),this.previousConditionsStack&&t.conditionCollection.importAllConditions(this.previousConditionsStack),t.filter()};fe.FiltersAction.prototype.redo=function(n,e){const t=n.getPlugin("filters");n.addHookOnce("afterViewRender",e),t.conditionCollection.importAllConditions(this.conditionsStack),t.filter()};class ife extends fe.Action{constructor(e,t){super(),this.cellRange=t;const r=this.cellRange.getTopStartCorner(),i=this.cellRange.getBottomEndCorner();this.rangeData=e.getData(r.row,r.col,i.row,i.col)}undo(e,t){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),r.unmergeRange(this.cellRange,!0);const i=this.cellRange.getTopStartCorner();e.populateFromArray(i.row,i.col,this.rangeData,void 0,void 0,"MergeCells")}redo(e,t){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),r.mergeRange(this.cellRange)}}fe.MergeCellsAction=ife;class sfe extends fe.Action{constructor(e,t){super(),this.cellRange=t}undo(e,t){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),r.mergeRange(this.cellRange,!0)}redo(e,t){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),r.unmergeRange(this.cellRange,!0),e.render()}}fe.UnmergeCellsAction=sfe;fe.RowMoveAction=function(n,e){this.rows=n.slice(),this.finalRowIndex=e,this.actionType="row_move"};co(fe.RowMoveAction,fe.Action);fe.RowMoveAction.prototype.undo=function(n,e){const t=n.getPlugin("manualRowMove");n.addHookOnce("afterViewRender",e),AO(this.rows,this.finalRowIndex,n.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(i=>{let{from:s,to:o}=i;s<o&&(o-=1),t.moveRow(o,s)}),n.render(),n.deselectCell(),n.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)};fe.RowMoveAction.prototype.redo=function(n,e){const t=n.getPlugin("manualRowMove");n.addHookOnce("afterViewRender",e),t.moveRows(this.rows.slice(),this.finalRowIndex),n.render(),n.deselectCell(),n.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)};fe.ColumnMoveAction=function(n,e){this.columns=n.slice(),this.finalColumnIndex=e,this.actionType="col_move"};co(fe.ColumnMoveAction,fe.Action);fe.ColumnMoveAction.prototype.undo=function(n,e){const t=n.getPlugin("manualColumnMove");n.addHookOnce("afterViewRender",e),AO(this.columns,this.finalColumnIndex,n.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(i=>{let{from:s,to:o}=i;s<o&&(o-=1),t.moveColumn(o,s)}),n.render(),n.deselectCell(),n.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)};fe.ColumnMoveAction.prototype.redo=function(n,e){const t=n.getPlugin("manualColumnMove");n.addHookOnce("afterViewRender",e),t.moveColumns(this.columns.slice(),this.finalColumnIndex),n.render(),n.deselectCell(),n.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)};fe.ColumnSortAction=function(n,e){this.previousSortState=n,this.nextSortState=e};co(fe.ColumnSortAction,fe.Action);fe.ColumnSortAction.prototype.undo=function(n,e){const t=n.getPlugin("columnSorting"),r=n.getPlugin("multiColumnSorting"),i=r.isEnabled()?r:t;this.previousSortState.length?i.sort(this.previousSortState):i.clearSort(),e()};fe.ColumnSortAction.prototype.redo=function(n,e){const t=n.getPlugin("columnSorting"),r=n.getPlugin("multiColumnSorting");(r.isEnabled()?r:t).sort(this.nextSortState),e()};fe.prototype.init=function(){const n=this.instance.getSettings().undo,e=typeof n>"u"||n;this.instance.undoRedo||(this.instance.undoRedo=this),e?this.instance.undoRedo.enable():this.instance.undoRedo.disable()};fe.prototype.registerShortcuts=function(){const e=this.instance.getShortcutManager().getContext("grid"),r={runOnlyIf:i=>!i.altKey,group:b$};e.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],r)};fe.prototype.unregisterShortcuts=function(){this.instance.getShortcutManager().getContext("grid").removeShortcutsByGroup(b$)};function T$(n,e){const t=this;if(e==="loadData")return t.undoRedo.clear()}function ofe(n){n.undo=function(){return n.undoRedo.undo()},n.redo=function(){return n.undoRedo.redo()},n.isUndoAvailable=function(){return n.undoRedo.isUndoAvailable()},n.isRedoAvailable=function(){return n.undoRedo.isRedoAvailable()},n.clearUndo=function(){return n.undoRedo.clear()}}function afe(n){delete n.undo,delete n.redo,delete n.isUndoAvailable,delete n.isRedoAvailable,delete n.clearUndo}const $g=be.getSingleton();$g.add("afterUpdateSettings",function(){var n;(n=this.getPlugin("undoRedo"))===null||n===void 0||n.init()});$g.register("beforeUndo");$g.register("afterUndo");$g.register("beforeRedo");$g.register("afterRedo");fe.PLUGIN_KEY=rfe;fe.SETTING_KEYS=!0;function lfe(){At(cm),At(See),At(dm),At(tte),At(ute),At(qB),At(rne),At(Wne),At(ZC),At(Zre),At(bie),At(Pie),At(tS),At(ose),At(iae),At(Hae),At(ale),At(vle),At(Ole),At(Ble),At(Qle),At(gue),At(bue),At(rhe),At(Fhe),At(Whe),At(mce),At(ede),At(Ede),At(Pde),At(Vde),At(Xde),At(fe)}function ufe(){qZ(),mJ(),EJ(),$J(),lfe()}function hfe(n){const e=typeof window>"u"?!1:window.jQuery;e&&(e.fn.handsontable=function(t){const r=this.first();let i=r.data("handsontable");if(typeof t!="string"){const u=t||{};return i?i.updateSettings(u):(i=new n.Core(r[0],u),r.data("handsontable",i),i.init()),r}let s;if(i)if(typeof i[t]<"u"){for(var o=arguments.length,a=new Array(o>1?o-1:0),l=1;l<o;l++)a[l-1]=arguments[l];s=i[t].call(i,...a),t==="destroy"&&r.removeData()}else throw new Error(`Handsontable do not provide action: ${t}`);return s})}var YT,KT,qT,XT,QT;ufe();hfe(Qe);Qe.__GhostTable=cO;Qe._getListenersCounter=_6;Qe._getRegisteredMapsCounter=y8;Qe.EventManager=ys;const cfe=[d4,u6,o8,pJ,o6,e6,p4,Q6,s6,v4,d6,X6],dfe=[X4,f6];Qe.helper={};Qe.dom={};L(cfe,n=>{L(Object.getOwnPropertyNames(n),e=>{e.charAt(0)!=="_"&&(Qe.helper[e]=n[e])})});L(dfe,n=>{L(Object.getOwnPropertyNames(n),e=>{e.charAt(0)!=="_"&&(Qe.dom[e]=n[e])})});Qe.cellTypes=(YT=Qe.cellTypes)!==null&&YT!==void 0?YT:{};L(b7(),n=>{Qe.cellTypes[n]=YI(n)});Qe.cellTypes.registerCellType=ts;Qe.cellTypes.getCellType=YI;Qe.editors=(KT=Qe.editors)!==null&&KT!==void 0?KT:{};L(T6(),n=>{Qe.editors[`${$r(n)}Editor`]=Uv(n)});Qe.editors.registerEditor=fi;Qe.editors.getEditor=Uv;Qe.renderers=(qT=Qe.renderers)!==null&&qT!==void 0?qT:{};L(dX(),n=>{const e=Bv(n);n==="base"&&(Qe.renderers.cellDecorator=e),Qe.renderers[`${$r(n)}Renderer`]=e});Qe.renderers.registerRenderer=Pi;Qe.renderers.getRenderer=Bv;Qe.validators=(XT=Qe.validators)!==null&&XT!==void 0?XT:{};L(gX(),n=>{Qe.validators[`${$r(n)}Validator`]=s0(n)});Qe.validators.registerValidator=ah;Qe.validators.getValidator=s0;Qe.plugins=(QT=Qe.plugins)!==null&&QT!==void 0?QT:{};L(i0(),n=>{Qe.plugins[n]=Og(n)});Qe.plugins[`${$r(_t.PLUGIN_KEY)}Plugin`]=_t;Qe.plugins.registerPlugin=At;Qe.plugins.getPlugin=Og;/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */var Hn;(function(n){n.RELATIVE="RELATIVE",n.ABSOLUTE="ABSOLUTE"})(Hn||(Hn={}));class ei{constructor(e,t,r){this.type=e,this.col=t,this.sheet=r}static absolute(e,t){return new ei(Hn.ABSOLUTE,e,t)}static relative(e,t){return new ei(Hn.RELATIVE,e,t)}static compareByAbsoluteAddress(e){return(t,r)=>t.toSimpleColumnAddress(e).col-r.toSimpleColumnAddress(e).col}isColumnAbsolute(){return this.type===Hn.ABSOLUTE}isColumnRelative(){return this.type===Hn.RELATIVE}isAbsolute(){return this.type===Hn.ABSOLUTE&&this.sheet!==void 0}moved(e,t,r){const i=this.sheet===void 0?void 0:e;return new ei(this.type,this.col+t,i)}shiftedByColumns(e){return new ei(this.type,this.col+e,this.sheet)}toSimpleColumnAddress(e){const t=no(this,e);let r=this.col;return this.isColumnRelative()&&(r=e.col+this.col),JG(t,r)}shiftRelativeDimensions(e,t){const r=this.isColumnRelative()?this.col+e:this.col;return new ei(this.type,r,this.sheet)}shiftAbsoluteDimensions(e,t){const r=this.isColumnAbsolute()?this.col+e:this.col;return new ei(this.type,r,this.sheet)}withSheet(e){return new ei(this.type,this.col,e)}isInvalid(e){return this.toSimpleColumnAddress(e).col<0}hash(e){const t=e&&this.sheet!==void 0?`#${this.sheet}`:"";switch(this.type){case Hn.RELATIVE:return`${t}#COLR${this.col}`;case Hn.ABSOLUTE:return`${t}#COLA${this.col}`}}unparse(e){const t=this.toSimpleColumnAddress(e);if(Ype(t))return;const r=oS(t.col);return`${this.type===Hn.ABSOLUTE?"$":""}${r}`}exceedsSheetSizeLimits(e){return this.col>=e}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class kr{constructor(e,t,r){this.type=e,this.row=t,this.sheet=r}static absolute(e,t){return new kr(Hn.ABSOLUTE,e,t)}static relative(e,t){return new kr(Hn.RELATIVE,e,t)}static compareByAbsoluteAddress(e){return(t,r)=>t.toSimpleRowAddress(e).row-r.toSimpleRowAddress(e).row}isRowAbsolute(){return this.type===Hn.ABSOLUTE}isRowRelative(){return this.type===Hn.RELATIVE}isAbsolute(){return this.type===Hn.ABSOLUTE&&this.sheet!==void 0}moved(e,t,r){const i=this.sheet===void 0?void 0:e;return new kr(this.type,this.row+r,i)}shiftedByRows(e){return new kr(this.type,this.row+e,this.sheet)}toSimpleRowAddress(e){const t=no(this,e);let r=this.row;return this.isRowRelative()&&(r=e.row+this.row),ZG(t,r)}shiftRelativeDimensions(e,t){const r=this.isRowRelative()?this.row+t:this.row;return new kr(this.type,r,this.sheet)}shiftAbsoluteDimensions(e,t){const r=this.isRowAbsolute()?this.row+t:this.row;return new kr(this.type,r,this.sheet)}withSheet(e){return new kr(this.type,this.row,e)}isInvalid(e){return this.toSimpleRowAddress(e).row<0}hash(e){const t=e&&this.sheet!==void 0?`#${this.sheet}`:"";switch(this.type){case Hn.RELATIVE:return`${t}#ROWR${this.row}`;case Hn.ABSOLUTE:return`${t}#ROWA${this.row}`}}unparse(e){const t=this.toSimpleRowAddress(e);return zpe(t)?void 0:`${this.type===Hn.ABSOLUTE?"$":""}${t.row+1}`}exceedsSheetSizeLimits(e){return this.row>=e}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */var kt;(function(n){n.CELL_REFERENCE_RELATIVE="CELL_REFERENCE",n.CELL_REFERENCE_ABSOLUTE="CELL_REFERENCE_ABSOLUTE",n.CELL_REFERENCE_ABSOLUTE_COL="CELL_REFERENCE_ABSOLUTE_COL",n.CELL_REFERENCE_ABSOLUTE_ROW="CELL_REFERENCE_ABSOLUTE_ROW"})(kt||(kt={}));class Xt{constructor(e,t,r,i){this.col=e,this.row=t,this.type=r,this.sheet=i}static fromColAndRow(e,t,r){return(e.isColumnAbsolute()&&t.isRowAbsolute()?Xt.absolute.bind(this):e.isColumnAbsolute()?Xt.absoluteCol.bind(this):t.isRowAbsolute()?Xt.absoluteRow.bind(this):Xt.relative.bind(this))(e.col,t.row,r)}static relative(e,t,r){return new Xt(e,t,kt.CELL_REFERENCE_RELATIVE,r)}static absolute(e,t,r){return new Xt(e,t,kt.CELL_REFERENCE_ABSOLUTE,r)}static absoluteCol(e,t,r){return new Xt(e,t,kt.CELL_REFERENCE_ABSOLUTE_COL,r)}static absoluteRow(e,t,r){return new Xt(e,t,kt.CELL_REFERENCE_ABSOLUTE_ROW,r)}toSimpleCellAddress(e){const t=no(this,e);return this.type===kt.CELL_REFERENCE_ABSOLUTE?we(t,this.col,this.row):this.type===kt.CELL_REFERENCE_ABSOLUTE_ROW?we(t,e.col+this.col,this.row):this.type===kt.CELL_REFERENCE_ABSOLUTE_COL?we(t,this.col,e.row+this.row):we(t,e.col+this.col,e.row+this.row)}toColumnAddress(){const e=this.isColumnRelative()?Hn.RELATIVE:Hn.ABSOLUTE;return new ei(e,this.col,this.sheet)}toRowAddress(){const e=this.isRowRelative()?Hn.RELATIVE:Hn.ABSOLUTE;return new kr(e,this.row,this.sheet)}toSimpleColumnAddress(e){const t=no(this,e);let r=this.col;return this.isColumnRelative()&&(r+=e.col),JG(t,r)}toSimpleRowAddress(e){const t=no(this,e);let r=this.row;return this.isRowRelative()&&(r+=e.row),ZG(t,r)}isRowAbsolute(){return this.type===kt.CELL_REFERENCE_ABSOLUTE||this.type===kt.CELL_REFERENCE_ABSOLUTE_ROW}isColumnAbsolute(){return this.type===kt.CELL_REFERENCE_ABSOLUTE||this.type===kt.CELL_REFERENCE_ABSOLUTE_COL}isColumnRelative(){return this.type===kt.CELL_REFERENCE_RELATIVE||this.type===kt.CELL_REFERENCE_ABSOLUTE_ROW}isRowRelative(){return this.type===kt.CELL_REFERENCE_RELATIVE||this.type===kt.CELL_REFERENCE_ABSOLUTE_COL}isAbsolute(){return this.type===kt.CELL_REFERENCE_ABSOLUTE&&this.sheet!==void 0}shiftedByRows(e){return new Xt(this.col,this.row+e,this.type,this.sheet)}shiftedByColumns(e){return new Xt(this.col+e,this.row,this.type,this.sheet)}moved(e,t,r){const i=this.sheet===void 0?void 0:e;return new Xt(this.col+t,this.row+r,this.type,i)}withSheet(e){return new Xt(this.col,this.row,this.type,e)}isInvalid(e){return Ri(this.toSimpleCellAddress(e))}shiftRelativeDimensions(e,t){const r=this.isColumnAbsolute()?this.col:this.col+e,i=this.isRowAbsolute()?this.row:this.row+t;return new Xt(r,i,this.type,this.sheet)}shiftAbsoluteDimensions(e,t){const r=this.isColumnRelative()?this.col:this.col+e,i=this.isRowRelative()?this.row:this.row+t;return new Xt(r,i,this.type,this.sheet)}hash(e){const t=e&&this.sheet!==void 0?`#${this.sheet}`:"";switch(this.type){case kt.CELL_REFERENCE_RELATIVE:return`${t}#${this.row}R${this.col}`;case kt.CELL_REFERENCE_ABSOLUTE:return`${t}#${this.row}A${this.col}`;case kt.CELL_REFERENCE_ABSOLUTE_COL:return`${t}#${this.row}AC${this.col}`;case kt.CELL_REFERENCE_ABSOLUTE_ROW:return`${t}#${this.row}AR${this.col}`}}unparse(e){const t=this.toSimpleCellAddress(e);if(Ri(t))return;const r=oS(t.col),i=this.type===kt.CELL_REFERENCE_ABSOLUTE||this.type===kt.CELL_REFERENCE_ABSOLUTE_ROW?"$":"";return`${this.type===kt.CELL_REFERENCE_ABSOLUTE||this.type===kt.CELL_REFERENCE_ABSOLUTE_COL?"$":""}${r}${i}${t.row+1}`}exceedsSheetSizeLimits(e,t){return this.row>=t||this.col>=e}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const Gg=":",ti="$",ffe="\\s+",mfe="[ \\t\\n\\r]+",sS="A-Za-zÃ-Ê¯",PO=`${sS}0-9_.`,A$=`[${sS}0-9_]+`,gfe="'(((?!').|'')*)'",Vd=`(${A$}|${gfe})!`,N$=`(${Vd})?\\${ti}?[A-Za-z]+\\${ti}?[0-9]+`,BD=`(${Vd})?\\${ti}?[A-Za-z]+`,WD=`(${Vd})?\\${ti}?[0-9]+`,M$="[rR][0-9]*[cC][0-9]*",pfe=`(${N$})[^${PO}]`,I$=`[${sS}_][${PO}]*`,wfe=["0","1","2","3","4","5","6","7","8","9"],O$=[...Array.from(Array(26)).map((n,e)=>e+65),...Array.from(Array(26)).map((n,e)=>e+97),...Array.from(Array(496)).map((n,e)=>e+192)].map(n=>String.fromCharCode(n));/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const _$=new RegExp(`^(${Vd})?(\\${ti}?)([A-Za-z]+)(\\${ti}?)([0-9]+)$`),vfe=new RegExp(`^(${Vd})?(\\${ti}?)([A-Za-z]+)$`),yfe=new RegExp(`^(${Vd})?(\\${ti}?)([0-9]+)$`),Cfe=new RegExp(`^${A$}$`),$c=(n,e,t)=>{const r=_$.exec(e),i=xO(r[6]);let s=aS(r,n);if(s===void 0)return;s===null&&(s=void 0);const o=Number(r[8])-1;return r[5]===ti&&r[7]===ti?Xt.absolute(i,o,s):r[5]===ti?Xt.absoluteCol(i,o-t.row,s):r[7]===ti?Xt.absoluteRow(i-t.col,o,s):Xt.relative(i-t.col,o-t.row,s)},My=(n,e,t)=>{const r=vfe.exec(e);let i=aS(r,n);if(i===void 0)return;i===null&&(i=void 0);const s=xO(r[6]);return r[5]===ti?ei.absolute(s,i):ei.relative(s-t.col,i)},Iy=(n,e,t)=>{const r=yfe.exec(e);let i=aS(r,n);if(i===void 0)return;i===null&&(i=void 0);const s=Number(r[6])-1;return r[5]===ti?kr.absolute(s,i):kr.relative(s-t.row,i)},vN=(n,e,t)=>{const r=_$.exec(e);if(!r)return;const i=xO(r[6]);let s=aS(r,n);if(s===void 0)return;s===null&&(s=t);const o=Number(r[8])-1;return we(s,i,o)},Sfe=(n,e,t)=>{const r=e.split(Gg);if(r.length!==2)return;const[i,s]=r,o=vN(n,i,t);if(o===void 0)return;const a=vN(n,s,o.sheet);if(a!==void 0&&o.sheet===a.sheet)return xN(o,a)},Oy=(n,e,t)=>{const r=oS(e.col),i=P$(e.sheet,n);if(i!==void 0)return t!==e.sheet?`${i}!${r}${e.row+1}`:`${r}${e.row+1}`},Rfe=(n,e,t)=>{const r=Oy(n,e.start,t),i=Oy(n,e.end,e.start.sheet);if(!(r===void 0||i===void 0))return`${r}${Gg}${i}`};function xO(n){return n.length===1?n.toUpperCase().charCodeAt(0)-65:n.split("").reduce((e,t)=>e*26+(t.toUpperCase().charCodeAt(0)-64),0)-1}function oS(n){let e="";for(;n>=0;)e=String.fromCharCode(n%26+97)+e,n=Math.floor(n/26)-1;return e.toUpperCase()}function P$(n,e){let t=e(n);if(t!==void 0)return Cfe.test(t)?t:(t=t.replace(/'/g,"''"),`'${t}'`)}function aS(n,e){var t;let r=(t=n[3])!==null&&t!==void 0?t:n[2];return r?(r=r.replace(/''/g,"'"),e(r)):null}function Qt(n){return n&&n.length===0}function ll(n){return n==null?[]:Object.keys(n)}function Br(n){for(var e=[],t=Object.keys(n),r=0;r<t.length;r++)e.push(n[t[r]]);return e}function Efe(n,e){for(var t=[],r=ll(n),i=0;i<r.length;i++){var s=r[i];t.push(e.call(null,n[s],s))}return t}function Ee(n,e){for(var t=[],r=0;r<n.length;r++)t.push(e.call(null,n[r],r));return t}function Ti(n){for(var e=[],t=0;t<n.length;t++){var r=n[t];Array.isArray(r)?e=e.concat(Ti(r)):e.push(r)}return e}function Cs(n){return Qt(n)?void 0:n[0]}function x$(n){var e=n&&n.length;return e?n[e-1]:void 0}function Ve(n,e){if(Array.isArray(n))for(var t=0;t<n.length;t++)e.call(null,n[t],t);else if(HO(n))for(var r=ll(n),t=0;t<r.length;t++){var i=r[t],s=n[i];e.call(null,s,i)}else throw Error("non exhaustive match")}function ia(n){return typeof n=="string"}function Ss(n){return n===void 0}function cu(n){return n instanceof Function}function br(n,e){return e===void 0&&(e=1),n.slice(e,n.length)}function sg(n,e){return e===void 0&&(e=1),n.slice(0,n.length-e)}function mo(n,e){var t=[];if(Array.isArray(n))for(var r=0;r<n.length;r++){var i=n[r];e.call(null,i)&&t.push(i)}return t}function Ph(n,e){return mo(n,function(t){return!e(t)})}function Ms(n,e){for(var t=Object.keys(n),r={},i=0;i<t.length;i++){var s=t[i],o=n[s];e(o)&&(r[s]=o)}return r}function ke(n,e){return HO(n)?n.hasOwnProperty(e):!1}function ar(n,e){return bd(n,function(t){return t===e})!==void 0}function Ai(n){for(var e=[],t=0;t<n.length;t++)e.push(n[t]);return e}function jg(n){var e={};for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e}function bd(n,e){for(var t=0;t<n.length;t++){var r=n[t];if(e.call(null,r))return r}}function bfe(n,e){for(var t=[],r=0;r<n.length;r++){var i=n[r];e.call(null,i)&&t.push(i)}return t}function Nr(n,e,t){for(var r=Array.isArray(n),i=r?n:Br(n),s=r?[]:ll(n),o=t,a=0;a<i.length;a++)o=e.call(null,o,i[a],r?a:s[a]);return o}function zg(n){return Ph(n,function(e){return e==null})}function LO(n,e){e===void 0&&(e=function(r){return r});var t=[];return Nr(n,function(r,i){var s=e(i);return ar(t,s)?r:(t.push(s),r.concat(i))},[])}function Js(n){return Array.isArray(n)}function tl(n){return n instanceof RegExp}function HO(n){return n instanceof Object}function ps(n,e){for(var t=0;t<n.length;t++)if(!e(n[t],t))return!1;return!0}function lS(n,e){return Ph(n,function(t){return ar(e,t)})}function L$(n,e){for(var t=0;t<n.length;t++)if(e(n[t]))return!0;return!1}function Tfe(n,e){for(var t=0;t<n.length;t++)if(n[t]===e)return t;return-1}function go(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];for(var r=0;r<e.length;r++)for(var i=e[r],s=ll(i),o=0;o<s.length;o++){var a=s[o];n[a]=i[a]}return n}function Afe(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];for(var r=0;r<e.length;r++){var i=e[r];if(!Ss(i))for(var s=ll(i),o=0;o<s.length;o++){var a=s[o];ke(n,a)||(n[a]=i[a])}}return n}function uS(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return Afe.apply(null,[{}].concat(n))}function H$(n,e){var t={};return Ve(n,function(r){var i=e(r),s=t[i];s?s.push(r):t[i]=[r]}),t}function $D(n,e){for(var t=jg(n),r=ll(e),i=0;i<r.length;i++){var s=r[i],o=e[s];t[s]=o}return t}function cr(){}function GD(n){return n}function Nfe(n){for(var e=[],t=0;t<n.length;t++){var r=n[t];e.push(r!==void 0?r:void 0)}return e}function yN(n){console&&console.error&&console.error("Error: "+n)}function DO(n){console&&console.warn&&console.warn("Warning: "+n)}function jD(){return typeof Map=="function"}function Mfe(n,e){e.forEach(function(t){var r=t.prototype;Object.getOwnPropertyNames(r).forEach(function(i){if(i!=="constructor"){var s=Object.getOwnPropertyDescriptor(r,i);s&&(s.get||s.set)?Object.defineProperty(n.prototype,i,s):n.prototype[i]=t.prototype[i]}})})}function D$(n){function e(){}e.prototype=n;var t=new e;function r(){return typeof t.bar}return r(),r(),n}function _y(n){return n[n.length-1]}function F$(n){var e=new Date().getTime(),t=n(),r=new Date().getTime(),i=r-e;return{time:i,value:t}}var wv={exports:{}},Ife=wv.exports,zD;function Ofe(){return zD||(zD=1,(function(n){(function(e,t){n.exports?n.exports=t():e.regexpToAst=t()})(typeof self<"u"?self:Ife,function(){function e(){}e.prototype.saveState=function(){return{idx:this.idx,input:this.input,groupIdx:this.groupIdx}},e.prototype.restoreState=function(p){this.idx=p.idx,this.input=p.input,this.groupIdx=p.groupIdx},e.prototype.pattern=function(p){this.idx=0,this.input=p,this.groupIdx=0,this.consumeChar("/");var v=this.disjunction();this.consumeChar("/");for(var y={type:"Flags",global:!1,ignoreCase:!1,multiLine:!1,unicode:!1,sticky:!1};this.isRegExpFlag();)switch(this.popChar()){case"g":a(y,"global");break;case"i":a(y,"ignoreCase");break;case"m":a(y,"multiLine");break;case"u":a(y,"unicode");break;case"y":a(y,"sticky");break}if(this.idx!==this.input.length)throw Error("Redundant input: "+this.input.substring(this.idx));return{type:"Pattern",flags:y,value:v}},e.prototype.disjunction=function(){var p=[];for(p.push(this.alternative());this.peekChar()==="|";)this.consumeChar("|"),p.push(this.alternative());return{type:"Disjunction",value:p}},e.prototype.alternative=function(){for(var p=[];this.isTerm();)p.push(this.term());return{type:"Alternative",value:p}},e.prototype.term=function(){return this.isAssertion()?this.assertion():this.atom()},e.prototype.assertion=function(){switch(this.popChar()){case"^":return{type:"StartAnchor"};case"$":return{type:"EndAnchor"};case"\\":switch(this.popChar()){case"b":return{type:"WordBoundary"};case"B":return{type:"NonWordBoundary"}}throw Error("Invalid Assertion Escape");case"(":this.consumeChar("?");var p;switch(this.popChar()){case"=":p="Lookahead";break;case"!":p="NegativeLookahead";break}l(p);var v=this.disjunction();return this.consumeChar(")"),{type:p,value:v}}u()},e.prototype.quantifier=function(p){var v;switch(this.popChar()){case"*":v={atLeast:0,atMost:1/0};break;case"+":v={atLeast:1,atMost:1/0};break;case"?":v={atLeast:0,atMost:1};break;case"{":var y=this.integerIncludingZero();switch(this.popChar()){case"}":v={atLeast:y,atMost:y};break;case",":var S;this.isDigit()?(S=this.integerIncludingZero(),v={atLeast:y,atMost:S}):v={atLeast:y,atMost:1/0},this.consumeChar("}");break}if(p===!0&&v===void 0)return;l(v);break}if(!(p===!0&&v===void 0))return l(v),this.peekChar(0)==="?"?(this.consumeChar("?"),v.greedy=!1):v.greedy=!0,v.type="Quantifier",v},e.prototype.atom=function(){var p;switch(this.peekChar()){case".":p=this.dotAll();break;case"\\":p=this.atomEscape();break;case"[":p=this.characterClass();break;case"(":p=this.group();break}return p===void 0&&this.isPatternCharacter()&&(p=this.patternCharacter()),l(p),this.isQuantifier()&&(p.quantifier=this.quantifier()),p},e.prototype.dotAll=function(){return this.consumeChar("."),{type:"Set",complement:!0,value:[s(`
`),s("\r"),s("\u2028"),s("\u2029")]}},e.prototype.atomEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return this.decimalEscapeAtom();case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},e.prototype.decimalEscapeAtom=function(){var p=this.positiveInteger();return{type:"GroupBackReference",value:p}},e.prototype.characterClassEscape=function(){var p,v=!1;switch(this.popChar()){case"d":p=c;break;case"D":p=c,v=!0;break;case"s":p=f;break;case"S":p=f,v=!0;break;case"w":p=d;break;case"W":p=d,v=!0;break}return l(p),{type:"Set",value:p,complement:v}},e.prototype.controlEscapeAtom=function(){var p;switch(this.popChar()){case"f":p=s("\f");break;case"n":p=s(`
`);break;case"r":p=s("\r");break;case"t":p=s("	");break;case"v":p=s("\v");break}return l(p),{type:"Character",value:p}},e.prototype.controlLetterEscapeAtom=function(){this.consumeChar("c");var p=this.popChar();if(/[a-zA-Z]/.test(p)===!1)throw Error("Invalid ");var v=p.toUpperCase().charCodeAt(0)-64;return{type:"Character",value:v}},e.prototype.nulCharacterAtom=function(){return this.consumeChar("0"),{type:"Character",value:s("\0")}},e.prototype.hexEscapeSequenceAtom=function(){return this.consumeChar("x"),this.parseHexDigits(2)},e.prototype.regExpUnicodeEscapeSequenceAtom=function(){return this.consumeChar("u"),this.parseHexDigits(4)},e.prototype.identityEscapeAtom=function(){var p=this.popChar();return{type:"Character",value:s(p)}},e.prototype.classPatternCharacterAtom=function(){switch(this.peekChar()){case`
`:case"\r":case"\u2028":case"\u2029":case"\\":case"]":throw Error("TBD");default:var p=this.popChar();return{type:"Character",value:s(p)}}},e.prototype.characterClass=function(){var p=[],v=!1;for(this.consumeChar("["),this.peekChar(0)==="^"&&(this.consumeChar("^"),v=!0);this.isClassAtom();){var y=this.classAtom(),S=y.type==="Character";if(S&&this.isRangeDash()){this.consumeChar("-");var R=this.classAtom(),A=R.type==="Character";if(A){if(R.value<y.value)throw Error("Range out of order in character class");p.push({from:y.value,to:R.value})}else o(y.value,p),p.push(s("-")),o(R.value,p)}else o(y.value,p)}return this.consumeChar("]"),{type:"Set",complement:v,value:p}},e.prototype.classAtom=function(){switch(this.peekChar()){case"]":case`
`:case"\r":case"\u2028":case"\u2029":throw Error("TBD");case"\\":return this.classEscape();default:return this.classPatternCharacterAtom()}},e.prototype.classEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"b":return this.consumeChar("b"),{type:"Character",value:s("\b")};case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},e.prototype.group=function(){var p=!0;switch(this.consumeChar("("),this.peekChar(0)){case"?":this.consumeChar("?"),this.consumeChar(":"),p=!1;break;default:this.groupIdx++;break}var v=this.disjunction();this.consumeChar(")");var y={type:"Group",capturing:p,value:v};return p&&(y.idx=this.groupIdx),y},e.prototype.positiveInteger=function(){var p=this.popChar();if(i.test(p)===!1)throw Error("Expecting a positive integer");for(;r.test(this.peekChar(0));)p+=this.popChar();return parseInt(p,10)},e.prototype.integerIncludingZero=function(){var p=this.popChar();if(r.test(p)===!1)throw Error("Expecting an integer");for(;r.test(this.peekChar(0));)p+=this.popChar();return parseInt(p,10)},e.prototype.patternCharacter=function(){var p=this.popChar();switch(p){case`
`:case"\r":case"\u2028":case"\u2029":case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":throw Error("TBD");default:return{type:"Character",value:s(p)}}},e.prototype.isRegExpFlag=function(){switch(this.peekChar(0)){case"g":case"i":case"m":case"u":case"y":return!0;default:return!1}},e.prototype.isRangeDash=function(){return this.peekChar()==="-"&&this.isClassAtom(1)},e.prototype.isDigit=function(){return r.test(this.peekChar(0))},e.prototype.isClassAtom=function(p){switch(p===void 0&&(p=0),this.peekChar(p)){case"]":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},e.prototype.isTerm=function(){return this.isAtom()||this.isAssertion()},e.prototype.isAtom=function(){if(this.isPatternCharacter())return!0;switch(this.peekChar(0)){case".":case"\\":case"[":case"(":return!0;default:return!1}},e.prototype.isAssertion=function(){switch(this.peekChar(0)){case"^":case"$":return!0;case"\\":switch(this.peekChar(1)){case"b":case"B":return!0;default:return!1}case"(":return this.peekChar(1)==="?"&&(this.peekChar(2)==="="||this.peekChar(2)==="!");default:return!1}},e.prototype.isQuantifier=function(){var p=this.saveState();try{return this.quantifier(!0)!==void 0}catch{return!1}finally{this.restoreState(p)}},e.prototype.isPatternCharacter=function(){switch(this.peekChar()){case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":case"/":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},e.prototype.parseHexDigits=function(p){for(var v="",y=0;y<p;y++){var S=this.popChar();if(t.test(S)===!1)throw Error("Expecting a HexDecimal digits");v+=S}var R=parseInt(v,16);return{type:"Character",value:R}},e.prototype.peekChar=function(p){return p===void 0&&(p=0),this.input[this.idx+p]},e.prototype.popChar=function(){var p=this.peekChar(0);return this.consumeChar(),p},e.prototype.consumeChar=function(p){if(p!==void 0&&this.input[this.idx]!==p)throw Error("Expected: '"+p+"' but found: '"+this.input[this.idx]+"' at offset: "+this.idx);if(this.idx>=this.input.length)throw Error("Unexpected end of input");this.idx++};var t=/[0-9a-fA-F]/,r=/[0-9]/,i=/[1-9]/;function s(p){return p.charCodeAt(0)}function o(p,v){p.length!==void 0?p.forEach(function(y){v.push(y)}):v.push(p)}function a(p,v){if(p[v]===!0)throw"duplicate flag "+v;p[v]=!0}function l(p){if(p===void 0)throw Error("Internal Error - Should never get here!")}function u(){throw Error("Internal Error - Should never get here!")}var h,c=[];for(h=s("0");h<=s("9");h++)c.push(h);var d=[s("_")].concat(c);for(h=s("a");h<=s("z");h++)d.push(h);for(h=s("A");h<=s("Z");h++)d.push(h);var f=[s(" "),s("\f"),s(`
`),s("\r"),s("	"),s("\v"),s("	"),s("Â "),s("á"),s("â"),s("â"),s("â"),s("â"),s("â"),s("â"),s("â"),s("â"),s("â"),s("â"),s("â"),s("\u2028"),s("\u2029"),s("â¯"),s("â"),s("ã"),s("\uFEFF")];function g(){}return g.prototype.visitChildren=function(p){for(var v in p){var y=p[v];p.hasOwnProperty(v)&&(y.type!==void 0?this.visit(y):Array.isArray(y)&&y.forEach(function(S){this.visit(S)},this))}},g.prototype.visit=function(p){switch(p.type){case"Pattern":this.visitPattern(p);break;case"Flags":this.visitFlags(p);break;case"Disjunction":this.visitDisjunction(p);break;case"Alternative":this.visitAlternative(p);break;case"StartAnchor":this.visitStartAnchor(p);break;case"EndAnchor":this.visitEndAnchor(p);break;case"WordBoundary":this.visitWordBoundary(p);break;case"NonWordBoundary":this.visitNonWordBoundary(p);break;case"Lookahead":this.visitLookahead(p);break;case"NegativeLookahead":this.visitNegativeLookahead(p);break;case"Character":this.visitCharacter(p);break;case"Set":this.visitSet(p);break;case"Group":this.visitGroup(p);break;case"GroupBackReference":this.visitGroupBackReference(p);break;case"Quantifier":this.visitQuantifier(p);break}this.visitChildren(p)},g.prototype.visitPattern=function(p){},g.prototype.visitFlags=function(p){},g.prototype.visitDisjunction=function(p){},g.prototype.visitAlternative=function(p){},g.prototype.visitStartAnchor=function(p){},g.prototype.visitEndAnchor=function(p){},g.prototype.visitWordBoundary=function(p){},g.prototype.visitNonWordBoundary=function(p){},g.prototype.visitLookahead=function(p){},g.prototype.visitNegativeLookahead=function(p){},g.prototype.visitCharacter=function(p){},g.prototype.visitSet=function(p){},g.prototype.visitGroup=function(p){},g.prototype.visitGroupBackReference=function(p){},g.prototype.visitQuantifier=function(p){},{RegExpParser:e,BaseRegExpVisitor:g,VERSION:"0.4.0"}})})(wv)),wv.exports}var Yg=Ofe(),vv={},_fe=new Yg.RegExpParser;function hS(n){var e=n.toString();if(vv.hasOwnProperty(e))return vv[e];var t=_fe.pattern(e);return vv[e]=t,t}function Pfe(){vv={}}var xfe=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}})(),k$="Complement Sets are not supported for first char optimization",Py=`Unable to use "first char" lexer optimizations:
`;function Lfe(n,e){e===void 0&&(e=!1);try{var t=hS(n),r=CN(t.value,{},t.flags.ignoreCase);return r}catch(s){if(s.message===k$)e&&DO(""+Py+("	Unable to optimize: < "+n.toString()+` >
`)+`	Complement Sets cannot be automatically optimized.
	This will disable the lexer's first char optimizations.
	See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#COMPLEMENT for details.`);else{var i="";e&&(i=`
	This will disable the lexer's first char optimizations.
	See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#REGEXP_PARSING for details.`),yN(Py+`
`+("	Failed parsing: < "+n.toString()+` >
`)+("	Using the regexp-to-ast library version: "+Yg.VERSION+`
`)+"	Please open an issue at: https://github.com/bd82/regexp-to-ast/issues"+i)}}return[]}function CN(n,e,t){switch(n.type){case"Disjunction":for(var r=0;r<n.value.length;r++)CN(n.value[r],e,t);break;case"Alternative":for(var i=n.value,r=0;r<i.length;r++){var s=i[r];switch(s.type){case"EndAnchor":case"GroupBackReference":case"Lookahead":case"NegativeLookahead":case"StartAnchor":case"WordBoundary":case"NonWordBoundary":continue}var o=s;switch(o.type){case"Character":Pw(o.value,e,t);break;case"Set":if(o.complement===!0)throw Error(k$);Ve(o.value,function(u){if(typeof u=="number")Pw(u,e,t);else{var h=u;if(t===!0)for(var c=h.from;c<=h.to;c++)Pw(c,e,t);else{for(var c=h.from;c<=h.to&&c<Jf;c++)Pw(c,e,t);if(h.to>=Jf)for(var d=h.from>=Jf?h.from:Jf,f=h.to,g=au(d),p=au(f),v=g;v<=p;v++)e[v]=v}}});break;case"Group":CN(o.value,e,t);break;default:throw Error("Non Exhaustive Match")}var a=o.quantifier!==void 0&&o.quantifier.atLeast===0;if(o.type==="Group"&&SN(o)===!1||o.type!=="Group"&&a===!1)break}break;default:throw Error("non exhaustive match!")}return Br(e)}function Pw(n,e,t){var r=au(n);e[r]=r,t===!0&&Hfe(n,e)}function Hfe(n,e){var t=String.fromCharCode(n),r=t.toUpperCase();if(r!==t){var i=au(r.charCodeAt(0));e[i]=i}else{var s=t.toLowerCase();if(s!==t){var i=au(s.charCodeAt(0));e[i]=i}}}function YD(n,e){return bd(n.value,function(t){if(typeof t=="number")return ar(e,t);var r=t;return bd(e,function(i){return r.from<=i&&i<=r.to})!==void 0})}function SN(n){return n.quantifier&&n.quantifier.atLeast===0?!0:n.value?Js(n.value)?ps(n.value,SN):SN(n.value):!1}var Dfe=(function(n){xfe(e,n);function e(t){var r=n.call(this)||this;return r.targetCharCodes=t,r.found=!1,r}return e.prototype.visitChildren=function(t){if(this.found!==!0){switch(t.type){case"Lookahead":this.visitLookahead(t);return;case"NegativeLookahead":this.visitNegativeLookahead(t);return}n.prototype.visitChildren.call(this,t)}},e.prototype.visitCharacter=function(t){ar(this.targetCharCodes,t.value)&&(this.found=!0)},e.prototype.visitSet=function(t){t.complement?YD(t,this.targetCharCodes)===void 0&&(this.found=!0):YD(t,this.targetCharCodes)!==void 0&&(this.found=!0)},e})(Yg.BaseRegExpVisitor);function FO(n,e){if(e instanceof RegExp){var t=hS(e),r=new Dfe(n);return r.visit(t),r.found}else return bd(e,function(i){return ar(n,i.charCodeAt(0))})!==void 0}var V$=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}})(),sa="PATTERN",yh="defaultMode",xw="modes",U$=typeof new RegExp("(?:)").sticky=="boolean";function Ffe(n,e){e=uS(e,{useSticky:U$,debug:!1,safeMode:!1,positionTracking:"full",lineTerminatorCharacters:["\r",`
`],tracer:function(S,R){return R()}});var t=e.tracer;t("initCharCodeToOptimizedIndexMap",function(){ome()});var r;t("Reject Lexer.NA",function(){r=Ph(n,function(S){return S[sa]===bi.NA})});var i=!1,s;t("Transform Patterns",function(){i=!1,s=Ee(r,function(S){var R=S[sa];if(tl(R)){var A=R.source;return A.length===1&&A!=="^"&&A!=="$"&&A!=="."?A:A.length===2&&A[0]==="\\"&&!ar(["d","D","s","S","t","r","n","t","0","c","b","B","f","v","w","W"],A[1])?A[1]:e.useSticky?qD(R):KD(R)}else{if(cu(R))return i=!0,{exec:R};if(ke(R,"exec"))return i=!0,R;if(typeof R=="string"){if(R.length===1)return R;var O=R.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),V=new RegExp(O);return e.useSticky?qD(V):KD(V)}else throw Error("non exhaustive match")}})});var o,a,l,u,h;t("misc mapping",function(){o=Ee(r,function(S){return S.tokenTypeIdx}),a=Ee(r,function(S){var R=S.GROUP;if(R!==bi.SKIPPED){if(ia(R))return R;if(Ss(R))return!1;throw Error("non exhaustive match")}}),l=Ee(r,function(S){var R=S.LONGER_ALT;if(R){var A=Tfe(r,R);return A}}),u=Ee(r,function(S){return S.PUSH_MODE}),h=Ee(r,function(S){return ke(S,"POP_MODE")})});var c;t("Line Terminator Handling",function(){var S=$$(e.lineTerminatorCharacters);c=Ee(r,function(R){return!1}),e.positionTracking!=="onlyOffset"&&(c=Ee(r,function(R){if(ke(R,"LINE_BREAKS"))return R.LINE_BREAKS;if(W$(R,S)===!1)return FO(S,R.PATTERN)}))});var d,f,g,p;t("Misc Mapping #2",function(){d=Ee(r,B$),f=Ee(s,rme),g=Nr(r,function(S,R){var A=R.GROUP;return ia(A)&&A!==bi.SKIPPED&&(S[A]=[]),S},{}),p=Ee(s,function(S,R){return{pattern:s[R],longerAlt:l[R],canLineTerminator:c[R],isCustom:d[R],short:f[R],group:a[R],push:u[R],pop:h[R],tokenTypeIdx:o[R],tokenType:r[R]}})});var v=!0,y=[];return e.safeMode||t("First Char Optimization",function(){y=Nr(r,function(S,R,A){if(typeof R.PATTERN=="string"){var O=R.PATTERN.charCodeAt(0),V=au(O);ZT(S,V,p[A])}else if(Js(R.START_CHARS_HINT)){var B;Ve(R.START_CHARS_HINT,function(q){var G=typeof q=="string"?q.charCodeAt(0):q,Z=au(G);B!==Z&&(B=Z,ZT(S,Z,p[A]))})}else if(tl(R.PATTERN))if(R.PATTERN.unicode)v=!1,e.ensureOptimizations&&yN(""+Py+("	Unable to analyze < "+R.PATTERN.toString()+` > pattern.
`)+`	The regexp unicode flag is not currently supported by the regexp-to-ast library.
	This will disable the lexer's first char optimizations.
	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#UNICODE_OPTIMIZE`);else{var Y=Lfe(R.PATTERN,e.ensureOptimizations);Qt(Y)&&(v=!1),Ve(Y,function(q){ZT(S,q,p[A])})}else e.ensureOptimizations&&yN(""+Py+("	TokenType: <"+R.name+`> is using a custom token pattern without providing <start_chars_hint> parameter.
`)+`	This will disable the lexer's first char optimizations.
	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#CUSTOM_OPTIMIZE`),v=!1;return S},[])}),t("ArrayPacking",function(){y=Nfe(y)}),{emptyGroups:g,patternIdxToConfig:p,charCodeToPatternIdxToConfig:y,hasCustom:i,canBeOptimized:v}}function kfe(n,e){var t=[],r=Ufe(n);t=t.concat(r.errors);var i=Bfe(r.valid),s=i.valid;return t=t.concat(i.errors),t=t.concat(Vfe(s)),t=t.concat(qfe(s)),t=t.concat(Xfe(s,e)),t=t.concat(Qfe(s)),t}function Vfe(n){var e=[],t=mo(n,function(r){return tl(r[sa])});return e=e.concat($fe(t)),e=e.concat(zfe(t)),e=e.concat(Yfe(t)),e=e.concat(Kfe(t)),e=e.concat(Gfe(t)),e}function Ufe(n){var e=mo(n,function(i){return!ke(i,sa)}),t=Ee(e,function(i){return{message:"Token Type: ->"+i.name+"<- missing static 'PATTERN' property",type:$n.MISSING_PATTERN,tokenTypes:[i]}}),r=lS(n,e);return{errors:t,valid:r}}function Bfe(n){var e=mo(n,function(i){var s=i[sa];return!tl(s)&&!cu(s)&&!ke(s,"exec")&&!ia(s)}),t=Ee(e,function(i){return{message:"Token Type: ->"+i.name+"<- static 'PATTERN' can only be a RegExp, a Function matching the {CustomPatternMatcherFunc} type or an Object matching the {ICustomPattern} interface.",type:$n.INVALID_PATTERN,tokenTypes:[i]}}),r=lS(n,e);return{errors:t,valid:r}}var Wfe=/[^\\][\$]/;function $fe(n){var e=(function(i){V$(s,i);function s(){var o=i!==null&&i.apply(this,arguments)||this;return o.found=!1,o}return s.prototype.visitEndAnchor=function(o){this.found=!0},s})(Yg.BaseRegExpVisitor),t=mo(n,function(i){var s=i[sa];try{var o=hS(s),a=new e;return a.visit(o),a.found}catch{return Wfe.test(s.source)}}),r=Ee(t,function(i){return{message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+i.name+`<- static 'PATTERN' cannot contain end of input anchor '$'
	See sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:$n.EOI_ANCHOR_FOUND,tokenTypes:[i]}});return r}function Gfe(n){var e=mo(n,function(r){var i=r[sa];return i.test("")}),t=Ee(e,function(r){return{message:"Token Type: ->"+r.name+"<- static 'PATTERN' must not match an empty string",type:$n.EMPTY_MATCH_PATTERN,tokenTypes:[r]}});return t}var jfe=/[^\\[][\^]|^\^/;function zfe(n){var e=(function(i){V$(s,i);function s(){var o=i!==null&&i.apply(this,arguments)||this;return o.found=!1,o}return s.prototype.visitStartAnchor=function(o){this.found=!0},s})(Yg.BaseRegExpVisitor),t=mo(n,function(i){var s=i[sa];try{var o=hS(s),a=new e;return a.visit(o),a.found}catch{return jfe.test(s.source)}}),r=Ee(t,function(i){return{message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+i.name+`<- static 'PATTERN' cannot contain start of input anchor '^'
	See https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:$n.SOI_ANCHOR_FOUND,tokenTypes:[i]}});return r}function Yfe(n){var e=mo(n,function(r){var i=r[sa];return i instanceof RegExp&&(i.multiline||i.global)}),t=Ee(e,function(r){return{message:"Token Type: ->"+r.name+"<- static 'PATTERN' may NOT contain global('g') or multiline('m')",type:$n.UNSUPPORTED_FLAGS_FOUND,tokenTypes:[r]}});return t}function Kfe(n){var e=[],t=Ee(n,function(s){return Nr(n,function(o,a){return s.PATTERN.source===a.PATTERN.source&&!ar(e,a)&&a.PATTERN!==bi.NA&&(e.push(a),o.push(a)),o},[])});t=zg(t);var r=mo(t,function(s){return s.length>1}),i=Ee(r,function(s){var o=Ee(s,function(l){return l.name}),a=Cs(s).PATTERN;return{message:"The same RegExp pattern ->"+a+"<-"+("has been used in all of the following Token Types: "+o.join(", ")+" <-"),type:$n.DUPLICATE_PATTERNS_FOUND,tokenTypes:s}});return i}function qfe(n){var e=mo(n,function(r){if(!ke(r,"GROUP"))return!1;var i=r.GROUP;return i!==bi.SKIPPED&&i!==bi.NA&&!ia(i)}),t=Ee(e,function(r){return{message:"Token Type: ->"+r.name+"<- static 'GROUP' can only be Lexer.SKIPPED/Lexer.NA/A String",type:$n.INVALID_GROUP_TYPE_FOUND,tokenTypes:[r]}});return t}function Xfe(n,e){var t=mo(n,function(i){return i.PUSH_MODE!==void 0&&!ar(e,i.PUSH_MODE)}),r=Ee(t,function(i){var s="Token Type: ->"+i.name+"<- static 'PUSH_MODE' value cannot refer to a Lexer Mode ->"+i.PUSH_MODE+"<-which does not exist";return{message:s,type:$n.PUSH_MODE_DOES_NOT_EXIST,tokenTypes:[i]}});return r}function Qfe(n){var e=[],t=Nr(n,function(r,i,s){var o=i.PATTERN;return o===bi.NA||(ia(o)?r.push({str:o,idx:s,tokenType:i}):tl(o)&&Jfe(o)&&r.push({str:o.source,idx:s,tokenType:i})),r},[]);return Ve(n,function(r,i){Ve(t,function(s){var o=s.str,a=s.idx,l=s.tokenType;if(i<a&&Zfe(o,r.PATTERN)){var u="Token: ->"+l.name+`<- can never be matched.
`+("Because it appears AFTER the Token Type ->"+r.name+"<-")+`in the lexer's definition.
See https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#UNREACHABLE`;e.push({message:u,type:$n.UNREACHABLE_PATTERN,tokenTypes:[r,l]})}})}),e}function Zfe(n,e){if(tl(e)){var t=e.exec(n);return t!==null&&t.index===0}else{if(cu(e))return e(n,0,[],{});if(ke(e,"exec"))return e.exec(n,0,[],{});if(typeof e=="string")return e===n;throw Error("non exhaustive match")}}function Jfe(n){var e=[".","\\","[","]","|","^","$","(",")","?","*","+","{"];return bd(e,function(t){return n.source.indexOf(t)!==-1})===void 0}function KD(n){var e=n.ignoreCase?"i":"";return new RegExp("^(?:"+n.source+")",e)}function qD(n){var e=n.ignoreCase?"iy":"y";return new RegExp(""+n.source,e)}function eme(n,e,t){var r=[];return ke(n,yh)||r.push({message:"A MultiMode Lexer cannot be initialized without a <"+yh+`> property in its definition
`,type:$n.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE}),ke(n,xw)||r.push({message:"A MultiMode Lexer cannot be initialized without a <"+xw+`> property in its definition
`,type:$n.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY}),ke(n,xw)&&ke(n,yh)&&!ke(n.modes,n.defaultMode)&&r.push({message:"A MultiMode Lexer cannot be initialized with a "+yh+": <"+n.defaultMode+`>which does not exist
`,type:$n.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST}),ke(n,xw)&&Ve(n.modes,function(i,s){Ve(i,function(o,a){Ss(o)&&r.push({message:"A Lexer cannot be initialized using an undefined Token Type. Mode:"+("<"+s+"> at index: <"+a+`>
`),type:$n.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED})})}),r}function tme(n,e,t){var r=[],i=!1,s=zg(Ti(Efe(n.modes,function(l){return l}))),o=Ph(s,function(l){return l[sa]===bi.NA}),a=$$(t);return e&&Ve(o,function(l){var u=W$(l,a);if(u!==!1){var h=sme(l,u),c={message:h,type:u.issue,tokenType:l};r.push(c)}else ke(l,"LINE_BREAKS")?l.LINE_BREAKS===!0&&(i=!0):FO(a,l.PATTERN)&&(i=!0)}),e&&!i&&r.push({message:`Warning: No LINE_BREAKS Found.
	This Lexer has been defined to track line and column information,
	But none of the Token Types can be identified as matching a line terminator.
	See https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#LINE_BREAKS 
	for details.`,type:$n.NO_LINE_BREAKS_FLAGS}),r}function nme(n){var e={},t=ll(n);return Ve(t,function(r){var i=n[r];if(Js(i))e[r]=[];else throw Error("non exhaustive match")}),e}function B$(n){var e=n.PATTERN;if(tl(e))return!1;if(cu(e))return!0;if(ke(e,"exec"))return!0;if(ia(e))return!1;throw Error("non exhaustive match")}function rme(n){return ia(n)&&n.length===1?n.charCodeAt(0):!1}var ime={test:function(n){for(var e=n.length,t=this.lastIndex;t<e;t++){var r=n.charCodeAt(t);if(r===10)return this.lastIndex=t+1,!0;if(r===13)return n.charCodeAt(t+1)===10?this.lastIndex=t+2:this.lastIndex=t+1,!0}return!1},lastIndex:0};function W$(n,e){if(ke(n,"LINE_BREAKS"))return!1;if(tl(n.PATTERN)){try{FO(e,n.PATTERN)}catch(t){return{issue:$n.IDENTIFY_TERMINATOR,errMsg:t.message}}return!1}else{if(ia(n.PATTERN))return!1;if(B$(n))return{issue:$n.CUSTOM_LINE_BREAK};throw Error("non exhaustive match")}}function sme(n,e){if(e.issue===$n.IDENTIFY_TERMINATOR)return`Warning: unable to identify line terminator usage in pattern.
`+("	The problem is in the <"+n.name+`> Token Type
`)+("	 Root cause: "+e.errMsg+`.
`)+"	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#IDENTIFY_TERMINATOR";if(e.issue===$n.CUSTOM_LINE_BREAK)return`Warning: A Custom Token Pattern should specify the <line_breaks> option.
`+("	The problem is in the <"+n.name+`> Token Type
`)+"	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#CUSTOM_LINE_BREAK";throw Error("non exhaustive match")}function $$(n){var e=Ee(n,function(t){return ia(t)&&t.length>0?t.charCodeAt(0):t});return e}function ZT(n,e,t){n[e]===void 0?n[e]=[t]:n[e].push(t)}var Jf=256;function au(n){return n<Jf?n:yv[n]}var yv=[];function ome(){if(Qt(yv)){yv=new Array(65536);for(var n=0;n<65536;n++)yv[n]=n>255?255+~~(n/255):n}}function cS(n,e){var t=n.tokenTypeIdx;return t===e.tokenTypeIdx?!0:e.isParent===!0&&e.categoryMatchesMap[t]===!0}function xy(n,e){return n.tokenTypeIdx===e.tokenTypeIdx}var XD=1,G$={};function Kg(n){var e=ame(n);lme(e),hme(e),ume(e),Ve(e,function(t){t.isParent=t.categoryMatches.length>0})}function ame(n){for(var e=Ai(n),t=n,r=!0;r;){t=zg(Ti(Ee(t,function(s){return s.CATEGORIES})));var i=lS(t,e);e=e.concat(i),Qt(i)?r=!1:t=i}return e}function lme(n){Ve(n,function(e){z$(e)||(G$[XD]=e,e.tokenTypeIdx=XD++),QD(e)&&!Js(e.CATEGORIES)&&(e.CATEGORIES=[e.CATEGORIES]),QD(e)||(e.CATEGORIES=[]),cme(e)||(e.categoryMatches=[]),dme(e)||(e.categoryMatchesMap={})})}function ume(n){Ve(n,function(e){e.categoryMatches=[],Ve(e.categoryMatchesMap,function(t,r){e.categoryMatches.push(G$[r].tokenTypeIdx)})})}function hme(n){Ve(n,function(e){j$([],e)})}function j$(n,e){Ve(n,function(t){e.categoryMatchesMap[t.tokenTypeIdx]=!0}),Ve(e.CATEGORIES,function(t){var r=n.concat(e);ar(r,t)||j$(r,t)})}function z$(n){return ke(n,"tokenTypeIdx")}function QD(n){return ke(n,"CATEGORIES")}function cme(n){return ke(n,"categoryMatches")}function dme(n){return ke(n,"categoryMatchesMap")}function fme(n){return ke(n,"tokenTypeIdx")}var mme={buildUnableToPopLexerModeMessage:function(n){return"Unable to pop Lexer Mode after encountering Token ->"+n.image+"<- The Mode Stack is empty"},buildUnexpectedCharactersMessage:function(n,e,t,r,i){return"unexpected character: ->"+n.charAt(e)+"<- at offset: "+e+","+(" skipped "+t+" characters.")}},$n;(function(n){n[n.MISSING_PATTERN=0]="MISSING_PATTERN",n[n.INVALID_PATTERN=1]="INVALID_PATTERN",n[n.EOI_ANCHOR_FOUND=2]="EOI_ANCHOR_FOUND",n[n.UNSUPPORTED_FLAGS_FOUND=3]="UNSUPPORTED_FLAGS_FOUND",n[n.DUPLICATE_PATTERNS_FOUND=4]="DUPLICATE_PATTERNS_FOUND",n[n.INVALID_GROUP_TYPE_FOUND=5]="INVALID_GROUP_TYPE_FOUND",n[n.PUSH_MODE_DOES_NOT_EXIST=6]="PUSH_MODE_DOES_NOT_EXIST",n[n.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE=7]="MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE",n[n.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY=8]="MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY",n[n.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST=9]="MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST",n[n.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED=10]="LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED",n[n.SOI_ANCHOR_FOUND=11]="SOI_ANCHOR_FOUND",n[n.EMPTY_MATCH_PATTERN=12]="EMPTY_MATCH_PATTERN",n[n.NO_LINE_BREAKS_FLAGS=13]="NO_LINE_BREAKS_FLAGS",n[n.UNREACHABLE_PATTERN=14]="UNREACHABLE_PATTERN",n[n.IDENTIFY_TERMINATOR=15]="IDENTIFY_TERMINATOR",n[n.CUSTOM_LINE_BREAK=16]="CUSTOM_LINE_BREAK"})($n||($n={}));var em={deferDefinitionErrorsHandling:!1,positionTracking:"full",lineTerminatorsPattern:/\n|\r\n?/g,lineTerminatorCharacters:[`
`,"\r"],ensureOptimizations:!1,safeMode:!1,errorMessageProvider:mme,traceInitPerf:!1,skipValidations:!1};Object.freeze(em);var bi=(function(){function n(e,t){var r=this;if(t===void 0&&(t=em),this.lexerDefinition=e,this.lexerDefinitionErrors=[],this.lexerDefinitionWarning=[],this.patternIdxToConfig={},this.charCodeToPatternIdxToConfig={},this.modes=[],this.emptyGroups={},this.config=void 0,this.trackStartLines=!0,this.trackEndLines=!0,this.hasCustom=!1,this.canModeBeOptimized={},typeof t=="boolean")throw Error(`The second argument to the Lexer constructor is now an ILexerConfig Object.
a boolean 2nd argument is no longer supported`);this.config=$D(em,t);var i=this.config.traceInitPerf;i===!0?(this.traceInitMaxIdent=1/0,this.traceInitPerf=!0):typeof i=="number"&&(this.traceInitMaxIdent=i,this.traceInitPerf=!0),this.traceInitIndent=-1,this.TRACE_INIT("Lexer Constructor",function(){var s,o=!0;r.TRACE_INIT("Lexer Config handling",function(){if(r.config.lineTerminatorsPattern===em.lineTerminatorsPattern)r.config.lineTerminatorsPattern=ime;else if(r.config.lineTerminatorCharacters===em.lineTerminatorCharacters)throw Error(`Error: Missing <lineTerminatorCharacters> property on the Lexer config.
	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#MISSING_LINE_TERM_CHARS`);if(t.safeMode&&t.ensureOptimizations)throw Error('"safeMode" and "ensureOptimizations" flags are mutually exclusive.');r.trackStartLines=/full|onlyStart/i.test(r.config.positionTracking),r.trackEndLines=/full/i.test(r.config.positionTracking),Js(e)?(s={modes:{}},s.modes[yh]=Ai(e),s[yh]=yh):(o=!1,s=jg(e))}),r.config.skipValidations===!1&&(r.TRACE_INIT("performRuntimeChecks",function(){r.lexerDefinitionErrors=r.lexerDefinitionErrors.concat(eme(s,r.trackStartLines,r.config.lineTerminatorCharacters))}),r.TRACE_INIT("performWarningRuntimeChecks",function(){r.lexerDefinitionWarning=r.lexerDefinitionWarning.concat(tme(s,r.trackStartLines,r.config.lineTerminatorCharacters))})),s.modes=s.modes?s.modes:{},Ve(s.modes,function(h,c){s.modes[c]=Ph(h,function(d){return Ss(d)})});var a=ll(s.modes);if(Ve(s.modes,function(h,c){r.TRACE_INIT("Mode: <"+c+"> processing",function(){if(r.modes.push(c),r.config.skipValidations===!1&&r.TRACE_INIT("validatePatterns",function(){r.lexerDefinitionErrors=r.lexerDefinitionErrors.concat(kfe(h,a))}),Qt(r.lexerDefinitionErrors)){Kg(h);var d;r.TRACE_INIT("analyzeTokenTypes",function(){d=Ffe(h,{lineTerminatorCharacters:r.config.lineTerminatorCharacters,positionTracking:t.positionTracking,ensureOptimizations:t.ensureOptimizations,safeMode:t.safeMode,tracer:r.TRACE_INIT.bind(r)})}),r.patternIdxToConfig[c]=d.patternIdxToConfig,r.charCodeToPatternIdxToConfig[c]=d.charCodeToPatternIdxToConfig,r.emptyGroups=$D(r.emptyGroups,d.emptyGroups),r.hasCustom=d.hasCustom||r.hasCustom,r.canModeBeOptimized[c]=d.canBeOptimized}})}),r.defaultMode=s.defaultMode,!Qt(r.lexerDefinitionErrors)&&!r.config.deferDefinitionErrorsHandling){var l=Ee(r.lexerDefinitionErrors,function(h){return h.message}),u=l.join(`-----------------------
`);throw new Error(`Errors detected in definition of Lexer:
`+u)}Ve(r.lexerDefinitionWarning,function(h){DO(h.message)}),r.TRACE_INIT("Choosing sub-methods implementations",function(){if(U$?(r.chopInput=GD,r.match=r.matchWithTest):(r.updateLastIndex=cr,r.match=r.matchWithExec),o&&(r.handleModes=cr),r.trackStartLines===!1&&(r.computeNewColumn=GD),r.trackEndLines===!1&&(r.updateTokenEndLineColumnLocation=cr),/full/i.test(r.config.positionTracking))r.createTokenInstance=r.createFullToken;else if(/onlyStart/i.test(r.config.positionTracking))r.createTokenInstance=r.createStartOnlyToken;else if(/onlyOffset/i.test(r.config.positionTracking))r.createTokenInstance=r.createOffsetOnlyToken;else throw Error('Invalid <positionTracking> config option: "'+r.config.positionTracking+'"');r.hasCustom?(r.addToken=r.addTokenUsingPush,r.handlePayload=r.handlePayloadWithCustom):(r.addToken=r.addTokenUsingMemberAccess,r.handlePayload=r.handlePayloadNoCustom)}),r.TRACE_INIT("Failed Optimization Warnings",function(){var h=Nr(r.canModeBeOptimized,function(c,d,f){return d===!1&&c.push(f),c},[]);if(t.ensureOptimizations&&!Qt(h))throw Error("Lexer Modes: < "+h.join(", ")+` > cannot be optimized.
	 Disable the "ensureOptimizations" lexer config flag to silently ignore this and run the lexer in an un-optimized mode.
	 Or inspect the console log for details on how to resolve these issues.`)}),r.TRACE_INIT("clearRegExpParserCache",function(){Pfe()}),r.TRACE_INIT("toFastProperties",function(){D$(r)})})}return n.prototype.tokenize=function(e,t){if(t===void 0&&(t=this.defaultMode),!Qt(this.lexerDefinitionErrors)){var r=Ee(this.lexerDefinitionErrors,function(o){return o.message}),i=r.join(`-----------------------
`);throw new Error(`Unable to Tokenize because Errors detected in definition of Lexer:
`+i)}var s=this.tokenizeInternal(e,t);return s},n.prototype.tokenizeInternal=function(e,t){var r=this,i,s,o,a,l,u,h,c,d,f,g,p,v,y,S=e,R=S.length,A=0,O=0,V=this.hasCustom?0:Math.floor(e.length/10),B=new Array(V),Y=[],q=this.trackStartLines?1:void 0,G=this.trackStartLines?1:void 0,Z=nme(this.emptyGroups),ee=this.trackStartLines,ne=this.config.lineTerminatorsPattern,re=0,ae=[],ze=[],Le=[],Se=[];Object.freeze(Se);var ye=void 0;function We(){return ae}function w(T){var I=au(T),x=ze[I];return x===void 0?Se:x}var C=function(T){if(Le.length===1&&T.tokenType.PUSH_MODE===void 0){var I=r.config.errorMessageProvider.buildUnableToPopLexerModeMessage(T);Y.push({offset:T.startOffset,line:T.startLine!==void 0?T.startLine:void 0,column:T.startColumn!==void 0?T.startColumn:void 0,length:T.image.length,message:I})}else{Le.pop();var x=x$(Le);ae=r.patternIdxToConfig[x],ze=r.charCodeToPatternIdxToConfig[x],re=ae.length;var j=r.canModeBeOptimized[x]&&r.config.safeMode===!1;ze&&j?ye=w:ye=We}};function b(T){Le.push(T),ze=this.charCodeToPatternIdxToConfig[T],ae=this.patternIdxToConfig[T],re=ae.length,re=ae.length;var I=this.canModeBeOptimized[T]&&this.config.safeMode===!1;ze&&I?ye=w:ye=We}b.call(this,t);for(var P;A<R;){l=null;var H=S.charCodeAt(A),W=ye(H),J=W.length;for(i=0;i<J;i++){P=W[i];var te=P.pattern;u=null;var ce=P.short;if(ce!==!1?H===ce&&(l=te):P.isCustom===!0?(y=te.exec(S,A,B,Z),y!==null?(l=y[0],y.payload!==void 0&&(u=y.payload)):l=null):(this.updateLastIndex(te,A),l=this.match(te,e,A)),l!==null){if(a=P.longerAlt,a!==void 0){var ge=ae[a],oe=ge.pattern;h=null,ge.isCustom===!0?(y=oe.exec(S,A,B,Z),y!==null?(o=y[0],y.payload!==void 0&&(h=y.payload)):o=null):(this.updateLastIndex(oe,A),o=this.match(oe,e,A)),o&&o.length>l.length&&(l=o,u=h,P=ge)}break}}if(l!==null){if(c=l.length,d=P.group,d!==void 0&&(f=P.tokenTypeIdx,g=this.createTokenInstance(l,A,f,P.tokenType,q,G,c),this.handlePayload(g,u),d===!1?O=this.addToken(B,O,g):Z[d].push(g)),e=this.chopInput(e,c),A=A+c,G=this.computeNewColumn(G,c),ee===!0&&P.canLineTerminator===!0){var Ue=0,$e=void 0,X=void 0;ne.lastIndex=0;do $e=ne.test(l),$e===!0&&(X=ne.lastIndex-1,Ue++);while($e===!0);Ue!==0&&(q=q+Ue,G=c-X,this.updateTokenEndLineColumnLocation(g,d,X,Ue,q,G,c))}this.handleModes(P,C,b,g)}else{for(var Ze=A,it=q,vt=G,qe=!1;!qe&&A<R;)for(S.charCodeAt(A),e=this.chopInput(e,1),A++,s=0;s<re;s++){var He=ae[s],te=He.pattern,ce=He.short;if(ce!==!1?S.charCodeAt(A)===ce&&(qe=!0):He.isCustom===!0?qe=te.exec(S,A,B,Z)!==null:(this.updateLastIndex(te,A),qe=te.exec(e)!==null),qe===!0)break}p=A-Ze,v=this.config.errorMessageProvider.buildUnexpectedCharactersMessage(S,Ze,p,it,vt),Y.push({offset:Ze,line:it,column:vt,length:p,message:v})}}return this.hasCustom||(B.length=O),{tokens:B,groups:Z,errors:Y}},n.prototype.handleModes=function(e,t,r,i){if(e.pop===!0){var s=e.push;t(i),s!==void 0&&r.call(this,s)}else e.push!==void 0&&r.call(this,e.push)},n.prototype.chopInput=function(e,t){return e.substring(t)},n.prototype.updateLastIndex=function(e,t){e.lastIndex=t},n.prototype.updateTokenEndLineColumnLocation=function(e,t,r,i,s,o,a){var l,u;t!==void 0&&(l=r===a-1,u=l?-1:0,i===1&&l===!0||(e.endLine=s+u,e.endColumn=o-1+-u))},n.prototype.computeNewColumn=function(e,t){return e+t},n.prototype.createTokenInstance=function(){return null},n.prototype.createOffsetOnlyToken=function(e,t,r,i){return{image:e,startOffset:t,tokenTypeIdx:r,tokenType:i}},n.prototype.createStartOnlyToken=function(e,t,r,i,s,o){return{image:e,startOffset:t,startLine:s,startColumn:o,tokenTypeIdx:r,tokenType:i}},n.prototype.createFullToken=function(e,t,r,i,s,o,a){return{image:e,startOffset:t,endOffset:t+a-1,startLine:s,endLine:s,startColumn:o,endColumn:o+a-1,tokenTypeIdx:r,tokenType:i}},n.prototype.addToken=function(e,t,r){return 666},n.prototype.addTokenUsingPush=function(e,t,r){return e.push(r),t},n.prototype.addTokenUsingMemberAccess=function(e,t,r){return e[t]=r,t++,t},n.prototype.handlePayload=function(e,t){},n.prototype.handlePayloadNoCustom=function(e,t){},n.prototype.handlePayloadWithCustom=function(e,t){t!==null&&(e.payload=t)},n.prototype.match=function(e,t,r){return null},n.prototype.matchWithTest=function(e,t,r){var i=e.test(t);return i===!0?t.substring(r,e.lastIndex):null},n.prototype.matchWithExec=function(e,t){var r=e.exec(t);return r!==null?r[0]:r},n.prototype.TRACE_INIT=function(e,t){if(this.traceInitPerf===!0){this.traceInitIndent++;var r=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(r+"--> <"+e+">");var i=F$(t),s=i.time,o=i.value,a=s>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&a(r+"<-- <"+e+"> time: "+s+"ms"),this.traceInitIndent--,o}else return t()},n.SKIPPED="This marks a skipped Token pattern, this means each token identified by it willbe consumed and then thrown into oblivion, this can be used to for example to completely ignore whitespace.",n.NA=/NOT_APPLICABLE/,n})();function dd(n){return Y$(n)?n.LABEL:n.name}function Y$(n){return ia(n.LABEL)&&n.LABEL!==""}var gme="parent",ZD="categories",JD="label",eF="group",tF="push_mode",nF="pop_mode",rF="longer_alt",iF="line_breaks",sF="start_chars_hint";function St(n){return pme(n)}function pme(n){var e=n.pattern,t={};if(t.name=n.name,Ss(e)||(t.PATTERN=e),ke(n,gme))throw`The parent property is no longer supported.
See: https://github.com/SAP/chevrotain/issues/564#issuecomment-349062346 for details.`;return ke(n,ZD)&&(t.CATEGORIES=n[ZD]),Kg([t]),ke(n,JD)&&(t.LABEL=n[JD]),ke(n,eF)&&(t.GROUP=n[eF]),ke(n,nF)&&(t.POP_MODE=n[nF]),ke(n,tF)&&(t.PUSH_MODE=n[tF]),ke(n,rF)&&(t.LONGER_ALT=n[rF]),ke(n,iF)&&(t.LINE_BREAKS=n[iF]),ke(n,sF)&&(t.START_CHARS_HINT=n[sF]),t}var xh=St({name:"EOF",pattern:bi.NA});Kg([xh]);function kO(n,e,t,r,i,s,o,a){return{image:e,startOffset:t,endOffset:r,startLine:i,endLine:s,startColumn:o,endColumn:a,tokenTypeIdx:n.tokenTypeIdx,tokenType:n}}function zt(n,e){return cS(n,e)}var ul=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}})(),ha=(function(){function n(e){this.definition=e}return n.prototype.accept=function(e){e.visit(this),Ve(this.definition,function(t){t.accept(e)})},n})(),Wi=(function(n){ul(e,n);function e(t){var r=n.call(this,[])||this;return r.idx=1,go(r,Ms(t,function(i){return i!==void 0})),r}return Object.defineProperty(e.prototype,"definition",{get:function(){return this.referencedRule!==void 0?this.referencedRule.definition:[]},set:function(t){},enumerable:!0,configurable:!0}),e.prototype.accept=function(t){t.visit(this)},e})(ha),Ud=(function(n){ul(e,n);function e(t){var r=n.call(this,t.definition)||this;return r.orgText="",go(r,Ms(t,function(i){return i!==void 0})),r}return e})(ha),Ni=(function(n){ul(e,n);function e(t){var r=n.call(this,t.definition)||this;return r.ignoreAmbiguities=!1,go(r,Ms(t,function(i){return i!==void 0})),r}return e})(ha),Ar=(function(n){ul(e,n);function e(t){var r=n.call(this,t.definition)||this;return r.idx=1,go(r,Ms(t,function(i){return i!==void 0})),r}return e})(ha),Rs=(function(n){ul(e,n);function e(t){var r=n.call(this,t.definition)||this;return r.idx=1,go(r,Ms(t,function(i){return i!==void 0})),r}return e})(ha),Es=(function(n){ul(e,n);function e(t){var r=n.call(this,t.definition)||this;return r.idx=1,go(r,Ms(t,function(i){return i!==void 0})),r}return e})(ha),Wn=(function(n){ul(e,n);function e(t){var r=n.call(this,t.definition)||this;return r.idx=1,go(r,Ms(t,function(i){return i!==void 0})),r}return e})(ha),$i=(function(n){ul(e,n);function e(t){var r=n.call(this,t.definition)||this;return r.idx=1,go(r,Ms(t,function(i){return i!==void 0})),r}return e})(ha),Gi=(function(n){ul(e,n);function e(t){var r=n.call(this,t.definition)||this;return r.idx=1,r.ignoreAmbiguities=!1,r.hasPredicates=!1,go(r,Ms(t,function(i){return i!==void 0})),r}return e})(ha),Nn=(function(){function n(e){this.idx=1,go(this,Ms(e,function(t){return t!==void 0}))}return n.prototype.accept=function(e){e.visit(this)},n})();function wme(n){return Ee(n,Cv)}function Cv(n){function e(i){return Ee(i,Cv)}if(n instanceof Wi)return{type:"NonTerminal",name:n.nonTerminalName,idx:n.idx};if(n instanceof Ni)return{type:"Flat",definition:e(n.definition)};if(n instanceof Ar)return{type:"Option",idx:n.idx,definition:e(n.definition)};if(n instanceof Rs)return{type:"RepetitionMandatory",name:n.name,idx:n.idx,definition:e(n.definition)};if(n instanceof Es)return{type:"RepetitionMandatoryWithSeparator",name:n.name,idx:n.idx,separator:Cv(new Nn({terminalType:n.separator})),definition:e(n.definition)};if(n instanceof $i)return{type:"RepetitionWithSeparator",name:n.name,idx:n.idx,separator:Cv(new Nn({terminalType:n.separator})),definition:e(n.definition)};if(n instanceof Wn)return{type:"Repetition",name:n.name,idx:n.idx,definition:e(n.definition)};if(n instanceof Gi)return{type:"Alternation",name:n.name,idx:n.idx,definition:e(n.definition)};if(n instanceof Nn){var t={type:"Terminal",name:n.terminalType.name,label:dd(n.terminalType),idx:n.idx},r=n.terminalType.PATTERN;return n.terminalType.PATTERN&&(t.pattern=tl(r)?r.source:r),t}else{if(n instanceof Ud)return{type:"Rule",name:n.name,orgText:n.orgText,definition:e(n.definition)};throw Error("non exhaustive match")}}var dS=(function(){function n(){}return n.prototype.walk=function(e,t){var r=this;t===void 0&&(t=[]),Ve(e.definition,function(i,s){var o=br(e.definition,s+1);if(i instanceof Wi)r.walkProdRef(i,o,t);else if(i instanceof Nn)r.walkTerminal(i,o,t);else if(i instanceof Ni)r.walkFlat(i,o,t);else if(i instanceof Ar)r.walkOption(i,o,t);else if(i instanceof Rs)r.walkAtLeastOne(i,o,t);else if(i instanceof Es)r.walkAtLeastOneSep(i,o,t);else if(i instanceof $i)r.walkManySep(i,o,t);else if(i instanceof Wn)r.walkMany(i,o,t);else if(i instanceof Gi)r.walkOr(i,o,t);else throw Error("non exhaustive match")})},n.prototype.walkTerminal=function(e,t,r){},n.prototype.walkProdRef=function(e,t,r){},n.prototype.walkFlat=function(e,t,r){var i=t.concat(r);this.walk(e,i)},n.prototype.walkOption=function(e,t,r){var i=t.concat(r);this.walk(e,i)},n.prototype.walkAtLeastOne=function(e,t,r){var i=[new Ar({definition:e.definition})].concat(t,r);this.walk(e,i)},n.prototype.walkAtLeastOneSep=function(e,t,r){var i=oF(e,t,r);this.walk(e,i)},n.prototype.walkMany=function(e,t,r){var i=[new Ar({definition:e.definition})].concat(t,r);this.walk(e,i)},n.prototype.walkManySep=function(e,t,r){var i=oF(e,t,r);this.walk(e,i)},n.prototype.walkOr=function(e,t,r){var i=this,s=t.concat(r);Ve(e.definition,function(o){var a=new Ni({definition:[o]});i.walk(a,s)})},n})();function oF(n,e,t){var r=[new Ar({definition:[new Nn({terminalType:n.separator})].concat(n.definition)})],i=r.concat(e,t);return i}var Kh=(function(){function n(){}return n.prototype.visit=function(e){var t=e;switch(t.constructor){case Wi:return this.visitNonTerminal(t);case Ni:return this.visitFlat(t);case Ar:return this.visitOption(t);case Rs:return this.visitRepetitionMandatory(t);case Es:return this.visitRepetitionMandatoryWithSeparator(t);case $i:return this.visitRepetitionWithSeparator(t);case Wn:return this.visitRepetition(t);case Gi:return this.visitAlternation(t);case Nn:return this.visitTerminal(t);case Ud:return this.visitRule(t);default:throw Error("non exhaustive match")}},n.prototype.visitNonTerminal=function(e){},n.prototype.visitFlat=function(e){},n.prototype.visitOption=function(e){},n.prototype.visitRepetition=function(e){},n.prototype.visitRepetitionMandatory=function(e){},n.prototype.visitRepetitionMandatoryWithSeparator=function(e){},n.prototype.visitRepetitionWithSeparator=function(e){},n.prototype.visitAlternation=function(e){},n.prototype.visitTerminal=function(e){},n.prototype.visitRule=function(e){},n})(),vme=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}})();function yme(n){return n instanceof Ni||n instanceof Ar||n instanceof Wn||n instanceof Rs||n instanceof Es||n instanceof $i||n instanceof Nn||n instanceof Ud}function Ly(n,e){e===void 0&&(e=[]);var t=n instanceof Ar||n instanceof Wn||n instanceof $i;return t?!0:n instanceof Gi?L$(n.definition,function(r){return Ly(r,e)}):n instanceof Wi&&ar(e,n)?!1:n instanceof ha?(n instanceof Wi&&e.push(n),ps(n.definition,function(r){return Ly(r,e)})):!1}function Cme(n){return n instanceof Gi}function qs(n){if(n instanceof Wi)return"SUBRULE";if(n instanceof Ar)return"OPTION";if(n instanceof Gi)return"OR";if(n instanceof Rs)return"AT_LEAST_ONE";if(n instanceof Es)return"AT_LEAST_ONE_SEP";if(n instanceof $i)return"MANY_SEP";if(n instanceof Wn)return"MANY";if(n instanceof Nn)return"CONSUME";throw Error("non exhaustive match")}var Sme=(function(n){vme(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.separator="-",t.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]},t}return e.prototype.reset=function(){this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}},e.prototype.visitTerminal=function(t){var r=t.terminalType.name+this.separator+"Terminal";ke(this.dslMethods,r)||(this.dslMethods[r]=[]),this.dslMethods[r].push(t)},e.prototype.visitNonTerminal=function(t){var r=t.nonTerminalName+this.separator+"Terminal";ke(this.dslMethods,r)||(this.dslMethods[r]=[]),this.dslMethods[r].push(t)},e.prototype.visitOption=function(t){this.dslMethods.option.push(t)},e.prototype.visitRepetitionWithSeparator=function(t){this.dslMethods.repetitionWithSeparator.push(t)},e.prototype.visitRepetitionMandatory=function(t){this.dslMethods.repetitionMandatory.push(t)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.dslMethods.repetitionMandatoryWithSeparator.push(t)},e.prototype.visitRepetition=function(t){this.dslMethods.repetition.push(t)},e.prototype.visitAlternation=function(t){this.dslMethods.alternation.push(t)},e})(Kh),Lw=new Sme;function Rme(n){Lw.reset(),n.accept(Lw);var e=Lw.dslMethods;return Lw.reset(),e}function qg(n){if(n instanceof Wi)return qg(n.referencedRule);if(n instanceof Nn)return Tme(n);if(yme(n))return Eme(n);if(Cme(n))return bme(n);throw Error("non exhaustive match")}function Eme(n){for(var e=[],t=n.definition,r=0,i=t.length>r,s,o=!0;i&&o;)s=t[r],o=Ly(s),e=e.concat(qg(s)),r=r+1,i=t.length>r;return LO(e)}function bme(n){var e=Ee(n.definition,function(t){return qg(t)});return LO(Ti(e))}function Tme(n){return[n.terminalType]}var K$="_~IN~_",Ame=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}})(),Nme=(function(n){Ame(e,n);function e(t){var r=n.call(this)||this;return r.topProd=t,r.follows={},r}return e.prototype.startWalking=function(){return this.walk(this.topProd),this.follows},e.prototype.walkTerminal=function(t,r,i){},e.prototype.walkProdRef=function(t,r,i){var s=Ime(t.referencedRule,t.idx)+this.topProd.name,o=r.concat(i),a=new Ni({definition:o}),l=qg(a);this.follows[s]=l},e})(dS);function Mme(n){var e={};return Ve(n,function(t){var r=new Nme(t).startWalking();go(e,r)}),e}function Ime(n,e){return n.name+e+K$}var Ome=4,du=8,_me=8,fd=1<<du,Hy=2<<du,Im=3<<du,Om=4<<du,_m=5<<du,ed=6<<du;function Pm(n,e,t){return t|e|n}var Pme=32-_me;function q$(n,e,t,r){var i=r+1<<Pme;return Pm(n,e,t)|i}var xme=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}})();function aF(n,e){isNaN(n.startOffset)===!0?(n.startOffset=e.startOffset,n.endOffset=e.endOffset):n.endOffset<e.endOffset&&(n.endOffset=e.endOffset)}function lF(n,e){isNaN(n.startOffset)===!0?(n.startOffset=e.startOffset,n.startColumn=e.startColumn,n.startLine=e.startLine,n.endOffset=e.endOffset,n.endColumn=e.endColumn,n.endLine=e.endLine):n.endOffset<e.endOffset&&(n.endOffset=e.endOffset,n.endColumn=e.endColumn,n.endLine=e.endLine)}function Lme(n,e,t){n.children[t]===void 0?n.children[t]=[e]:n.children[t].push(e)}function uF(n,e,t){n.children[e]===void 0?n.children[e]=[t]:n.children[e].push(t)}var VO=(function(n){xme(e,n);function e(t){var r=n.call(this)||this;return r.result=[],r.ruleIdx=t,r}return e.prototype.collectNamedDSLMethod=function(t,r,i){if(!Ss(t.name)){var s=void 0;if(t instanceof Ar||t instanceof Wn||t instanceof Rs||t instanceof Gi)s=new r({definition:t.definition,idx:t.idx});else if(t instanceof Es||t instanceof $i)s=new r({definition:t.definition,idx:t.idx,separator:t.separator});else throw Error("non exhaustive match");var o=[s],a=Pm(this.ruleIdx,i,t.idx);this.result.push({def:o,key:a,name:t.name,orgProd:t})}},e.prototype.visitOption=function(t){this.collectNamedDSLMethod(t,Ar,Hy)},e.prototype.visitRepetition=function(t){this.collectNamedDSLMethod(t,Wn,Im)},e.prototype.visitRepetitionMandatory=function(t){this.collectNamedDSLMethod(t,Rs,Om)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.collectNamedDSLMethod(t,Es,ed)},e.prototype.visitRepetitionWithSeparator=function(t){this.collectNamedDSLMethod(t,$i,_m)},e.prototype.visitAlternation=function(t){var r=this;this.collectNamedDSLMethod(t,Gi,fd);var i=t.definition.length>1;Ve(t.definition,function(s,o){if(!Ss(s.name)){var a=s.definition;i?a=[new Ar({definition:s.definition})]:a=s.definition;var l=q$(r.ruleIdx,fd,t.idx,o);r.result.push({def:a,key:l,name:s.name,orgProd:s})}})},e})(Kh);function Hme(n,e){var t={allRuleNames:[]};return Ve(n,function(r){var i=e[r.name];t.allRuleNames.push(r.name);var s=new VO(i);r.accept(s),Ve(s.result,function(o){o.def,o.key;var a=o.name;t.allRuleNames.push(r.name+a)})}),t}var qh=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}})(),Dme=(function(n){qh(e,n);function e(t,r){var i=n.call(this)||this;return i.topProd=t,i.path=r,i.possibleTokTypes=[],i.nextProductionName="",i.nextProductionOccurrence=0,i.found=!1,i.isAtEndOfPath=!1,i}return e.prototype.startWalking=function(){if(this.found=!1,this.path.ruleStack[0]!==this.topProd.name)throw Error("The path does not start with the walker's top Rule!");return this.ruleStack=Ai(this.path.ruleStack).reverse(),this.occurrenceStack=Ai(this.path.occurrenceStack).reverse(),this.ruleStack.pop(),this.occurrenceStack.pop(),this.updateExpectedNext(),this.walk(this.topProd),this.possibleTokTypes},e.prototype.walk=function(t,r){r===void 0&&(r=[]),this.found||n.prototype.walk.call(this,t,r)},e.prototype.walkProdRef=function(t,r,i){if(t.referencedRule.name===this.nextProductionName&&t.idx===this.nextProductionOccurrence){var s=r.concat(i);this.updateExpectedNext(),this.walk(t.referencedRule,s)}},e.prototype.updateExpectedNext=function(){Qt(this.ruleStack)?(this.nextProductionName="",this.nextProductionOccurrence=0,this.isAtEndOfPath=!0):(this.nextProductionName=this.ruleStack.pop(),this.nextProductionOccurrence=this.occurrenceStack.pop())},e})(dS),Fme=(function(n){qh(e,n);function e(t,r){var i=n.call(this,t,r)||this;return i.path=r,i.nextTerminalName="",i.nextTerminalOccurrence=0,i.nextTerminalName=i.path.lastTok.name,i.nextTerminalOccurrence=i.path.lastTokOccurrence,i}return e.prototype.walkTerminal=function(t,r,i){if(this.isAtEndOfPath&&t.terminalType.name===this.nextTerminalName&&t.idx===this.nextTerminalOccurrence&&!this.found){var s=r.concat(i),o=new Ni({definition:s});this.possibleTokTypes=qg(o),this.found=!0}},e})(Dme),fS=(function(n){qh(e,n);function e(t,r){var i=n.call(this)||this;return i.topRule=t,i.occurrence=r,i.result={token:void 0,occurrence:void 0,isEndOfRule:void 0},i}return e.prototype.startWalking=function(){return this.walk(this.topRule),this.result},e})(dS),kme=(function(n){qh(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.walkMany=function(t,r,i){if(t.idx===this.occurrence){var s=Cs(r.concat(i));this.result.isEndOfRule=s===void 0,s instanceof Nn&&(this.result.token=s.terminalType,this.result.occurrence=s.idx)}else n.prototype.walkMany.call(this,t,r,i)},e})(fS),hF=(function(n){qh(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.walkManySep=function(t,r,i){if(t.idx===this.occurrence){var s=Cs(r.concat(i));this.result.isEndOfRule=s===void 0,s instanceof Nn&&(this.result.token=s.terminalType,this.result.occurrence=s.idx)}else n.prototype.walkManySep.call(this,t,r,i)},e})(fS),Vme=(function(n){qh(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.walkAtLeastOne=function(t,r,i){if(t.idx===this.occurrence){var s=Cs(r.concat(i));this.result.isEndOfRule=s===void 0,s instanceof Nn&&(this.result.token=s.terminalType,this.result.occurrence=s.idx)}else n.prototype.walkAtLeastOne.call(this,t,r,i)},e})(fS),cF=(function(n){qh(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.walkAtLeastOneSep=function(t,r,i){if(t.idx===this.occurrence){var s=Cs(r.concat(i));this.result.isEndOfRule=s===void 0,s instanceof Nn&&(this.result.token=s.terminalType,this.result.occurrence=s.idx)}else n.prototype.walkAtLeastOneSep.call(this,t,r,i)},e})(fS);function RN(n,e,t){t===void 0&&(t=[]),t=Ai(t);var r=[],i=0;function s(u){return u.concat(br(n,i+1))}function o(u){var h=RN(s(u),e,t);return r.concat(h)}for(;t.length<e&&i<n.length;){var a=n[i];if(a instanceof Ni)return o(a.definition);if(a instanceof Wi)return o(a.definition);if(a instanceof Ar)r=o(a.definition);else if(a instanceof Rs){var l=a.definition.concat([new Wn({definition:a.definition})]);return o(l)}else if(a instanceof Es){var l=[new Ni({definition:a.definition}),new Wn({definition:[new Nn({terminalType:a.separator})].concat(a.definition)})];return o(l)}else if(a instanceof $i){var l=a.definition.concat([new Wn({definition:[new Nn({terminalType:a.separator})].concat(a.definition)})]);r=o(l)}else if(a instanceof Wn){var l=a.definition.concat([new Wn({definition:a.definition})]);r=o(l)}else{if(a instanceof Gi)return Ve(a.definition,function(u){r=o(u.definition)}),r;if(a instanceof Nn)t.push(a.terminalType);else throw Error("non exhaustive match")}i++}return r.push({partialPath:t,suffixDef:br(n,i)}),r}function X$(n,e,t,r){var i="EXIT_NONE_TERMINAL",s=[i],o="EXIT_ALTERNATIVE",a=!1,l=e.length,u=l-r-1,h=[],c=[];for(c.push({idx:-1,def:n,ruleStack:[],occurrenceStack:[]});!Qt(c);){var d=c.pop();if(d===o){a&&x$(c).idx<=u&&c.pop();continue}var f=d.def,g=d.idx,p=d.ruleStack,v=d.occurrenceStack;if(!Qt(f)){var y=f[0];if(y===i){var S={idx:g,def:br(f),ruleStack:sg(p),occurrenceStack:sg(v)};c.push(S)}else if(y instanceof Nn)if(g<l-1){var R=g+1,A=e[R];if(t(A,y.terminalType)){var S={idx:R,def:br(f),ruleStack:p,occurrenceStack:v};c.push(S)}}else if(g===l-1)h.push({nextTokenType:y.terminalType,nextTokenOccurrence:y.idx,ruleStack:p,occurrenceStack:v}),a=!0;else throw Error("non exhaustive match");else if(y instanceof Wi){var O=Ai(p);O.push(y.nonTerminalName);var V=Ai(v);V.push(y.idx);var S={idx:g,def:y.definition.concat(s,br(f)),ruleStack:O,occurrenceStack:V};c.push(S)}else if(y instanceof Ar){var B={idx:g,def:br(f),ruleStack:p,occurrenceStack:v};c.push(B),c.push(o);var Y={idx:g,def:y.definition.concat(br(f)),ruleStack:p,occurrenceStack:v};c.push(Y)}else if(y instanceof Rs){var q=new Wn({definition:y.definition,idx:y.idx}),G=y.definition.concat([q],br(f)),S={idx:g,def:G,ruleStack:p,occurrenceStack:v};c.push(S)}else if(y instanceof Es){var Z=new Nn({terminalType:y.separator}),q=new Wn({definition:[Z].concat(y.definition),idx:y.idx}),G=y.definition.concat([q],br(f)),S={idx:g,def:G,ruleStack:p,occurrenceStack:v};c.push(S)}else if(y instanceof $i){var B={idx:g,def:br(f),ruleStack:p,occurrenceStack:v};c.push(B),c.push(o);var Z=new Nn({terminalType:y.separator}),ee=new Wn({definition:[Z].concat(y.definition),idx:y.idx}),G=y.definition.concat([ee],br(f)),Y={idx:g,def:G,ruleStack:p,occurrenceStack:v};c.push(Y)}else if(y instanceof Wn){var B={idx:g,def:br(f),ruleStack:p,occurrenceStack:v};c.push(B),c.push(o);var ee=new Wn({definition:y.definition,idx:y.idx}),G=y.definition.concat([ee],br(f)),Y={idx:g,def:G,ruleStack:p,occurrenceStack:v};c.push(Y)}else if(y instanceof Gi)for(var ne=y.definition.length-1;ne>=0;ne--){var re=y.definition[ne],ae={idx:g,def:re.definition.concat(br(f)),ruleStack:p,occurrenceStack:v};c.push(ae),c.push(o)}else if(y instanceof Ni)c.push({idx:g,def:y.definition.concat(br(f)),ruleStack:p,occurrenceStack:v});else if(y instanceof Ud)c.push(Ume(y,g,p,v));else throw Error("non exhaustive match")}}return h}function Ume(n,e,t,r){var i=Ai(t);i.push(n.name);var s=Ai(r);return s.push(1),{idx:e,def:n.definition,ruleStack:i,occurrenceStack:s}}var Q$=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}})(),tn;(function(n){n[n.OPTION=0]="OPTION",n[n.REPETITION=1]="REPETITION",n[n.REPETITION_MANDATORY=2]="REPETITION_MANDATORY",n[n.REPETITION_MANDATORY_WITH_SEPARATOR=3]="REPETITION_MANDATORY_WITH_SEPARATOR",n[n.REPETITION_WITH_SEPARATOR=4]="REPETITION_WITH_SEPARATOR",n[n.ALTERNATION=5]="ALTERNATION"})(tn||(tn={}));function Bme(n){if(n instanceof Ar)return tn.OPTION;if(n instanceof Wn)return tn.REPETITION;if(n instanceof Rs)return tn.REPETITION_MANDATORY;if(n instanceof Es)return tn.REPETITION_MANDATORY_WITH_SEPARATOR;if(n instanceof $i)return tn.REPETITION_WITH_SEPARATOR;if(n instanceof Gi)return tn.ALTERNATION;throw Error("non exhaustive match")}function Wme(n,e,t,r,i,s){var o=UO(n,e,t),a=eG(o)?xy:cS;return s(o,r,a,i)}function $me(n,e,t,r,i,s){var o=BO(n,e,i,t),a=eG(o)?xy:cS;return s(o[0],a,r)}function Gme(n,e,t,r){var i=n.length,s=ps(n,function(l){return ps(l,function(u){return u.length===1})});if(e)return function(l){for(var u=Ee(l,function(R){return R.GATE}),h=0;h<i;h++){var c=n[h],d=c.length,f=u[h];if(!(f!==void 0&&f.call(this)===!1))e:for(var g=0;g<d;g++){for(var p=c[g],v=p.length,y=0;y<v;y++){var S=this.LA(y+1);if(t(S,p[y])===!1)continue e}return h}}};if(s&&!r){var o=Ee(n,function(l){return Ti(l)}),a=Nr(o,function(l,u,h){return Ve(u,function(c){ke(l,c.tokenTypeIdx)||(l[c.tokenTypeIdx]=h),Ve(c.categoryMatches,function(d){ke(l,d)||(l[d]=h)})}),l},[]);return function(){var l=this.LA(1);return a[l.tokenTypeIdx]}}else return function(){for(var l=0;l<i;l++){var u=n[l],h=u.length;e:for(var c=0;c<h;c++){for(var d=u[c],f=d.length,g=0;g<f;g++){var p=this.LA(g+1);if(t(p,d[g])===!1)continue e}return l}}}}function jme(n,e,t){var r=ps(n,function(u){return u.length===1}),i=n.length;if(r&&!t){var s=Ti(n);if(s.length===1&&Qt(s[0].categoryMatches)){var o=s[0],a=o.tokenTypeIdx;return function(){return this.LA(1).tokenTypeIdx===a}}else{var l=Nr(s,function(u,h,c){return u[h.tokenTypeIdx]=!0,Ve(h.categoryMatches,function(d){u[d]=!0}),u},[]);return function(){var u=this.LA(1);return l[u.tokenTypeIdx]===!0}}}else return function(){e:for(var u=0;u<i;u++){for(var h=n[u],c=h.length,d=0;d<c;d++){var f=this.LA(d+1);if(e(f,h[d])===!1)continue e}return!0}return!1}}var zme=(function(n){Q$(e,n);function e(t,r,i){var s=n.call(this)||this;return s.topProd=t,s.targetOccurrence=r,s.targetProdType=i,s}return e.prototype.startWalking=function(){return this.walk(this.topProd),this.restDef},e.prototype.checkIsTarget=function(t,r,i,s){return t.idx===this.targetOccurrence&&this.targetProdType===r?(this.restDef=i.concat(s),!0):!1},e.prototype.walkOption=function(t,r,i){this.checkIsTarget(t,tn.OPTION,r,i)||n.prototype.walkOption.call(this,t,r,i)},e.prototype.walkAtLeastOne=function(t,r,i){this.checkIsTarget(t,tn.REPETITION_MANDATORY,r,i)||n.prototype.walkOption.call(this,t,r,i)},e.prototype.walkAtLeastOneSep=function(t,r,i){this.checkIsTarget(t,tn.REPETITION_MANDATORY_WITH_SEPARATOR,r,i)||n.prototype.walkOption.call(this,t,r,i)},e.prototype.walkMany=function(t,r,i){this.checkIsTarget(t,tn.REPETITION,r,i)||n.prototype.walkOption.call(this,t,r,i)},e.prototype.walkManySep=function(t,r,i){this.checkIsTarget(t,tn.REPETITION_WITH_SEPARATOR,r,i)||n.prototype.walkOption.call(this,t,r,i)},e})(dS),Z$=(function(n){Q$(e,n);function e(t,r,i){var s=n.call(this)||this;return s.targetOccurrence=t,s.targetProdType=r,s.targetRef=i,s.result=[],s}return e.prototype.checkIsTarget=function(t,r){t.idx===this.targetOccurrence&&this.targetProdType===r&&(this.targetRef===void 0||t===this.targetRef)&&(this.result=t.definition)},e.prototype.visitOption=function(t){this.checkIsTarget(t,tn.OPTION)},e.prototype.visitRepetition=function(t){this.checkIsTarget(t,tn.REPETITION)},e.prototype.visitRepetitionMandatory=function(t){this.checkIsTarget(t,tn.REPETITION_MANDATORY)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.checkIsTarget(t,tn.REPETITION_MANDATORY_WITH_SEPARATOR)},e.prototype.visitRepetitionWithSeparator=function(t){this.checkIsTarget(t,tn.REPETITION_WITH_SEPARATOR)},e.prototype.visitAlternation=function(t){this.checkIsTarget(t,tn.ALTERNATION)},e})(Kh);function dF(n){for(var e=new Array(n),t=0;t<n;t++)e[t]=[];return e}function JT(n){for(var e=[""],t=0;t<n.length;t++){for(var r=n[t],i=[],s=0;s<e.length;s++){var o=e[s];i.push(o+"_"+r.tokenTypeIdx);for(var a=0;a<r.categoryMatches.length;a++){var l="_"+r.categoryMatches[a];i.push(o+l)}}e=i}return e}function Yme(n,e,t){for(var r=0;r<n.length;r++)if(r!==t)for(var i=n[r],s=0;s<e.length;s++){var o=e[s];if(i[o]===!0)return!1}return!0}function J$(n,e){for(var t=Ee(n,function(h){return RN([h],1)}),r=dF(t.length),i=Ee(t,function(h){var c={};return Ve(h,function(d){var f=JT(d.partialPath);Ve(f,function(g){c[g]=!0})}),c}),s=t,o=1;o<=e;o++){var a=s;s=dF(a.length);for(var l=function(h){for(var c=a[h],d=0;d<c.length;d++){var f=c[d].partialPath,g=c[d].suffixDef,p=JT(f),v=Yme(i,p,h);if(v||Qt(g)||f.length===e){var y=r[h];if(EN(y,f)===!1){y.push(f);for(var S=0;S<p.length;S++){var R=p[S];i[h][R]=!0}}}else{var A=RN(g,o+1,f);s[h]=s[h].concat(A),Ve(A,function(O){var V=JT(O.partialPath);Ve(V,function(B){i[h][B]=!0})})}}},u=0;u<a.length;u++)l(u)}return r}function UO(n,e,t,r){var i=new Z$(n,tn.ALTERNATION,r);return e.accept(i),J$(i.result,t)}function BO(n,e,t,r){var i=new Z$(n,t);e.accept(i);var s=i.result,o=new zme(e,n,t),a=o.startWalking(),l=new Ni({definition:s}),u=new Ni({definition:a});return J$([l,u],r)}function EN(n,e){e:for(var t=0;t<n.length;t++){var r=n[t];if(r.length===e.length){for(var i=0;i<r.length;i++){var s=e[i],o=r[i],a=s===o||o.categoryMatchesMap[s.tokenTypeIdx]!==void 0;if(a===!1)continue e}return!0}}return!1}function Kme(n,e){return n.length<e.length&&ps(n,function(t,r){var i=e[r];return t===i||i.categoryMatchesMap[t.tokenTypeIdx]})}function eG(n){return ps(n,function(e){return ps(e,function(t){return ps(t,function(r){return Qt(r.categoryMatches)})})})}var WO=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}})();function qme(n,e,t,r,i,s){var o=Ee(n,function(S){return Qme(S,i)}),a=Ee(n,function(S){return rG(S,S,i)}),l=[],u=[],h=[];ps(a,Qt)&&(l=Ee(n,function(S){return sge(S,i)}),u=Ee(n,function(S){return oge(S,e,r,i)}),h=uge(n,e,i));var c=dge(n,t,i),d=Ee(t,function(S){return nge(S,i)}),f=Xme(n,i),g=fge(n,i),p=Ee(n,function(S){return lge(S,i)}),v=Ee(n,function(S){return ege(S,i)}),y=Ee(n,function(S){return rge(S,n,s,i)});return Ti(o.concat(d,f,g,h,a,l,u,c,p,v,y))}function Xme(n,e){var t=[];return Ve(n,function(r){var i=new VO("");r.accept(i);var s=Ee(i.result,function(o){return o.orgProd});t.push(Ee(s,function(o){return tge(r,o,e)}))}),Ti(t)}function Qme(n,e){var t=new Jme;n.accept(t);var r=t.allProductions,i=H$(r,Zme),s=Ms(i,function(a){return a.length>1}),o=Ee(Br(s),function(a){var l=Cs(a),u=e.buildDuplicateFoundError(n,a),h=qs(l),c={message:u,type:wr.DUPLICATE_PRODUCTIONS,ruleName:n.name,dslName:h,occurrence:l.idx},d=tG(l);return d&&(c.parameter=d),c});return o}function Zme(n){return qs(n)+"_#_"+n.idx+"_#_"+tG(n)}function tG(n){return n instanceof Nn?n.terminalType.name:n instanceof Wi?n.nonTerminalName:""}var Jme=(function(n){WO(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.allProductions=[],t}return e.prototype.visitNonTerminal=function(t){this.allProductions.push(t)},e.prototype.visitOption=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionWithSeparator=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionMandatory=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.allProductions.push(t)},e.prototype.visitRepetition=function(t){this.allProductions.push(t)},e.prototype.visitAlternation=function(t){this.allProductions.push(t)},e.prototype.visitTerminal=function(t){this.allProductions.push(t)},e})(Kh),Lh=/^[a-zA-Z_]\w*$/,nG=new RegExp(Lh.source.replace("^","^\\$"));function ege(n,e){var t=[],r=n.name;return r.match(Lh)||t.push({message:e.buildInvalidRuleNameError({topLevelRule:n,expectedPattern:Lh}),type:wr.INVALID_RULE_NAME,ruleName:r}),t}function tge(n,e,t){var r=[],i;return e.name.match(nG)||(i=t.buildInvalidNestedRuleNameError(n,e),r.push({message:i,type:wr.INVALID_NESTED_RULE_NAME,ruleName:n.name})),r}function nge(n,e){var t=[],r=n.name;return r.match(Lh)||t.push({message:e.buildTokenNameError({tokenType:n,expectedPattern:Lh}),type:wr.INVALID_TOKEN_NAME}),t}function rge(n,e,t,r){var i=[],s=Nr(e,function(a,l){return l.name===n.name?a+1:a},0);if(s>1){var o=r.buildDuplicateRuleNameError({topLevelRule:n,grammarName:t});i.push({message:o,type:wr.DUPLICATE_RULE_NAME,ruleName:n.name})}return i}function ige(n,e,t){var r=[],i;return ar(e,n)||(i="Invalid rule override, rule: ->"+n+"<- cannot be overridden in the grammar: ->"+t+"<-as it is not defined in any of the super grammars ",r.push({message:i,type:wr.INVALID_RULE_OVERRIDE,ruleName:n})),r}function rG(n,e,t,r){r===void 0&&(r=[]);var i=[],s=Sv(e.definition);if(Qt(s))return[];var o=n.name,a=ar(s,n);a&&i.push({message:t.buildLeftRecursionError({topLevelRule:n,leftRecursionPath:r}),type:wr.LEFT_RECURSION,ruleName:o});var l=lS(s,r.concat([n])),u=Ee(l,function(h){var c=Ai(r);return c.push(h),rG(n,h,t,c)});return i.concat(Ti(u))}function Sv(n){var e=[];if(Qt(n))return e;var t=Cs(n);if(t instanceof Wi)e.push(t.referencedRule);else if(t instanceof Ni||t instanceof Ar||t instanceof Rs||t instanceof Es||t instanceof $i||t instanceof Wn)e=e.concat(Sv(t.definition));else if(t instanceof Gi)e=Ti(Ee(t.definition,function(o){return Sv(o.definition)}));else if(!(t instanceof Nn))throw Error("non exhaustive match");var r=Ly(t),i=n.length>1;if(r&&i){var s=br(n);return e.concat(Sv(s))}else return e}var $O=(function(n){WO(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.alternations=[],t}return e.prototype.visitAlternation=function(t){this.alternations.push(t)},e})(Kh);function sge(n,e){var t=new $O;n.accept(t);var r=t.alternations,i=Nr(r,function(s,o){var a=sg(o.definition),l=Ee(a,function(u,h){var c=X$([u],[],null,1);return Qt(c)?{message:e.buildEmptyAlternationError({topLevelRule:n,alternation:o,emptyChoiceIdx:h}),type:wr.NONE_LAST_EMPTY_ALT,ruleName:n.name,occurrence:o.idx,alternative:h+1}:null});return s.concat(zg(l))},[]);return i}function oge(n,e,t,r){var i=new $O;n.accept(i);var s=i.alternations,o=t[n.name];o&&(s=Ph(s,function(l){return o[qs(l)+(l.idx===0?"":l.idx)]})),s=Ph(s,function(l){return l.ignoreAmbiguities===!0});var a=Nr(s,function(l,u){var h=u.idx,c=u.maxLookahead||e,d=UO(h,n,c,u),f=hge(d,u,n,r),g=cge(d,u,n,r);return l.concat(f,g)},[]);return a}var age=(function(n){WO(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.allProductions=[],t}return e.prototype.visitRepetitionWithSeparator=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionMandatory=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.allProductions.push(t)},e.prototype.visitRepetition=function(t){this.allProductions.push(t)},e})(Kh);function lge(n,e){var t=new $O;n.accept(t);var r=t.alternations,i=Nr(r,function(s,o){return o.definition.length>255&&s.push({message:e.buildTooManyAlternativesError({topLevelRule:n,alternation:o}),type:wr.TOO_MANY_ALTS,ruleName:n.name,occurrence:o.idx}),s},[]);return i}function uge(n,e,t){var r=[];return Ve(n,function(i){var s=new age;i.accept(s);var o=s.allProductions;Ve(o,function(a){var l=Bme(a),u=a.maxLookahead||e,h=a.idx,c=BO(h,i,l,u),d=c[0];if(Qt(Ti(d))){var f=t.buildEmptyRepetitionError({topLevelRule:i,repetition:a});r.push({message:f,type:wr.NO_NON_EMPTY_LOOKAHEAD,ruleName:i.name})}})}),r}function hge(n,e,t,r){var i=[],s=Nr(n,function(a,l,u){return e.definition[u].ignoreAmbiguities===!0||Ve(l,function(h){var c=[u];Ve(n,function(d,f){u!==f&&EN(d,h)&&e.definition[f].ignoreAmbiguities!==!0&&c.push(f)}),c.length>1&&!EN(i,h)&&(i.push(h),a.push({alts:c,path:h}))}),a},[]),o=Ee(s,function(a){var l=Ee(a.alts,function(h){return h+1}),u=r.buildAlternationAmbiguityError({topLevelRule:t,alternation:e,ambiguityIndices:l,prefixPath:a.path});return{message:u,type:wr.AMBIGUOUS_ALTS,ruleName:t.name,occurrence:e.idx,alternatives:[a.alts]}});return o}function cge(n,e,t,r){var i=[],s=Nr(n,function(o,a,l){var u=Ee(a,function(h){return{idx:l,path:h}});return o.concat(u)},[]);return Ve(s,function(o){var a=e.definition[o.idx];if(a.ignoreAmbiguities!==!0){var l=o.idx,u=o.path,h=bfe(s,function(d){return e.definition[d.idx].ignoreAmbiguities!==!0&&d.idx<l&&Kme(d.path,u)}),c=Ee(h,function(d){var f=[d.idx+1,l+1],g=e.idx===0?"":e.idx,p=r.buildAlternationPrefixAmbiguityError({topLevelRule:t,alternation:e,ambiguityIndices:f,prefixPath:d.path});return{message:p,type:wr.AMBIGUOUS_PREFIX_ALTS,ruleName:t.name,occurrence:g,alternatives:f}});i=i.concat(c)}}),i}function dge(n,e,t){var r=[],i=Ee(e,function(s){return s.name});return Ve(n,function(s){var o=s.name;if(ar(i,o)){var a=t.buildNamespaceConflictError(s);r.push({message:a,type:wr.CONFLICT_TOKENS_RULES_NAMESPACE,ruleName:o})}}),r}function fge(n,e){var t=[];return Ve(n,function(r){var i=new VO("");r.accept(i);var s=H$(i.result,function(a){return a.name}),o=Ms(s,function(a){return a.length>1});Ve(Br(o),function(a){var l=Ee(a,function(h){return h.orgProd}),u=e.buildDuplicateNestedRuleNameError(r,l);t.push({message:u,type:wr.DUPLICATE_NESTED_NAME,ruleName:r.name})})}),t}var iG={buildMismatchTokenMessage:function(n){var e=n.expected,t=n.actual;n.previous,n.ruleName;var r=Y$(e),i=r?"--> "+dd(e)+" <--":"token of type --> "+e.name+" <--",s="Expecting "+i+" but found --> '"+t.image+"' <--";return s},buildNotAllInputParsedMessage:function(n){var e=n.firstRedundant;return n.ruleName,"Redundant input, expecting EOF but found: "+e.image},buildNoViableAltMessage:function(n){var e=n.expectedPathsPerAlt,t=n.actual;n.previous;var r=n.customUserDescription;n.ruleName;var i="Expecting: ",s=Cs(t).image,o=`
but found: '`+s+"'";if(r)return i+r+o;var a=Nr(e,function(c,d){return c.concat(d)},[]),l=Ee(a,function(c){return"["+Ee(c,function(d){return dd(d)}).join(", ")+"]"}),u=Ee(l,function(c,d){return"  "+(d+1)+". "+c}),h=`one of these possible Token sequences:
`+u.join(`
`);return i+h+o},buildEarlyExitMessage:function(n){var e=n.expectedIterationPaths,t=n.actual,r=n.customUserDescription;n.ruleName;var i="Expecting: ",s=Cs(t).image,o=`
but found: '`+s+"'";if(r)return i+r+o;var a=Ee(e,function(u){return"["+Ee(u,function(h){return dd(h)}).join(",")+"]"}),l=`expecting at least one iteration which starts with one of these possible Token sequences::
  `+("<"+a.join(" ,")+">");return i+l+o}};Object.freeze(iG);var mge={buildRuleNotFoundError:function(n,e){var t="Invalid grammar, reference to a rule which is not defined: ->"+e.nonTerminalName+`<-
inside top level rule: ->`+n.name+"<-";return t}},GO={buildDuplicateFoundError:function(n,e){function t(h){return h instanceof Nn?h.terminalType.name:h instanceof Wi?h.nonTerminalName:""}var r=n.name,i=Cs(e),s=i.idx,o=qs(i),a=t(i),l=s>0,u="->"+o+(l?s:"")+"<- "+(a?"with argument: ->"+a+"<-":"")+`
                  appears more than once (`+e.length+" times) in the top level rule: ->"+r+`<-.                  
                  For further details see: https://sap.github.io/chevrotain/docs/FAQ.html#NUMERICAL_SUFFIXES 
                  `;return u=u.replace(/[ \t]+/g," "),u=u.replace(/\s\s+/g,`
`),u},buildInvalidNestedRuleNameError:function(n,e){var t="Invalid nested rule name: ->"+e.name+"<- inside rule: ->"+n.name+`<-
`+("it must match the pattern: ->"+nG.toString()+`<-.
`)+"Note that this means a nested rule name must start with the '$'(dollar) sign.";return t},buildDuplicateNestedRuleNameError:function(n,e){var t=Cs(e).name,r="Duplicate nested rule name: ->"+t+"<- inside rule: ->"+n.name+`<-
A nested name must be unique in the scope of a top level grammar rule.`;return r},buildNamespaceConflictError:function(n){var e=`Namespace conflict found in grammar.
`+("The grammar has both a Terminal(Token) and a Non-Terminal(Rule) named: <"+n.name+`>.
`)+`To resolve this make sure each Terminal and Non-Terminal names are unique
This is easy to accomplish by using the convention that Terminal names start with an uppercase letter
and Non-Terminal names start with a lower case letter.`;return e},buildAlternationPrefixAmbiguityError:function(n){var e=Ee(n.prefixPath,function(i){return dd(i)}).join(", "),t=n.alternation.idx===0?"":n.alternation.idx,r="Ambiguous alternatives: <"+n.ambiguityIndices.join(" ,")+`> due to common lookahead prefix
`+("in <OR"+t+"> inside <"+n.topLevelRule.name+`> Rule,
`)+("<"+e+`> may appears as a prefix path in all these alternatives.
`)+`See: https://sap.github.io/chevrotain/docs/guide/resolving_grammar_errors.html#COMMON_PREFIX
For Further details.`;return r},buildAlternationAmbiguityError:function(n){var e=Ee(n.prefixPath,function(i){return dd(i)}).join(", "),t=n.alternation.idx===0?"":n.alternation.idx,r="Ambiguous Alternatives Detected: <"+n.ambiguityIndices.join(" ,")+"> in <OR"+t+">"+(" inside <"+n.topLevelRule.name+`> Rule,
`)+("<"+e+`> may appears as a prefix path in all these alternatives.
`);return r=r+`See: https://sap.github.io/chevrotain/docs/guide/resolving_grammar_errors.html#AMBIGUOUS_ALTERNATIVES
For Further details.`,r},buildEmptyRepetitionError:function(n){var e=qs(n.repetition);n.repetition.idx!==0&&(e+=n.repetition.idx);var t="The repetition <"+e+"> within Rule <"+n.topLevelRule.name+`> can never consume any tokens.
This could lead to an infinite loop.`;return t},buildTokenNameError:function(n){var e=n.tokenType.name,t="Invalid Grammar Token name: ->"+e+"<- it must match the pattern: ->"+n.expectedPattern.toString()+"<-";return t},buildEmptyAlternationError:function(n){var e="Ambiguous empty alternative: <"+(n.emptyChoiceIdx+1)+">"+(" in <OR"+n.alternation.idx+"> inside <"+n.topLevelRule.name+`> Rule.
`)+"Only the last alternative may be an empty alternative.";return e},buildTooManyAlternativesError:function(n){var e=`An Alternation cannot have more than 256 alternatives:
`+("<OR"+n.alternation.idx+"> inside <"+n.topLevelRule.name+`> Rule.
 has `+(n.alternation.definition.length+1)+" alternatives.");return e},buildLeftRecursionError:function(n){var e=n.topLevelRule.name,t=Ee(n.leftRecursionPath,function(s){return s.name}),r=e+" --> "+t.concat([e]).join(" --> "),i=`Left Recursion found in grammar.
`+("rule: <"+e+`> can be invoked from itself (directly or indirectly)
`)+(`without consuming any Tokens. The grammar path that causes this is: 
 `+r+`
`)+` To fix this refactor your grammar to remove the left recursion.
see: https://en.wikipedia.org/wiki/LL_parser#Left_Factoring.`;return i},buildInvalidRuleNameError:function(n){var e=n.topLevelRule.name,t=n.expectedPattern.toString(),r="Invalid grammar rule name: ->"+e+"<- it must match the pattern: ->"+t+"<-";return r},buildDuplicateRuleNameError:function(n){var e;n.topLevelRule instanceof Ud?e=n.topLevelRule.name:e=n.topLevelRule;var t="Duplicate definition, rule: ->"+e+"<- is already defined in the grammar: ->"+n.grammarName+"<-";return t}},gge=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}})();function pge(n,e){var t=new wge(n,e);return t.resolveRefs(),t.errors}var wge=(function(n){gge(e,n);function e(t,r){var i=n.call(this)||this;return i.nameToTopRule=t,i.errMsgProvider=r,i.errors=[],i}return e.prototype.resolveRefs=function(){var t=this;Ve(Br(this.nameToTopRule),function(r){t.currTopLevel=r,r.accept(t)})},e.prototype.visitNonTerminal=function(t){var r=this.nameToTopRule[t.nonTerminalName];if(r)t.referencedRule=r;else{var i=this.errMsgProvider.buildRuleNotFoundError(this.currTopLevel,t);this.errors.push({message:i,type:wr.UNRESOLVED_SUBRULE_REF,ruleName:this.currTopLevel.name,unresolvedRefName:t.nonTerminalName})}},e})(Kh);function vge(n){n=uS(n,{errMsgProvider:mge});var e={};return Ve(n.rules,function(t){e[t.name]=t}),pge(e,n.errMsgProvider)}function yge(n){return n=uS(n,{errMsgProvider:GO,ignoredIssues:{}}),qme(n.rules,n.maxLookahead,n.tokenTypes,n.ignoredIssues,n.errMsgProvider,n.grammarName)}var sG="MismatchedTokenException",oG="NoViableAltException",aG="EarlyExitException",lG="NotAllInputParsedException",uG=[sG,oG,aG,lG];Object.freeze(uG);function Dy(n){return ar(uG,n.name)}function jO(n,e,t){this.name=sG,this.message=n,this.token=e,this.previousToken=t,this.resyncedTokens=[]}jO.prototype=Error.prototype;function hG(n,e,t){this.name=oG,this.message=n,this.token=e,this.previousToken=t,this.resyncedTokens=[]}hG.prototype=Error.prototype;function cG(n,e){this.name=lG,this.message=n,this.token=e,this.resyncedTokens=[]}cG.prototype=Error.prototype;function dG(n,e,t){this.name=aG,this.message=n,this.token=e,this.previousToken=t,this.resyncedTokens=[]}dG.prototype=Error.prototype;var eA={},fG="InRuleRecoveryException";function mG(n){this.name=fG,this.message=n}mG.prototype=Error.prototype;var Cge=(function(){function n(){}return n.prototype.initRecoverable=function(e){this.firstAfterRepMap={},this.resyncFollows={},this.recoveryEnabled=ke(e,"recoveryEnabled")?e.recoveryEnabled:Si.recoveryEnabled,this.recoveryEnabled&&(this.attemptInRepetitionRecovery=Sge)},n.prototype.getTokenToInsert=function(e){var t=kO(e,"",NaN,NaN,NaN,NaN,NaN,NaN);return t.isInsertedInRecovery=!0,t},n.prototype.canTokenTypeBeInsertedInRecovery=function(e){return!0},n.prototype.tryInRepetitionRecovery=function(e,t,r,i){for(var s=this,o=this.findReSyncTokenType(),a=this.exportLexerState(),l=[],u=!1,h=this.LA(1),c=this.LA(1),d=function(){var f=s.LA(0),g=s.errorMessageProvider.buildMismatchTokenMessage({expected:i,actual:h,previous:f,ruleName:s.getCurrRuleFullName()}),p=new jO(g,h,s.LA(0));p.resyncedTokens=sg(l),s.SAVE_ERROR(p)};!u;)if(this.tokenMatcher(c,i)){d();return}else if(r.call(this)){d(),e.apply(this,t);return}else this.tokenMatcher(c,o)?u=!0:(c=this.SKIP_TOKEN(),this.addToResyncTokens(c,l));this.importLexerState(a)},n.prototype.shouldInRepetitionRecoveryBeTried=function(e,t,r){return!(r===!1||e===void 0||t===void 0||this.tokenMatcher(this.LA(1),e)||this.isBackTracking()||this.canPerformInRuleRecovery(e,this.getFollowsForInRuleRecovery(e,t)))},n.prototype.getFollowsForInRuleRecovery=function(e,t){var r=this.getCurrentGrammarPath(e,t),i=this.getNextPossibleTokenTypes(r);return i},n.prototype.tryInRuleRecovery=function(e,t){if(this.canRecoverWithSingleTokenInsertion(e,t)){var r=this.getTokenToInsert(e);return r}if(this.canRecoverWithSingleTokenDeletion(e)){var i=this.SKIP_TOKEN();return this.consumeToken(),i}throw new mG("sad sad panda")},n.prototype.canPerformInRuleRecovery=function(e,t){return this.canRecoverWithSingleTokenInsertion(e,t)||this.canRecoverWithSingleTokenDeletion(e)},n.prototype.canRecoverWithSingleTokenInsertion=function(e,t){var r=this;if(!this.canTokenTypeBeInsertedInRecovery(e)||Qt(t))return!1;var i=this.LA(1),s=bd(t,function(o){return r.tokenMatcher(i,o)})!==void 0;return s},n.prototype.canRecoverWithSingleTokenDeletion=function(e){var t=this.tokenMatcher(this.LA(2),e);return t},n.prototype.isInCurrentRuleReSyncSet=function(e){var t=this.getCurrFollowKey(),r=this.getFollowSetFromFollowKey(t);return ar(r,e)},n.prototype.findReSyncTokenType=function(){for(var e=this.flattenFollowSet(),t=this.LA(1),r=2;;){var i=t.tokenType;if(ar(e,i))return i;t=this.LA(r),r++}},n.prototype.getCurrFollowKey=function(){if(this.RULE_STACK.length===1)return eA;var e=this.getLastExplicitRuleShortName(),t=this.getLastExplicitRuleOccurrenceIndex(),r=this.getPreviousExplicitRuleShortName();return{ruleName:this.shortRuleNameToFullName(e),idxInCallingRule:t,inRule:this.shortRuleNameToFullName(r)}},n.prototype.buildFullFollowKeyStack=function(){var e=this,t=this.RULE_STACK,r=this.RULE_OCCURRENCE_STACK;return Qt(this.LAST_EXPLICIT_RULE_STACK)||(t=Ee(this.LAST_EXPLICIT_RULE_STACK,function(i){return e.RULE_STACK[i]}),r=Ee(this.LAST_EXPLICIT_RULE_STACK,function(i){return e.RULE_OCCURRENCE_STACK[i]})),Ee(t,function(i,s){return s===0?eA:{ruleName:e.shortRuleNameToFullName(i),idxInCallingRule:r[s],inRule:e.shortRuleNameToFullName(t[s-1])}})},n.prototype.flattenFollowSet=function(){var e=this,t=Ee(this.buildFullFollowKeyStack(),function(r){return e.getFollowSetFromFollowKey(r)});return Ti(t)},n.prototype.getFollowSetFromFollowKey=function(e){if(e===eA)return[xh];var t=e.ruleName+e.idxInCallingRule+K$+e.inRule;return this.resyncFollows[t]},n.prototype.addToResyncTokens=function(e,t){return this.tokenMatcher(e,xh)||t.push(e),t},n.prototype.reSyncTo=function(e){for(var t=[],r=this.LA(1);this.tokenMatcher(r,e)===!1;)r=this.SKIP_TOKEN(),this.addToResyncTokens(r,t);return sg(t)},n.prototype.attemptInRepetitionRecovery=function(e,t,r,i,s,o,a){},n.prototype.getCurrentGrammarPath=function(e,t){var r=this.getHumanReadableRuleStack(),i=Ai(this.RULE_OCCURRENCE_STACK),s={ruleStack:r,occurrenceStack:i,lastTok:e,lastTokOccurrence:t};return s},n.prototype.getHumanReadableRuleStack=function(){var e=this;return Qt(this.LAST_EXPLICIT_RULE_STACK)?Ee(this.RULE_STACK,function(t){return e.shortRuleNameToFullName(t)}):Ee(this.LAST_EXPLICIT_RULE_STACK,function(t){return e.shortRuleNameToFullName(e.RULE_STACK[t])})},n})();function Sge(n,e,t,r,i,s,o){var a=this.getKeyForAutomaticLookahead(r,i),l=this.firstAfterRepMap[a];if(l===void 0){var u=this.getCurrRuleFullName(),h=this.getGAstProductions()[u],c=new s(h,i);l=c.startWalking(),this.firstAfterRepMap[a]=l}var d=l.token,f=l.occurrence,g=l.isEndOfRule;this.RULE_STACK.length===1&&g&&d===void 0&&(d=xh,f=1),this.shouldInRepetitionRecoveryBeTried(d,f,o)&&this.tryInRepetitionRecovery(n,e,t,d)}var Rge=(function(){function n(){}return n.prototype.initLooksAhead=function(e){this.dynamicTokensEnabled=ke(e,"dynamicTokensEnabled")?e.dynamicTokensEnabled:Si.dynamicTokensEnabled,this.maxLookahead=ke(e,"maxLookahead")?e.maxLookahead:Si.maxLookahead,this.lookAheadFuncsCache=jD()?new Map:[],jD()?(this.getLaFuncFromCache=this.getLaFuncFromMap,this.setLaFuncCache=this.setLaFuncCacheUsingMap):(this.getLaFuncFromCache=this.getLaFuncFromObj,this.setLaFuncCache=this.setLaFuncUsingObj)},n.prototype.preComputeLookaheadFunctions=function(e){var t=this;Ve(e,function(r){t.TRACE_INIT(r.name+" Rule Lookahead",function(){var i=Rme(r),s=i.alternation,o=i.repetition,a=i.option,l=i.repetitionMandatory,u=i.repetitionMandatoryWithSeparator,h=i.repetitionWithSeparator;Ve(s,function(c){var d=c.idx===0?"":c.idx;t.TRACE_INIT(""+qs(c)+d,function(){var f=Wme(c.idx,r,c.maxLookahead||t.maxLookahead,c.hasPredicates,t.dynamicTokensEnabled,t.lookAheadBuilderForAlternatives),g=Pm(t.fullRuleNameToShort[r.name],fd,c.idx);t.setLaFuncCache(g,f)})}),Ve(o,function(c){t.computeLookaheadFunc(r,c.idx,Im,tn.REPETITION,c.maxLookahead,qs(c))}),Ve(a,function(c){t.computeLookaheadFunc(r,c.idx,Hy,tn.OPTION,c.maxLookahead,qs(c))}),Ve(l,function(c){t.computeLookaheadFunc(r,c.idx,Om,tn.REPETITION_MANDATORY,c.maxLookahead,qs(c))}),Ve(u,function(c){t.computeLookaheadFunc(r,c.idx,ed,tn.REPETITION_MANDATORY_WITH_SEPARATOR,c.maxLookahead,qs(c))}),Ve(h,function(c){t.computeLookaheadFunc(r,c.idx,_m,tn.REPETITION_WITH_SEPARATOR,c.maxLookahead,qs(c))})})})},n.prototype.computeLookaheadFunc=function(e,t,r,i,s,o){var a=this;this.TRACE_INIT(""+o+(t===0?"":t),function(){var l=$me(t,e,s||a.maxLookahead,a.dynamicTokensEnabled,i,a.lookAheadBuilderForOptional),u=Pm(a.fullRuleNameToShort[e.name],r,t);a.setLaFuncCache(u,l)})},n.prototype.lookAheadBuilderForOptional=function(e,t,r){return jme(e,t,r)},n.prototype.lookAheadBuilderForAlternatives=function(e,t,r,i){return Gme(e,t,r,i)},n.prototype.getKeyForAutomaticLookahead=function(e,t){var r=this.getLastExplicitRuleShortName();return Pm(r,e,t)},n.prototype.getLaFuncFromCache=function(e){},n.prototype.getLaFuncFromMap=function(e){return this.lookAheadFuncsCache.get(e)},n.prototype.getLaFuncFromObj=function(e){return this.lookAheadFuncsCache[e]},n.prototype.setLaFuncCache=function(e,t){},n.prototype.setLaFuncCacheUsingMap=function(e,t){this.lookAheadFuncsCache.set(e,t)},n.prototype.setLaFuncUsingObj=function(e,t){this.lookAheadFuncsCache[e]=t},n})();function Ege(n){return mS(n.constructor)}var bge=/^\s*function\s*(\S*)\s*\(/,fF="name";function mS(n){var e=n.name;if(e)return e;var t=n.toString().match(bge)[1];return t}function gG(n,e){var t=Object.getOwnPropertyDescriptor(n,fF);return Ss(t)||t.configurable?(Object.defineProperty(n,fF,{enumerable:!1,configurable:!0,writable:!1,value:e}),!0):!1}function Tge(n,e){for(var t=ll(n),r=t.length,i=0;i<r;i++)for(var s=t[i],o=n[s],a=o.length,l=0;l<a;l++){var u=o[l];u.tokenTypeIdx===void 0&&(u.fullName!==void 0?this[u.fullName](u.children,e):this[u.name](u.children,e))}}function Age(n,e){var t=function(){};gG(t,n+"BaseSemantics");var r={visit:function(i,s){if(Js(i)&&(i=i[0]),!Ss(i))return i.fullName!==void 0?this[i.fullName](i.children,s):this[i.name](i.children,s)},validateVisitor:function(){var i=Mge(this,e);if(!Qt(i)){var s=Ee(i,function(o){return o.msg});throw Error("Errors Detected in CST Visitor <"+mS(this.constructor)+`>:
	`+(""+s.join(`

`).replace(/\n/g,`
	`)))}}};return t.prototype=r,t.prototype.constructor=t,t._RULE_NAMES=e,t}function Nge(n,e,t){var r=function(){};gG(r,n+"BaseSemanticsWithDefaults");var i=Object.create(t.prototype);return Ve(e,function(s){i[s]=Tge}),r.prototype=i,r.prototype.constructor=r,r}var Fy;(function(n){n[n.REDUNDANT_METHOD=0]="REDUNDANT_METHOD",n[n.MISSING_METHOD=1]="MISSING_METHOD"})(Fy||(Fy={}));function Mge(n,e){var t=Ige(n,e),r=_ge(n,e);return t.concat(r)}function Ige(n,e){var t=Ee(e,function(r){if(!cu(n[r]))return{msg:"Missing visitor method: <"+r+"> on "+mS(n.constructor)+" CST Visitor.",type:Fy.MISSING_METHOD,methodName:r}});return zg(t)}var Oge=["constructor","visit","validateVisitor"];function _ge(n,e){var t=[];for(var r in n)Lh.test(r)&&cu(n[r])&&!ar(Oge,r)&&!ar(e,r)&&t.push({msg:"Redundant visitor method: <"+r+"> on "+mS(n.constructor)+` CST Visitor
There is no Grammar Rule corresponding to this method's name.
`+("For utility methods on visitor classes use methods names that do not match /"+Lh.source+"/."),type:Fy.REDUNDANT_METHOD,methodName:r});return t}var Pge=(function(){function n(){}return n.prototype.initTreeBuilder=function(e){if(this.LAST_EXPLICIT_RULE_STACK=[],this.CST_STACK=[],this.outputCst=ke(e,"outputCst")?e.outputCst:Si.outputCst,this.nodeLocationTracking=ke(e,"nodeLocationTracking")?e.nodeLocationTracking:Si.nodeLocationTracking,!this.outputCst)this.cstInvocationStateUpdate=cr,this.cstFinallyStateUpdate=cr,this.cstPostTerminal=cr,this.cstPostNonTerminal=cr,this.cstPostRule=cr,this.getLastExplicitRuleShortName=this.getLastExplicitRuleShortNameNoCst,this.getPreviousExplicitRuleShortName=this.getPreviousExplicitRuleShortNameNoCst,this.getLastExplicitRuleOccurrenceIndex=this.getLastExplicitRuleOccurrenceIndexNoCst,this.manyInternal=this.manyInternalNoCst,this.orInternal=this.orInternalNoCst,this.optionInternal=this.optionInternalNoCst,this.atLeastOneInternal=this.atLeastOneInternalNoCst,this.manySepFirstInternal=this.manySepFirstInternalNoCst,this.atLeastOneSepFirstInternal=this.atLeastOneSepFirstInternalNoCst;else if(/full/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=lF,this.setNodeLocationFromNode=lF,this.cstPostRule=cr,this.setInitialNodeLocation=this.setInitialNodeLocationFullRecovery):(this.setNodeLocationFromToken=cr,this.setNodeLocationFromNode=cr,this.cstPostRule=this.cstPostRuleFull,this.setInitialNodeLocation=this.setInitialNodeLocationFullRegular);else if(/onlyOffset/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=aF,this.setNodeLocationFromNode=aF,this.cstPostRule=cr,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRecovery):(this.setNodeLocationFromToken=cr,this.setNodeLocationFromNode=cr,this.cstPostRule=this.cstPostRuleOnlyOffset,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRegular);else if(/none/i.test(this.nodeLocationTracking))this.setNodeLocationFromToken=cr,this.setNodeLocationFromNode=cr,this.cstPostRule=cr,this.setInitialNodeLocation=cr;else throw Error('Invalid <nodeLocationTracking> config option: "'+e.nodeLocationTracking+'"')},n.prototype.setInitialNodeLocationOnlyOffsetRecovery=function(e){e.location={startOffset:NaN,endOffset:NaN}},n.prototype.setInitialNodeLocationOnlyOffsetRegular=function(e){e.location={startOffset:this.LA(1).startOffset,endOffset:NaN}},n.prototype.setInitialNodeLocationFullRecovery=function(e){e.location={startOffset:NaN,startLine:NaN,startColumn:NaN,endOffset:NaN,endLine:NaN,endColumn:NaN}},n.prototype.setInitialNodeLocationFullRegular=function(e){var t=this.LA(1);e.location={startOffset:t.startOffset,startLine:t.startLine,startColumn:t.startColumn,endOffset:NaN,endLine:NaN,endColumn:NaN}},n.prototype.cstNestedInvocationStateUpdate=function(e,t){var r={name:e,fullName:this.shortRuleNameToFull[this.getLastExplicitRuleShortName()]+e,children:{}};this.setInitialNodeLocation(r),this.CST_STACK.push(r)},n.prototype.cstInvocationStateUpdate=function(e,t){this.LAST_EXPLICIT_RULE_STACK.push(this.RULE_STACK.length-1);var r={name:e,children:{}};this.setInitialNodeLocation(r),this.CST_STACK.push(r)},n.prototype.cstFinallyStateUpdate=function(){this.LAST_EXPLICIT_RULE_STACK.pop(),this.CST_STACK.pop()},n.prototype.cstNestedFinallyStateUpdate=function(){var e=this.CST_STACK.pop();this.cstPostRule(e)},n.prototype.cstPostRuleFull=function(e){var t=this.LA(0),r=e.location;r.startOffset<=t.startOffset?(r.endOffset=t.endOffset,r.endLine=t.endLine,r.endColumn=t.endColumn):(r.startOffset=NaN,r.startLine=NaN,r.startColumn=NaN)},n.prototype.cstPostRuleOnlyOffset=function(e){var t=this.LA(0),r=e.location;r.startOffset<=t.startOffset?r.endOffset=t.endOffset:r.startOffset=NaN},n.prototype.cstPostTerminal=function(e,t){var r=this.CST_STACK[this.CST_STACK.length-1];Lme(r,t,e),this.setNodeLocationFromToken(r.location,t)},n.prototype.cstPostNonTerminal=function(e,t){if(this.isBackTracking()!==!0){var r=this.CST_STACK[this.CST_STACK.length-1];uF(r,t,e),this.setNodeLocationFromNode(r.location,e.location)}},n.prototype.getBaseCstVisitorConstructor=function(){if(Ss(this.baseCstVisitorConstructor)){var e=Age(this.className,this.allRuleNames);return this.baseCstVisitorConstructor=e,e}return this.baseCstVisitorConstructor},n.prototype.getBaseCstVisitorConstructorWithDefaults=function(){if(Ss(this.baseCstVisitorWithDefaultsConstructor)){var e=Nge(this.className,this.allRuleNames,this.getBaseCstVisitorConstructor());return this.baseCstVisitorWithDefaultsConstructor=e,e}return this.baseCstVisitorWithDefaultsConstructor},n.prototype.nestedRuleBeforeClause=function(e,t){var r;if(e.NAME!==void 0)return r=e.NAME,this.nestedRuleInvocationStateUpdate(r,t),r},n.prototype.nestedAltBeforeClause=function(e,t,r,i){var s=this.getLastExplicitRuleShortName(),o=q$(s,r,t,i),a;if(e.NAME!==void 0)return a=e.NAME,this.nestedRuleInvocationStateUpdate(a,o),{shortName:o,nestedName:a}},n.prototype.nestedRuleFinallyClause=function(e,t){var r=this.CST_STACK,i=r[r.length-1];this.nestedRuleFinallyStateUpdate();var s=r[r.length-1];uF(s,t,i),this.setNodeLocationFromNode(s.location,i.location)},n.prototype.getLastExplicitRuleShortName=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-1];return this.RULE_STACK[e]},n.prototype.getLastExplicitRuleShortNameNoCst=function(){var e=this.RULE_STACK;return e[e.length-1]},n.prototype.getPreviousExplicitRuleShortName=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-2];return this.RULE_STACK[e]},n.prototype.getPreviousExplicitRuleShortNameNoCst=function(){var e=this.RULE_STACK;return e[e.length-2]},n.prototype.getLastExplicitRuleOccurrenceIndex=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-1];return this.RULE_OCCURRENCE_STACK[e]},n.prototype.getLastExplicitRuleOccurrenceIndexNoCst=function(){var e=this.RULE_OCCURRENCE_STACK;return e[e.length-1]},n.prototype.nestedRuleInvocationStateUpdate=function(e,t){this.RULE_OCCURRENCE_STACK.push(1),this.RULE_STACK.push(t),this.cstNestedInvocationStateUpdate(e,t)},n.prototype.nestedRuleFinallyStateUpdate=function(){this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstNestedFinallyStateUpdate()},n})(),xge=(function(){function n(){}return n.prototype.initLexerAdapter=function(){this.tokVector=[],this.tokVectorLength=0,this.currIdx=-1},Object.defineProperty(n.prototype,"input",{get:function(){return this.tokVector},set:function(e){if(this.selfAnalysisDone!==!0)throw Error("Missing <performSelfAnalysis> invocation at the end of the Parser's constructor.");this.reset(),this.tokVector=e,this.tokVectorLength=e.length},enumerable:!0,configurable:!0}),n.prototype.SKIP_TOKEN=function(){return this.currIdx<=this.tokVector.length-2?(this.consumeToken(),this.LA(1)):Vy},n.prototype.LA=function(e){var t=this.currIdx+e;return t<0||this.tokVectorLength<=t?Vy:this.tokVector[t]},n.prototype.consumeToken=function(){this.currIdx++},n.prototype.exportLexerState=function(){return this.currIdx},n.prototype.importLexerState=function(e){this.currIdx=e},n.prototype.resetLexerState=function(){this.currIdx=-1},n.prototype.moveToTerminatedState=function(){this.currIdx=this.tokVector.length-1},n.prototype.getLexerPosition=function(){return this.exportLexerState()},n})(),Lge=(function(){function n(){}return n.prototype.ACTION=function(e){return e.call(this)},n.prototype.consume=function(e,t,r){return this.consumeInternal(t,e,r)},n.prototype.subrule=function(e,t,r){return this.subruleInternal(t,e,r)},n.prototype.option=function(e,t){return this.optionInternal(t,e)},n.prototype.or=function(e,t){return this.orInternal(t,e)},n.prototype.many=function(e,t){return this.manyInternal(e,t)},n.prototype.atLeastOne=function(e,t){return this.atLeastOneInternal(e,t)},n.prototype.CONSUME=function(e,t){return this.consumeInternal(e,0,t)},n.prototype.CONSUME1=function(e,t){return this.consumeInternal(e,1,t)},n.prototype.CONSUME2=function(e,t){return this.consumeInternal(e,2,t)},n.prototype.CONSUME3=function(e,t){return this.consumeInternal(e,3,t)},n.prototype.CONSUME4=function(e,t){return this.consumeInternal(e,4,t)},n.prototype.CONSUME5=function(e,t){return this.consumeInternal(e,5,t)},n.prototype.CONSUME6=function(e,t){return this.consumeInternal(e,6,t)},n.prototype.CONSUME7=function(e,t){return this.consumeInternal(e,7,t)},n.prototype.CONSUME8=function(e,t){return this.consumeInternal(e,8,t)},n.prototype.CONSUME9=function(e,t){return this.consumeInternal(e,9,t)},n.prototype.SUBRULE=function(e,t){return this.subruleInternal(e,0,t)},n.prototype.SUBRULE1=function(e,t){return this.subruleInternal(e,1,t)},n.prototype.SUBRULE2=function(e,t){return this.subruleInternal(e,2,t)},n.prototype.SUBRULE3=function(e,t){return this.subruleInternal(e,3,t)},n.prototype.SUBRULE4=function(e,t){return this.subruleInternal(e,4,t)},n.prototype.SUBRULE5=function(e,t){return this.subruleInternal(e,5,t)},n.prototype.SUBRULE6=function(e,t){return this.subruleInternal(e,6,t)},n.prototype.SUBRULE7=function(e,t){return this.subruleInternal(e,7,t)},n.prototype.SUBRULE8=function(e,t){return this.subruleInternal(e,8,t)},n.prototype.SUBRULE9=function(e,t){return this.subruleInternal(e,9,t)},n.prototype.OPTION=function(e){return this.optionInternal(e,0)},n.prototype.OPTION1=function(e){return this.optionInternal(e,1)},n.prototype.OPTION2=function(e){return this.optionInternal(e,2)},n.prototype.OPTION3=function(e){return this.optionInternal(e,3)},n.prototype.OPTION4=function(e){return this.optionInternal(e,4)},n.prototype.OPTION5=function(e){return this.optionInternal(e,5)},n.prototype.OPTION6=function(e){return this.optionInternal(e,6)},n.prototype.OPTION7=function(e){return this.optionInternal(e,7)},n.prototype.OPTION8=function(e){return this.optionInternal(e,8)},n.prototype.OPTION9=function(e){return this.optionInternal(e,9)},n.prototype.OR=function(e){return this.orInternal(e,0)},n.prototype.OR1=function(e){return this.orInternal(e,1)},n.prototype.OR2=function(e){return this.orInternal(e,2)},n.prototype.OR3=function(e){return this.orInternal(e,3)},n.prototype.OR4=function(e){return this.orInternal(e,4)},n.prototype.OR5=function(e){return this.orInternal(e,5)},n.prototype.OR6=function(e){return this.orInternal(e,6)},n.prototype.OR7=function(e){return this.orInternal(e,7)},n.prototype.OR8=function(e){return this.orInternal(e,8)},n.prototype.OR9=function(e){return this.orInternal(e,9)},n.prototype.MANY=function(e){this.manyInternal(0,e)},n.prototype.MANY1=function(e){this.manyInternal(1,e)},n.prototype.MANY2=function(e){this.manyInternal(2,e)},n.prototype.MANY3=function(e){this.manyInternal(3,e)},n.prototype.MANY4=function(e){this.manyInternal(4,e)},n.prototype.MANY5=function(e){this.manyInternal(5,e)},n.prototype.MANY6=function(e){this.manyInternal(6,e)},n.prototype.MANY7=function(e){this.manyInternal(7,e)},n.prototype.MANY8=function(e){this.manyInternal(8,e)},n.prototype.MANY9=function(e){this.manyInternal(9,e)},n.prototype.MANY_SEP=function(e){this.manySepFirstInternal(0,e)},n.prototype.MANY_SEP1=function(e){this.manySepFirstInternal(1,e)},n.prototype.MANY_SEP2=function(e){this.manySepFirstInternal(2,e)},n.prototype.MANY_SEP3=function(e){this.manySepFirstInternal(3,e)},n.prototype.MANY_SEP4=function(e){this.manySepFirstInternal(4,e)},n.prototype.MANY_SEP5=function(e){this.manySepFirstInternal(5,e)},n.prototype.MANY_SEP6=function(e){this.manySepFirstInternal(6,e)},n.prototype.MANY_SEP7=function(e){this.manySepFirstInternal(7,e)},n.prototype.MANY_SEP8=function(e){this.manySepFirstInternal(8,e)},n.prototype.MANY_SEP9=function(e){this.manySepFirstInternal(9,e)},n.prototype.AT_LEAST_ONE=function(e){this.atLeastOneInternal(0,e)},n.prototype.AT_LEAST_ONE1=function(e){return this.atLeastOneInternal(1,e)},n.prototype.AT_LEAST_ONE2=function(e){this.atLeastOneInternal(2,e)},n.prototype.AT_LEAST_ONE3=function(e){this.atLeastOneInternal(3,e)},n.prototype.AT_LEAST_ONE4=function(e){this.atLeastOneInternal(4,e)},n.prototype.AT_LEAST_ONE5=function(e){this.atLeastOneInternal(5,e)},n.prototype.AT_LEAST_ONE6=function(e){this.atLeastOneInternal(6,e)},n.prototype.AT_LEAST_ONE7=function(e){this.atLeastOneInternal(7,e)},n.prototype.AT_LEAST_ONE8=function(e){this.atLeastOneInternal(8,e)},n.prototype.AT_LEAST_ONE9=function(e){this.atLeastOneInternal(9,e)},n.prototype.AT_LEAST_ONE_SEP=function(e){this.atLeastOneSepFirstInternal(0,e)},n.prototype.AT_LEAST_ONE_SEP1=function(e){this.atLeastOneSepFirstInternal(1,e)},n.prototype.AT_LEAST_ONE_SEP2=function(e){this.atLeastOneSepFirstInternal(2,e)},n.prototype.AT_LEAST_ONE_SEP3=function(e){this.atLeastOneSepFirstInternal(3,e)},n.prototype.AT_LEAST_ONE_SEP4=function(e){this.atLeastOneSepFirstInternal(4,e)},n.prototype.AT_LEAST_ONE_SEP5=function(e){this.atLeastOneSepFirstInternal(5,e)},n.prototype.AT_LEAST_ONE_SEP6=function(e){this.atLeastOneSepFirstInternal(6,e)},n.prototype.AT_LEAST_ONE_SEP7=function(e){this.atLeastOneSepFirstInternal(7,e)},n.prototype.AT_LEAST_ONE_SEP8=function(e){this.atLeastOneSepFirstInternal(8,e)},n.prototype.AT_LEAST_ONE_SEP9=function(e){this.atLeastOneSepFirstInternal(9,e)},n.prototype.RULE=function(e,t,r){if(r===void 0&&(r=Uy),ar(this.definedRulesNames,e)){var i=GO.buildDuplicateRuleNameError({topLevelRule:e,grammarName:this.className}),s={message:i,type:wr.DUPLICATE_RULE_NAME,ruleName:e};this.definitionErrors.push(s)}this.definedRulesNames.push(e);var o=this.defineRule(e,t,r);return this[e]=o,o},n.prototype.OVERRIDE_RULE=function(e,t,r){r===void 0&&(r=Uy);var i=[];i=i.concat(ige(e,this.definedRulesNames,this.className)),this.definitionErrors.push.apply(this.definitionErrors,i);var s=this.defineRule(e,t,r);return this[e]=s,s},n.prototype.BACKTRACK=function(e,t){return function(){this.isBackTrackingStack.push(1);var r=this.saveRecogState();try{return e.apply(this,t),!0}catch(i){if(Dy(i))return!1;throw i}finally{this.reloadRecogState(r),this.isBackTrackingStack.pop()}}},n.prototype.getGAstProductions=function(){return this.gastProductionsCache},n.prototype.getSerializedGastProductions=function(){return wme(Br(this.gastProductionsCache))},n})(),Hge=(function(){function n(){}return n.prototype.initRecognizerEngine=function(e,t){if(this.className=Ege(this),this.shortRuleNameToFull={},this.fullRuleNameToShort={},this.ruleShortNameIdx=256,this.tokenMatcher=xy,this.definedRulesNames=[],this.tokensMap={},this.allRuleNames=[],this.isBackTrackingStack=[],this.RULE_STACK=[],this.RULE_OCCURRENCE_STACK=[],this.gastProductionsCache={},ke(t,"serializedGrammar"))throw Error(`The Parser's configuration can no longer contain a <serializedGrammar> property.
	See: https://sap.github.io/chevrotain/docs/changes/BREAKING_CHANGES.html#_6-0-0
	For Further details.`);if(Js(e)){if(Qt(e))throw Error(`A Token Vocabulary cannot be empty.
	Note that the first argument for the parser constructor
	is no longer a Token vector (since v4.0).`);if(typeof e[0].startOffset=="number")throw Error(`The Parser constructor no longer accepts a token vector as the first argument.
	See: https://sap.github.io/chevrotain/docs/changes/BREAKING_CHANGES.html#_4-0-0
	For Further details.`)}if(Js(e))this.tokensMap=Nr(e,function(o,a){return o[a.name]=a,o},{});else if(ke(e,"modes")&&ps(Ti(Br(e.modes)),fme)){var r=Ti(Br(e.modes)),i=LO(r);this.tokensMap=Nr(i,function(o,a){return o[a.name]=a,o},{})}else if(HO(e))this.tokensMap=jg(e);else throw new Error("<tokensDictionary> argument must be An Array of Token constructors, A dictionary of Token constructors or an IMultiModeLexerDefinition");this.tokensMap.EOF=xh;var s=ps(Br(e),function(o){return Qt(o.categoryMatches)});this.tokenMatcher=s?xy:cS,Kg(Br(this.tokensMap))},n.prototype.defineRule=function(e,t,r){if(this.selfAnalysisDone)throw Error("Grammar rule <"+e+`> may not be defined after the 'performSelfAnalysis' method has been called'
Make sure that all grammar rule definitions are done before 'performSelfAnalysis' is called.`);var i=ke(r,"resyncEnabled")?r.resyncEnabled:Uy.resyncEnabled,s=ke(r,"recoveryValueFunc")?r.recoveryValueFunc:Uy.recoveryValueFunc,o=this.ruleShortNameIdx<<Ome+du;this.ruleShortNameIdx++,this.shortRuleNameToFull[o]=e,this.fullRuleNameToShort[e]=o;function a(h){try{if(this.outputCst===!0){t.apply(this,h);var c=this.CST_STACK[this.CST_STACK.length-1];return this.cstPostRule(c),c}else return t.apply(this,h)}catch(d){return this.invokeRuleCatch(d,i,s)}finally{this.ruleFinallyStateUpdate()}}var l;l=function(h,c){return h===void 0&&(h=0),this.ruleInvocationStateUpdate(o,e,h),a.call(this,c)};var u="ruleName";return l[u]=e,l.originalGrammarAction=t,l},n.prototype.invokeRuleCatch=function(e,t,r){var i=this.RULE_STACK.length===1,s=t&&!this.isBackTracking()&&this.recoveryEnabled;if(Dy(e)){var o=e;if(s){var a=this.findReSyncTokenType();if(this.isInCurrentRuleReSyncSet(a))if(o.resyncedTokens=this.reSyncTo(a),this.outputCst){var l=this.CST_STACK[this.CST_STACK.length-1];return l.recoveredNode=!0,l}else return r();else{if(this.outputCst){var l=this.CST_STACK[this.CST_STACK.length-1];l.recoveredNode=!0,o.partialCstResult=l}throw o}}else{if(i)return this.moveToTerminatedState(),r();throw o}}else throw e},n.prototype.optionInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(Hy,t),i=this.nestedRuleBeforeClause(e,r);try{return this.optionInternalLogic(e,t,r)}finally{i!==void 0&&this.nestedRuleFinallyClause(r,i)}},n.prototype.optionInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(Hy,t);return this.optionInternalLogic(e,t,r)},n.prototype.optionInternalLogic=function(e,t,r){var i=this,s=this.getLaFuncFromCache(r),o,a;if(e.DEF!==void 0){if(o=e.DEF,a=e.GATE,a!==void 0){var l=s;s=function(){return a.call(i)&&l.call(i)}}}else o=e;if(s.call(this)===!0)return o.call(this)},n.prototype.atLeastOneInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(Om,e),i=this.nestedRuleBeforeClause(t,r);try{return this.atLeastOneInternalLogic(e,t,r)}finally{i!==void 0&&this.nestedRuleFinallyClause(r,i)}},n.prototype.atLeastOneInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(Om,e);this.atLeastOneInternalLogic(e,t,r)},n.prototype.atLeastOneInternalLogic=function(e,t,r){var i=this,s=this.getLaFuncFromCache(r),o,a;if(t.DEF!==void 0){if(o=t.DEF,a=t.GATE,a!==void 0){var l=s;s=function(){return a.call(i)&&l.call(i)}}}else o=t;if(s.call(this)===!0)for(var u=this.doSingleRepetition(o);s.call(this)===!0&&u===!0;)u=this.doSingleRepetition(o);else throw this.raiseEarlyExitException(e,tn.REPETITION_MANDATORY,t.ERR_MSG);this.attemptInRepetitionRecovery(this.atLeastOneInternal,[e,t],s,Om,e,Vme)},n.prototype.atLeastOneSepFirstInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(ed,e),i=this.nestedRuleBeforeClause(t,r);try{this.atLeastOneSepFirstInternalLogic(e,t,r)}finally{i!==void 0&&this.nestedRuleFinallyClause(r,i)}},n.prototype.atLeastOneSepFirstInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(ed,e);this.atLeastOneSepFirstInternalLogic(e,t,r)},n.prototype.atLeastOneSepFirstInternalLogic=function(e,t,r){var i=this,s=t.DEF,o=t.SEP,a=this.getLaFuncFromCache(r);if(a.call(this)===!0){s.call(this);for(var l=function(){return i.tokenMatcher(i.LA(1),o)};this.tokenMatcher(this.LA(1),o)===!0;)this.CONSUME(o),s.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,o,l,s,cF],l,ed,e,cF)}else throw this.raiseEarlyExitException(e,tn.REPETITION_MANDATORY_WITH_SEPARATOR,t.ERR_MSG)},n.prototype.manyInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(Im,e),i=this.nestedRuleBeforeClause(t,r);try{return this.manyInternalLogic(e,t,r)}finally{i!==void 0&&this.nestedRuleFinallyClause(r,i)}},n.prototype.manyInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(Im,e);return this.manyInternalLogic(e,t,r)},n.prototype.manyInternalLogic=function(e,t,r){var i=this,s=this.getLaFuncFromCache(r),o,a;if(t.DEF!==void 0){if(o=t.DEF,a=t.GATE,a!==void 0){var l=s;s=function(){return a.call(i)&&l.call(i)}}}else o=t;for(var u=!0;s.call(this)===!0&&u===!0;)u=this.doSingleRepetition(o);this.attemptInRepetitionRecovery(this.manyInternal,[e,t],s,Im,e,kme,u)},n.prototype.manySepFirstInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(_m,e),i=this.nestedRuleBeforeClause(t,r);try{this.manySepFirstInternalLogic(e,t,r)}finally{i!==void 0&&this.nestedRuleFinallyClause(r,i)}},n.prototype.manySepFirstInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(_m,e);this.manySepFirstInternalLogic(e,t,r)},n.prototype.manySepFirstInternalLogic=function(e,t,r){var i=this,s=t.DEF,o=t.SEP,a=this.getLaFuncFromCache(r);if(a.call(this)===!0){s.call(this);for(var l=function(){return i.tokenMatcher(i.LA(1),o)};this.tokenMatcher(this.LA(1),o)===!0;)this.CONSUME(o),s.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,o,l,s,hF],l,_m,e,hF)}},n.prototype.repetitionSepSecondInternal=function(e,t,r,i,s){for(;r();)this.CONSUME(t),i.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,t,r,i,s],r,ed,e,s)},n.prototype.doSingleRepetition=function(e){var t=this.getLexerPosition();e.call(this);var r=this.getLexerPosition();return r>t},n.prototype.orInternalNoCst=function(e,t){var r=Js(e)?e:e.DEF,i=this.getKeyForAutomaticLookahead(fd,t),s=this.getLaFuncFromCache(i),o=s.call(this,r);if(o!==void 0){var a=r[o];return a.ALT.call(this)}this.raiseNoAltException(t,e.ERR_MSG)},n.prototype.orInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(fd,t),i=this.nestedRuleBeforeClause(e,r);try{var s=Js(e)?e:e.DEF,o=this.getLaFuncFromCache(r),a=o.call(this,s);if(a!==void 0){var l=s[a],u=this.nestedAltBeforeClause(l,t,fd,a);try{return l.ALT.call(this)}finally{u!==void 0&&this.nestedRuleFinallyClause(u.shortName,u.nestedName)}}this.raiseNoAltException(t,e.ERR_MSG)}finally{i!==void 0&&this.nestedRuleFinallyClause(r,i)}},n.prototype.ruleFinallyStateUpdate=function(){if(this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstFinallyStateUpdate(),this.RULE_STACK.length===0&&this.isAtEndOfInput()===!1){var e=this.LA(1),t=this.errorMessageProvider.buildNotAllInputParsedMessage({firstRedundant:e,ruleName:this.getCurrRuleFullName()});this.SAVE_ERROR(new cG(t,e))}},n.prototype.subruleInternal=function(e,t,r){var i;try{var s=r!==void 0?r.ARGS:void 0;return i=e.call(this,t,s),this.cstPostNonTerminal(i,r!==void 0&&r.LABEL!==void 0?r.LABEL:e.ruleName),i}catch(o){this.subruleInternalError(o,r,e.ruleName)}},n.prototype.subruleInternalError=function(e,t,r){throw Dy(e)&&e.partialCstResult!==void 0&&(this.cstPostNonTerminal(e.partialCstResult,t!==void 0&&t.LABEL!==void 0?t.LABEL:r),delete e.partialCstResult),e},n.prototype.consumeInternal=function(e,t,r){var i;try{var s=this.LA(1);this.tokenMatcher(s,e)===!0?(this.consumeToken(),i=s):this.consumeInternalError(e,s,r)}catch(o){i=this.consumeInternalRecovery(e,t,o)}return this.cstPostTerminal(r!==void 0&&r.LABEL!==void 0?r.LABEL:e.name,i),i},n.prototype.consumeInternalError=function(e,t,r){var i,s=this.LA(0);throw r!==void 0&&r.ERR_MSG?i=r.ERR_MSG:i=this.errorMessageProvider.buildMismatchTokenMessage({expected:e,actual:t,previous:s,ruleName:this.getCurrRuleFullName()}),this.SAVE_ERROR(new jO(i,t,s))},n.prototype.consumeInternalRecovery=function(e,t,r){if(this.recoveryEnabled&&r.name==="MismatchedTokenException"&&!this.isBackTracking()){var i=this.getFollowsForInRuleRecovery(e,t);try{return this.tryInRuleRecovery(e,i)}catch(s){throw s.name===fG?r:s}}else throw r},n.prototype.saveRecogState=function(){var e=this.errors,t=Ai(this.RULE_STACK);return{errors:e,lexerState:this.exportLexerState(),RULE_STACK:t,CST_STACK:this.CST_STACK,LAST_EXPLICIT_RULE_STACK:this.LAST_EXPLICIT_RULE_STACK}},n.prototype.reloadRecogState=function(e){this.errors=e.errors,this.importLexerState(e.lexerState),this.RULE_STACK=e.RULE_STACK},n.prototype.ruleInvocationStateUpdate=function(e,t,r){this.RULE_OCCURRENCE_STACK.push(r),this.RULE_STACK.push(e),this.cstInvocationStateUpdate(t,e)},n.prototype.isBackTracking=function(){return this.isBackTrackingStack.length!==0},n.prototype.getCurrRuleFullName=function(){var e=this.getLastExplicitRuleShortName();return this.shortRuleNameToFull[e]},n.prototype.shortRuleNameToFullName=function(e){return this.shortRuleNameToFull[e]},n.prototype.isAtEndOfInput=function(){return this.tokenMatcher(this.LA(1),xh)},n.prototype.reset=function(){this.resetLexerState(),this.isBackTrackingStack=[],this.errors=[],this.RULE_STACK=[],this.LAST_EXPLICIT_RULE_STACK=[],this.CST_STACK=[],this.RULE_OCCURRENCE_STACK=[]},n})(),Dge=(function(){function n(){}return n.prototype.initErrorHandler=function(e){this._errors=[],this.errorMessageProvider=uS(e.errorMessageProvider,Si.errorMessageProvider)},n.prototype.SAVE_ERROR=function(e){if(Dy(e))return e.context={ruleStack:this.getHumanReadableRuleStack(),ruleOccurrenceStack:Ai(this.RULE_OCCURRENCE_STACK)},this._errors.push(e),e;throw Error("Trying to save an Error which is not a RecognitionException")},Object.defineProperty(n.prototype,"errors",{get:function(){return Ai(this._errors)},set:function(e){this._errors=e},enumerable:!0,configurable:!0}),n.prototype.raiseEarlyExitException=function(e,t,r){for(var i=this.getCurrRuleFullName(),s=this.getGAstProductions()[i],o=BO(e,s,t,this.maxLookahead),a=o[0],l=[],u=1;u<=this.maxLookahead;u++)l.push(this.LA(u));var h=this.errorMessageProvider.buildEarlyExitMessage({expectedIterationPaths:a,actual:l,previous:this.LA(0),customUserDescription:r,ruleName:i});throw this.SAVE_ERROR(new dG(h,this.LA(1),this.LA(0)))},n.prototype.raiseNoAltException=function(e,t){for(var r=this.getCurrRuleFullName(),i=this.getGAstProductions()[r],s=UO(e,i,this.maxLookahead),o=[],a=1;a<=this.maxLookahead;a++)o.push(this.LA(a));var l=this.LA(0),u=this.errorMessageProvider.buildNoViableAltMessage({expectedPathsPerAlt:s,actual:o,previous:l,customUserDescription:t,ruleName:this.getCurrRuleFullName()});throw this.SAVE_ERROR(new hG(u,this.LA(1),l))},n})(),Fge=(function(){function n(){}return n.prototype.initContentAssist=function(){},n.prototype.computeContentAssist=function(e,t){var r=this.gastProductionsCache[e];if(Ss(r))throw Error("Rule ->"+e+"<- does not exist in this grammar.");return X$([r],t,this.tokenMatcher,this.maxLookahead)},n.prototype.getNextPossibleTokenTypes=function(e){var t=Cs(e.ruleStack),r=this.getGAstProductions(),i=r[t],s=new Fme(i,e).startWalking();return s},n})(),gS={description:"This Object indicates the Parser is during Recording Phase"};Object.freeze(gS);var mF=!0,gF=Math.pow(2,du)-1,pG=St({name:"RECORDING_PHASE_TOKEN",pattern:bi.NA});Kg([pG]);var wG=kO(pG,`This IToken indicates the Parser is in Recording Phase
	See: https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording for details`,-1,-1,-1,-1,-1,-1);Object.freeze(wG);var kge={name:`This CSTNode indicates the Parser is in Recording Phase
	See: https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording for details`,children:{}},Vge=(function(){function n(){}return n.prototype.initGastRecorder=function(e){this.recordingProdStack=[],this.RECORDING_PHASE=!1},n.prototype.enableRecording=function(){var e=this;this.RECORDING_PHASE=!0,this.TRACE_INIT("Enable Recording",function(){for(var t=function(i){var s=i>0?i:"";e["CONSUME"+s]=function(o,a){return this.consumeInternalRecord(o,i,a)},e["SUBRULE"+s]=function(o,a){return this.subruleInternalRecord(o,i,a)},e["OPTION"+s]=function(o){return this.optionInternalRecord(o,i)},e["OR"+s]=function(o){return this.orInternalRecord(o,i)},e["MANY"+s]=function(o){this.manyInternalRecord(i,o)},e["MANY_SEP"+s]=function(o){this.manySepFirstInternalRecord(i,o)},e["AT_LEAST_ONE"+s]=function(o){this.atLeastOneInternalRecord(i,o)},e["AT_LEAST_ONE_SEP"+s]=function(o){this.atLeastOneSepFirstInternalRecord(i,o)}},r=0;r<10;r++)t(r);e.consume=function(i,s,o){return this.consumeInternalRecord(s,i,o)},e.subrule=function(i,s,o){return this.subruleInternalRecord(s,i,o)},e.option=function(i,s){return this.optionInternalRecord(s,i)},e.or=function(i,s){return this.orInternalRecord(s,i)},e.many=function(i,s){this.manyInternalRecord(i,s)},e.atLeastOne=function(i,s){this.atLeastOneInternalRecord(i,s)},e.ACTION=e.ACTION_RECORD,e.BACKTRACK=e.BACKTRACK_RECORD,e.LA=e.LA_RECORD})},n.prototype.disableRecording=function(){var e=this;this.RECORDING_PHASE=!1,this.TRACE_INIT("Deleting Recording methods",function(){for(var t=0;t<10;t++){var r=t>0?t:"";delete e["CONSUME"+r],delete e["SUBRULE"+r],delete e["OPTION"+r],delete e["OR"+r],delete e["MANY"+r],delete e["MANY_SEP"+r],delete e["AT_LEAST_ONE"+r],delete e["AT_LEAST_ONE_SEP"+r]}delete e.consume,delete e.subrule,delete e.option,delete e.or,delete e.many,delete e.atLeastOne,delete e.ACTION,delete e.BACKTRACK,delete e.LA})},n.prototype.ACTION_RECORD=function(e){},n.prototype.BACKTRACK_RECORD=function(e,t){return function(){return!0}},n.prototype.LA_RECORD=function(e){return Vy},n.prototype.topLevelRuleRecord=function(e,t){try{var r=new Ud({definition:[],name:e});return r.name=e,this.recordingProdStack.push(r),t.call(this),this.recordingProdStack.pop(),r}catch(i){if(i.KNOWN_RECORDER_ERROR!==!0)try{i.message=i.message+`
	 This error was thrown during the "grammar recording phase" For more info see:
	https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording`}catch{throw i}throw i}},n.prototype.optionInternalRecord=function(e,t){return zf.call(this,Ar,e,t)},n.prototype.atLeastOneInternalRecord=function(e,t){zf.call(this,Rs,t,e)},n.prototype.atLeastOneSepFirstInternalRecord=function(e,t){zf.call(this,Es,t,e,mF)},n.prototype.manyInternalRecord=function(e,t){zf.call(this,Wn,t,e)},n.prototype.manySepFirstInternalRecord=function(e,t){zf.call(this,$i,t,e,mF)},n.prototype.orInternalRecord=function(e,t){return Uge.call(this,e,t)},n.prototype.subruleInternalRecord=function(e,t,r){if(ky(t),!e||ke(e,"ruleName")===!1){var i=new Error("<SUBRULE"+pF(t)+"> argument is invalid"+(" expecting a Parser method reference but got: <"+JSON.stringify(e)+">")+(`
 inside top level rule: <`+this.recordingProdStack[0].name+">"));throw i.KNOWN_RECORDER_ERROR=!0,i}var s=_y(this.recordingProdStack),o=e.ruleName,a=new Wi({idx:t,nonTerminalName:o,referencedRule:void 0});return s.definition.push(a),this.outputCst?kge:gS},n.prototype.consumeInternalRecord=function(e,t,r){if(ky(t),!z$(e)){var i=new Error("<CONSUME"+pF(t)+"> argument is invalid"+(" expecting a TokenType reference but got: <"+JSON.stringify(e)+">")+(`
 inside top level rule: <`+this.recordingProdStack[0].name+">"));throw i.KNOWN_RECORDER_ERROR=!0,i}var s=_y(this.recordingProdStack),o=new Nn({idx:t,terminalType:e});return s.definition.push(o),wG},n})();function zf(n,e,t,r){r===void 0&&(r=!1),ky(t);var i=_y(this.recordingProdStack),s=cu(e)?e:e.DEF,o=new n({definition:[],idx:t});return ke(e,"NAME")&&(o.name=e.NAME),r&&(o.separator=e.SEP),ke(e,"MAX_LOOKAHEAD")&&(o.maxLookahead=e.MAX_LOOKAHEAD),this.recordingProdStack.push(o),s.call(this),i.definition.push(o),this.recordingProdStack.pop(),gS}function Uge(n,e){var t=this;ky(e);var r=_y(this.recordingProdStack),i=Js(n)===!1,s=i===!1?n:n.DEF,o=new Gi({definition:[],idx:e,ignoreAmbiguities:i&&n.IGNORE_AMBIGUITIES===!0});ke(n,"NAME")&&(o.name=n.NAME),ke(n,"MAX_LOOKAHEAD")&&(o.maxLookahead=n.MAX_LOOKAHEAD);var a=L$(s,function(l){return cu(l.GATE)});return o.hasPredicates=a,r.definition.push(o),Ve(s,function(l){var u=new Ni({definition:[]});o.definition.push(u),ke(l,"NAME")&&(u.name=l.NAME),ke(l,"IGNORE_AMBIGUITIES")?u.ignoreAmbiguities=l.IGNORE_AMBIGUITIES:ke(l,"GATE")&&(u.ignoreAmbiguities=!0),t.recordingProdStack.push(u),l.ALT.call(t),t.recordingProdStack.pop()}),gS}function pF(n){return n===0?"":""+n}function ky(n){if(n<0||n>gF){var e=new Error("Invalid DSL Method idx value: <"+n+`>
	`+("Idx value must be a none negative value smaller than "+(gF+1)));throw e.KNOWN_RECORDER_ERROR=!0,e}}var Bge=(function(){function n(){}return n.prototype.initPerformanceTracer=function(e){if(ke(e,"traceInitPerf")){var t=e.traceInitPerf,r=typeof t=="number";this.traceInitMaxIdent=r?t:1/0,this.traceInitPerf=r?t>0:t}else this.traceInitMaxIdent=0,this.traceInitPerf=Si.traceInitPerf;this.traceInitIndent=-1},n.prototype.TRACE_INIT=function(e,t){if(this.traceInitPerf===!0){this.traceInitIndent++;var r=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(r+"--> <"+e+">");var i=F$(t),s=i.time,o=i.value,a=s>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&a(r+"<-- <"+e+"> time: "+s+"ms"),this.traceInitIndent--,o}else return t()},n})(),vG=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}})(),Vy=kO(xh,"",NaN,NaN,NaN,NaN,NaN,NaN);Object.freeze(Vy);var Si=Object.freeze({recoveryEnabled:!1,maxLookahead:4,ignoredIssues:{},dynamicTokensEnabled:!1,outputCst:!0,errorMessageProvider:iG,nodeLocationTracking:"none",traceInitPerf:!1,skipValidations:!1}),Uy=Object.freeze({recoveryValueFunc:function(){},resyncEnabled:!0}),wr;(function(n){n[n.INVALID_RULE_NAME=0]="INVALID_RULE_NAME",n[n.DUPLICATE_RULE_NAME=1]="DUPLICATE_RULE_NAME",n[n.INVALID_RULE_OVERRIDE=2]="INVALID_RULE_OVERRIDE",n[n.DUPLICATE_PRODUCTIONS=3]="DUPLICATE_PRODUCTIONS",n[n.UNRESOLVED_SUBRULE_REF=4]="UNRESOLVED_SUBRULE_REF",n[n.LEFT_RECURSION=5]="LEFT_RECURSION",n[n.NONE_LAST_EMPTY_ALT=6]="NONE_LAST_EMPTY_ALT",n[n.AMBIGUOUS_ALTS=7]="AMBIGUOUS_ALTS",n[n.CONFLICT_TOKENS_RULES_NAMESPACE=8]="CONFLICT_TOKENS_RULES_NAMESPACE",n[n.INVALID_TOKEN_NAME=9]="INVALID_TOKEN_NAME",n[n.INVALID_NESTED_RULE_NAME=10]="INVALID_NESTED_RULE_NAME",n[n.DUPLICATE_NESTED_NAME=11]="DUPLICATE_NESTED_NAME",n[n.NO_NON_EMPTY_LOOKAHEAD=12]="NO_NON_EMPTY_LOOKAHEAD",n[n.AMBIGUOUS_PREFIX_ALTS=13]="AMBIGUOUS_PREFIX_ALTS",n[n.TOO_MANY_ALTS=14]="TOO_MANY_ALTS"})(wr||(wr={}));function Wge(n){return n===void 0&&(n=void 0),function(){return n}}var zO=(function(){function n(e,t){t===void 0&&(t=Si),this.ignoredIssues=Si.ignoredIssues,this.definitionErrors=[],this.selfAnalysisDone=!1;var r=this;r.initErrorHandler(t),r.initLexerAdapter(),r.initLooksAhead(t),r.initRecognizerEngine(e,t),r.initRecoverable(t),r.initTreeBuilder(t),r.initContentAssist(),r.initGastRecorder(t),r.initPerformanceTracer(t),ke(t,"ignoredIssues")&&t.ignoredIssues!==Si.ignoredIssues&&DO(`The <ignoredIssues> IParserConfig property is soft-deprecated and will be removed in future versions.
	Please use the <IGNORE_AMBIGUITIES> flag on the relevant DSL method instead.`),this.ignoredIssues=ke(t,"ignoredIssues")?t.ignoredIssues:Si.ignoredIssues,this.skipValidations=ke(t,"skipValidations")?t.skipValidations:Si.skipValidations}return n.performSelfAnalysis=function(e){e.performSelfAnalysis()},n.prototype.performSelfAnalysis=function(){var e=this;this.TRACE_INIT("performSelfAnalysis",function(){var t;e.selfAnalysisDone=!0;var r=e.className;e.TRACE_INIT("toFastProps",function(){D$(e)}),e.TRACE_INIT("Grammar Recording",function(){try{e.enableRecording(),Ve(e.definedRulesNames,function(s){var o=e[s],a=o.originalGrammarAction,l=void 0;e.TRACE_INIT(s+" Rule",function(){l=e.topLevelRuleRecord(s,a)}),e.gastProductionsCache[s]=l})}finally{e.disableRecording()}});var i=[];if(e.TRACE_INIT("Grammar Resolving",function(){i=vge({rules:Br(e.gastProductionsCache)}),e.definitionErrors.push.apply(e.definitionErrors,i)}),e.TRACE_INIT("Grammar Validations",function(){if(Qt(i)&&e.skipValidations===!1){var s=yge({rules:Br(e.gastProductionsCache),maxLookahead:e.maxLookahead,tokenTypes:Br(e.tokensMap),ignoredIssues:e.ignoredIssues,errMsgProvider:GO,grammarName:r});e.definitionErrors.push.apply(e.definitionErrors,s)}}),Qt(e.definitionErrors)&&(e.recoveryEnabled&&e.TRACE_INIT("computeAllProdsFollows",function(){var s=Mme(Br(e.gastProductionsCache));e.resyncFollows=s}),e.TRACE_INIT("ComputeLookaheadFunctions",function(){e.preComputeLookaheadFunctions(Br(e.gastProductionsCache))})),e.TRACE_INIT("expandAllNestedRuleNames",function(){var s=Hme(Br(e.gastProductionsCache),e.fullRuleNameToShort);e.allRuleNames=s.allRuleNames}),!n.DEFER_DEFINITION_ERRORS_HANDLING&&!Qt(e.definitionErrors))throw t=Ee(e.definitionErrors,function(s){return s.message}),new Error(`Parser Definition Errors detected:
 `+t.join(`
-------------------------------
`))})},n.DEFER_DEFINITION_ERRORS_HANDLING=!1,n})();Mfe(zO,[Cge,Rge,Pge,xge,Hge,Lge,Dge,Fge,Vge,Bge]);(function(n){vG(e,n);function e(t,r){r===void 0&&(r=Si);var i=this,s=jg(r);return s.outputCst=!0,i=n.call(this,t,s)||this,i}return e})(zO);var $ge=(function(n){vG(e,n);function e(t,r){r===void 0&&(r=Si);var i=this,s=jg(r);return s.outputCst=!1,i=n.call(this,t,s)||this,i}return e})(zO);/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const wF=(n,e)=>({type:n,message:e});var Pn;(function(n){n.LexingError="LexingError",n.ParserError="ParsingError",n.StaticOffsetError="StaticOffsetError",n.StaticOffsetOutOfRangeError="StaticOffsetOutOfRangeError",n.RangeOffsetNotAllowed="RangeOffsetNotAllowed",n.InvalidRangeSize="InvalidRangeSize"})(Pn||(Pn={}));var M;(function(n){n.EMPTY="EMPTY",n.NUMBER="NUMBER",n.STRING="STRING",n.MINUS_UNARY_OP="MINUS_UNARY_OP",n.PLUS_UNARY_OP="PLUS_UNARY_OP",n.PERCENT_OP="PERCENT_OP",n.CONCATENATE_OP="CONCATENATE_OP",n.EQUALS_OP="EQUALS_OP",n.NOT_EQUAL_OP="NOT_EQUAL_OP",n.GREATER_THAN_OP="GREATER_THAN_OP",n.LESS_THAN_OP="LESS_THAN_OP",n.GREATER_THAN_OR_EQUAL_OP="GREATER_THAN_OR_EQUAL_OP",n.LESS_THAN_OR_EQUAL_OP="LESS_THAN_OR_EQUAL_OP",n.PLUS_OP="PLUS_OP",n.MINUS_OP="MINUS_OP",n.TIMES_OP="TIMES_OP",n.DIV_OP="DIV_OP",n.POWER_OP="POWER_OP",n.FUNCTION_CALL="FUNCTION_CALL",n.NAMED_EXPRESSION="NAMED_EXPRESSION",n.PARENTHESIS="PARENTHESES",n.CELL_REFERENCE="CELL_REFERENCE",n.CELL_RANGE="CELL_RANGE",n.COLUMN_RANGE="COLUMN_RANGE",n.ROW_RANGE="ROW_RANGE",n.ERROR="ERROR",n.ERROR_WITH_RAW_INPUT="ERROR_WITH_RAW_INPUT",n.ARRAY="ARRAY"})(M||(M={}));var ms;(function(n){n[n.RELATIVE=0]="RELATIVE",n[n.START_ABSOLUTE=1]="START_ABSOLUTE",n[n.BOTH_ABSOLUTE=2]="BOTH_ABSOLUTE"})(ms||(ms={}));const Gge=n=>({type:M.EMPTY,leadingWhitespace:n?.image}),jge=(n,e)=>({type:M.NUMBER,value:n,leadingWhitespace:e?.image}),zge=n=>{var e;return{type:M.STRING,value:n.image.slice(1,-1),leadingWhitespace:(e=n.leadingWhitespace)===null||e===void 0?void 0:e.image}},vF=(n,e)=>({type:M.CELL_REFERENCE,reference:n,leadingWhitespace:e?.image}),yF=(n,e,t,r)=>(YO(n,e,t),{type:M.CELL_RANGE,start:n,end:e,sheetReferenceType:t,leadingWhitespace:r}),Yge=(n,e,t,r)=>(YO(n,e,t),{type:M.COLUMN_RANGE,start:n,end:e,sheetReferenceType:t,leadingWhitespace:r?.image}),Kge=(n,e,t,r)=>(YO(n,e,t),{type:M.ROW_RANGE,start:n,end:e,sheetReferenceType:t,leadingWhitespace:r?.image}),qge=(n,e,t)=>({type:M.CONCATENATE_OP,left:n,right:e,leadingWhitespace:t?.image}),Xge=(n,e,t)=>({type:M.EQUALS_OP,left:n,right:e,leadingWhitespace:t?.image}),Qge=(n,e,t)=>({type:M.NOT_EQUAL_OP,left:n,right:e,leadingWhitespace:t?.image}),Zge=(n,e,t)=>({type:M.GREATER_THAN_OP,left:n,right:e,leadingWhitespace:t?.image}),Jge=(n,e,t)=>({type:M.LESS_THAN_OP,left:n,right:e,leadingWhitespace:t?.image}),epe=(n,e,t)=>({type:M.GREATER_THAN_OR_EQUAL_OP,left:n,right:e,leadingWhitespace:t?.image}),tpe=(n,e,t)=>({type:M.LESS_THAN_OR_EQUAL_OP,left:n,right:e,leadingWhitespace:t?.image}),npe=(n,e,t)=>({type:M.PLUS_OP,left:n,right:e,leadingWhitespace:t?.image}),rpe=(n,e,t)=>({type:M.MINUS_OP,left:n,right:e,leadingWhitespace:t?.image}),ipe=(n,e,t)=>({type:M.TIMES_OP,left:n,right:e,leadingWhitespace:t?.image}),spe=(n,e,t)=>({type:M.DIV_OP,left:n,right:e,leadingWhitespace:t?.image}),ope=(n,e,t)=>({type:M.POWER_OP,left:n,right:e,leadingWhitespace:t?.image}),ape=(n,e)=>({type:M.MINUS_UNARY_OP,value:n,leadingWhitespace:e?.image}),lpe=(n,e)=>({type:M.PLUS_UNARY_OP,value:n,leadingWhitespace:e?.image}),upe=(n,e)=>({type:M.PERCENT_OP,value:n,leadingWhitespace:e?.image}),hpe=(n,e,t,r,i)=>({type:M.FUNCTION_CALL,procedureName:n,args:e,leadingWhitespace:t?.image,internalWhitespace:r?.image,hyperlink:i}),CF=(n,e,t)=>({type:M.ARRAY,args:n,leadingWhitespace:e?.image,internalWhitespace:t?.image}),cpe=(n,e)=>({type:M.NAMED_EXPRESSION,expressionName:n,leadingWhitespace:e?.image}),dpe=(n,e,t)=>({type:M.PARENTHESIS,expression:n,leadingWhitespace:e?.image,internalWhitespace:t?.image}),Go=(n,e)=>({type:M.ERROR,error:n,leadingWhitespace:e?.image}),Lc=(n,e,t)=>({type:M.ERROR_WITH_RAW_INPUT,error:e,rawInput:n,leadingWhitespace:t?.image}),bN=()=>({type:M.ERROR,error:E.parsingError()});function YO(n,e,t){if(n.sheet!==void 0&&e.sheet===void 0||n.sheet===void 0&&e.sheet!==void 0)throw new Error("Start address inconsistent with end address");if(n.sheet===void 0&&t!==ms.RELATIVE||n.sheet!==void 0&&t===ms.RELATIVE)throw new Error("Sheet address inconsistent with sheet reference type")}function bt(n,e){return(e??"")+n}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const yG={[M.PLUS_OP]:"+",[M.MINUS_OP]:"-",[M.TIMES_OP]:"*",[M.DIV_OP]:"/",[M.CONCATENATE_OP]:"&",[M.POWER_OP]:"^",[M.EQUALS_OP]:"=",[M.NOT_EQUAL_OP]:"<>",[M.GREATER_THAN_OP]:">",[M.GREATER_THAN_OR_EQUAL_OP]:">=",[M.LESS_THAN_OP]:"<",[M.LESS_THAN_OR_EQUAL_OP]:"<="};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const fpe=(n,e,t,r)=>({ast:n,relativeDependencies:e,hasVolatileFunction:t,hasStructuralChangeFunction:r});class mpe{constructor(e){this.functionRegistry=e,this.cache=new Map}set(e,t){const r=wS(t,this.functionRegistry),i=fpe(t,r,_l(t,this.functionRegistry.isFunctionVolatile),_l(t,this.functionRegistry.isFunctionDependentOnSheetStructureChange));return this.cache.set(e,i),i}get(e){return this.cache.get(e)}maybeSetAndThenGet(e,t){const r=this.cache.get(e);return r!==void 0?r.ast:(this.set(e,t),t)}}const _l=(n,e)=>{switch(n.type){case M.EMPTY:case M.NUMBER:case M.STRING:case M.ERROR:case M.ERROR_WITH_RAW_INPUT:case M.CELL_REFERENCE:case M.CELL_RANGE:case M.COLUMN_RANGE:case M.ROW_RANGE:case M.NAMED_EXPRESSION:return!1;case M.PERCENT_OP:case M.PLUS_UNARY_OP:case M.MINUS_UNARY_OP:return _l(n.value,e);case M.CONCATENATE_OP:case M.EQUALS_OP:case M.NOT_EQUAL_OP:case M.LESS_THAN_OP:case M.GREATER_THAN_OP:case M.LESS_THAN_OR_EQUAL_OP:case M.GREATER_THAN_OR_EQUAL_OP:case M.MINUS_OP:case M.PLUS_OP:case M.TIMES_OP:case M.DIV_OP:case M.POWER_OP:return _l(n.left,e)||_l(n.right,e);case M.PARENTHESIS:return _l(n.expression,e);case M.FUNCTION_CALL:return e(n.procedureName)?!0:n.args.some(t=>_l(t,e));case M.ARRAY:return n.args.some(t=>t.some(r=>_l(r,e)))}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class _{}_.DistinctSigns="Distinct signs.";_.WrongArgNumber="Wrong number of arguments.";_.EmptyArg="Empty function argument.";_.EmptyArray="Empty array not allowed.";_.ArrayDimensions="Array dimensions are not compatible.";_.NoSpaceForArrayResult="No space for array result.";_.ValueSmall="Value too small.";_.ValueLarge="Value too large.";_.BadCriterion="Incorrect criterion.";_.RangeManySheets="Range spans more than one sheet.";_.CellRangeExpected="Cell range expected.";_.WrongDimension="Wrong range dimension.";_.ScalarExpected="Cell range not allowed.";_.NumberCoercion="Value cannot be coerced to number.";_.NumberExpected="Number argument expected.";_.IntegerExpected="Value needs to be an integer.";_.BadMode="Mode not recognized.";_.DateBounds="Date outside of bounds.";_.OutOfSheet="Resulting reference is out of the sheet.";_.WrongType="Wrong type of argument.";_.NaN="NaN or infinite value encountered.";_.EqualLength="Ranges need to be of equal length.";_.Negative="Value cannot be negative.";_.NotBinary="String does not represent a binary number.";_.NotOctal="String does not represent an octal number.";_.NotHex="String does not represent a hexadecimal number.";_.EndStartPeriod="End period needs to be at least start period.";_.CellRefExpected="Cell reference expected.";_.EmptyRange="Empty range not allowed.";_.BadRef="Address is not correct.";_.NumberRange="Number-only range expected.";_.ValueNotFound="Value not found.";_.ValueBaseLarge="Value in base too large.";_.ValueBaseSmall="Value in base too small.";_.ValueBaseLong="Value in base too long.";_.NegativeLength="Length cannot be negative.";_.PatternNotFound="Pattern not found.";_.OneValue="Needs at least one value.";_.TwoValues="Range needs to contain at least two elements.";_.ThreeValues="Range needs to contain at least three elements.";_.IndexBounds="Index out of bounds.";_.IndexLarge="Index too large.";_.Formula="Expected formula.";_.NegativeCount="Count cannot be negative.";_.ParseError="Parsing error.";_.SheetRef="Sheet does not exist.";_.PeriodLong="Period number cannot exceed life length.";_.InvalidDate="Invalid date.";_.BitshiftLong="Result of bitshift is too long.";_.EmptyString="Empty-string argument not allowed.";_.LengthBounds="Length out of bounds.";_.NegativeTime="Time cannot be negative.";_.NoDefault="No default option.";_.NoConditionMet="None of the conditions were met.";_.Selector="Selector cannot exceed the number of arguments.";_.StartEndDate="Start date needs to be earlier than end date.";_.IncorrectDateTime="String does not represent correct DateTime.";_.CharacterCodeBounds="Character code out of bounds.";_.NonZero="Argument cannot be 0.";_.LessThanOne="Argument cannot be less than 1.";_.WeekendString="Incorrect weekend bitmask string.";_.InvalidRoman="Invalid roman numeral.";_.WrongOrder="Wrong order of values.";_.ComplexNumberExpected="Complex number expected.";_.ShouldBeIorJ="Should be 'i' or 'j'.";_.SizeMismatch="Array dimensions mismatched.";_.FunctionName=n=>`Function name ${n} not recognized.`;_.NamedExpressionName=n=>`Named expression ${n} not recognized.`;_.LicenseKey=n=>`License key is ${n}.`;/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class gpe{constructor(){this.POSSIBLE_START_CHARACTERS=[...O$,...wfe,ti,"'","_"],this.cellReferenceRegexp=new RegExp(pfe,"y")}match(e,t){this.cellReferenceRegexp.lastIndex=t;const r=this.cellReferenceRegexp.exec(e+"@");return r==null||r[1]==null?null:(r[0]=r[1],r)}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class ppe{constructor(){this.POSSIBLE_START_CHARACTERS=[...O$,"_"],this.namedExpressionRegexp=new RegExp(I$,"y"),this.r1c1CellRefRegexp=new RegExp(`^${M$}$`)}match(e,t){this.namedExpressionRegexp.lastIndex=t;const r=this.namedExpressionRegexp.exec(e);return r==null||r[0]==null||this.r1c1CellRefRegexp.test(r[0])?null:r}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const og=St({name:"AdditionOp",pattern:bi.NA}),TN=St({name:"PlusOp",pattern:/\+/,categories:og}),AN=St({name:"MinusOp",pattern:/-/,categories:og}),pS=St({name:"MultiplicationOp",pattern:bi.NA}),CG=St({name:"TimesOp",pattern:/\*/,categories:pS}),SG=St({name:"DivOp",pattern:/\//,categories:pS}),NN=St({name:"PowerOp",pattern:/\^/}),RG=St({name:"PercentOp",pattern:/%/}),fu=St({name:"BooleanOp",pattern:bi.NA}),MN=St({name:"EqualsOp",pattern:/=/,categories:fu}),EG=St({name:"NotEqualOp",pattern:/<>/,categories:fu}),bG=St({name:"GreaterThanOp",pattern:/>/,categories:fu}),TG=St({name:"LessThanOp",pattern:/</,categories:fu}),AG=St({name:"GreaterThanOrEqualOp",pattern:/>=/,categories:fu}),NG=St({name:"LessThanOrEqualOp",pattern:/<=/,categories:fu}),MG=St({name:"ConcatenateOp",pattern:/&/}),IN=St({name:"LParen",pattern:/\(/}),Rv=St({name:"RParen",pattern:/\)/}),IG=St({name:"ArrayLParen",pattern:/{/}),OG=St({name:"ArrayRParen",pattern:/}/}),_G=St({name:"StringLiteral",pattern:/"([^"\\]*(\\.[^"\\]*)*)"/}),PG=St({name:"ErrorLiteral",pattern:/#[A-Za-z0-9\/]+[?!]?/}),ag=St({name:"RangeSeparator",pattern:new RegExp(Gg)}),KO=St({name:"ColumnRange",pattern:new RegExp(`${BD}${Gg}${BD}`)}),qO=St({name:"RowRange",pattern:new RegExp(`${WD}${Gg}${WD}`)}),XO=St({name:"ProcedureName",pattern:new RegExp(`([${sS}][${PO}]*)\\(`)}),tA=new gpe,zl=St({name:"CellReference",pattern:tA.match.bind(tA),start_chars_hint:tA.POSSIBLE_START_CHARACTERS,line_breaks:!1}),nA=new ppe,xG=St({name:"NamedExpression",pattern:nA.match.bind(nA),start_chars_hint:nA.POSSIBLE_START_CHARACTERS,line_breaks:!1}),QO=n=>{const e=n.translationPackage.getFunctionTranslation("OFFSET"),t=n.errorMapping,r=n.translationPackage.buildFunctionMapping(),i=new RegExp(n.ignoreWhiteSpace==="standard"?mfe:ffe),s=St({name:"WhiteSpace",pattern:i}),o=St({name:"ArrayRowSep",pattern:n.arrayRowSeparator}),a=St({name:"ArrayColSep",pattern:n.arrayColumnSeparator}),l=St({name:"NumberLiteral",pattern:new RegExp(`(([${n.decimalSeparator}]\\d+)|(\\d+([${n.decimalSeparator}]\\d*)?))(e[+-]?\\d+)?`)}),u=St({name:"OffsetProcedureName",pattern:new RegExp(e,"i")});let h,c;n.functionArgSeparator===n.arrayColumnSeparator?(h=a,c=[]):n.functionArgSeparator===n.arrayRowSeparator?(h=o,c=[]):(h=St({name:"ArgSeparator",pattern:n.functionArgSeparator}),c=[h]);const d=[s,TN,AN,CG,SG,NN,MN,EG,RG,AG,NG,bG,TG,IN,Rv,IG,OG,u,XO,ag,...c,KO,qO,l,_G,PG,MG,fu,og,pS,zl,xG,o,a];return{ArgSeparator:h,NumberLiteral:l,OffsetProcedureName:u,ArrayRowSeparator:o,ArrayColSeparator:a,WhiteSpace:s,allTokens:d,errorMapping:t,functionMapping:r,decimalSeparator:n.decimalSeparator,maxColumns:n.maxColumns,maxRows:n.maxRows}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class td extends $ge{constructor(e,t){super(e.allTokens,{outputCst:!1,maxLookahead:7}),this.booleanExpressionOrEmpty=this.RULE("booleanExpressionOrEmpty",()=>this.OR([{ALT:()=>this.SUBRULE(this.booleanExpression)},{ALT:Wge(Gge())}])),this.procedureExpression=this.RULE("procedureExpression",()=>{var r;const i=this.CONSUME(XO),s=i.image.toUpperCase().slice(0,-1),o=(r=this.lexerConfig.functionMapping[s])!==null&&r!==void 0?r:s,a=[];let l=this.SUBRULE(this.booleanExpressionOrEmpty);this.MANY(()=>{var h;const c=this.CONSUME(this.lexerConfig.ArgSeparator);l.type===M.EMPTY&&(l.leadingWhitespace=(h=c.leadingWhitespace)===null||h===void 0?void 0:h.image),a.push(l),l=this.SUBRULE2(this.booleanExpressionOrEmpty)}),a.push(l),a.length===1&&a[0].type===M.EMPTY&&(a.length=0);const u=this.CONSUME(Rv);return hpe(o,a,i.leadingWhitespace,u.leadingWhitespace)}),this.namedExpressionExpression=this.RULE("namedExpressionExpression",()=>{const r=this.CONSUME(xG);return cpe(r.image,r.leadingWhitespace)}),this.offsetProcedureExpression=this.RULE("offsetProcedureExpression",()=>{const r=[];return this.CONSUME(this.lexerConfig.OffsetProcedureName),this.CONSUME(IN),this.MANY_SEP({SEP:this.lexerConfig.ArgSeparator,DEF:()=>{r.push(this.SUBRULE(this.booleanExpression))}}),this.CONSUME(Rv),this.handleOffsetHeuristic(r)}),this.columnRangeExpression=this.RULE("columnRangeExpression",()=>{const r=this.CONSUME(KO),[i,s]=r.image.split(":"),o=this.ACTION(()=>My(this.sheetMapping,i,this.formulaAddress)),a=this.ACTION(()=>My(this.sheetMapping,s,this.formulaAddress));if(o===void 0||a===void 0)return Go(new E(N.REF));if(o.exceedsSheetSizeLimits(this.lexerConfig.maxColumns)||a.exceedsSheetSizeLimits(this.lexerConfig.maxColumns))return Lc(r.image,new E(N.NAME),r.leadingWhitespace);if(o.sheet===void 0&&a.sheet!==void 0)return this.parsingError(Pn.ParserError,"Malformed range expression");const{firstEnd:l,secondEnd:u,sheetRefType:h}=td.fixSheetIdsForRangeEnds(o,a);return Yge(l,u,h,r.leadingWhitespace)}),this.rowRangeExpression=this.RULE("rowRangeExpression",()=>{const r=this.CONSUME(qO),[i,s]=r.image.split(":"),o=this.ACTION(()=>Iy(this.sheetMapping,i,this.formulaAddress)),a=this.ACTION(()=>Iy(this.sheetMapping,s,this.formulaAddress));if(o===void 0||a===void 0)return Go(new E(N.REF));if(o.exceedsSheetSizeLimits(this.lexerConfig.maxRows)||a.exceedsSheetSizeLimits(this.lexerConfig.maxRows))return Lc(r.image,new E(N.NAME),r.leadingWhitespace);if(o.sheet===void 0&&a.sheet!==void 0)return this.parsingError(Pn.ParserError,"Malformed range expression");const{firstEnd:l,secondEnd:u,sheetRefType:h}=td.fixSheetIdsForRangeEnds(o,a);return Kge(l,u,h,r.leadingWhitespace)}),this.cellReference=this.RULE("cellReference",()=>{const r=this.CONSUME(zl),i=this.ACTION(()=>$c(this.sheetMapping,r.image,this.formulaAddress));return i===void 0?Lc(r.image,new E(N.REF),r.leadingWhitespace):i.exceedsSheetSizeLimits(this.lexerConfig.maxColumns,this.lexerConfig.maxRows)?Lc(r.image,new E(N.NAME),r.leadingWhitespace):vF(i,r.leadingWhitespace)}),this.endRangeReference=this.RULE("endRangeReference",r=>{var i;const s=this.CONSUME(zl),o=this.ACTION(()=>$c(this.sheetMapping,r.image,this.formulaAddress)),a=this.ACTION(()=>$c(this.sheetMapping,s.image,this.formulaAddress));return o===void 0||a===void 0?this.ACTION(()=>Lc(`${r.image}:${s.image}`,new E(N.REF),r.leadingWhitespace)):o.exceedsSheetSizeLimits(this.lexerConfig.maxColumns,this.lexerConfig.maxRows)||a.exceedsSheetSizeLimits(this.lexerConfig.maxColumns,this.lexerConfig.maxRows)?this.ACTION(()=>Lc(`${r.image}:${s.image}`,new E(N.NAME),r.leadingWhitespace)):this.buildCellRange(o,a,(i=r.leadingWhitespace)===null||i===void 0?void 0:i.image)}),this.endOfRangeExpression=this.RULE("endOfRangeExpression",r=>this.OR([{ALT:()=>this.SUBRULE(this.endRangeReference,{ARGS:[r]})},{ALT:()=>{var i;const s=this.SUBRULE(this.offsetProcedureExpression),o=this.ACTION(()=>$c(this.sheetMapping,r.image,this.formulaAddress));return o===void 0?Go(new E(N.REF)):s.type===M.CELL_REFERENCE?this.buildCellRange(o,s.reference,(i=r.leadingWhitespace)===null||i===void 0?void 0:i.image):this.parsingError(Pn.RangeOffsetNotAllowed,"Range offset not allowed here")}}])),this.cellRangeExpression=this.RULE("cellRangeExpression",()=>{const r=this.CONSUME(zl);return this.CONSUME2(ag),this.SUBRULE(this.endOfRangeExpression,{ARGS:[r]})}),this.endRangeWithOffsetStartReference=this.RULE("endRangeWithOffsetStartReference",r=>{const i=this.CONSUME(zl),s=this.ACTION(()=>$c(this.sheetMapping,i.image,this.formulaAddress));return s===void 0?this.ACTION(()=>Go(new E(N.REF))):this.buildCellRange(r.reference,s,r.leadingWhitespace)}),this.endOfRangeWithOffsetStartExpression=this.RULE("endOfRangeWithOffsetStartExpression",r=>this.OR([{ALT:()=>this.SUBRULE(this.endRangeWithOffsetStartReference,{ARGS:[r]})},{ALT:()=>{const i=this.SUBRULE(this.offsetProcedureExpression);return i.type===M.CELL_REFERENCE?this.buildCellRange(r.reference,i.reference,r.leadingWhitespace):this.parsingError(Pn.RangeOffsetNotAllowed,"Range offset not allowed here")}}])),this.offsetExpression=this.RULE("offsetExpression",()=>{const r=this.SUBRULE(this.offsetProcedureExpression);let i;return this.OPTION(()=>{this.CONSUME(ag),r.type===M.CELL_RANGE?i=this.parsingError(Pn.RangeOffsetNotAllowed,"Range offset not allowed here"):i=this.SUBRULE(this.endOfRangeWithOffsetStartExpression,{ARGS:[r]})}),i!==void 0?i:r}),this.insideArrayExpression=this.RULE("insideArrayExpression",()=>{const r=[[]];return r[r.length-1].push(this.SUBRULE(this.booleanExpression)),this.MANY(()=>{this.OR([{ALT:()=>{this.CONSUME(this.lexerConfig.ArrayColSeparator),r[r.length-1].push(this.SUBRULE2(this.booleanExpression))}},{ALT:()=>{this.CONSUME(this.lexerConfig.ArrayRowSeparator),r.push([]),r[r.length-1].push(this.SUBRULE3(this.booleanExpression))}}])}),CF(r)}),this.parenthesisExpression=this.RULE("parenthesisExpression",()=>{const r=this.CONSUME(IN),i=this.SUBRULE(this.booleanExpression),s=this.CONSUME(Rv);return dpe(i,r.leadingWhitespace,s.leadingWhitespace)}),this.arrayExpression=this.RULE("arrayExpression",()=>this.OR([{ALT:()=>{const r=this.CONSUME(IG),i=this.SUBRULE(this.insideArrayExpression),s=this.CONSUME(OG);return CF(i.args,r.leadingWhitespace,s.leadingWhitespace)}},{ALT:()=>this.SUBRULE(this.parenthesisExpression)}])),this.numericStringToNumber=r=>{const i=r.replace(this.lexerConfig.decimalSeparator,".");return Number(i)},this.positiveAtomicExpression=this.RULE("positiveAtomicExpression",()=>{var r;return this.OR((r=this.atomicExpCache)!==null&&r!==void 0?r:this.atomicExpCache=[{ALT:()=>this.SUBRULE(this.arrayExpression)},{ALT:()=>this.SUBRULE(this.cellRangeExpression)},{ALT:()=>this.SUBRULE(this.columnRangeExpression)},{ALT:()=>this.SUBRULE(this.rowRangeExpression)},{ALT:()=>this.SUBRULE(this.offsetExpression)},{ALT:()=>this.SUBRULE(this.cellReference)},{ALT:()=>this.SUBRULE(this.procedureExpression)},{ALT:()=>this.SUBRULE(this.namedExpressionExpression)},{ALT:()=>{const i=this.CONSUME(this.lexerConfig.NumberLiteral);return jge(this.numericStringToNumber(i.image),i.leadingWhitespace)}},{ALT:()=>{const i=this.CONSUME(_G);return zge(i)}},{ALT:()=>{const i=this.CONSUME(PG),s=i.image.toUpperCase(),o=this.lexerConfig.errorMapping[s];return o?Go(new E(o),i.leadingWhitespace):this.parsingError(Pn.ParserError,"Unknown error literal")}}])}),this.rightUnaryOpAtomicExpression=this.RULE("rightUnaryOpAtomicExpression",()=>{const r=this.SUBRULE(this.positiveAtomicExpression),i=this.OPTION(()=>this.CONSUME(RG));return i?upe(r,i.leadingWhitespace):r}),this.atomicExpression=this.RULE("atomicExpression",()=>this.OR([{ALT:()=>{const r=this.CONSUME(og),i=this.SUBRULE(this.atomicExpression);return zt(r,TN)?lpe(i,r.leadingWhitespace):zt(r,AN)?ape(i,r.leadingWhitespace):(this.customParsingError=wF(Pn.ParserError,"Mismatched token type"),this.customParsingError)}},{ALT:()=>this.SUBRULE2(this.rightUnaryOpAtomicExpression)}])),this.powerExpression=this.RULE("powerExpression",()=>{let r=this.SUBRULE(this.atomicExpression);return this.MANY(()=>{const i=this.CONSUME(NN),s=this.SUBRULE2(this.atomicExpression);zt(i,NN)?r=ope(r,s,i.leadingWhitespace):this.ACTION(()=>{throw Error("Operator not supported")})}),r}),this.multiplicationExpression=this.RULE("multiplicationExpression",()=>{let r=this.SUBRULE(this.powerExpression);return this.MANY(()=>{const i=this.CONSUME(pS),s=this.SUBRULE2(this.powerExpression);zt(i,CG)?r=ipe(r,s,i.leadingWhitespace):zt(i,SG)?r=spe(r,s,i.leadingWhitespace):this.ACTION(()=>{throw Error("Operator not supported")})}),r}),this.additionExpression=this.RULE("additionExpression",()=>{let r=this.SUBRULE(this.multiplicationExpression);return this.MANY(()=>{const i=this.CONSUME(og),s=this.SUBRULE2(this.multiplicationExpression);zt(i,TN)?r=npe(r,s,i.leadingWhitespace):zt(i,AN)?r=rpe(r,s,i.leadingWhitespace):this.ACTION(()=>{throw Error("Operator not supported")})}),r}),this.concatenateExpression=this.RULE("concatenateExpression",()=>{let r=this.SUBRULE(this.additionExpression);return this.MANY(()=>{const i=this.CONSUME(MG),s=this.SUBRULE2(this.additionExpression);r=qge(r,s,i.leadingWhitespace)}),r}),this.booleanExpression=this.RULE("booleanExpression",()=>{let r=this.SUBRULE(this.concatenateExpression);return this.MANY(()=>{const i=this.CONSUME(fu),s=this.SUBRULE2(this.concatenateExpression);zt(i,MN)?r=Xge(r,s,i.leadingWhitespace):zt(i,EG)?r=Qge(r,s,i.leadingWhitespace):zt(i,bG)?r=Zge(r,s,i.leadingWhitespace):zt(i,TG)?r=Jge(r,s,i.leadingWhitespace):zt(i,AG)?r=epe(r,s,i.leadingWhitespace):zt(i,NG)?r=tpe(r,s,i.leadingWhitespace):this.ACTION(()=>{throw Error("Operator not supported")})}),r}),this.formula=this.RULE("formula",()=>(this.CONSUME(MN),this.SUBRULE(this.booleanExpression))),this.lexerConfig=e,this.sheetMapping=t,this.formulaAddress=we(0,0,0),this.performSelfAnalysis()}parseFromTokens(e,t){this.input=e;let r=this.formulaWithContext(t),i=[];return this.customParsingError&&i.push(this.customParsingError),i=i.concat(this.errors.map(s=>({type:Pn.ParserError,message:s.message}))),i.length>0&&(r=bN()),{ast:r,errors:i}}reset(){super.reset(),this.customParsingError=void 0}formulaWithContext(e){return this.formulaAddress=e,this.formula()}buildCellRange(e,t,r){if(e.sheet===void 0&&t.sheet!==void 0)return this.parsingError(Pn.ParserError,"Malformed range expression");const{firstEnd:i,secondEnd:s,sheetRefType:o}=td.fixSheetIdsForRangeEnds(e,t);return yF(i,s,o,r)}static fixSheetIdsForRangeEnds(e,t){const r=td.rangeSheetReferenceType(e.sheet,t.sheet),i=e.sheet!==void 0&&t.sheet===void 0?t.withSheet(e.sheet):t;return{firstEnd:e,secondEnd:i,sheetRefType:r}}handleOffsetHeuristic(e){const t=e[0];if(t.type!==M.CELL_REFERENCE)return this.parsingError(Pn.StaticOffsetError,"First argument to OFFSET is not a reference");const r=e[1];let i;if(r.type===M.NUMBER&&Number.isInteger(r.value))i=r.value;else if(r.type===M.PLUS_UNARY_OP&&r.value.type===M.NUMBER&&Number.isInteger(r.value.value))i=r.value.value;else if(r.type===M.MINUS_UNARY_OP&&r.value.type===M.NUMBER&&Number.isInteger(r.value.value))i=-r.value.value;else return this.parsingError(Pn.StaticOffsetError,"Second argument to OFFSET is not a static number");const s=e[2];let o;if(s.type===M.NUMBER&&Number.isInteger(s.value))o=s.value;else if(s.type===M.PLUS_UNARY_OP&&s.value.type===M.NUMBER&&Number.isInteger(s.value.value))o=s.value.value;else if(s.type===M.MINUS_UNARY_OP&&s.value.type===M.NUMBER&&Number.isInteger(s.value.value))o=-s.value.value;else return this.parsingError(Pn.StaticOffsetError,"Third argument to OFFSET is not a static number");const a=e[3];let l;if(a===void 0)l=1;else if(a.type===M.NUMBER){if(l=a.value,l<1)return this.parsingError(Pn.StaticOffsetError,"Fourth argument to OFFSET is too small number");if(!Number.isInteger(l))return this.parsingError(Pn.StaticOffsetError,"Fourth argument to OFFSET is not integer")}else return this.parsingError(Pn.StaticOffsetError,"Fourth argument to OFFSET is not a static number");const u=e[4];let h;if(u===void 0)h=1;else if(u.type===M.NUMBER){if(h=u.value,h<1)return this.parsingError(Pn.StaticOffsetError,"Fifth argument to OFFSET is too small number");if(!Number.isInteger(h))return this.parsingError(Pn.StaticOffsetError,"Fifth argument to OFFSET is not integer")}else return this.parsingError(Pn.StaticOffsetError,"Fifth argument to OFFSET is not a static number");const c=new Xt(t.reference.col+o,t.reference.row+i,t.reference.type);let d=c.col,f=c.row;if((t.reference.type===kt.CELL_REFERENCE_RELATIVE||t.reference.type===kt.CELL_REFERENCE_ABSOLUTE_COL)&&(f=f+this.formulaAddress.row),(t.reference.type===kt.CELL_REFERENCE_RELATIVE||t.reference.type===kt.CELL_REFERENCE_ABSOLUTE_ROW)&&(d=d+this.formulaAddress.col),d<0||f<0)return Go(new E(N.REF,_.OutOfSheet));if(h===1&&l===1)return vF(c);{const g=new Xt(c.col+h-1,c.row+l-1,c.type);return yF(c,g,ms.RELATIVE)}}parsingError(e,t){return this.customParsingError=wF(e,t),bN()}static rangeSheetReferenceType(e,t){return e===void 0?ms.RELATIVE:t===void 0?ms.START_ABSOLUTE:ms.BOTH_ABSOLUTE}}class By{constructor(e){this.lexerConfig=e,this.lexer=new bi(e.allTokens,{ensureOptimizations:!0})}tokenizeFormula(e){const t=this.lexer.tokenize(e);let r=t.tokens;return r=this.trimTrailingWhitespaces(r),r=this.skipWhitespacesInsideRanges(r),r=this.skipWhitespacesBeforeArgSeparators(r),t.tokens=r,t}skipWhitespacesInsideRanges(e){return By.filterTokensByNeighbors(e,(t,r,i)=>(zt(t,zl)||zt(t,ag))&&zt(r,this.lexerConfig.WhiteSpace)&&(zt(i,zl)||zt(i,ag)))}skipWhitespacesBeforeArgSeparators(e){return By.filterTokensByNeighbors(e,(t,r,i)=>!zt(t,this.lexerConfig.ArgSeparator)&&zt(r,this.lexerConfig.WhiteSpace)&&zt(i,this.lexerConfig.ArgSeparator))}static filterTokensByNeighbors(e,t){if(e.length<3)return e;let r=0;const i=[e[r++]];for(;r<e.length-1;)t(e[r-1],e[r],e[r+1])||i.push(e[r]),++r;return i.push(e[r]),i}trimTrailingWhitespaces(e){return e.length>0&&zt(e[e.length-1],this.lexerConfig.WhiteSpace)&&e.pop(),e}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class LG{constructor(e,t,r,i){this.config=e,this.lexerConfig=t,this.sheetMappingFn=r,this.namedExpressions=i}unparse(e,t){return"="+this.unparseAst(e,t)}unparseAst(e,t){var r,i;switch(e.type){case M.EMPTY:return bt("",e.leadingWhitespace);case M.NUMBER:return bt(HG(e.value,this.config.decimalSeparator),e.leadingWhitespace);case M.STRING:return bt('"'+e.value+'"',e.leadingWhitespace);case M.FUNCTION_CALL:{const s=e.args.map(l=>l!==void 0?this.unparseAst(l,t):"").join(this.config.functionArgSeparator),a=(this.config.translationPackage.isFunctionTranslated(e.procedureName)?this.config.translationPackage.getFunctionTranslation(e.procedureName):e.procedureName)+"("+s+bt(")",e.internalWhitespace);return bt(a,e.leadingWhitespace)}case M.NAMED_EXPRESSION:{const s=(r=this.namedExpressions.nearestNamedExpression(e.expressionName,t.sheet))===null||r===void 0?void 0:r.displayName;return bt(s||e.expressionName,e.leadingWhitespace)}case M.CELL_REFERENCE:{let s;return e.reference.sheet!==void 0?s=this.unparseSheetName(e.reference.sheet)+"!":s="",s+=(i=e.reference.unparse(t))!==null&&i!==void 0?i:this.config.translationPackage.getErrorTranslation(N.REF),bt(s,e.leadingWhitespace)}case M.COLUMN_RANGE:case M.ROW_RANGE:case M.CELL_RANGE:return bt(this.formatRange(e,t),e.leadingWhitespace);case M.PLUS_UNARY_OP:{const s=this.unparseAst(e.value,t);return bt("+",e.leadingWhitespace)+s}case M.MINUS_UNARY_OP:{const s=this.unparseAst(e.value,t);return bt("-",e.leadingWhitespace)+s}case M.PERCENT_OP:return this.unparseAst(e.value,t)+bt("%",e.leadingWhitespace);case M.ERROR:{const s=this.config.translationPackage.getErrorTranslation(e.error?e.error.type:N.ERROR);return bt(s,e.leadingWhitespace)}case M.ERROR_WITH_RAW_INPUT:return bt(e.rawInput,e.leadingWhitespace);case M.PARENTHESIS:{const o="("+this.unparseAst(e.expression,t)+bt(")",e.internalWhitespace);return bt(o,e.leadingWhitespace)}case M.ARRAY:{const s="{"+e.args.map(o=>o.map(a=>this.unparseAst(a,t)).join(this.config.arrayColumnSeparator)).join(this.config.arrayRowSeparator)+bt("}",e.internalWhitespace);return bt(s,e.leadingWhitespace)}default:{const s=this.unparseAst(e.left,t),o=this.unparseAst(e.right,t);return s+bt(yG[e.type],e.leadingWhitespace)+o}}}unparseSheetName(e){const t=P$(e,this.sheetMappingFn);if(t===void 0)throw new Rn(e);return t}formatRange(e,t){let r="",i="";e.start.sheet!==void 0&&e.sheetReferenceType!==ms.RELATIVE&&(r=this.unparseSheetName(e.start.sheet)+"!"),e.end.sheet!==void 0&&e.sheetReferenceType===ms.BOTH_ABSOLUTE&&(i=this.unparseSheetName(e.end.sheet)+"!");const s=e.start.unparse(t),o=e.end.unparse(t);return s===void 0||o===void 0?this.config.translationPackage.getErrorTranslation(N.REF):`${r}${s}:${i}${o}`}}function HG(n,e){return n.toString().replace(".",e)}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class xm{constructor(e,t,r){this.config=e,this.functionRegistry=t,this.sheetMapping=r,this.statsCacheUsed=0,this.lexerConfig=QO(e),this.lexer=new By(this.lexerConfig),this.formulaParser=new td(this.lexerConfig,this.sheetMapping),this.cache=new mpe(this.functionRegistry)}parse(e,t){this.formulaAddress=t;const r=this.tokenizeFormula(e);if(r.errors.length>0){const c=r.errors.map(d=>({type:Pn.LexingError,message:d.message}));return{ast:bN(),errors:c,hasVolatileFunction:!1,hasStructuralChangeFunction:!1,dependencies:[]}}const i=this.computeHashFromTokens(r.tokens,t);let s=this.cache.get(i);if(s!==void 0)++this.statsCacheUsed;else{const c=this.bindWhitespacesToTokens(r.tokens),d=this.formulaParser.parseFromTokens(c,t);if(d.errors.length>0)return Object.assign(Object.assign({},d),{hasVolatileFunction:!1,hasStructuralChangeFunction:!1,dependencies:[]});s=this.cache.set(i,d.ast)}const{ast:o,hasVolatileFunction:a,hasStructuralChangeFunction:l}=s,u=this.convertReversedRangesToRegularRanges(o),h=wS(u,this.functionRegistry);return{ast:u,errors:[],hasVolatileFunction:a,hasStructuralChangeFunction:l,dependencies:h}}convertReversedRangesToRegularRanges(e){switch(e.type){case M.EMPTY:case M.NUMBER:case M.STRING:case M.ERROR:case M.ERROR_WITH_RAW_INPUT:case M.CELL_REFERENCE:case M.NAMED_EXPRESSION:return e;case M.CELL_RANGE:{const{start:t,end:r}=e,i=this.orderCellRangeEnds(t,r);return Object.assign(Object.assign({},e),{start:i.start,end:i.end})}case M.COLUMN_RANGE:{const{start:t,end:r}=e,i=this.orderColumnRangeEnds(t,r);return Object.assign(Object.assign({},e),{start:i.start,end:i.end})}case M.ROW_RANGE:{const{start:t,end:r}=e,i=this.orderRowRangeEnds(t,r);return Object.assign(Object.assign({},e),{start:i.start,end:i.end})}case M.PERCENT_OP:case M.PLUS_UNARY_OP:case M.MINUS_UNARY_OP:{const t=this.convertReversedRangesToRegularRanges(e.value);return Object.assign(Object.assign({},e),{value:t})}case M.CONCATENATE_OP:case M.EQUALS_OP:case M.NOT_EQUAL_OP:case M.LESS_THAN_OP:case M.GREATER_THAN_OP:case M.LESS_THAN_OR_EQUAL_OP:case M.GREATER_THAN_OR_EQUAL_OP:case M.MINUS_OP:case M.PLUS_OP:case M.TIMES_OP:case M.DIV_OP:case M.POWER_OP:{const t=this.convertReversedRangesToRegularRanges(e.left),r=this.convertReversedRangesToRegularRanges(e.right);return Object.assign(Object.assign({},e),{left:t,right:r})}case M.PARENTHESIS:{const t=this.convertReversedRangesToRegularRanges(e.expression);return Object.assign(Object.assign({},e),{expression:t})}case M.FUNCTION_CALL:{const t=e.args.map(r=>this.convertReversedRangesToRegularRanges(r));return Object.assign(Object.assign({},e),{args:t})}case M.ARRAY:{const t=e.args.map(r=>r.map(i=>this.convertReversedRangesToRegularRanges(i)));return Object.assign(Object.assign({},e),{args:t})}}}orderCellRangeEnds(e,t){const r=[e,t],[i,s]=r.map(h=>h.toColumnAddress()).sort(ei.compareByAbsoluteAddress(this.formulaAddress)),[o,a]=r.map(h=>h.toRowAddress()).sort(kr.compareByAbsoluteAddress(this.formulaAddress)),[l,u]=r.map(h=>h.sheet).sort(xm.compareSheetIds.bind(this));return{start:Xt.fromColAndRow(i,o,l),end:Xt.fromColAndRow(s,a,u)}}orderColumnRangeEnds(e,t){const r=[e,t],[i,s]=r.sort(ei.compareByAbsoluteAddress(this.formulaAddress)),[o,a]=r.map(l=>l.sheet).sort(xm.compareSheetIds.bind(this));return{start:new ei(i.type,i.col,o),end:new ei(s.type,s.col,a)}}orderRowRangeEnds(e,t){const r=[e,t],[i,s]=r.sort(kr.compareByAbsoluteAddress(this.formulaAddress)),[o,a]=r.map(l=>l.sheet).sort(xm.compareSheetIds.bind(this));return{start:new kr(i.type,i.row,o),end:new kr(s.type,s.row,a)}}static compareSheetIds(e,t){return e=e??1/0,t=t??1/0,e-t}fetchCachedResultForAst(e){const t=this.computeHashFromAst(e);return this.fetchCachedResult(t)}fetchCachedResult(e){const t=this.cache.get(e);if(t===void 0)throw new Error("There is no AST with such key in the cache");{const{ast:r,hasVolatileFunction:i,hasStructuralChangeFunction:s,relativeDependencies:o}=t;return{ast:r,errors:[],hasVolatileFunction:i,hasStructuralChangeFunction:s,dependencies:o}}}computeHashFromTokens(e,t){var r;let i="",s=0;for(;s<e.length;){const o=e[s];if(zt(o,zl)){const a=$c(this.sheetMapping,o.image,t);a===void 0?i=i.concat(o.image):i=i.concat(a.hash(!0))}else if(zt(o,XO)){const a=o.image.toUpperCase().slice(0,-1),l=(r=this.lexerConfig.functionMapping[a])!==null&&r!==void 0?r:a;i=i.concat(l,"(")}else if(zt(o,KO)){const[a,l]=o.image.split(":"),u=My(this.sheetMapping,a,t),h=My(this.sheetMapping,l,t);u===void 0||h===void 0?i=i.concat("!REF"):i=i.concat(u.hash(!0),":",h.hash(!0))}else if(zt(o,qO)){const[a,l]=o.image.split(":"),u=Iy(this.sheetMapping,a,t),h=Iy(this.sheetMapping,l,t);u===void 0||h===void 0?i=i.concat("!REF"):i=i.concat(u.hash(!0),":",h.hash(!0))}else i=i.concat(o.image);s++}return i}rememberNewAst(e){const t=this.computeHashFromAst(e);return this.cache.maybeSetAndThenGet(t,e)}computeHashFromAst(e){return"="+this.computeHashOfAstNode(e)}computeHashOfAstNode(e){switch(e.type){case M.EMPTY:return e.leadingWhitespace||"";case M.NUMBER:return bt(HG(e.value,this.config.decimalSeparator),e.leadingWhitespace);case M.STRING:return bt('"'+e.value+'"',e.leadingWhitespace);case M.NAMED_EXPRESSION:return bt(e.expressionName,e.leadingWhitespace);case M.FUNCTION_CALL:{const t=e.args.map(i=>this.computeHashOfAstNode(i)).join(this.config.functionArgSeparator),r=e.procedureName+"("+t+bt(")",e.internalWhitespace);return bt(r,e.leadingWhitespace)}case M.CELL_REFERENCE:return bt(e.reference.hash(!0),e.leadingWhitespace);case M.COLUMN_RANGE:case M.ROW_RANGE:case M.CELL_RANGE:{const t=e.start.hash(e.sheetReferenceType!==ms.RELATIVE),r=e.end.hash(e.sheetReferenceType===ms.BOTH_ABSOLUTE);return bt(t+":"+r,e.leadingWhitespace)}case M.MINUS_UNARY_OP:return bt("-"+this.computeHashOfAstNode(e.value),e.leadingWhitespace);case M.PLUS_UNARY_OP:return bt("+"+this.computeHashOfAstNode(e.value),e.leadingWhitespace);case M.PERCENT_OP:return this.computeHashOfAstNode(e.value)+bt("%",e.leadingWhitespace);case M.ERROR:{const t=this.config.translationPackage.getErrorTranslation(e.error?e.error.type:N.ERROR);return bt(t,e.leadingWhitespace)}case M.ERROR_WITH_RAW_INPUT:return bt(e.rawInput,e.leadingWhitespace);case M.ARRAY:{const t=e.args.map(r=>r.map(i=>this.computeHashOfAstNode(i)).join(",")).join(";");return bt("{"+t+bt("}",e.internalWhitespace),e.leadingWhitespace)}case M.PARENTHESIS:{const r="("+this.computeHashOfAstNode(e.expression)+bt(")",e.internalWhitespace);return bt(r,e.leadingWhitespace)}default:return this.computeHashOfAstNode(e.left)+bt(yG[e.type],e.leadingWhitespace)+this.computeHashOfAstNode(e.right)}}bindWhitespacesToTokens(e){const t=[],r=e[0];zt(r,this.lexerConfig.WhiteSpace)||t.push(r);for(let i=1;i<e.length;++i){const s=e[i];if(zt(s,this.lexerConfig.WhiteSpace))continue;const o=e[i-1];zt(o,this.lexerConfig.WhiteSpace)&&(s.leadingWhitespace=o),t.push(s)}return t}tokenizeFormula(e){return this.lexer.tokenizeFormula(e)}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const Gc=(n,e,t,r)=>{switch(n.type){case M.EMPTY:case M.NUMBER:case M.STRING:case M.ERROR:return;case M.NAMED_EXPRESSION:{r&&t.push(new za(n.expressionName));return}case M.CELL_REFERENCE:{r&&t.push(new DG(n.reference));return}case M.CELL_RANGE:{r&&n.start.sheet===n.end.sheet&&t.push(new wpe(n.start,n.end));return}case M.COLUMN_RANGE:{r&&n.start.sheet===n.end.sheet&&t.push(new vpe(n.start,n.end));return}case M.ROW_RANGE:{r&&n.start.sheet===n.end.sheet&&t.push(new ype(n.start,n.end));return}case M.PERCENT_OP:case M.PLUS_UNARY_OP:case M.MINUS_UNARY_OP:{Gc(n.value,e,t,!0);return}case M.CONCATENATE_OP:case M.EQUALS_OP:case M.NOT_EQUAL_OP:case M.LESS_THAN_OP:case M.GREATER_THAN_OP:case M.LESS_THAN_OR_EQUAL_OP:case M.GREATER_THAN_OR_EQUAL_OP:case M.MINUS_OP:case M.PLUS_OP:case M.TIMES_OP:case M.DIV_OP:case M.POWER_OP:Gc(n.left,e,t,!0),Gc(n.right,e,t,!0);return;case M.PARENTHESIS:Gc(n.expression,e,t,r);return;case M.FUNCTION_CALL:{const i=!e.doesFunctionNeedArgumentToBeComputed(n.procedureName);n.args.forEach(s=>Gc(s,e,t,i));return}}},wS=(n,e)=>{const t=new Array;return Gc(n,e,t,!0),t};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class DG{constructor(e){this.dependency=e}absolutize(e){return this.dependency.toSimpleCellAddress(e)}}class wpe{constructor(e,t){this.start=e,this.end=t}absolutize(e){return new _e(this.start.toSimpleCellAddress(e),this.end.toSimpleCellAddress(e))}}class vpe{constructor(e,t){this.start=e,this.end=t}absolutize(e){const t=this.start.toSimpleColumnAddress(e),r=this.end.toSimpleColumnAddress(e);return new qa(t.sheet,t.col,r.col)}}class ype{constructor(e,t){this.start=e,this.end=t}absolutize(e){const t=this.start.toSimpleRowAddress(e),r=this.end.toSimpleRowAddress(e);return new Xa(t.sheet,t.row,r.row)}}class za{constructor(e){this.name=e}absolutize(e){return this}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const jo=(n,e)=>n.map(t=>t.absolutize(e)),Cpe=n=>n.filter(e=>e instanceof za?!0:e instanceof _e?!(Ri(e.start)||Ri(e.end)):!Ri(e));/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const ht=Symbol("Empty value");function me(n){return n instanceof ca?n.val:n}class ca{constructor(e,t){this.val=e,this.format=t}fromNumber(e){return new this.constructor(e)}}function ZO(n,e){if(typeof n=="number")return e;{const t=n.fromNumber(e);return t.format=n.format,t}}class JO extends ca{getDetailedType(){return Te.NUMBER_DATE}}class ON extends ca{getDetailedType(){return Te.NUMBER_CURRENCY}}class e_ extends ca{getDetailedType(){return Te.NUMBER_TIME}}class t_ extends ca{getDetailedType(){return Te.NUMBER_DATETIME}}class Ev extends ca{getDetailedType(){return Te.NUMBER_PERCENT}}function It(n){return typeof n=="number"||n instanceof ca}var Te;(function(n){n.NUMBER_RAW="NUMBER_RAW",n.NUMBER_DATE="NUMBER_DATE",n.NUMBER_TIME="NUMBER_TIME",n.NUMBER_DATETIME="NUMBER_DATETIME",n.NUMBER_CURRENCY="NUMBER_CURRENCY",n.NUMBER_PERCENT="NUMBER_PERCENT"})(Te||(Te={}));function Spe(n){return n instanceof ca?n.getDetailedType():Te.NUMBER_RAW}function Rpe(n){if(n instanceof ca)return n.format}function Wy(n){return n instanceof ca?{type:n.getDetailedType(),format:n.format}:{type:Te.NUMBER_RAW}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class Ae{constructor(e,t,r,i){this._data=e,this.range=t,this.dependencyGraph=r,this._hasOnlyNumbers=i,this.size=e===void 0?new gt(t.effectiveWidth(r),t.effectiveHeight(r)):new gt(e[0].length,e.length)}get data(){return this.ensureThatComputed(),this._data}static fromRange(e,t,r){return new Ae(e,t,r,!0)}static onlyNumbers(e){return new Ae(e,void 0,void 0,!0)}static onlyValues(e){return new Ae(e,void 0,void 0,void 0)}static onlyRange(e,t){return new Ae(void 0,e,t,void 0)}static fromScalar(e){return new Ae([[e]],void 0,void 0,void 0)}isAdHoc(){return this.range===void 0}width(){return this.size.width}height(){return this.size.height}valuesFromTopLeftCorner(){this.ensureThatComputed();const e=[];for(let t=0;t<this._data.length;t++)for(let r=0;r<this._data[0].length;r++)e.push(this._data[t][r]);return e}*effectiveAddressesFromData(e){for(let t=0;t<this.data.length;++t){const r=this.data[t];for(let i=0;i<r.length;++i)yield we(e.sheet,e.col+i,e.row+t)}}*entriesFromTopLeftCorner(e){this.ensureThatComputed();for(let t=0;t<this.size.height;++t)for(let r=0;r<this.size.width;++r)yield[this._data[t][r],we(e.sheet,e.col+r,e.row+t)]}*iterateValuesFromTopLeftCorner(){yield*this.valuesFromTopLeftCorner()}numberOfElements(){return this.size.width*this.size.height}hasOnlyNumbers(){if(this._hasOnlyNumbers===void 0){this._hasOnlyNumbers=!0;for(const e of this.data)for(const t of e)if(typeof t!="number")return this._hasOnlyNumbers=!1,!1}return this._hasOnlyNumbers}rawNumbers(){return this._data}rawData(){var e;return this.ensureThatComputed(),(e=this._data)!==null&&e!==void 0?e:[]}sameDimensionsAs(e){return this.width()===e.width()&&this.height()===e.height()}ensureThatComputed(){this._data===void 0&&(this._hasOnlyNumbers=!0,this._data=this.range.addressesArrayMap(this.dependencyGraph,e=>{const t=this.dependencyGraph.getCellValue(e);return t instanceof Ae?(this._hasOnlyNumbers=!1,new E(N.VALUE,_.ScalarExpected)):(It(t)||(this._hasOnlyNumbers=!1),t)}))}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class Jl{constructor(){this.changes=new Map}static empty(){return new Jl}addAll(e){for(const t of e.changes.values())this.add(t.address,t);return this}addChange(e,t,r){this.addInterpreterValue(e,t,r)}exportChanges(e){let t=[];return this.changes.forEach(r=>{const i=e.exportChange(r);Array.isArray(i)?t=t.concat(i):t.push(i)}),t}getChanges(){return Array.from(this.changes.values())}isEmpty(){return this.changes.size===0}add(e,t){const r=t.value;if(r instanceof Ae)for(const i of r.effectiveAddressesFromData(e))this.changes.delete(Lm(i));this.changes.set(Lm(e),t)}addInterpreterValue(e,t,r){this.add(t,{address:t,value:e,oldValue:r})}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class Ei{constructor(e,t,r){if(this.sheet=e,this.rowStart=t,this.rowEnd=r,t<0)throw Error("Starting row cant be less than 0");if(r<t)throw Error("Row span cant end before start")}get numberOfRows(){return this.rowEnd-this.rowStart+1}get start(){return this.rowStart}get end(){return this.rowEnd}static fromNumberOfRows(e,t,r){return new Ei(e,t,t+r-1)}static fromRowStartAndEnd(e,t,r){return new Ei(e,t,r)}*rows(){for(let e=this.rowStart;e<=this.rowEnd;++e)yield e}intersect(e){if(this.sheet!==e.sheet)throw Error("Can't intersect spans from different sheets");const t=Math.max(this.rowStart,e.rowStart),r=Math.min(this.rowEnd,e.rowEnd);return t>r?null:new Ei(this.sheet,t,r)}firstRow(){return new Ei(this.sheet,this.rowStart,this.rowStart)}}class Ui{constructor(e,t,r){if(this.sheet=e,this.columnStart=t,this.columnEnd=r,t<0)throw Error("Starting column cant be less than 0");if(r<t)throw Error("Column span cant end before start")}get numberOfColumns(){return this.columnEnd-this.columnStart+1}get start(){return this.columnStart}get end(){return this.columnEnd}static fromNumberOfColumns(e,t,r){return new Ui(e,t,t+r-1)}static fromColumnStartAndEnd(e,t,r){return new Ui(e,t,r)}*columns(){for(let e=this.columnStart;e<=this.columnEnd;++e)yield e}intersect(e){if(this.sheet!==e.sheet)throw Error("Can't intersect spans from different sheets");const t=Math.max(this.columnStart,e.columnStart),r=Math.min(this.columnEnd,e.columnEnd);return t>r?null:new Ui(this.sheet,t,r)}firstColumn(){return new Ui(this.sheet,this.columnStart,this.columnStart)}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */var Ke;(function(n){n.BUILD_ENGINE_TOTAL="BUILD_ENGINE_TOTAL",n.PARSER="PARSER",n.GRAPH_BUILD="GRAPH_BUILD",n.COLLECT_DEPENDENCIES="COLLECT_DEPENDENCIES",n.PROCESS_DEPENDENCIES="PROCESS_DEPENDENCIES",n.TOP_SORT="TOP_SORT",n.BUILD_COLUMN_INDEX="BUILD_COLUMN_INDEX",n.EVALUATION="EVALUATION",n.VLOOKUP="VLOOKUP",n.TRANSFORM_ASTS="TRANSFORM_ASTS",n.TRANSFORM_ASTS_POSTPONED="TRANSFORM_ASTS_POSTPONED",n.ADJUSTING_ADDRESS_MAPPING="ADJUSTING_ADDRESS_MAPPING",n.ADJUSTING_ARRAY_MAPPING="ADJUSTING_ARRAY_MAPPING",n.ADJUSTING_RANGES="ADJUSTING_RANGES",n.ADJUSTING_GRAPH="ADJUSTING_GRAPH",n.CRITERION_FUNCTION_FULL_CACHE_USED="CRITERION_FUNCTION_FULL_CACHE_USED",n.CRITERION_FUNCTION_PARTIAL_CACHE_USED="CRITERION_FUNCTION_PARTIAL_CACHE_USED"})(Ke||(Ke={}));/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class FG{constructor(){this.stats=new Map([[Ke.CRITERION_FUNCTION_FULL_CACHE_USED,0],[Ke.CRITERION_FUNCTION_PARTIAL_CACHE_USED,0]]),this.startTimes=new Map}incrementCriterionFunctionFullCacheUsed(){var e;const t=((e=this.stats.get(Ke.CRITERION_FUNCTION_FULL_CACHE_USED))!==null&&e!==void 0?e:0)+1;this.stats.set(Ke.CRITERION_FUNCTION_FULL_CACHE_USED,t)}incrementCriterionFunctionPartialCacheUsed(){var e;const t=((e=this.stats.get(Ke.CRITERION_FUNCTION_PARTIAL_CACHE_USED))!==null&&e!==void 0?e:0)+1;this.stats.set(Ke.CRITERION_FUNCTION_PARTIAL_CACHE_USED,t)}reset(){this.stats.clear(),this.startTimes.clear(),this.stats.set(Ke.CRITERION_FUNCTION_FULL_CACHE_USED,0),this.stats.set(Ke.CRITERION_FUNCTION_PARTIAL_CACHE_USED,0)}start(e){if(this.startTimes.get(e))throw Error(`Statistics ${e} already started`);this.startTimes.set(e,Date.now())}end(e){var t;const r=Date.now(),i=this.startTimes.get(e);if(i){let s=(t=this.stats.get(e))!==null&&t!==void 0?t:0;s+=r-i,this.stats.set(e,s),this.startTimes.delete(e)}else throw Error(`Statistics ${e} not started`)}measure(e,t){this.start(e);const r=t();return this.end(e),r}snapshot(){return new Map(this.stats)}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class Epe extends FG{incrementCriterionFunctionFullCacheUsed(){}incrementCriterionFunctionPartialCacheUsed(){}start(e){}end(e){}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class Rn extends Error{constructor(e){super(`There's no sheet with id = ${e}`)}}class kG extends Error{constructor(e){super(`There's no sheet with name '${e}'`)}}class lg extends Error{constructor(e){super(`Sheet with name ${e} already exists`)}}class Sh extends Error{constructor(){super("Sheet size limit exceeded")}}class bv extends Error{constructor(){super("This is not a formula")}}class VG extends Error{constructor(e){super(`Address (row = ${e.row}, col = ${e.col}) is invalid`)}}class Kn extends Error{constructor(e){super(`Invalid arguments, expected ${e}`)}}class ug extends Error{constructor(e,t){super(`Sheets ${e} and ${t} are not equal.`)}}class UG extends Error{constructor(e){super(`Name of Named Expression '${e}' is already present`)}}class BG extends Error{constructor(e){super(`Name of Named Expression '${e}' is invalid`)}}class hg extends Error{constructor(e){super(`Named Expression '${e}' does not exist`)}}class WG extends Error{constructor(){super("There is no operation to undo")}}class $G extends Error{constructor(){super("There is no operation to redo")}}class GG extends Error{constructor(){super("There is nothing to paste")}}function bpe(n,e){switch(typeof e){case"function":case"symbol":return e.toString();case"bigint":return"BigInt("+e.toString()+")";default:return e instanceof RegExp?"RegExp("+e.toString()+")":e}}class jG extends Error{constructor(e){super(`Unable to parse value: ${JSON.stringify(e,bpe,4)}`)}}class Nt extends Error{constructor(e,t){super(`Expected value of type: ${e} for config parameter: ${t}`)}}class Tpe extends Error{constructor(e){super(`Config parameter ${e} cannot be empty.`)}}class zG extends Error{constructor(e,t){super(`Config parameter ${e} should be at least ${t}`)}}class YG extends Error{constructor(e,t){super(`Config parameter ${e} should be at most ${t}`)}}class KG extends Error{constructor(e,t){super(`Expected one of ${e} for config parameter: ${t}`)}}class qG extends Error{constructor(){super("Computations are suspended")}}class jc extends Error{constructor(e){super(`Translation for ${e} is missing in the translation package you're using.`)}}class XG extends Error{constructor(e){super(`Cannot register translation for function with id: ${e}`)}}class _N extends Error{constructor(){super("Language not registered.")}}class QG extends Error{constructor(){super("Language already registered.")}}class Td extends Error{static functionNotDeclaredInPlugin(e,t){return new Td(`Function with id ${e} not declared in plugin ${t}`)}static functionMethodNotFound(e,t){return new Td(`Function method ${e} not found in plugin ${t}`)}}class Rh extends Error{static cannotRegisterFunctionWithId(e){return new Rh(`Cannot register function with id ${e}`)}static cannotUnregisterFunctionWithId(e){return new Rh(`Cannot unregister function with id ${e}`)}static cannotUnregisterProtectedPlugin(){return new Rh("Cannot unregister protected plugin")}}class nd extends Error{constructor(){super("Cannot perform this operation, source location has an array inside.")}}class $y extends Error{constructor(){super("Cannot perform this operation, target location has an array inside.")}}class n_ extends Error{constructor(){super("Relative addresses not allowed in named expressions.")}}class Ape extends Error{constructor(e,t){super(`Alias id ${e} in plugin ${t} already defined as a function or alias.`)}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class Npe{constructor(e){this.policy=e,this.mapping=new Map}getCell(e){const t=this.mapping.get(e.sheet);if(t===void 0)throw new Rn(e.sheet);return t.getCell(e)}fetchCell(e){const t=this.mapping.get(e.sheet);if(t===void 0)throw new Rn(e.sheet);const r=t.getCell(e);if(!r)throw Error("Vertex for address missing in AddressMapping");return r}strategyFor(e){const t=this.mapping.get(e);if(t===void 0)throw new Rn(e);return t}addSheet(e,t){if(this.mapping.has(e))throw Error("Sheet already added");this.mapping.set(e,t)}autoAddSheet(e,t){const{height:r,width:i,fill:s}=t,o=this.policy.call(s);this.addSheet(e,new o(i,r))}getCellValue(e){const t=this.getCell(e);return t===void 0?ht:t instanceof Bn?t.getArrayCellValue(e):t.getCellValue()}getRawValue(e){const t=this.getCell(e);return t instanceof eu?t.getValues().rawValue:t instanceof Bn?t.getArrayCellRawValue(e):null}setCell(e,t){const r=this.mapping.get(e.sheet);if(!r)throw Error("Sheet not initialized");r.setCell(e,t)}moveCell(e,t){const r=this.mapping.get(e.sheet);if(!r)throw Error("Sheet not initialized.");if(e.sheet!==t.sheet)throw Error("Cannot move cells between sheets.");if(r.has(t))throw new Error("Cannot move cell. Destination already occupied.");const i=r.getCell(e);if(i===void 0)throw new Error("Cannot move cell. No cell with such address.");this.setCell(t,i),this.removeCell(e)}removeCell(e){const t=this.mapping.get(e.sheet);if(!t)throw Error("Sheet not initialized");t.removeCell(e)}has(e){const t=this.mapping.get(e.sheet);return t===void 0?!1:t.has(e)}getHeight(e){const t=this.mapping.get(e);if(t===void 0)throw new Rn(e);return t.getHeight()}getWidth(e){const t=this.mapping.get(e);if(!t)throw new Rn(e);return t.getWidth()}addRows(e,t,r){const i=this.mapping.get(e);if(i===void 0)throw new Rn(e);i.addRows(t,r)}removeRows(e){const t=this.mapping.get(e.sheet);if(t===void 0)throw new Rn(e.sheet);t.removeRows(e)}removeSheet(e){this.mapping.delete(e)}addColumns(e,t,r){const i=this.mapping.get(e);if(i===void 0)throw new Rn(e);i.addColumns(t,r)}removeColumns(e){const t=this.mapping.get(e.sheet);if(t===void 0)throw new Rn(e.sheet);t.removeColumns(e)}*verticesFromRowsSpan(e){yield*this.mapping.get(e.sheet).verticesFromRowsSpan(e)}*verticesFromColumnsSpan(e){yield*this.mapping.get(e.sheet).verticesFromColumnsSpan(e)}*entriesFromRowsSpan(e){yield*this.mapping.get(e.sheet).entriesFromRowsSpan(e)}*entriesFromColumnsSpan(e){yield*this.mapping.get(e.sheet).entriesFromColumnsSpan(e)}*entries(){for(const[e,t]of this.mapping.entries())yield*t.getEntries(e)}*sheetEntries(e){const t=this.mapping.get(e);if(t!==void 0)yield*t.getEntries(e);else throw new Rn(e)}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class Mpe{constructor(){this.arrayMapping=new Map}getArray(e){const t=this.getArrayByCorner(e.start);if(t?.getRange().sameAs(e))return t}getArrayByCorner(e){return this.arrayMapping.get(Lm(e))}setArray(e,t){this.arrayMapping.set(Lm(e.start),t)}removeArray(e){typeof e=="string"?this.arrayMapping.delete(e):this.arrayMapping.delete(Lm(e.start))}count(){return this.arrayMapping.size}*arraysInRows(e){for(const[t,r]of this.arrayMapping.entries())r.spansThroughSheetRows(e.sheet,e.rowStart,e.rowEnd)&&(yield[t,r])}*arraysInCols(e){for(const[t,r]of this.arrayMapping.entries())r.spansThroughSheetColumn(e.sheet,e.columnStart,e.columnEnd)&&(yield[t,r])}isFormulaArrayInRow(e,t){for(const r of this.arrayMapping.values())if(r.spansThroughSheetRows(e,t))return!0;return!1}isFormulaArrayInAllRows(e){let t=!0;for(const r of e.rows())this.isFormulaArrayInRow(e.sheet,r)||(t=!1);return t}isFormulaArrayInColumn(e,t){for(const r of this.arrayMapping.values())if(r.spansThroughSheetColumn(e,t))return!0;return!1}isFormulaArrayInAllColumns(e){let t=!0;for(const r of e.columns())this.isFormulaArrayInColumn(e.sheet,r)||(t=!1);return t}isFormulaArrayInRange(e){for(const t of this.arrayMapping.values())if(t.getRange().doesOverlap(e))return!0;return!1}isFormulaArrayAtAddress(e){for(const t of this.arrayMapping.values())if(t.getRange().addressInRange(e))return!0;return!1}moveArrayVerticesAfterRowByRows(e,t,r){this.updateArrayVerticesInSheet(e,(i,s)=>{const o=s.getRange();return t<=o.start.row?[o.shifted(0,r),s]:void 0})}moveArrayVerticesAfterColumnByColumns(e,t,r){this.updateArrayVerticesInSheet(e,(i,s)=>{const o=s.getRange();return t<=o.start.col?[o.shifted(r,0),s]:void 0})}updateArrayVerticesInSheet(e,t){const r=Array();for(const[i,s]of this.arrayMapping.entries()){if(s.sheet!==e)continue;const o=t(i,s);o!==void 0&&(this.removeArray(i),r.push(o))}r.forEach(([i,s])=>{this.setArray(i,s)})}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class tm{constructor(e){this.size=e}width(){return this.size.width}height(){return this.size.height}get(e,t){throw Error("Array not computed yet.")}simpleRangeValue(){throw Error("Array not computed yet.")}}class Ad{constructor(e){if(this.size=new gt(e.length>0?e[0].length:0,e.length),this.array=e,this.size.width<=0||this.size.height<=0)throw Error("Incorrect array size")}static fromInterpreterValue(e){return e instanceof Ae?new Ad(e.data):new Ad([[e]])}simpleRangeValue(){return Ae.onlyValues(this.array)}addRows(e,t){this.array.splice(e,0,...this.nullArrays(t,this.width())),this.size.height+=t}addColumns(e,t){for(let r=0;r<this.height();r++)this.array[r].splice(e,0,...new Array(t).fill(ht));this.size.width+=t}removeRows(e,t){if(this.outOfBound(0,e)||this.outOfBound(0,t))throw Error("Array index out of bound");const r=t-e+1;this.array.splice(e,r),this.size.height-=r}removeColumns(e,t){if(this.outOfBound(e,0)||this.outOfBound(t,0))throw Error("Array index out of bound");const r=t-e+1;for(const i of this.array)i.splice(e,r);this.size.width-=r}nullArrays(e,t){const r=[];for(let i=0;i<e;++i)r.push(new Array(t).fill(ht));return r}get(e,t){if(this.outOfBound(e,t))throw Error("Array index out of bound");return this.array[t][e]}set(e,t,r){if(this.outOfBound(e,t))throw Error("Array index out of bound");this.array[t][e]=r}width(){return this.size.width}height(){return this.size.height}raw(){return this.array}resize(e){if(this.height()<e.height&&isFinite(e.height)&&this.addRows(this.height(),e.height-this.height()),this.height()>e.height||(this.width()<e.width&&isFinite(e.width)&&this.addColumns(this.width(),e.width-this.width()),this.width()>e.width))throw Error("Resizing to smaller array")}outOfBound(e,t){return e<0||t<0||t>this.size.height-1||e>this.size.width-1}}class rA{constructor(e,t){this.error=e,this.size=t}get(e,t){return this.error}width(){return this.size.width}height(){return this.size.height}simpleRangeValue(){return this.error}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class Bi{constructor(e,t,r){this.formula=e,this.cellAddress=t,this.version=r}get width(){return 1}get height(){return 1}static fromAst(e,t,r,i){return r.isScalar()?new Zo(e,t,i):new Bn(e,t,r,i)}getFormula(e){return this.ensureRecentData(e),this.formula}ensureRecentData(e){if(this.version!=e.version()){const[t,r,i]=e.applyTransformations(this.formula,this.cellAddress,this.version);this.formula=t,this.cellAddress=r,this.version=i}}getAddress(e){return this.ensureRecentData(e),this.cellAddress}}class Bn extends Bi{constructor(e,t,r,i=0){super(e,t,i),r.isRef?this.array=new rA(new E(N.REF,_.NoSpaceForArrayResult),gt.error()):this.array=new tm(r)}get width(){return this.array.width()}get height(){return this.array.height()}get sheet(){return this.cellAddress.sheet}get leftCorner(){return this.cellAddress}setCellValue(e){if(e instanceof E)return this.setErrorValue(e),e;const t=Ad.fromInterpreterValue(e);return t.resize(this.array.size),this.array=t,e}getCellValue(){if(this.array instanceof tm)throw Error("Array not computed yet.");return this.array.simpleRangeValue()}valueOrUndef(){if(!(this.array instanceof tm))return this.array.simpleRangeValue()}getArrayCellValue(e){const t=e.col-this.cellAddress.col,r=e.row-this.cellAddress.row;try{return this.array.get(t,r)}catch{return new E(N.REF)}}getArrayCellRawValue(e){const t=this.getArrayCellValue(e);if(!(t instanceof E||t===ht))return me(t)}setArrayCellValue(e,t){const r=e.col-this.cellAddress.col,i=e.row-this.cellAddress.row;this.array instanceof Ad&&this.array.set(r,i,t)}setNoSpace(){return this.array=new rA(new E(N.SPILL,_.NoSpaceForArrayResult),gt.error()),this.getCellValue()}getRange(){return _e.spanFrom(this.cellAddress,this.width,this.height)}getRangeOrUndef(){return _e.spanFromOrUndef(this.cellAddress,this.width,this.height)}setAddress(e){this.cellAddress=e}setFormula(e){this.formula=e}spansThroughSheetRows(e,t,r=t){return this.cellAddress.sheet===e&&this.cellAddress.row<=r&&t<this.cellAddress.row+this.height}spansThroughSheetColumn(e,t,r=t){return this.cellAddress.sheet===e&&this.cellAddress.col<=r&&t<this.cellAddress.col+this.width}isComputed(){return!(this.array instanceof tm)}columnsFromArray(){return Ui.fromNumberOfColumns(this.cellAddress.sheet,this.cellAddress.col,this.width)}rowsFromArray(){return Ei.fromNumberOfRows(this.cellAddress.sheet,this.cellAddress.row,this.height)}ensureRecentData(e){}isLeftCorner(e){return dg(this.cellAddress,e)}setErrorValue(e){this.array=new rA(e,this.array.size)}}class Zo extends Bi{constructor(e,t,r){super(e,t,r)}valueOrUndef(){return this.cachedCellValue}setCellValue(e){return this.cachedCellValue=e,this.cachedCellValue}getCellValue(){if(this.cachedCellValue!==void 0)return this.cachedCellValue;throw Error("Value of the formula cell is not computed.")}isComputed(){return this.cachedCellValue!==void 0}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class Fr{constructor(e){this.range=e,this.functionCache=new Map,this.criterionFunctionCache=new Map,this.dependentCacheRanges=new Set,this.bruteForce=!1}get start(){return this.range.start}get end(){return this.range.end}get sheet(){return this.range.start.sheet}getFunctionValue(e){return this.functionCache.get(e)}setFunctionValue(e,t){this.functionCache.set(e,t)}getCriterionFunctionValue(e,t){var r;return(r=this.getCriterionFunctionValues(e).get(t))===null||r===void 0?void 0:r[0]}getCriterionFunctionValues(e){var t;return(t=this.criterionFunctionCache.get(e))!==null&&t!==void 0?t:new Map}setCriterionFunctionValues(e,t){this.criterionFunctionCache.set(e,t)}addDependentCacheRange(e){e!==this&&this.dependentCacheRanges.add(e)}clearCache(){this.functionCache.clear(),this.criterionFunctionCache.clear(),this.dependentCacheRanges.forEach(e=>e.criterionFunctionCache.clear()),this.dependentCacheRanges.clear()}getStart(){return this.start}getEnd(){return this.end}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const Ipe=(n,e,t,r,i)=>{if(e instanceof Fr){const a=e.range.intersectionWith(t);return a!==void 0?Array.from(a.addresses(i)):[]}let s,o;if(e instanceof Bi)s=e.getFormula(r),o=e.getAddress(r);else return[];return wS(s,n).filter(a=>a instanceof DG).map(a=>a.dependency.toSimpleCellAddress(o)).filter(a=>t.addressInRange(a))};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */var Da;(function(n){n[n.ON_STACK=0]="ON_STACK",n[n.PROCESSED=1]="PROCESSED",n[n.POPPED=2]="POPPED"})(Da||(Da={}));class Ope{constructor(e=[],t=[]){this.nodesSparseArray=e,this.edgesSparseArray=t,this.entranceTime=[],this.low=[],this.parent=[],this.inSCC=[],this.nodeStatus=[],this.order=[],this.sccNonSingletons=[],this.timeCounter=0}getTopSortedWithSccSubgraphFrom(e,t,r){const i=e.reverse();return i.forEach(s=>this.runDFS(s)),this.postprocess(i,r,t)}getAdjacentNodeIds(e){return this.edgesSparseArray[e].filter(t=>t!==void 0&&this.nodesSparseArray[t])}runDFS(e){if(this.nodeStatus[e]!==void 0)return;this.nodeStatus[e]=Da.ON_STACK;const t=[e],r=[];for(;t.length>0;){const i=t[t.length-1];switch(this.nodeStatus[i]){case Da.ON_STACK:{this.handleOnStack(i,r,t);break}case Da.PROCESSED:{this.handleProcessed(i,r,t);break}case Da.POPPED:{t.pop();break}}}}handleOnStack(e,t,r){this.entranceTime[e]=this.timeCounter,this.low[e]=this.timeCounter,this.timeCounter++,t.push(e),this.getAdjacentNodeIds(e).forEach(i=>{this.entranceTime[i]===void 0&&(r.push(i),this.parent[i]=e,this.nodeStatus[i]=Da.ON_STACK)}),this.nodeStatus[e]=Da.PROCESSED}handleProcessed(e,t,r){let i=this.entranceTime[e];if(this.getAdjacentNodeIds(e).forEach(s=>{this.inSCC[s]||(i=this.parent[s]===e?Math.min(i,this.low[s]):Math.min(i,this.entranceTime[s]))}),this.low[e]=i,i===this.entranceTime[e]){const s=[];do s.push(t[t.length-1]),t.pop();while(s[s.length-1]!==e);s.forEach(o=>{this.inSCC[o]=!0}),this.order.push(...s),s.length>1&&s.forEach(o=>{this.sccNonSingletons[o]=!0})}r.pop(),this.nodeStatus[e]=Da.POPPED}postprocess(e,t,r){const i=[];e.forEach(a=>{i[a]=!0});const s=[],o=[];return this.order.reverse(),this.order.forEach(a=>{const l=this.getAdjacentNodeIds(a);this.sccNonSingletons[a]||l.includes(a)?(o.push(this.nodesSparseArray[a]),t(this.nodesSparseArray[a]),l.forEach(u=>i[u]=!0)):(s.push(this.nodesSparseArray[a]),i[a]&&r(this.nodesSparseArray[a])&&l.forEach(u=>i[u]=!0))}),{sorted:s,cycled:o}}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class _pe{constructor(e,t){this.rawValue=e,this.processFn=t,this.processedValue=null}getProcessedValue(){return this.processedValue===null&&(this.processedValue=this.processFn(this.rawValue)),this.processedValue}markAsModified(){this.processedValue=null}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class Ppe{constructor(e){this.dependencyQuery=e,this.nodesSparseArray=[],this.edgesSparseArray=[],this.nodesIds=new Map,this.dirtyAndVolatileNodeIds=new _pe({dirty:[],volatile:[]},t=>this.processDirtyAndVolatileNodeIds(t)),this.infiniteRangeIds=new Set,this.changingWithStructureNodeIds=[],this.nextId=0}getNodes(){return this.nodesSparseArray.filter(e=>e!==void 0)}hasNode(e){return this.nodesIds.has(e)}existsEdge(e,t){const r=this.getNodeId(e),i=this.getNodeId(t);return r===void 0||i===void 0?!1:this.edgesSparseArray[r].includes(i)}adjacentNodes(e){const t=this.getNodeId(e);if(t===void 0)throw this.missingNodeError(e);return new Set(this.edgesSparseArray[t].filter(r=>r!==void 0).map(r=>this.nodesSparseArray[r]))}adjacentNodesCount(e){const t=this.getNodeId(e);if(t===void 0)throw this.missingNodeError(e);return this.fixEdgesArrayForNode(t).length}addNodeAndReturnId(e){const t=this.nodesIds.get(e);if(t!==void 0)return t;const r=this.nextId;return this.nextId++,this.nodesSparseArray[r]=e,this.edgesSparseArray[r]=[],this.nodesIds.set(e,r),r}addEdge(e,t){const r=this.getNodeIdIfNotNumber(e),i=this.getNodeIdIfNotNumber(t);if(r===void 0)throw this.missingNodeError(e);if(i===void 0)throw this.missingNodeError(t);this.edgesSparseArray[r].includes(i)||this.edgesSparseArray[r].push(i)}removeNode(e){const t=this.getNodeId(e);if(t===void 0)throw this.missingNodeError(e);this.edgesSparseArray[t].length>0&&(this.edgesSparseArray[t].forEach(i=>this.dirtyAndVolatileNodeIds.rawValue.dirty.push(i)),this.dirtyAndVolatileNodeIds.markAsModified());const r=this.removeDependencies(e);return delete this.nodesSparseArray[t],delete this.edgesSparseArray[t],this.infiniteRangeIds.delete(t),this.nodesIds.delete(e),r}removeEdge(e,t){const r=this.getNodeIdIfNotNumber(e),i=this.getNodeIdIfNotNumber(t);if(r===void 0)throw this.missingNodeError(e);if(i===void 0)throw this.missingNodeError(t);const s=this.edgesSparseArray[r].indexOf(i);if(s===-1)throw new Error("Edge does not exist");delete this.edgesSparseArray[r][s]}removeEdgeIfExists(e,t){const r=this.getNodeId(e),i=this.getNodeId(t);if(r===void 0||i===void 0)return;const s=this.edgesSparseArray[r].indexOf(i);s!==-1&&delete this.edgesSparseArray[r][s]}topSortWithScc(){return this.getTopSortedWithSccSubgraphFrom(this.getNodes(),()=>!0,()=>{})}getTopSortedWithSccSubgraphFrom(e,t,r){const i=new Ope(this.nodesSparseArray,this.edgesSparseArray),s=e.map(o=>this.getNodeId(o)).filter(o=>o!==void 0);return i.getTopSortedWithSccSubgraphFrom(s,t,r)}markNodeAsVolatile(e){const t=this.getNodeId(e);t!==void 0&&(this.dirtyAndVolatileNodeIds.rawValue.volatile.push(t),this.dirtyAndVolatileNodeIds.markAsModified())}markNodeAsDirty(e){const t=this.getNodeId(e);t!==void 0&&(this.dirtyAndVolatileNodeIds.rawValue.dirty.push(t),this.dirtyAndVolatileNodeIds.markAsModified())}getDirtyAndVolatileNodes(){return this.dirtyAndVolatileNodeIds.getProcessedValue()}clearDirtyNodes(){this.dirtyAndVolatileNodeIds.rawValue.dirty=[],this.dirtyAndVolatileNodeIds.markAsModified()}markNodeAsChangingWithStructure(e){const t=this.getNodeId(e);t!==void 0&&this.changingWithStructureNodeIds.push(t)}markChangingWithStructureNodesAsDirty(){this.changingWithStructureNodeIds.length<=0||(this.dirtyAndVolatileNodeIds.rawValue.dirty=[...this.dirtyAndVolatileNodeIds.rawValue.dirty,...this.changingWithStructureNodeIds],this.dirtyAndVolatileNodeIds.markAsModified())}markNodeAsInfiniteRange(e){const t=this.getNodeIdIfNotNumber(e);t!==void 0&&this.infiniteRangeIds.add(t)}getInfiniteRanges(){return[...this.infiniteRangeIds].map(e=>({node:this.nodesSparseArray[e],id:e}))}getNodeId(e){return this.nodesIds.get(e)}getNodeIdIfNotNumber(e){return typeof e=="number"?e:this.nodesIds.get(e)}fixEdgesArrayForNode(e){const t=this.edgesSparseArray[e];return this.edgesSparseArray[e]=t.filter(r=>r!==void 0&&this.nodesSparseArray[r]),this.edgesSparseArray[e]}removeDependencies(e){const t=this.dependencyQuery(e);return t.forEach(([r,i])=>{this.removeEdgeIfExists(i,e)}),t}processDirtyAndVolatileNodeIds({dirty:e,volatile:t}){return[...new Set([...e,...t])].map(r=>this.nodesSparseArray[r]).filter(r=>r!==void 0)}missingNodeError(e){return new Error(`Unknown node ${e}`)}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class xpe{constructor(){this.rangeMapping=new Map}getMappingSize(e){var t,r;return(r=(t=this.rangeMapping.get(e))===null||t===void 0?void 0:t.size)!==null&&r!==void 0?r:0}setRange(e){let t=this.rangeMapping.get(e.getStart().sheet);t===void 0&&(t=new Map,this.rangeMapping.set(e.getStart().sheet,t));const r=Tv(e.getStart(),e.getEnd());t.set(r,e)}removeRange(e){const t=e.getStart().sheet,r=this.rangeMapping.get(t);if(r===void 0)return;const i=Tv(e.getStart(),e.getEnd());r.delete(i),r.size===0&&this.rangeMapping.delete(t)}getRange(e,t){const r=this.rangeMapping.get(e.sheet),i=Tv(e,t);return r?.get(i)}fetchRange(e,t){const r=this.getRange(e,t);if(!r)throw Error("Range does not exist");return r}truncateRanges(e,t){const r=Array(),i=Array(),s=Array(),o=e.sheet;for(const[l,u]of this.entriesFromSheet(e.sheet)){const h=u.range;e.start<=t(u.range.end)&&(h.removeSpan(e),h.shouldBeRemoved()?(this.removeByKey(o,l),r.push(u)):i.push([l,u]),s.push(u))}const a=[];i.sort((l,u)=>Hpe(l[1],u[1],t));for(const[l,u]of i){const h=Lpe(u.range);if(h===l)continue;const c=this.getByKey(o,h);this.removeByKey(o,l),c!==void 0&&u!=c?a.push([c,u]):this.setRange(u)}return{verticesToRemove:r,verticesToMerge:a,verticesWithChangedSize:s}}moveAllRangesInSheetAfterRowByRows(e,t,r){return this.updateVerticesFromSheet(e,(i,s)=>t<=s.start.row?(s.range.shiftByRows(r),{changedSize:!1,vertex:s}):t>s.start.row&&t<=s.end.row?(s.range.expandByRows(r),{changedSize:!0,vertex:s}):void 0)}moveAllRangesInSheetAfterColumnByColumns(e,t,r){return this.updateVerticesFromSheet(e,(i,s)=>t<=s.start.col?(s.range.shiftByColumns(r),{changedSize:!1,vertex:s}):t>s.start.col&&t<=s.end.col?(s.range.expandByColumns(r),{changedSize:!0,vertex:s}):void 0)}moveRangesInsideSourceRange(e,t,r,i){this.updateVerticesFromSheet(e.sheet,(s,o)=>{if(e.containsRange(o.range))return o.range.shiftByColumns(t),o.range.shiftByRows(r),o.range.moveToSheet(i),{changedSize:!1,vertex:o}})}removeRangesInSheet(e){if(this.rangeMapping.has(e)){const t=this.rangeMapping.get(e).values();return this.rangeMapping.delete(e),t}return[][Symbol.iterator]()}*rangesInSheet(e){const t=this.rangeMapping.get(e);t&&(yield*t.values())}*rangeVerticesContainedInRange(e){for(const t of this.rangesInSheet(e.sheet))e.containsRange(t.range)&&(yield t)}findSmallerRange(e){if(e.height()>1&&Number.isFinite(e.height())){const t=we(e.end.sheet,e.end.col,e.end.row-1),r=this.getRange(e.start,t);if(r!==void 0){const i=_e.fromSimpleCellAddresses(we(e.start.sheet,e.start.col,e.end.row),e.end);return{smallerRangeVertex:r,restRange:i}}}return{restRange:e}}*entriesFromSheet(e){const t=this.rangeMapping.get(e);t&&(yield*t.entries())}removeByKey(e,t){this.rangeMapping.get(e).delete(t)}getByKey(e,t){var r;return(r=this.rangeMapping.get(e))===null||r===void 0?void 0:r.get(t)}updateVerticesFromSheet(e,t){const r=Array();for(const[i,s]of this.entriesFromSheet(e)){const o=t(i,s);o!==void 0&&(this.removeByKey(e,i),r.push(o))}return r.forEach(i=>{this.setRange(i.vertex)}),{verticesWithChangedSize:r.filter(i=>i.changedSize).map(i=>i.vertex)}}}function Tv(n,e){return`${n.col},${n.row},${e.col},${e.row}`}function Lpe(n){return Tv(n.start,n.end)}const Hpe=(n,e,t)=>{const r=t(n.range.start),i=t(n.range.start);if(r===i){const s=t(n.range.end),o=t(e.range.end);return s-o}else return r-i};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class Dpe{constructor(e,t,r){this.functions=e,this.errors=t,this.ui=r,this._protectedTranslations={VERSION:"VERSION"},this.checkUI(),this.checkErrors(),this.checkFunctionTranslations(this.functions),Object.assign(this.functions,this._protectedTranslations)}extendFunctions(e){this.checkFunctionTranslations(e),Object.assign(this.functions,e)}buildFunctionMapping(){return Object.keys(this.functions).reduce((e,t)=>(e[this.functions[t]]=t,e),{})}buildErrorMapping(){return Object.keys(this.errors).reduce((e,t)=>(e[this.errors[t]]=t,e),{})}isFunctionTranslated(e){return this.functions[e]!==void 0}getFunctionTranslations(e){const t=[];for(const r of e)this.isFunctionTranslated(r)&&t.push(this.functions[r]);return t}getFunctionTranslation(e){const t=this.functions[e];if(t===void 0)throw new jc(`functions.${e}`);return t}getMaybeFunctionTranslation(e){return this.functions[e]}getErrorTranslation(e){if(e===N.LIC)return`#${N.LIC}!`;const t=this.errors[e];if(t===void 0)throw new jc(`errors.${e}`);return t}getUITranslation(e){const t=this.ui[e];if(t===void 0)throw new jc(`ui.${e}`);return t}checkUI(){for(const e of Object.values(cg))if(!(e in this.ui))throw new jc(`ui.${e}`)}checkErrors(){for(const e of Object.values(N))if(!(e in this.errors)&&e!==N.LIC)throw new jc(`errors.${e}`)}checkFunctionTranslations(e){const t=new Set(Object.getOwnPropertyNames(e));for(const r of Object.getOwnPropertyNames(this._protectedTranslations))if(t.has(r))throw new XG(r)}}function Fpe(n){return new Dpe(Object.assign({},n.functions),Object.assign({},n.errors),Object.assign({},n.ui))}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */var cg;(function(n){n.NEW_SHEET_PREFIX="NEW_SHEET_PREFIX"})(cg||(cg={}));/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */function zc(n){return n.toLowerCase()}class kpe{constructor(e,t){this.id=e,this.displayName=t}get canonicalName(){return zc(this.displayName)}}class Vpe{constructor(e){this.languages=e,this.mappingFromCanonicalName=new Map,this.mappingFromId=new Map,this.lastSheetId=-1,this.fetch=t=>{const r=this.mappingFromCanonicalName.get(zc(t));if(r===void 0)throw new kG(t);return r.id},this.get=t=>{var r;return(r=this.mappingFromCanonicalName.get(zc(t)))===null||r===void 0?void 0:r.id},this.fetchDisplayName=t=>this.fetchSheetById(t).displayName,this.sheetNamePrefix=e.getUITranslation(cg.NEW_SHEET_PREFIX)}addSheet(e=`${this.sheetNamePrefix}${this.lastSheetId+2}`){const t=zc(e);if(this.mappingFromCanonicalName.has(t))throw new lg(e);this.lastSheetId++;const r=new kpe(this.lastSheetId,e);return this.store(r),r.id}removeSheet(e){const t=this.fetchSheetById(e);e==this.lastSheetId&&--this.lastSheetId,this.mappingFromCanonicalName.delete(t.canonicalName),this.mappingFromId.delete(t.id)}getDisplayName(e){var t;return(t=this.mappingFromId.get(e))===null||t===void 0?void 0:t.displayName}*displayNames(){for(const e of this.mappingFromCanonicalName.values())yield e.displayName}numberOfSheets(){return this.mappingFromCanonicalName.size}hasSheetWithId(e){return this.mappingFromId.has(e)}hasSheetWithName(e){return this.mappingFromCanonicalName.has(zc(e))}renameSheet(e,t){const r=this.fetchSheetById(e),i=r.displayName;if(i===t)return;const s=this.mappingFromCanonicalName.get(zc(t));if(s!==void 0&&s.id!==r.id)throw new lg(t);const o=r.canonicalName;return this.mappingFromCanonicalName.delete(o),r.displayName=t,this.store(r),i}sheetNames(){return Array.from(this.mappingFromId.values()).map(e=>e.displayName)}store(e){this.mappingFromId.set(e.id,e),this.mappingFromCanonicalName.set(e.canonicalName,e)}fetchSheetById(e){const t=this.mappingFromId.get(e);if(t===void 0)throw new Rn(e);return t}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class r_{constructor(e,t,r,i,s,o,a,l){this.addressMapping=e,this.rangeMapping=t,this.sheetMapping=r,this.arrayMapping=i,this.stats=s,this.lazilyTransformingAstService=o,this.functionRegistry=a,this.namedExpressions=l,this.changes=Jl.empty(),this.dependencyQueryAddresses=u=>{if(u instanceof Fr)return this.rangeDependencyQuery(u).map(([h,c])=>h);{const h=this.formulaDependencyQuery(u);if(h!==void 0){const[c,d]=h;return d.map(f=>f instanceof za?this.namedExpressions.namedExpressionOrPlaceholder(f.name,c.sheet).address:_n(f)?f:xN(f.start,f.end))}else return[]}},this.dependencyQueryVertices=u=>{if(u instanceof Fr)return this.rangeDependencyQuery(u);{const h=this.formulaDependencyQuery(u);if(h!==void 0){const[c,d]=h;return d.map(f=>{if(f instanceof _e)return[f.start,this.rangeMapping.fetchRange(f.start,f.end)];if(f instanceof za){const g=this.namedExpressions.namedExpressionOrPlaceholder(f.name,c.sheet);return[g.address,this.addressMapping.fetchCell(g.address)]}else return[f,this.addressMapping.fetchCell(f)]})}else return[]}},this.rangeDependencyQuery=u=>{const h=[],{smallerRangeVertex:c,restRange:d}=this.rangeMapping.findSmallerRange(u.range);let f;c!==void 0&&this.graph.adjacentNodes(c).has(u)?(f=d,h.push([new _e(c.start,c.end),c])):f=u.range;for(const g of f.addresses(this)){const p=this.addressMapping.getCell(g);p!==void 0&&h.push([g,p])}return h},this.formulaDependencyQuery=u=>{let h,c;if(u instanceof Bi)c=u.getAddress(this.lazilyTransformingAstService),h=u.getFormula(this.lazilyTransformingAstService);else return;const d=wS(h,this.functionRegistry);return[c,jo(d,c)]},this.graph=new Ppe(this.dependencyQueryVertices)}static buildEmpty(e,t,r,i,s){return new r_(new Npe(t.chooseAddressMappingPolicy),new xpe,new Vpe(t.translationPackage),new Mpe,s,e,r,i)}setFormulaToCell(e,t,r,i,s,o){const a=Bi.fromAst(t,e,i,this.lazilyTransformingAstService.version());return this.exchangeOrAddFormulaVertex(a),this.processCellDependencies(r,a),this.graph.markNodeAsDirty(a),s&&this.markAsVolatile(a),o&&this.markAsDependentOnStructureChange(a),this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}setParsingErrorToCell(e,t){const r=this.shrinkPossibleArrayAndGetCell(e);return this.exchangeOrAddGraphNode(r,t),this.addressMapping.setCell(e,t),this.graph.markNodeAsDirty(t),this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}setValueToCell(e,t){const r=this.shrinkPossibleArrayAndGetCell(e);if(r instanceof Bn&&this.arrayMapping.removeArray(r.getRange()),r instanceof eu)r.getValues().rawValue!==t.rawValue&&(r.setValues(t),this.graph.markNodeAsDirty(r));else{const i=new eu(t.parsedValue,t.rawValue);this.exchangeOrAddGraphNode(r,i),this.addressMapping.setCell(e,i),this.graph.markNodeAsDirty(i)}return this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}setCellEmpty(e){const t=this.shrinkPossibleArrayAndGetCell(e);if(t===void 0)return Jl.empty();if(this.graph.adjacentNodes(t).size>0){const r=new Vl;this.exchangeGraphNode(t,r),this.graph.adjacentNodesCount(r)===0?(this.removeVertex(r),this.addressMapping.removeCell(e)):(this.graph.markNodeAsDirty(r),this.addressMapping.setCell(e,r))}else this.removeVertex(t),this.addressMapping.removeCell(e);return this.getAndClearContentChanges()}clearDirtyVertices(){this.graph.clearDirtyNodes()}verticesToRecompute(){return this.graph.getDirtyAndVolatileNodes()}processCellDependencies(e,t){const r=this.graph.getNodeId(t);e.forEach(i=>{if(i instanceof _e){const s=i;let o=this.getRange(s.start,s.end);o===void 0&&(o=new Fr(s),this.rangeMapping.setRange(o)),this.graph.addNodeAndReturnId(o);const a=this.graph.getNodeId(o);s.isFinite()||this.graph.markNodeAsInfiniteRange(a);const{smallerRangeVertex:l,restRange:u}=this.rangeMapping.findSmallerRange(s);if(l!==void 0){if(this.graph.addEdge(l,a),o.bruteForce){o.bruteForce=!1;for(const c of s.addresses(this))this.graph.removeEdge(this.fetchCell(c),a)}}else o.bruteForce=!0;const h=this.arrayMapping.getArray(u);if(h!==void 0)this.graph.addEdge(h,a);else for(const c of u.addresses(this)){const{vertex:d,id:f}=this.fetchCellOrCreateEmpty(c);this.graph.addEdge(f??d,a)}this.graph.addEdge(a,r),s.isFinite()&&this.correctInfiniteRangesDependenciesByRangeVertex(o)}else if(i instanceof za){const s=t.getAddress(this.lazilyTransformingAstService).sheet,{vertex:o,id:a}=this.fetchNamedExpressionVertex(i.name,s);this.graph.addEdge(a??o,r)}else{const{vertex:s,id:o}=this.fetchCellOrCreateEmpty(i);this.graph.addEdge(o??s,r)}})}fetchNamedExpressionVertex(e,t){const r=this.namedExpressions.namedExpressionOrPlaceholder(e,t);return this.fetchCellOrCreateEmpty(r.address)}exchangeNode(e,t){const r=this.fetchCellOrCreateEmpty(e).vertex,i=this.fetchCellOrCreateEmpty(t).vertex;this.addressMapping.removeCell(e),this.exchangeGraphNode(r,i)}fetchCellOrCreateEmpty(e){const t=this.addressMapping.getCell(e);if(t!==void 0)return{vertex:t,id:void 0};const r=new Vl,i=this.graph.addNodeAndReturnId(r);return this.addressMapping.setCell(e,r),{vertex:r,id:i}}removeRows(e){this.stats.measure(Ke.ADJUSTING_GRAPH,()=>{for(const[r,i]of this.addressMapping.entriesFromRowsSpan(e)){for(const s of this.graph.adjacentNodes(i))this.graph.markNodeAsDirty(s);if(i instanceof Bn)if(i.isLeftCorner(r))this.shrinkArrayToCorner(i),this.arrayMapping.removeArray(i.getRange());else continue;this.removeVertex(i)}}),this.stats.measure(Ke.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.removeRows(e)});const t=this.stats.measure(Ke.ADJUSTING_RANGES,()=>{const r=this.truncateRanges(e,i=>i.row);return this.getArrayVerticesRelatedToRanges(r)});return this.stats.measure(Ke.ADJUSTING_ARRAY_MAPPING,()=>{this.fixArraysAfterRemovingRows(e.sheet,e.rowStart,e.numberOfRows)}),this.addStructuralNodesToChangeSet(),{affectedArrays:t,contentChanges:this.getAndClearContentChanges()}}removeSheet(e){this.clearSheet(e);for(const[t,r]of this.addressMapping.sheetEntries(e)){for(const i of this.graph.adjacentNodes(r))this.graph.markNodeAsDirty(i);this.removeVertex(r),this.addressMapping.removeCell(t)}this.stats.measure(Ke.ADJUSTING_RANGES,()=>{const t=this.rangeMapping.removeRangesInSheet(e);for(const r of t)this.removeVertex(r);this.stats.measure(Ke.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.removeSheet(e)})})}clearSheet(e){const t=new Set;for(const[r,i]of this.addressMapping.sheetEntries(e))i instanceof Bn?t.add(i):this.setCellEmpty(r);for(const r of t.values())this.setArrayEmpty(r);this.addStructuralNodesToChangeSet()}removeColumns(e){this.stats.measure(Ke.ADJUSTING_GRAPH,()=>{for(const[r,i]of this.addressMapping.entriesFromColumnsSpan(e)){for(const s of this.graph.adjacentNodes(i))this.graph.markNodeAsDirty(s);if(i instanceof Bn)if(i.isLeftCorner(r))this.shrinkArrayToCorner(i),this.arrayMapping.removeArray(i.getRange());else continue;this.removeVertex(i)}}),this.stats.measure(Ke.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.removeColumns(e)});const t=this.stats.measure(Ke.ADJUSTING_RANGES,()=>{const r=this.truncateRanges(e,i=>i.col);return this.getArrayVerticesRelatedToRanges(r)});return this.stats.measure(Ke.ADJUSTING_ARRAY_MAPPING,()=>this.fixArraysAfterRemovingColumns(e.sheet,e.columnStart,e.numberOfColumns)),this.addStructuralNodesToChangeSet(),{affectedArrays:t,contentChanges:this.getAndClearContentChanges()}}addRows(e){this.stats.measure(Ke.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.addRows(e.sheet,e.rowStart,e.numberOfRows)});const t=this.stats.measure(Ke.ADJUSTING_RANGES,()=>{const r=this.rangeMapping.moveAllRangesInSheetAfterRowByRows(e.sheet,e.rowStart,e.numberOfRows);return this.fixRangesWhenAddingRows(e.sheet,e.rowStart,e.numberOfRows),this.getArrayVerticesRelatedToRanges(r.verticesWithChangedSize)});this.stats.measure(Ke.ADJUSTING_ARRAY_MAPPING,()=>{this.fixArraysAfterAddingRow(e.sheet,e.rowStart,e.numberOfRows)});for(const r of this.addressMapping.verticesFromRowsSpan(e))this.graph.markNodeAsDirty(r);return this.addStructuralNodesToChangeSet(),{affectedArrays:t}}addColumns(e){this.stats.measure(Ke.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.addColumns(e.sheet,e.columnStart,e.numberOfColumns)});const t=this.stats.measure(Ke.ADJUSTING_RANGES,()=>{const r=this.rangeMapping.moveAllRangesInSheetAfterColumnByColumns(e.sheet,e.columnStart,e.numberOfColumns);return this.fixRangesWhenAddingColumns(e.sheet,e.columnStart,e.numberOfColumns),this.getArrayVerticesRelatedToRanges(r.verticesWithChangedSize)});this.stats.measure(Ke.ADJUSTING_ARRAY_MAPPING,()=>this.fixArraysAfterAddingColumn(e.sheet,e.columnStart,e.numberOfColumns));for(const r of this.addressMapping.verticesFromColumnsSpan(e))this.graph.markNodeAsDirty(r);return this.addStructuralNodesToChangeSet(),{affectedArrays:t,contentChanges:this.getAndClearContentChanges()}}isThereSpaceForArray(e){const t=e.getRangeOrUndef();if(t===void 0)return!1;for(const r of t.addresses(this)){const i=this.addressMapping.getCell(r);if(i!==void 0&&!(i instanceof Vl)&&i!==e)return!1}return!0}moveCells(e,t,r,i){for(const s of e.addressesWithDirection(t,r,this)){const o=we(i,s.col+t,s.row+r);let a=this.addressMapping.getCell(s);const l=this.addressMapping.getCell(o);if(this.addressMapping.removeCell(s),a!==void 0){this.graph.markNodeAsDirty(a),this.addressMapping.setCell(o,a);let u;for(const h of this.graph.adjacentNodes(a))h instanceof Fr&&!e.containsRange(h.range)&&(u=u??this.fetchCellOrCreateEmpty(s).vertex,this.graph.addEdge(u,h),this.graph.removeEdge(a,h));u&&(this.graph.markNodeAsDirty(u),this.addressMapping.setCell(s,u))}if(l!==void 0){a===void 0&&this.addressMapping.removeCell(o);for(const u of this.graph.adjacentNodes(l))a=a??this.fetchCellOrCreateEmpty(o).vertex,this.graph.addEdge(a,u),this.graph.markNodeAsDirty(a);this.removeVertex(l)}}for(const s of this.rangeMapping.rangeVerticesContainedInRange(e))for(const o of this.graph.adjacentNodes(s))if(o instanceof Fr&&!e.containsRange(o.range)){this.graph.removeEdge(s,o);for(const a of s.range.addresses(this)){const{vertex:l,id:u}=this.fetchCellOrCreateEmpty(a);this.graph.addEdge(u??l,o),this.addressMapping.setCell(a,l),this.graph.markNodeAsDirty(l)}}this.rangeMapping.moveRangesInsideSourceRange(e,t,r,i)}setArrayEmpty(e){const t=_e.spanFrom(e.getAddress(this.lazilyTransformingAstService),e.width,e.height),r=this.graph.adjacentNodes(e);for(const i of t.addresses(this))this.addressMapping.removeCell(i);for(const i of r.values()){const s=Ipe(this.functionRegistry,i,e.getRange(),this.lazilyTransformingAstService,this);for(const o of s){const{vertex:a,id:l}=this.fetchCellOrCreateEmpty(o);this.graph.addEdge(l??a,i)}s.length>0&&this.graph.markNodeAsDirty(i)}this.removeVertex(e),this.arrayMapping.removeArray(e.getRange())}addVertex(e,t){this.graph.addNodeAndReturnId(t),this.addressMapping.setCell(e,t)}addArrayVertex(e,t){this.graph.addNodeAndReturnId(t),this.setAddressMappingForArrayVertex(t,e)}*arrayFormulaNodes(){for(const e of this.graph.getNodes())e instanceof Bn&&(yield e)}*entriesFromRowsSpan(e){yield*this.addressMapping.entriesFromRowsSpan(e)}*entriesFromColumnsSpan(e){yield*this.addressMapping.entriesFromColumnsSpan(e)}fetchCell(e){return this.addressMapping.fetchCell(e)}getCell(e){return this.addressMapping.getCell(e)}getCellValue(e){return this.addressMapping.getCellValue(e)}getRawValue(e){return this.addressMapping.getRawValue(e)}getScalarValue(e){const t=this.addressMapping.getCellValue(e);return t instanceof Ae?new E(N.VALUE,_.ScalarExpected):t}existsEdge(e,t){return this.graph.existsEdge(e,t)}getSheetId(e){return this.sheetMapping.fetch(e)}getSheetHeight(e){return this.addressMapping.getHeight(e)}getSheetWidth(e){return this.addressMapping.getWidth(e)}getArray(e){return this.arrayMapping.getArray(e)}getRange(e,t){return this.rangeMapping.getRange(e,t)}topSortWithScc(){return this.graph.topSortWithScc()}markAsVolatile(e){this.graph.markNodeAsVolatile(e)}markAsDependentOnStructureChange(e){this.graph.markNodeAsChangingWithStructure(e)}forceApplyPostponedTransformations(){for(const e of this.graph.getNodes())e instanceof Zo&&e.ensureRecentData(this.lazilyTransformingAstService)}*rawValuesFromRange(e){for(const t of e.addresses(this)){const r=this.getScalarValue(t);r!==ht&&(yield[me(r),t])}}computeListOfValuesInRange(e){const t=[];for(const r of e.addresses(this)){const i=this.getScalarValue(r);t.push(i)}return t}shrinkArrayToCorner(e){this.cleanAddressMappingUnderArray(e);for(const t of this.adjacentArrayVertices(e)){let r;t instanceof Bi?r=this.formulaDirectDependenciesToArray(t,e):r=this.rangeDirectDependenciesToArray(t,e);let i=!1;for(const[s,o]of r)e.isLeftCorner(s)&&(i=!0),this.graph.addEdge(o,t),this.graph.markNodeAsDirty(o);i||this.graph.removeEdge(e,t)}this.graph.markNodeAsDirty(e)}isArrayInternalCell(e){const t=this.getCell(e);return t instanceof Bn&&!t.isLeftCorner(e)}getAndClearContentChanges(){const e=this.changes;return this.changes=Jl.empty(),e}getAdjacentNodesAddresses(e){const t=this.graph.adjacentNodes(e),r=[];return t.forEach(i=>{const s=i;s instanceof Fr?r.push(xN(s.start,s.end)):r.push(s.getAddress(this.lazilyTransformingAstService))}),r}exchangeGraphNode(e,t){this.graph.addNodeAndReturnId(t);const r=this.graph.adjacentNodes(e);this.removeVertex(e),r.forEach(i=>{this.graph.hasNode(i)&&this.graph.addEdge(t,i)})}setArray(e,t){this.arrayMapping.setArray(e,t)}correctInfiniteRangesDependency(e){const t=this.graph.getInfiniteRanges().filter(({node:o})=>o.range.addressInRange(e));if(t.length<=0)return;const{vertex:r,id:i}=this.fetchCellOrCreateEmpty(e),s=i??this.graph.getNodeId(r);t.forEach(({id:o})=>{this.graph.addEdge(s,o)})}exchangeOrAddGraphNode(e,t){e?this.exchangeGraphNode(e,t):this.graph.addNodeAndReturnId(t)}getArrayVerticesRelatedToRanges(e){const t=new Set;return e.forEach(r=>{this.graph.hasNode(r)&&this.graph.adjacentNodes(r).forEach(i=>{i instanceof Bn&&t.add(i)})}),t}correctInfiniteRangesDependenciesByRangeVertex(e){this.graph.getInfiniteRanges().forEach(({id:t,node:r})=>{const i=e.range.intersectionWith(r.range);i!==void 0&&i.addresses(this).forEach(s=>{const{vertex:o,id:a}=this.fetchCellOrCreateEmpty(s);this.graph.addEdge(a??o,t)})})}cleanAddressMappingUnderArray(e){const t=e.getRange();for(const r of t.addresses(this)){const i=e.getArrayCellValue(r);this.getCell(r)===e?e.isLeftCorner(r)?this.changes.addChange(new E(N.REF),r,i):(this.addressMapping.removeCell(r),this.changes.addChange(ht,r,i)):this.changes.addChange(ht,r,i)}}*formulaDirectDependenciesToArray(e,t){var r;const[,i]=(r=this.formulaDependencyQuery(e))!==null&&r!==void 0?r:[];if(i!==void 0){for(const s of i)if(!(s instanceof za||s instanceof _e)&&t.getRange().addressInRange(s)){const o=this.fetchCellOrCreateEmpty(s).vertex;yield[s,o]}}}*rangeDirectDependenciesToArray(e,t){const{restRange:r}=this.rangeMapping.findSmallerRange(e.range);for(const i of r.addresses(this))if(t.getRange().addressInRange(i)){const s=this.fetchCellOrCreateEmpty(i).vertex;yield[i,s]}}*adjacentArrayVertices(e){const t=this.graph.adjacentNodes(e);for(const r of t)(r instanceof Bi||r instanceof Fr)&&(yield r)}addStructuralNodesToChangeSet(){this.graph.markChangingWithStructureNodesAsDirty()}fixRangesWhenAddingRows(e,t,r){const i=Array.from(this.rangeMapping.rangesInSheet(e));for(const s of i)if(s.range.includesRow(t+r))if(s.bruteForce){const o=s.range.rangeWithSameWidth(t,r);for(const a of o.addresses(this)){const{vertex:l,id:u}=this.fetchCellOrCreateEmpty(a);this.graph.addEdge(u??l,s)}}else{let o=s,a=this.rangeMapping.findSmallerRange(o.range);if(a.smallerRangeVertex!==void 0)continue;for(;a.smallerRangeVertex===void 0;){const l=new Fr(_e.spanFrom(o.range.start,o.range.width(),o.range.height()-1));this.rangeMapping.setRange(l),this.graph.addNodeAndReturnId(l);const u=new _e(we(o.range.start.sheet,o.range.start.col,o.range.end.row),o.range.end);this.addAllFromRange(u,o),this.graph.addEdge(l,o),o=l,a=this.rangeMapping.findSmallerRange(o.range)}this.graph.addEdge(a.smallerRangeVertex,o),this.addAllFromRange(a.restRange,o),this.graph.removeEdge(a.smallerRangeVertex,s)}}addAllFromRange(e,t){for(const r of e.addresses(this)){const{vertex:i,id:s}=this.fetchCellOrCreateEmpty(r);this.graph.addEdge(s??i,t)}}fixRangesWhenAddingColumns(e,t,r){for(const i of this.rangeMapping.rangesInSheet(e))if(i.range.includesColumn(t+r)){let s;i.bruteForce?s=i.range.rangeWithSameHeight(t,r):s=_e.spanFrom(we(e,t,i.range.end.row),r,1);for(const o of s.addresses(this)){const{vertex:a,id:l}=this.fetchCellOrCreateEmpty(o);this.graph.addEdge(l??a,i)}}}exchangeOrAddFormulaVertex(e){const t=e.getAddress(this.lazilyTransformingAstService),r=_e.spanFrom(t,e.width,e.height),i=this.shrinkPossibleArrayAndGetCell(t);if(e instanceof Bn&&this.setArray(r,e),this.exchangeOrAddGraphNode(i,e),this.addressMapping.setCell(t,e),e instanceof Bn){if(!this.isThereSpaceForArray(e))return;for(const s of r.addresses(this)){if(e.isLeftCorner(s))continue;const o=this.getCell(s);this.exchangeOrAddGraphNode(o,e)}}for(const s of r.addresses(this))this.addressMapping.setCell(s,e)}setAddressMappingForArrayVertex(e,t){if(this.addressMapping.setCell(t,e),!(e instanceof Bn))return;const r=_e.spanFromOrUndef(t,e.width,e.height);if(r!==void 0&&(this.setArray(r,e),!!this.isThereSpaceForArray(e)))for(const i of r.addresses(this))this.addressMapping.setCell(i,e)}truncateRanges(e,t){const{verticesToRemove:r,verticesToMerge:i,verticesWithChangedSize:s}=this.rangeMapping.truncateRanges(e,t);for(const[o,a]of i)this.mergeRangeVertices(o,a);for(const o of r)this.removeVertexAndCleanupDependencies(o);return s}fixArraysAfterAddingRow(e,t,r){if(this.arrayMapping.moveArrayVerticesAfterRowByRows(e,t,r),!(t<=0))for(const[,i]of this.arrayMapping.arraysInRows(Ei.fromRowStartAndEnd(e,t-1,t-1))){const s=i.getRange();for(let o=s.start.col;o<=s.end.col;++o)for(let a=t;a<=s.end.row;++a){const l=we(e,o,a),u=we(e,o,a+r),h=i.getArrayCellValue(l);this.addressMapping.moveCell(u,l),this.changes.addChange(ht,u,h)}}}fixArraysAfterRemovingRows(e,t,r){if(this.arrayMapping.moveArrayVerticesAfterRowByRows(e,t,-r),!(t<=0))for(const[,i]of this.arrayMapping.arraysInRows(Ei.fromRowStartAndEnd(e,t-1,t-1)))if(this.isThereSpaceForArray(i))for(const s of i.getRange().addresses(this))this.addressMapping.setCell(s,i);else this.setNoSpaceIfArray(i)}fixArraysAfterAddingColumn(e,t,r){if(this.arrayMapping.moveArrayVerticesAfterColumnByColumns(e,t,r),!(t<=0))for(const[,i]of this.arrayMapping.arraysInCols(Ui.fromColumnStartAndEnd(e,t-1,t-1))){const s=i.getRange();for(let o=s.start.row;o<=s.end.row;++o)for(let a=t;a<=s.end.col;++a){const l=we(e,a,o),u=we(e,a+r,o),h=i.getArrayCellValue(l);this.addressMapping.moveCell(u,l),this.changes.addChange(ht,u,h)}}}fixArraysAfterRemovingColumns(e,t,r){if(this.arrayMapping.moveArrayVerticesAfterColumnByColumns(e,t,-r),!(t<=0))for(const[,i]of this.arrayMapping.arraysInCols(Ui.fromColumnStartAndEnd(e,t-1,t-1)))if(this.isThereSpaceForArray(i))for(const s of i.getRange().addresses(this))this.addressMapping.setCell(s,i);else this.setNoSpaceIfArray(i)}shrinkPossibleArrayAndGetCell(e){const t=this.getCell(e);return t instanceof Bn?(this.setNoSpaceIfArray(t),this.getCell(e)):t}setNoSpaceIfArray(e){e instanceof Bn&&(this.shrinkArrayToCorner(e),e.setNoSpace())}removeVertex(e){this.removeVertexAndCleanupDependencies(e),e instanceof Fr&&this.rangeMapping.removeRange(e)}mergeRangeVertices(e,t){const r=this.graph.adjacentNodes(t);this.removeVertexAndCleanupDependencies(t),this.graph.removeEdgeIfExists(e,t),r.forEach(i=>{this.graph.hasNode(i)&&this.graph.addEdge(e,i)})}removeVertexAndCleanupDependencies(e){const t=new Set(this.graph.removeNode(e));for(;t.size>0;){const r=t.values().next().value;t.delete(r);const[i,s]=r;this.graph.hasNode(s)&&this.graph.adjacentNodesCount(s)===0&&((s instanceof Fr||s instanceof Vl)&&this.graph.removeNode(s).forEach(o=>t.add(o)),s instanceof Fr?this.rangeMapping.removeRange(s):s instanceof Vl&&this.addressMapping.removeCell(i))}}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class Vl{constructor(){}getCellValue(){return ht}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class eu{constructor(e,t){this.parsedValue=e,this.rawValue=t}getValues(){return{parsedValue:this.parsedValue,rawValue:this.rawValue}}setValues(e){this.parsedValue=e.parsedValue,this.rawValue=e.rawValue}getCellValue(){return this.parsedValue}setCellValue(e){throw Error("SetCellValue is deprecated for ValueCellVertex")}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class md{constructor(e,t){this.errors=e,this.rawInput=t}getCellValue(){const e=this.errors.map(t=>t.message).find(t=>t);return E.parsingError(e)}getFormula(){return this.rawInput}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class Upe{constructor(e,t){this.width=e,this.height=t,this.mapping=new Map}getCell(e){var t;return(t=this.mapping.get(e.col))===null||t===void 0?void 0:t.get(e.row)}setCell(e,t){this.width=Math.max(this.width,e.col+1),this.height=Math.max(this.height,e.row+1);let r=this.mapping.get(e.col);r||(r=new Map,this.mapping.set(e.col,r)),r.set(e.row,t)}has(e){var t;return!!(!((t=this.mapping.get(e.col))===null||t===void 0)&&t.get(e.row))}getHeight(){return this.height}getWidth(){return this.width}removeCell(e){var t;(t=this.mapping.get(e.col))===null||t===void 0||t.delete(e.row)}addRows(e,t){this.mapping.forEach(r=>{const i=new Map;r.forEach((s,o)=>{o>=e&&(i.set(o+t,s),r.delete(o))}),i.forEach((s,o)=>{r.set(o,s)})}),this.height+=t}addColumns(e,t){const r=new Map;this.mapping.forEach((i,s)=>{s>=e&&(r.set(s+t,i),this.mapping.delete(s))}),r.forEach((i,s)=>{this.mapping.set(s,i)}),this.width+=t}removeRows(e){this.mapping.forEach(i=>{const s=new Map;i.forEach((o,a)=>{a>=e.rowStart&&(i.delete(a),a>e.rowEnd&&s.set(a-e.numberOfRows,o))}),s.forEach((o,a)=>{i.set(a,o)})});const t=Math.min(this.height-1,e.rowEnd),r=Math.max(0,t-e.rowStart+1);this.height=Math.max(0,this.height-r)}removeColumns(e){const t=new Map;this.mapping.forEach((s,o)=>{o>=e.columnStart&&(this.mapping.delete(o),o>e.columnEnd&&t.set(o-e.numberOfColumns,s))}),t.forEach((s,o)=>{this.mapping.set(o,s)});const r=Math.min(this.width-1,e.columnEnd),i=Math.max(0,r-e.columnStart+1);this.width=Math.max(0,this.width-i)}*getEntries(e){for(const[t,r]of this.mapping)for(const[i,s]of r)yield[we(e,t,i),s]}*verticesFromColumn(e){const t=this.mapping.get(e);if(t!==void 0)for(const[r,i]of t)yield i}*verticesFromRow(e){for(const t of this.mapping.values()){const r=t.get(e);r!==void 0&&(yield r)}}*verticesFromColumnsSpan(e){for(const t of e.columns()){const r=this.mapping.get(t);if(r!==void 0)for(const[i,s]of r)yield s}}*verticesFromRowsSpan(e){for(const t of this.mapping.values())for(const r of e.rows()){const i=t.get(r);i!==void 0&&(yield i)}}*entriesFromRowsSpan(e){for(const[t,r]of this.mapping.entries())for(const i of e.rows()){const s=r.get(i);s!==void 0&&(yield[we(e.sheet,t,i),s])}}*entriesFromColumnsSpan(e){for(const t of e.columns()){const r=this.mapping.get(t);if(r!==void 0)for(const[i,s]of r.entries())yield[we(e.sheet,t,i),s]}}*vertices(){for(const[e,t]of this.mapping)for(const[r,i]of t)i!==void 0&&(yield i)}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class Bpe{constructor(e,t){this.width=e,this.height=t,this.mapping=new Array(t);for(let r=0;r<t;r++)this.mapping[r]=new Array(e)}getCell(e){return this.getCellVertex(e.col,e.row)}setCell(e,t){this.width=Math.max(this.width,e.col+1),this.height=Math.max(this.height,e.row+1),this.mapping[e.row]||(this.mapping[e.row]=new Array(this.width)),this.mapping[e.row][e.col]=t}has(e){const t=this.mapping[e.row];return t?!!t[e.col]:!1}getHeight(){return this.height}getWidth(){return this.width}removeCell(e){this.mapping[e.row]!==void 0&&delete this.mapping[e.row][e.col]}addRows(e,t){const r=[];for(let i=0;i<t;i++)r.push(new Array(this.width));this.mapping.splice(e,0,...r),this.height+=t}addColumns(e,t){for(let r=0;r<this.height;r++)this.mapping[r]!==void 0&&this.mapping[r].splice(e,0,...new Array(t));this.width+=t}removeRows(e){this.mapping.splice(e.rowStart,e.numberOfRows);const t=Math.min(this.height-1,e.rowEnd),r=Math.max(0,t-e.rowStart+1);this.height=Math.max(0,this.height-r)}removeColumns(e){for(let i=0;i<this.height;i++)this.mapping[i]!==void 0&&this.mapping[i].splice(e.columnStart,e.numberOfColumns);const t=Math.min(this.width-1,e.columnEnd),r=Math.max(0,t-e.columnStart+1);this.width=Math.max(0,this.width-r)}*getEntries(e){for(let t=0;t<this.height;++t)for(let r=0;r<this.width;++r){const i=this.getCellVertex(r,t);i&&(yield[we(e,r,t),i])}}*verticesFromColumn(e){for(let t=0;t<this.height;++t){const r=this.getCellVertex(e,t);r&&(yield r)}}*verticesFromRow(e){for(let t=0;t<this.width;++t){const r=this.getCellVertex(t,e);r&&(yield r)}}*verticesFromColumnsSpan(e){for(let t=e.columnStart;t<=e.columnEnd;++t)for(let r=0;r<this.height;++r){const i=this.getCellVertex(t,r);i&&(yield i)}}*verticesFromRowsSpan(e){for(let t=0;t<this.width;++t)for(let r=e.rowStart;r<=e.rowEnd;++r){const i=this.getCellVertex(t,r);i&&(yield i)}}*entriesFromRowsSpan(e){for(let t=0;t<this.width;++t)for(let r=e.rowStart;r<=e.rowEnd;++r){const i=this.getCellVertex(t,r);i&&(yield[we(e.sheet,t,r),i])}}*entriesFromColumnsSpan(e){for(let t=e.columnStart;t<=e.columnEnd;++t)for(let r=0;r<this.height;++r){const i=this.getCellVertex(t,r);i&&(yield[we(e.sheet,t,r),i])}}*vertices(){for(let e=0;e<this.height;++e)for(let t=0;t<this.width;++t){const r=this.getCellVertex(t,e);r&&(yield r)}}getCellVertex(e,t){var r;return(r=this.mapping[t])===null||r===void 0?void 0:r[e]}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */var N;(function(n){n.DIV_BY_ZERO="DIV_BY_ZERO",n.NAME="NAME",n.VALUE="VALUE",n.NUM="NUM",n.NA="NA",n.CYCLE="CYCLE",n.REF="REF",n.SPILL="SPILL",n.LIC="LIC",n.ERROR="ERROR"})(N||(N={}));var yi;(function(n){n.FORMULA="FORMULA",n.VALUE="VALUE",n.ARRAY="ARRAY",n.EMPTY="EMPTY",n.ARRAYFORMULA="ARRAYFORMULA"})(yi||(yi={}));const Wpe=(n,e)=>n instanceof Bn?n.isLeftCorner(e)?yi.ARRAYFORMULA:yi.ARRAY:n instanceof Zo||n instanceof md?yi.FORMULA:n instanceof eu?yi.VALUE:yi.EMPTY;var Gy;(function(n){n.EMPTY="EMPTY",n.NUMBER="NUMBER",n.STRING="STRING",n.BOOLEAN="BOOLEAN",n.ERROR="ERROR"})(Gy||(Gy={}));var PN;(function(n){n.NUMBER="NUMBER"})(PN||(PN={}));const Qs=Object.assign(Object.assign({},Gy),PN),$pe=Object.assign(Object.assign({},Gy),Te),SF=n=>{switch(n){case Qs.EMPTY:return 0;case Qs.NUMBER:return 1;case Qs.STRING:return 2;case Qs.BOOLEAN:return 3;case Qs.ERROR:return 4}throw new Error("Cell value not computed")},jy=n=>{if(n===ht)return Qs.EMPTY;if(n instanceof E||n instanceof Ae)return Qs.ERROR;if(typeof n=="string")return Qs.STRING;if(It(n))return Qs.NUMBER;if(typeof n=="boolean")return Qs.BOOLEAN;throw new Error("Cell value not computed")},Gpe=n=>It(n)?Spe(n):jy(n),jpe=n=>{if(It(n))return Rpe(n)};class E{constructor(e,t,r){this.type=e,this.message=t,this.root=r}static parsingError(e){return new E(N.ERROR,`${_.ParseError}${e?" "+e:""}`)}attachRootVertex(e){return this.root===void 0?new E(this.type,this.message,e):this}}const ZG=(n,e)=>({sheet:n,row:e}),zpe=n=>n.row<0,JG=(n,e)=>({sheet:n,col:e}),Ype=n=>n.col<0,we=(n,e,t)=>({sheet:n,col:e,row:t}),Ri=n=>n.col<0||n.row<0,Kpe=(n,e,t,r)=>we(e,n.col+t,n.row+r),Lm=n=>`${n.sheet},${n.row},${n.col}`;function _n(n){var e,t,r;return n&&(typeof n=="object"||typeof n=="function")&&typeof((e=n)===null||e===void 0?void 0:e.sheet)=="number"&&typeof((t=n)===null||t===void 0?void 0:t.col)=="number"&&typeof((r=n)===null||r===void 0?void 0:r.row)=="number"}const no=(n,e)=>{var t;return(t=n.sheet)!==null&&t!==void 0?t:e.sheet},dg=(n,e)=>n.sheet===e.sheet&&n.col===e.col&&n.row===e.row;/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const qpe="AbsoluteCellRange: Wrong range size";function Oi(n){return n&&(typeof n=="object"||typeof n=="function")?"start"in n&&_n(n.start)&&"end"in n&&_n(n.end):!1}const xN=(n,e)=>({start:n,end:e});class _e{constructor(e,t){if(e.sheet!==t.sheet)throw new ug(e.sheet,t.sheet);this.start=we(e.sheet,e.col,e.row),this.end=we(t.sheet,t.col,t.row)}get sheet(){return this.start.sheet}static fromSimpleCellAddresses(e,t){if(e.sheet!==t.sheet)throw new ug(e.sheet,t.sheet);const r=t.col-e.col,i=t.row-e.row;return Number.isFinite(i)&&Number.isFinite(r)?new _e(e,t):Number.isFinite(i)?new Xa(e.sheet,e.row,t.row):new qa(e.sheet,e.col,t.col)}static fromAst(e,t){return e.type===M.CELL_RANGE?_e.fromCellRange(e,t):e.type===M.COLUMN_RANGE?qa.fromColumnRange(e,t):Xa.fromRowRangeAst(e,t)}static fromAstOrUndef(e,t){try{return _e.fromAst(e,t)}catch{return}}static fromCellRange(e,t){return new _e(e.start.toSimpleCellAddress(t),e.end.toSimpleCellAddress(t))}static spanFrom(e,t,r){const i=_e.spanFromOrUndef(e,t,r);if(i===void 0)throw new Error(qpe);return i}static spanFromOrUndef(e,t,r){if(!Number.isFinite(t)&&Number.isFinite(r))return e.col!==0?void 0:new Xa(e.sheet,e.row,e.row+r-1);if(!Number.isFinite(r)&&Number.isFinite(t))return e.row!==0?void 0:new qa(e.sheet,e.col,e.col+t-1);if(Number.isFinite(r)&&Number.isFinite(t))return new _e(e,we(e.sheet,e.col+t-1,e.row+r-1))}static fromCoordinates(e,t,r,i,s){return new _e(we(e,t,r),we(e,i,s))}isFinite(){return Number.isFinite(this.size())}doesOverlap(e){return!(this.start.sheet!=e.start.sheet||this.end.row<e.start.row||this.start.row>e.end.row||this.end.col<e.start.col||this.start.col>e.end.col)}addressInRange(e){return this.sheet!==e.sheet?!1:this.start.row<=e.row&&this.end.row>=e.row&&this.start.col<=e.col&&this.end.col>=e.col}columnInRange(e){return this.sheet!==e.sheet?!1:this.start.col<=e.col&&this.end.col>=e.col}rowInRange(e){return this.sheet!==e.sheet?!1:this.start.row<=e.row&&this.end.row>=e.row}containsRange(e){return this.addressInRange(e.start)&&this.addressInRange(e.end)}intersectionWith(e){if(this.sheet!==e.start.sheet)return;const t=Math.max(this.start.row,e.start.row),r=Math.min(this.end.row,e.end.row),i=Math.max(this.start.col,e.start.col),s=Math.min(this.end.col,e.end.col);if(!(t>r||i>s))return new _e(we(this.sheet,i,t),we(this.sheet,s,r))}includesRow(e){return this.start.row<e&&this.end.row>=e}includesColumn(e){return this.start.col<e&&this.end.col>=e}shiftByRows(e){this.start.row+=e,this.end.row+=e}expandByRows(e){this.end.row+=e}shiftByColumns(e){this.start.col+=e,this.end.col+=e}shifted(e,t){return _e.spanFrom(we(this.sheet,this.start.col+e,this.start.row+t),this.width(),this.height())}expandByColumns(e){this.end.col+=e}moveToSheet(e){this.start.sheet=e,this.end.sheet=e}removeSpan(e){e instanceof Ei?this.removeRows(e.start,e.end):this.removeColumns(e.start,e.end)}shouldBeRemoved(){return this.width()<=0||this.height()<=0}rangeWithSameWidth(e,t){return _e.spanFrom(we(this.sheet,this.start.col,e),this.width(),t)}rangeWithSameHeight(e,t){return _e.spanFrom(we(this.sheet,e,this.start.row),t,this.height())}toString(){return`${this.start.sheet},${this.start.col},${this.start.row},${this.end.col},${this.end.row}`}width(){return this.end.col-this.start.col+1}height(){return this.end.row-this.start.row+1}size(){return this.height()*this.width()}arrayOfAddressesInRange(){const e=[];for(let t=0;t<this.height();++t){e[t]=[];for(let r=0;r<this.width();++r){const i=we(this.sheet,this.start.col+r,this.start.row+t);e[t].push(i)}}return e}withStart(e){return new _e(e,this.end)}sameDimensionsAs(e){return this.width()===e.width()&&this.height()===e.height()}sameAs(e){return dg(this.start,e.start)&&dg(this.end,e.end)}addressesArrayMap(e,t){const r=[];let i=this.start.row;for(;i<=this.effectiveEndRow(e);){let s=this.start.col;const o=[];for(;s<=this.effectiveEndColumn(e);)o.push(t(we(this.start.sheet,s,i))),s++;r.push(o),i++}return r}addresses(e){const t=[];let r=this.start.row;const i=this.effectiveEndRow(e),s=this.effectiveEndColumn(e);for(;r<=i;){let o=this.start.col;for(;o<=s;)t.push(we(this.start.sheet,o,r)),o++;r++}return t}*addressesWithDirection(e,t,r){if(e>0)if(t>0){let i=this.effectiveEndRow(r);for(;i>=this.start.row;){let s=this.effectiveEndColumn(r);for(;s>=this.start.col;)yield we(this.start.sheet,s,i),s-=1;i-=1}}else{let i=this.start.row;for(;i<=this.effectiveEndRow(r);){let s=this.effectiveEndColumn(r);for(;s>=this.start.col;)yield we(this.start.sheet,s,i),s-=1;i+=1}}else if(t>0){let i=this.effectiveEndRow(r);for(;i>=this.start.row;){let s=this.start.col;for(;s<=this.effectiveEndColumn(r);)yield we(this.start.sheet,s,i),s+=1;i-=1}}else{let i=this.start.row;for(;i<=this.effectiveEndRow(r);){let s=this.start.col;for(;s<=this.effectiveEndColumn(r);)yield we(this.start.sheet,s,i),s+=1;i+=1}}}getAddress(e,t){if(e<0||t<0||t>this.height()-1||e>this.width()-1)throw Error("Index out of bound");return we(this.start.sheet,this.start.col+e,this.start.row+t)}exceedsSheetSizeLimits(e,t){return this.end.col>=e||this.end.row>=t}effectiveEndColumn(e){return this.end.col}effectiveEndRow(e){return this.end.row}effectiveWidth(e){return this.width()}effectiveHeight(e){return this.height()}removeRows(e,t){if(!(e>this.end.row)){if(t<this.start.row){const r=t-e+1;return this.shiftByRows(-r)}e<=this.start.row&&(this.start.row=e),this.end.row-=Math.min(t,this.end.row)-e+1}}removeColumns(e,t){if(!(e>this.end.col)){if(t<this.start.col){const r=t-e+1;return this.shiftByColumns(-r)}e<=this.start.col&&(this.start.col=e),this.end.col-=Math.min(t,this.end.col)-e+1}}}class qa extends _e{constructor(e,t,r){super(we(e,t,0),we(e,r,Number.POSITIVE_INFINITY))}static fromColumnRange(e,t){const r=e.start.toSimpleColumnAddress(t),i=e.end.toSimpleColumnAddress(t);if(r.sheet!==i.sheet)throw new ug(r.sheet,i.sheet);return new qa(r.sheet,r.col,i.col)}shouldBeRemoved(){return this.width()<=0}shiftByRows(e){}expandByRows(e){}shifted(e,t){return new qa(this.sheet,this.start.col+e,this.end.col+e)}rangeWithSameHeight(e,t){return new qa(this.sheet,e,e+t-1)}exceedsSheetSizeLimits(e,t){return this.end.col>=e}effectiveEndRow(e){return this.effectiveHeight(e)-1}effectiveHeight(e){return e.getSheetHeight(this.sheet)}removeRows(e,t){}}class Xa extends _e{constructor(e,t,r){super(we(e,0,t),we(e,Number.POSITIVE_INFINITY,r))}static fromRowRangeAst(e,t){const r=e.start.toSimpleRowAddress(t),i=e.end.toSimpleRowAddress(t);if(r.sheet!==i.sheet)throw new ug(r.sheet,i.sheet);return new Xa(r.sheet,r.row,i.row)}shouldBeRemoved(){return this.height()<=0}shiftByColumns(e){}expandByColumns(e){}shifted(e,t){return new Xa(this.sheet,this.start.row+t,this.end.row+t)}rangeWithSameWidth(e,t){return new Xa(this.sheet,e,e+t-1)}exceedsSheetSizeLimits(e,t){return this.end.row>=t}effectiveEndColumn(e){return this.effectiveWidth(e)-1}effectiveWidth(e){return e.getSheetWidth(this.sheet)}removeColumns(e,t){}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class ta{constructor(e,t,r){this.formulaAddress=e,this.arraysFlag=t,this.formulaVertex=r}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */function Xpe(n){const e=n.caseSensitive?n.accentSensitive?"variant":"case":n.accentSensitive?"accent":"base",t=n.caseFirst,r=n.ignorePunctuation;return new Intl.Collator(n.localeLang,{sensitivity:e,caseFirst:t,ignorePunctuation:r})}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const Qpe="i",Zpe=/^\s*([+-]?)\s*(([\d\.,]+(e[+-]?\d+)?)\s*([ij]?)|([ij]))\s*(([+-])\s*([+-]?)\s*(([\d\.,]+(e[+-]?\d+)?)\s*([ij]?)|([ij])))?$/;class Jpe{constructor(e,t,r){this.config=e,this.dateTimeHelper=t,this.numberLiteralsHelper=r,this.lt=(i,s)=>this.compare(i,s)<0,this.leq=(i,s)=>this.compare(i,s)<=0,this.gt=(i,s)=>this.compare(i,s)>0,this.geq=(i,s)=>this.compare(i,s)>=0,this.eq=(i,s)=>this.compare(i,s)===0,this.neq=(i,s)=>this.compare(i,s)!==0,this.pow=(i,s)=>Math.pow(me(i),me(s)),this.addWithEpsilonRaw=(i,s)=>{const o=i+s;return Math.abs(o)<this.actualEps*Math.abs(i)?0:o},this.addWithEpsilon=(i,s)=>{const o=bF(i,s);return this.ExtendedNumberFactory(this.addWithEpsilonRaw(me(i),me(s)),o)},this.unaryMinus=i=>ZO(i,-me(i)),this.unaryPlus=i=>i,this.unaryPercent=i=>new Ev(me(i)/100),this.concat=(i,s)=>i.concat(s),this.nonstrictadd=(i,s)=>i instanceof E?i:s instanceof E?s:typeof i=="number"?typeof s=="number"?this.addWithEpsilonRaw(i,s):i:typeof s=="number"?s:0,this.subtract=(i,s)=>{const o=bF(i,s),a=me(i),l=me(s);let u=a-l;return Math.abs(u)<this.actualEps*Math.abs(a)&&(u=0),this.ExtendedNumberFactory(u,o)},this.divide=(i,s)=>{const o=me(i),a=me(s);if(a===0)return new E(N.DIV_BY_ZERO);{const l=TF(i,s);return this.ExtendedNumberFactory(o/a,l)}},this.multiply=(i,s)=>{const o=TF(i,s);return this.ExtendedNumberFactory(me(i)*me(s),o)},this.manyToExactComplex=i=>{const s=[];for(const o of i){if(o instanceof E)return o;if(It(o)||typeof o=="string"){const a=this.coerceScalarToComplex(o);a instanceof E||s.push(a)}}return s},this.coerceNumbersExactRanges=i=>this.manyToNumbers(i,this.manyToExactNumbers),this.coerceNumbersCoerceRangesDropNulls=i=>this.manyToNumbers(i,this.manyToCoercedNumbersDropNulls),this.manyToExactNumbers=i=>{const s=[];for(const o of i){if(o instanceof E)return o;It(o)&&s.push(me(o))}return s},this.manyToOnlyNumbersDropNulls=i=>{const s=[];for(const o of i){if(o instanceof E)return o;if(It(o))s.push(me(o));else if(o!==ht)return new E(N.VALUE,_.NumberExpected)}return s},this.manyToCoercedNumbersDropNulls=i=>{const s=[];for(const o of i){if(o instanceof E)return o;if(o===ht)continue;const a=this.coerceScalarToNumberOrError(o);It(a)&&s.push(me(a))}return s},this.collator=Xpe(e),this.actualEps=e.smartRounding?e.precisionEpsilon:0}eqMatcherFunction(e){const t=this.buildRegex(e);return r=>typeof r=="string"&&t.test(this.normalizeString(r))}neqMatcherFunction(e){const t=this.buildRegex(e);return r=>typeof r!="string"||!t.test(this.normalizeString(r))}searchString(e,t){var r;const s=this.buildRegex(e,!1).exec(t);return(r=s?.index)!==null&&r!==void 0?r:-1}requiresRegex(e){if(!this.config.useRegularExpressions&&!this.config.useWildcards)return!this.config.matchWholeCell;for(let t=0;t<e.length;t++){const r=e.charAt(t);if(fg(r)||this.config.useRegularExpressions&&mg(r))return!0}return!1}floatCmp(e,t){const r=me(e),i=me(t),s=1+this.actualEps;return i>=0&&r*s>=i&&r<=i*s||i<=0&&r*s<=i&&r>=i*s?0:r>i?1:-1}coerceScalarToNumberOrError(e){var t;return e instanceof E?e:(t=this.coerceToMaybeNumber(e))!==null&&t!==void 0?t:new E(N.VALUE,_.NumberCoercion)}coerceToMaybeNumber(e){var t;return(t=this.coerceNonDateScalarToMaybeNumber(e))!==null&&t!==void 0?t:typeof e=="string"?this.dateTimeHelper.dateStringToDateNumber(e):void 0}coerceNonDateScalarToMaybeNumber(e){if(e===ht)return 0;if(typeof e=="string"){if(e==="")return 0;const t=this.coerceStringToMaybePercentNumber(e);if(t!==void 0)return t;const r=this.coerceStringToMaybeCurrencyNumber(e);return r!==void 0?r:this.numberLiteralsHelper.numericStringToMaybeNumber(e.trim())}else return It(e)?e:typeof e=="boolean"?Number(e):void 0}coerceStringToMaybePercentNumber(e){const t=e.trim();if(t.endsWith("%")){const r=t.slice(0,t.length-1).trim(),i=this.numberLiteralsHelper.numericStringToMaybeNumber(r);if(i!==void 0)return new Ev(i/100)}}coerceStringToMaybeCurrencyNumber(e){const t=this.currencyMatcher(e.trim());if(t!==void 0){const[r,i]=t,s=this.numberLiteralsHelper.numericStringToMaybeNumber(i);if(s!==void 0)return new ON(s,r)}}currencyMatcher(e){for(const t of this.config.currencySymbol){if(e.startsWith(t))return[t,e.slice(t.length).trim()];if(e.endsWith(t))return[t,e.slice(0,e.length-t.length).trim()]}}coerceComplexExactRanges(e){const t=[];for(const i of e)if(i instanceof Ae)t.push(i);else if(i!==ht){const s=this.coerceScalarToComplex(i);if(s instanceof E)return s;t.push(s)}const r=[];for(const i of t)if(i instanceof Ae){const s=this.manyToExactComplex(i.valuesFromTopLeftCorner());if(s instanceof E)return s;r.push(...s)}else r.push(i);return r}coerceScalarToComplex(e){return e instanceof E?e:e===ht?[0,0]:It(e)?[me(e),0]:typeof e=="string"?this.coerceStringToComplex(e):new E(N.NUM,_.ComplexNumberExpected)}ExtendedNumberFactory(e,t){const{type:r,format:i}=t;switch(r){case Te.NUMBER_RAW:return e;case Te.NUMBER_CURRENCY:return new ON(e,i??this.config.currencySymbol[0]);case Te.NUMBER_DATE:return new JO(e,i);case Te.NUMBER_DATETIME:return new t_(e,i);case Te.NUMBER_TIME:return new e_(e,i);case Te.NUMBER_PERCENT:return new Ev(e,i)}}buildRegex(e,t=!0){e=this.normalizeString(e);let r,i=this.config.useWildcards,s=this.config.useRegularExpressions;if(s)try{RegExp(e)}catch{s=!1,i=!1}return s?r=rwe(e,this.config.caseSensitive):i?r=twe(e,this.config.caseSensitive):r=nwe(e,this.config.caseSensitive),this.config.matchWholeCell&&t?RegExp("^("+r+")$"):RegExp(r)}normalizeString(e){return this.config.caseSensitive||(e=e.toLowerCase()),this.config.accentSensitive||(e=i2(e,"nfd").replace(/[\u0300-\u036f]/g,"")),e}compare(e,t){if(typeof e=="string"||typeof t=="string"){const r=typeof e=="string"?this.dateTimeHelper.dateStringToDateNumber(e):e,i=typeof t=="string"?this.dateTimeHelper.dateStringToDateNumber(t):t;if(It(r)&&It(i))return this.floatCmp(r,i)}return e===ht?e=RF(t):t===ht&&(t=RF(e)),typeof e=="string"&&typeof t=="string"?this.stringCmp(e,t):typeof e=="boolean"&&typeof t=="boolean"?EF(LN(e),LN(t)):It(e)&&It(t)?this.floatCmp(e,t):e===ht&&t===ht?0:EF(SF(jy(e)),SF(jy(t)))}stringCmp(e,t){return this.collator.compare(e,t)}manyToNumbers(e,t){const r=[];for(const s of e)if(s instanceof Ae)r.push(s);else{const o=me(this.coerceScalarToNumberOrError(s));if(o instanceof E)return o;r.push(o)}const i=[];for(const s of r)if(s instanceof Ae){const o=t(s.valuesFromTopLeftCorner());if(o instanceof E)return o;i.push(...o)}else i.push(s);return i}coerceStringToComplex(e){const t=Zpe.exec(e);if(t===null)return new E(N.NUM,_.ComplexNumberExpected);let r;if(t[6]!==void 0?r=t[1]==="-"?[0,-1]:[0,1]:r=this.parseComplexToken(t[1]+t[3],t[5]),r instanceof E||t[8]===void 0)return r;let i;return t[14]!==void 0?i=t[9]==="-"?[0,-1]:[0,1]:i=this.parseComplexToken(t[9]+t[11],t[13]),i instanceof E?i:t[5]!==""||t[13]===""?new E(N.NUM,_.ComplexNumberExpected):t[8]==="+"?[r[0]+i[0],r[1]+i[1]]:[r[0]-i[0],r[1]-i[1]]}parseComplexToken(e,t){const r=me(this.coerceNonDateScalarToMaybeNumber(e));return r===void 0?new E(N.NUM,_.ComplexNumberExpected):t===""?[r,0]:[0,r]}}function On([n,e],t){if(!isFinite(n)||!isFinite(e))return new E(N.NUM,_.NaN);if(t=t??Qpe,e===0)return`${n}`;const r=`${e===-1||e===1?"":Math.abs(e)}${t}`;return n===0?`${e<0?"-":""}${r}`:`${n}${e<0?"-":"+"}${r}`}function e2(n){return n instanceof Ae?n:Ae.fromScalar(n)}function LN(n){return Number(n)}function RF(n){return typeof n=="string"?"":It(n)?0:typeof n=="boolean"?!1:ht}function t2(n){if(n instanceof E||typeof n=="boolean")return n;if(n===ht)return!1;if(It(n))return me(n)!==0;{const e=n.toUpperCase();return e==="TRUE"?!0:e==="FALSE"||e===""?!1:void 0}}function HN(n){return n instanceof E||typeof n=="string"?n:n===ht?"":It(n)?me(n).toString():n?"TRUE":"FALSE"}function iA(n){return n===ht?0:n}function EF(n,e){const t=me(n),r=me(e);return t>r?1:t<r?-1:0}function n2(n){return isNaN(n)||n===1/0||n===-1/0}function r2(n){return n===0?0:n}function fg(n){return["*","?"].includes(n)}const ewe=["{","}","[","]","(",")","<",">","=",".","+","-",",","\\","$","^","!"];function mg(n){return ewe.includes(n)}function twe(n,e){let t="";for(let r=0;r<n.length;r++){const i=n.charAt(r);if(i==="~"){if(r==n.length-1){t+="~";continue}const s=n.charAt(r+1);fg(s)||mg(s)?(t+="\\"+s,r++):(t+=s,r++)}else fg(i)?t+="."+i:mg(i)?t+="\\"+i:e?t+=i:t+=i.toLowerCase()}return t}function nwe(n,e){let t="";for(let r=0;r<n.length;r++){const i=n.charAt(r);fg(i)||mg(i)?t+="\\"+i:e?t+=i:t+=i.toLowerCase()}return t}function rwe(n,e){let t="";for(let r=0;r<n.length;r++){const i=n.charAt(r);fg(i)||mg(i)||e?t+=i:t+=i.toLowerCase()}return t}function bF(n,e){const{type:t,format:r}=Wy(n),{type:i,format:s}=Wy(e);if(t===Te.NUMBER_RAW)return{type:i,format:s};if(i===Te.NUMBER_RAW)return{type:t,format:r};if((t===Te.NUMBER_DATETIME||t===Te.NUMBER_DATE)&&(i===Te.NUMBER_DATETIME||i===Te.NUMBER_DATE))return{type:Te.NUMBER_RAW};if(t===Te.NUMBER_TIME){if(i===Te.NUMBER_DATE)return{type:Te.NUMBER_DATETIME,format:`${s} ${r}`};if(i===Te.NUMBER_DATETIME)return{type:Te.NUMBER_DATETIME,format:s}}if(i===Te.NUMBER_TIME){if(t===Te.NUMBER_DATE)return{type:Te.NUMBER_DATETIME,format:`${r} ${s}`};if(t===Te.NUMBER_DATETIME)return{type:Te.NUMBER_DATETIME,format:r}}return{type:t,format:r}}function TF(n,e){let{type:t,format:r}=Wy(n),{type:i,format:s}=Wy(e);return t===Te.NUMBER_PERCENT&&(t=Te.NUMBER_RAW,r=void 0),i===Te.NUMBER_PERCENT&&(i=Te.NUMBER_RAW,s=void 0),t===Te.NUMBER_RAW?{type:i,format:s}:i===Te.NUMBER_RAW?{type:t,format:r}:{type:Te.NUMBER_RAW}}function Hm(n){return i2(n.toLowerCase(),"nfd").replace(/[\u0300-\u036f]/g,"")}function Av(n,e){var t;if(n.isAdHoc())return(t=n.data[0])===null||t===void 0?void 0:t[0];const r=n.range;if(e.formulaAddress.sheet===r.sheet){if(r.width()===1){const i=e.formulaAddress.row-r.start.row;if(i>=0&&i<r.height())return n.data[i][0]}else if(r.height()===1){const i=e.formulaAddress.col-r.start.col;if(i>=0&&i<r.width())return n.data[0][i]}}}function i2(n,e){return n.normalize(e.toUpperCase())}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */var m;(function(n){n.STRING="STRING",n.NUMBER="NUMBER",n.BOOLEAN="BOOLEAN",n.SCALAR="SCALAR",n.NOERROR="NOERROR",n.RANGE="RANGE",n.INTEGER="INTEGER",n.COMPLEX="COMPLEX",n.ANY="ANY"})(m||(m={}));class et{constructor(e){this.coerceScalarToNumberOrError=t=>this.arithmeticHelper.coerceScalarToNumberOrError(t),this.runFunction=(t,r,i,s)=>{const o=this.evaluateArguments(t,r,i),a=o.map(([g,p])=>g),l=o.map(([g,p])=>p),u=this.buildMetadataForEachArgumentValue(a.length,i),h=r.arraysFlag&&!i.vectorizationForbidden;if(!this.isNumberOfArgumentValuesValid(u,a.length))return new E(N.NA,_.WrongArgNumber);const[c,d]=h?this.calculateSizeOfVectorizedResultArray(a,u):[1,1];if(c===1&&d===1){const g=this.vectorizeAndBroadcastArgumentsIfNecessary(h,a,u,0,0);return this.calculateSingleCellOfResultArray(r,g,u,l,s,i.returnNumberType)}const f=[...Array(c).keys()].map(g=>[...Array(d).keys()].map(p=>{const v=this.vectorizeAndBroadcastArgumentsIfNecessary(h,a,u,g,p),y=this.calculateSingleCellOfResultArray(r,v,u,l,s,i.returnNumberType);if(y instanceof Ae)throw new Error("Function returning array cannot be vectorized.");return y}));return Ae.onlyValues(f)},this.runFunctionWithReferenceArgument=(t,r,i,s,o,a=()=>new E(N.NA,_.CellRefExpected))=>{if(t.length===0)return this.returnNumberWrapper(s(),i.returnNumberType);if(t.length>1)return new E(N.NA,_.WrongArgNumber);let l=t[0];for(;l.type===M.PARENTHESIS;)l=l.expression;let u;if(l.type===M.CELL_REFERENCE)u=l.reference.toSimpleCellAddress(r.formulaAddress);else if(l.type===M.CELL_RANGE||l.type===M.COLUMN_RANGE||l.type===M.ROW_RANGE)try{u=_e.fromAst(l,r.formulaAddress).start}catch{return new E(N.REF,_.CellRefExpected)}return u!==void 0?this.returnNumberWrapper(o(u),i.returnNumberType):this.runFunction(t,r,i,a)},this.interpreter=e,this.dependencyGraph=e.dependencyGraph,this.columnSearch=e.columnSearch,this.config=e.config,this.serialization=e.serialization,this.arraySizePredictor=e.arraySizePredictor,this.dateTimeHelper=e.dateTimeHelper,this.arithmeticHelper=e.arithmeticHelper}evaluateAst(e,t){return this.interpreter.evaluateAst(e,t)}arraySizeForAst(e,t){return this.arraySizePredictor.checkArraySizeForAst(e,t)}listOfScalarValues(e,t){const r=[];for(const i of e){const s=this.evaluateAst(i,t);if(s instanceof Ae)for(const o of s.valuesFromTopLeftCorner())r.push([o,!0]);else r.push([s,!1])}return r}coerceToType(e,t,r){let i;if(e instanceof Ae)switch(t.argumentType){case m.RANGE:case m.ANY:i=e;break;default:{const s=Av(e,r);if(s===void 0)return;e=s}}if(!(e instanceof Ae))switch(t.argumentType){case m.INTEGER:case m.NUMBER:const s=this.coerceScalarToNumberOrError(e);if(!It(s)){i=s;break}const o=me(s);if(t.maxValue!==void 0&&o>t.maxValue)return new E(N.NUM,_.ValueLarge);if(t.minValue!==void 0&&o<t.minValue)return new E(N.NUM,_.ValueSmall);if(t.lessThan!==void 0&&o>=t.lessThan)return new E(N.NUM,_.ValueLarge);if(t.greaterThan!==void 0&&o<=t.greaterThan)return new E(N.NUM,_.ValueSmall);if(t.argumentType===m.INTEGER&&!Number.isInteger(o))return new E(N.NUM,_.IntegerExpected);i=s;break;case m.STRING:i=HN(e);break;case m.BOOLEAN:i=t2(e);break;case m.SCALAR:case m.NOERROR:case m.ANY:i=e;break;case m.RANGE:if(e instanceof E)return e;i=e2(e);break;case m.COMPLEX:return this.arithmeticHelper.coerceScalarToComplex(me(e))}return t.passSubtype||i===void 0?i:me(i)}calculateSingleCellOfResultArray(e,t,r,i,s,o){const a=this.coerceArgumentsToRequiredTypes(e,t,r,i);if(a instanceof E)return a;const l=s(...a);return this.returnNumberWrapper(l,o)}coerceArgumentsToRequiredTypes(e,t,r,i){const s=[];for(let o=0;o<r.length;o++){const a=r[o],l=t[o]!==void 0?t[o]:a?.defaultValue;if(l===void 0){s.push(void 0);continue}const u=this.coerceToType(l,a,e);if(u===void 0&&!i[o])return new E(N.VALUE,_.WrongType);if(u instanceof E&&a.argumentType!==m.SCALAR)return u;s.push(u)}return s}vectorizeAndBroadcastArgumentsIfNecessary(e,t,r,i,s){return t.map((o,a)=>e&&this.isRangePassedAsAScalarArgument(o,r[a])?this.vectorizeAndBroadcastRangeArgument(o,i,s):o)}vectorizeAndBroadcastRangeArgument(e,t,r){var i;const s=e.height()===1?0:t,o=e.width()===1?0:r;return(i=e.data[s])===null||i===void 0?void 0:i[o]}evaluateArguments(e,t,r){return r.expandRanges?this.listOfScalarValues(e,t):e.map(i=>[this.evaluateAst(i,t),!1])}buildMetadataForEachArgumentValue(e,t){const r=t.parameters?[...t.parameters]:[];if(t.repeatLastArgs!==void 0&&Number.isInteger(t.repeatLastArgs)&&t.repeatLastArgs>0)for(;e>r.length;)r.push(...r.slice(r.length-t.repeatLastArgs));return r}isNumberOfArgumentValuesValid(e,t){return t>e.length?!1:t<e.length?e.slice(t).every(s=>s?.optionalArg||s?.defaultValue!==void 0):!0}calculateSizeOfVectorizedResultArray(e,t){const r=e.filter((o,a)=>this.isRangePassedAsAScalarArgument(o,t[a])),i=Math.max(1,...r.map(o=>o.height())),s=Math.max(1,...r.map(o=>o.width()));return[i,s]}isRangePassedAsAScalarArgument(e,t){return e==null||t==null?!1:e instanceof Ae&&![m.RANGE,m.ANY].includes(t.argumentType)}metadata(e){const t=this.constructor.implementedFunctions[e];if(t!==void 0)return t;throw new Error(`No metadata for function ${e}.`)}returnNumberWrapper(e,t,r){return t!==void 0&&It(e)?this.arithmeticHelper.ExtendedNumberFactory(me(e),{type:t,format:r}):e}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class gt{constructor(e,t,r=!1){this.width=e,this.height=t,this.isRef=r}static error(){return new gt(1,1,!0)}static scalar(){return new gt(1,1,!1)}isScalar(){return this.width===1&&this.height===1||this.isRef}}function iwe(n,e){return new gt(Math.max(n.width,e.width),Math.max(n.height,e.height))}function swe(n){return new gt(n.width,n.height)}class owe{constructor(e,t){this.config=e,this.functionRegistry=t}checkArraySize(e,t){return this.checkArraySizeForAst(e,{formulaAddress:t,arraysFlag:this.config.useArrayArithmetic})}checkArraySizeForAst(e,t){switch(e.type){case M.FUNCTION_CALL:return this.checkArraySizeForFunction(e,t);case M.COLUMN_RANGE:case M.ROW_RANGE:case M.CELL_RANGE:{const r=_e.fromAstOrUndef(e,t.formulaAddress);return r===void 0?gt.error():new gt(r.width(),r.height(),!0)}case M.ARRAY:{const r=[],i=[];for(const a of e.args){const l=a.map(c=>this.checkArraySizeForAst(c,t)),u=Math.min(...l.map(c=>c.height)),h=l.reduce((c,d)=>c+d.width,0);r.push(u),i.push(h)}const s=r.reduce((a,l)=>a+l,0),o=Math.min(...i);return new gt(o,s)}case M.STRING:case M.NUMBER:return gt.scalar();case M.CELL_REFERENCE:return new gt(1,1,!0);case M.DIV_OP:case M.CONCATENATE_OP:case M.EQUALS_OP:case M.GREATER_THAN_OP:case M.GREATER_THAN_OR_EQUAL_OP:case M.LESS_THAN_OP:case M.LESS_THAN_OR_EQUAL_OP:case M.MINUS_OP:case M.NOT_EQUAL_OP:case M.PLUS_OP:case M.POWER_OP:case M.TIMES_OP:{const r=this.checkArraySizeForAst(e.left,t),i=this.checkArraySizeForAst(e.right,t);return!t.arraysFlag&&(r.height>1||r.width>1||i.height>1||i.width>1)?gt.error():iwe(r,i)}case M.MINUS_UNARY_OP:case M.PLUS_UNARY_OP:case M.PERCENT_OP:{const r=this.checkArraySizeForAst(e.value,t);return!t.arraysFlag&&(r.height>1||r.width>1)?gt.error():swe(r)}case M.PARENTHESIS:return this.checkArraySizeForAst(e.expression,t);case M.EMPTY:return gt.error();default:return gt.error()}}checkArraySizeForFunction(e,t){const r=this.functionRegistry.getArraySizeFunction(e.procedureName);if(r!==void 0)return r(e,t);const i=this.functionRegistry.getMetadata(e.procedureName);if(i===void 0||i.expandRanges||!t.arraysFlag||i.vectorizationForbidden||i.parameters===void 0)return new gt(1,1);const s=e.args.map(u=>{var h;return this.checkArraySizeForAst(u,new ta(t.formulaAddress,t.arraysFlag||((h=i?.arrayFunction)!==null&&h!==void 0?h:!1)))}),o=[...i.parameters];if(i.repeatLastArgs!==void 0&&o.length<s.length&&(s.length-o.length)%i.repeatLastArgs!==0)return gt.error();for(;o.length<s.length;){if(i.repeatLastArgs===void 0)return gt.error();o.push(...o.slice(o.length-i.repeatLastArgs))}let a=1,l=1;for(let u=0;u<s.length;u++)o[u].argumentType!==m.RANGE&&o[u].argumentType!==m.ANY&&(l=Math.max(l,s[u].height),a=Math.max(a,s[u].width));return new gt(a,l)}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class s2{constructor(e,t,r){var i;this.value=t,this.address=r,this.type=e.type,this.message=(i=e.message)!==null&&i!==void 0?i:""}toString(){return this.value}valueOf(){return this.value}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */function Ht(n,e,t){if(typeof n>"u")return Tr.defaultConfig[t];if(typeof e=="string"){if(typeof n===e)return n;throw new Nt(e,t)}else{if(e.includes(n))return n;throw new KG(e.map(r=>`'${r}'`).join(" "),t)}}function Hc(n,e,t){if(n<t)throw new zG(e,t)}function awe(n,e,t){if(n>t)throw new YG(e,t)}function Hw(n,e,t,r){if(e(n))return n;if(typeof n>"u")return Tr.defaultConfig[r];throw new Nt(t,r)}function AF(...n){const e=new Map;n.forEach(r=>{const i=e.get(r.value)||[];i.push(r.name),e.set(r.value,i)});const t=[];for(const r of e.values())r.length>1&&t.push(r);if(t.length>0){t.forEach(i=>i.sort());const r=t.map(i=>`[${i}]`).join("; ");throw new Error(`Config initialization failed. Parameters in conflict: ${r}`)}}function le(n,e,t){if(typeof n!==e)throw new Nt(e,t)}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const i_=new RegExp("^ss(\\.(s+|0+))?$"),lwe=new RegExp("^[0-9/.\\-: ]+[ap]?m?$"),uwe=new RegExp("\\s+"),o2=new RegExp("[ /.-]"),DN=":",NF=1e3,hwe=a2(fwe),cwe=a2(mwe);function dwe(n,e,t){if(e===void 0&&t===void 0)return;let r=n.replace(uwe," ").trim().toLowerCase();if(!gwe(r))return;let i=r.substring(r.length-2);i==="am"||i==="pm"?r=r.substring(0,r.length-2).trim():(i=r.substring(r.length-1),i==="a"||i==="p"?r=r.substring(0,r.length-1).trim():i=void 0);const s=r.split(o2);s.length>=2&&s[s.length-2].includes(DN)&&(s[s.length-2]=s[s.length-2]+"."+s[s.length-1],s.pop());const o=s[s.length-1].split(DN);if(i!==void 0&&o.push(i),s.length===1)return MF(o,t);if(o.length===1)return IF(s,e);const a=IF(s.slice(0,s.length-1),e),l=MF(o,t);if(a!==void 0)return l===void 0?void 0:Object.assign(Object.assign({},a),l)}function MF(n,e){var t,r,i;if(e===void 0)return;const{itemsCount:s,hourItem:o,minuteItem:a,secondItem:l}=hwe(e);let u;if(n[n.length-1]==="am"||n[n.length-1]==="a"?(u=!1,n.pop()):(n[n.length-1]==="pm"||n[n.length-1]==="p")&&(u=!0,n.pop()),n.length!==s)return;const h=Number((t=n[l])!==null&&t!==void 0?t:"0");if(!Number.isFinite(h))return;const c=Math.round(h*NF)/NF,d=Number((r=n[a])!==null&&r!==void 0?r:"0");if(!(Number.isFinite(d)&&Number.isInteger(d)))return;const f=Number((i=n[o])!==null&&i!==void 0?i:"0");return!(Number.isFinite(f)&&Number.isInteger(f))||u!==void 0&&(f<0||f>12)?void 0:{hours:u!==void 0?f%12+(u?12:0):f,minutes:d,seconds:c}}function IF(n,e){var t;if(e===void 0)return;const{itemsCount:r,dayItem:i,monthItem:s,shortYearItem:o,longYearItem:a}=cwe(e);if(n.length!==r)return;const l=Number(n[i]);if(!(Number.isFinite(l)&&Number.isInteger(l)))return;const u=Number(n[s]);if(!(Number.isFinite(u)&&Number.isInteger(u))||n[a]&&n[o])return;const h=Number((t=n[a])!==null&&t!==void 0?t:n[o]);if(Number.isFinite(h)&&Number.isInteger(h)&&!(n[a]&&(h<1e3||h>9999))&&!(n[o]&&(h<0||h>99)))return{year:h,month:u,day:l}}function fwe(n){const e=n.toLowerCase().trim(),r=(e.endsWith("am/pm")?e.substring(0,e.length-5):e.endsWith("a/p")?e.substring(0,n.length-3):e).trim().split(DN);return{itemsCount:r.length,hourItem:r.indexOf("hh"),minuteItem:r.indexOf("mm"),secondItem:r.findIndex(i=>i_.test(i))}}function mwe(n){const e=n.toLowerCase().trim().split(o2);return{itemsCount:e.length,dayItem:e.indexOf("dd"),monthItem:e.indexOf("mm"),shortYearItem:e.indexOf("yy"),longYearItem:e.indexOf("yyyy")}}function gwe(n){return lwe.test(n)}function a2(n){const e={};return t=>{const r=e[t];if(r!==void 0)return r;const i=n(t);return e[t]=i,i}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const FN=[31,28,31,30,31,30,31,31,30,31,30,31],rd=[0,31,59,90,120,151,181,212,243,273,304,334],Dw=60,Fw=60,kN=24;function Dm(n){return n&&(typeof n=="object"||typeof n=="function")?"year"in n&&typeof n.year=="number"&&"month"in n&&typeof n.month=="number"&&"day"in n&&typeof n.day=="number":!1}function l2(n){return n&&(typeof n=="object"||typeof n=="function")?"hours"in n&&typeof n.hours=="number"&&"minutes"in n&&typeof n.minutes=="number"&&"seconds"in n&&typeof n.seconds=="number":!1}const pwe={year:9999,month:12,day:31};class wwe{constructor(e){this.config=e,this.minDateAbsoluteValue=this.dateToNumberFromZero(e.nullDate),this.maxDateValue=this.dateToNumber(pwe),this.leapYear1900=e.leapYear1900,!this.leapYear1900&&0<=this.dateToNumber({year:1900,month:2,day:28})?this.epochYearZero=this.numberToSimpleDate(2).year:this.epochYearZero=this.numberToSimpleDate(1).year,this.parseDateTime=e.parseDateTime}getWithinBounds(e){return e<=this.maxDateValue&&e>=0?e:void 0}dateStringToDateNumber(e){const{dateTime:t,dateFormat:r="",timeFormat:i=""}=this.parseDateTimeFromConfigFormats(e);if(t!==void 0)return l2(t)?Dm(t)?new t_(pd(t)+this.dateToNumber(t),r+" "+i):new e_(pd(t),i):Dm(t)?new JO(this.dateToNumber(t),r):0}parseDateTimeFromConfigFormats(e){return this.parseDateTimeFromFormats(e,this.config.dateFormats,this.config.timeFormats)}getNullYear(){return this.config.nullYear}getEpochYearZero(){return this.epochYearZero}isValidDate(e){return isNaN(e.year)||isNaN(e.month)||isNaN(e.day)||e.day!==Math.round(e.day)||e.month!==Math.round(e.month)||e.year!==Math.round(e.year)||e.year<1582||e.month<1||e.month>12||e.day<1?!1:this.isLeapYear(e.year)&&e.month===2?e.day<=29:e.day<=FN[e.month-1]}dateToNumber(e){return this.dateToNumberFromZero(e)-this.minDateAbsoluteValue}relativeNumberToAbsoluteNumber(e){return e+this.minDateAbsoluteValue-(this.leapYear1900?1:0)}numberToSimpleDate(e){const t=Math.floor(e)+this.minDateAbsoluteValue;let r=Math.floor(t/365.2425);this.dateToNumberFromZero({year:r+1,month:1,day:1})<=t?r++:this.dateToNumberFromZero({year:r-1,month:1,day:1})>t&&r--;const i=t-this.dateToNumberFromZero({year:r,month:1,day:1}),s=vwe(i-(this.isLeapYear(r)&&i>=59?1:0)),o=i-rd[s]-(this.isLeapYear(r)&&s>1?1:0);return{year:r,month:s+1,day:o+1}}numberToSimpleDateTime(e){const t=gd(e%1),r=Math.floor(t.hours/kN);t.hours=t.hours%kN;const i=this.numberToSimpleDate(Math.floor(e)+r);return Object.assign(Object.assign({},i),t)}leapYearsCount(e){return Math.floor(e/4)-Math.floor(e/100)+Math.floor(e/400)+(this.config.leapYear1900&&e>=1900?1:0)}daysInMonth(e,t){return this.isLeapYear(e)&&t===2?29:FN[t-1]}endOfMonth(e){return{year:e.year,month:e.month,day:this.daysInMonth(e.year,e.month)}}toBasisUS(e,t){return e.day===31&&(e.day=30),e.day===30&&t.day===31&&(t.day=30),e.month===2&&e.day===this.daysInMonth(e.year,e.month)&&(e.day=30,t.month===2&&t.day===this.daysInMonth(t.year,t.month)&&(t.day=30)),[e,t]}yearLengthForBasis(e,t){return e.year!==t.year?e.year+1!==t.year||e.month<t.month||e.month===t.month&&e.day<t.day?(this.leapYearsCount(t.year)-this.leapYearsCount(e.year-1))/(t.year-e.year+1)+365:this.countLeapDays(t)!==this.countLeapDays({year:e.year,month:e.month,day:e.day-1})?366:365:this.isLeapYear(e.year)?366:365}parseSingleFormat(e,t,r){const i=this.parseDateTime(e,t,r);if(!(Dm(i)&&(i.year>=0&&i.year<100&&(i.year<this.getNullYear()?i.year+=2e3:i.year+=1900),!this.isValidDate(i))))return i}parseDateTimeFromFormats(e,t,r){const i=t.length===0?[void 0]:t,s=r.length===0?[void 0]:r;for(const o of i)for(const a of s){const l=this.parseSingleFormat(e,o,a);if(l!==void 0)return{dateTime:l,timeFormat:a,dateFormat:o}}return{}}countLeapDays(e){return e.month>2||e.month===2&&e.day>=29?this.leapYearsCount(e.year):this.leapYearsCount(e.year-1)}dateToNumberFromZero(e){return 365*e.year+rd[e.month-1]+e.day-1+(e.month<=2?this.leapYearsCount(e.year-1):this.leapYearsCount(e.year))}isLeapYear(e){return e%4?!1:e%100?!0:e%400?e===1900&&this.config.leapYear1900:!0}}function vwe(n){let e=0;return rd[e+6]<=n&&(e+=6),rd[e+3]<=n&&(e+=3),rd[e+2]<=n?e+=2:rd[e+1]<=n&&(e+=1),e}function OF(n,e){const t=12*n.year+n.month-1+e;return{year:Math.floor(t/12),month:t%12+1,day:n.day}}function ywe(n){return{year:n.year,month:n.month,day:Math.min(n.day,FN[n.month-1])}}function sA(n){return Math.round(n*3600*24)/(3600*24)}function Cwe(n,e=1){return Math.round(n*e)/e}function gd(n){const e=n*kN*Fw*Dw,t=Cwe(e%Dw,1e5)%Dw,r=(e-t)/Dw,i=Math.round(r%Fw)%Fw,s=(r-i)/Fw;return{hours:Math.round(s),minutes:i,seconds:t}}function pd(n){return((n.seconds/60+n.minutes)/60+n.hours)/24}function _F(n){return{year:n.year,month:n.month,day:Math.min(30,n.day)}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class Swe{call(){return Bpe}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const PF=/(\\.|dd|DD|d|D|mm|MM|m|M|YYYY|YY|yyyy|yy|HH|hh|H|h|ss(\.(0+|s+))?|s|AM\/PM|am\/pm|A\/P|a\/p|\[mm]|\[MM]|\[hh]|\[HH])/g,xF=/(\\.|[#0]+(\.[#0]*)?)/g;var Jo;(function(n){n.FORMAT="FORMAT",n.FREE_TEXT="FREE_TEXT"})(Jo||(Jo={}));function kw(n,e){return{type:n,value:e}}var zy;(function(n){n.DATE="DATE",n.NUMBER="NUMBER",n.STRING="STRING"})(zy||(zy={}));function Rwe(n){PF.lastIndex=0;const e=[];let t;do t=PF.exec(n),t!==null&&e.push(t);while(t);return e}function Ewe(n){xF.lastIndex=0;const e=xF.exec(n);return e!==null?[e]:[]}function u2(n,e){const t=[];let r=0;for(let s=0;s<n.length;++s){const o=n[s];if(o.index!==r){const a=e.substr(r,o.index-r);t.push(kw(Jo.FREE_TEXT,a))}o[0].startsWith("\\")?t.push(kw(Jo.FREE_TEXT,o[0])):t.push(kw(Jo.FORMAT,o[0])),r=o.index+o[0].length}const i=n[n.length-1];if(i.index+i[0].length<e.length){const s=e.substr(i.index+i[0].length,e.length);t.push(kw(Jo.FREE_TEXT,s))}return t}function h2(n){const e=Rwe(n);if(!e.every(t=>c2(t)))return{type:zy.DATE,tokens:u2(e,n)}}function bwe(n){const e=Ewe(n);if(!e.every(t=>c2(t)))return{type:zy.NUMBER,tokens:u2(e,n)}}function c2(n){return n[0].startsWith("\\")}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */function Twe(n,e,t,r){const i=t.stringifyDateTime(r.numberToSimpleDateTime(n),e);if(i!==void 0)return i;const s=t.stringifyDuration(gd(n),e);if(s!==void 0)return s;const o=bwe(e);return o!==void 0?Nwe(o.tokens,n):e}function Ci(n,e){let t=`${n}`;for(;t.length<e;)t="0"+t;return t}function Awe(n,e){let t=`${n}`;for(;t.length<e;)t=t+"0";return t}function LF(n,e){return n.split(e).length-1}function Nwe(n,e){let t="";for(let r=0;r<n.length;++r){const i=n[r];if(i.type===Jo.FREE_TEXT){t+=i.value;continue}const s=i.value.split("."),o=s[0],a=s[1]||"",l=s[1]?".":"",u=Number(e.toFixed(a.length)).toString().split(".");let h=u[0]||"",c=u[1]||"";if(o.length>h.length){const f=LF(o.substr(0,o.length-h.length),"0");h=Ci(h,f+h.length)}const d=LF(a.substr(c.length,a.length-c.length),"0");c=Awe(c,d+c.length),t+=h+l+c}return t}function Mwe(n,e){const t=h2(e);if(t===void 0)return;const r=t.tokens;let i="";for(const s of r){if(s.type===Jo.FREE_TEXT){i+=s.value;continue}switch(s.value.toLowerCase()){case"h":case"hh":{i+=Ci(n.hours,s.value.length),n.hours=0;break}case"[hh]":{i+=Ci(n.hours,s.value.length-2),n.hours=0;break}case"m":case"mm":{i+=Ci(n.minutes,s.value.length),n.minutes=0;break}case"[mm]":{i+=Ci(n.minutes+60*n.hours,s.value.length-2),n.minutes=0,n.hours=0;break}case"s":case"ss":{i+=Ci(Math.floor(n.seconds),s.value.length);break}default:{if(i_.test(s.value)){const o=Math.max(s.value.length-3,0);i+=`${n.seconds<10?"0":""}${Math.floor(n.seconds*Math.pow(10,o))/Math.pow(10,o)}`;continue}return}}}return i}function Iwe(n,e){const t=h2(e);if(t===void 0)return;const r=t.tokens;let i="",s=!1;const o=r.some(a=>a.type===Jo.FORMAT&&(a.value==="a/p"||a.value==="A/P"||a.value==="am/pm"||a.value==="AM/PM"));for(let a=0;a<r.length;a++){const l=r[a];if(l.type===Jo.FREE_TEXT){i+=l.value;continue}switch(l.value.toLowerCase()){case"h":case"hh":{s=!0,i+=Ci(o?(n.hours+11)%12+1:n.hours,l.value.length);break}case"d":case"dd":{i+=Ci(n.day,l.value.length);break}case"s":case"ss":{i+=Ci(Math.floor(n.seconds),l.value.length);break}case"m":case"mm":{a+1<r.length&&r[a+1].value.startsWith(":")&&(s=!0),s?i+=Ci(n.minutes,l.value.length):i+=Ci(n.month,l.value.length),s=!0;break}case"yy":{i+=Ci(n.year%100,l.value.length);break}case"yyyy":{i+=n.year;break}case"am/pm":case"a/p":{const[u,h]=l.value.split("/");i+=n.hours<12?u:h;break}default:{if(i_.test(l.value)){const u=l.value.length-3;i+=`${n.seconds<10?"0":""}${Math.floor(n.seconds*Math.pow(10,u))/Math.pow(10,u)}`;continue}return}}}return i}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const VN="length",Fm=n=>parseInt(n,16),HF=n=>parseInt(n,10),oA=n=>(n+"").replace(/\-/g,""),Yy=(n,e,t)=>n.substr(e,t),zs=n=>n.codePointAt(0)-65;function Owe(n){return oA(n)[VN]===25?Fm(Yy(oA(n),Fm("12"),zs("F")))/(Fm(Yy(oA(n),zs("C"),zs("Y")>>4))||(~~![][VN]<<3)+1):0}function _we(n){if(n=(n+"").replace(/\-/g,""),n[VN]!==zs("Z"))return!1;let e=0;return[[0,zs("G")+1],[zs("H"),zs("H")-1],[zs("G")+zs("H"),zs("G")]].reduce((t,[r,i],s)=>(t|=(HF(`${HF(Fm(Yy(n,e+r-(s===0?0:2),i+(s?2:0)))+(Fm(Yy(n,e+r+i,2))+[]).padStart(2,"0"))}`)%97||2)>>1,e+=2,t),zs("A"))==="1">>1}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const Pwe={invalid:()=>"The license key for HyperFormula is invalid.",expired:({keyValidityDate:n})=>`The license key for HyperFormula expired on ${n}, and is not valid for the installed version.`,missing:()=>"The license key for HyperFormula is missing."};let DF=!1;function xwe(n){const e={template:"missing",vars:{}};if(n==="gpl-v3"||n==="internal-use-in-handsontable")e.template="valid";else if(typeof n=="string"&&_we(n)){const[t,r,i]="18/07/2024".split("/"),s=Math.floor(new Date(`${r}/${t}/${i}`).getTime()/864e5),o=Owe(n);e.vars.keyValidityDate=Lwe(new Date((o+1)*864e5)),s>o?e.template="expired":e.template="valid"}else n!==""&&(e.template="invalid");return!DF&&e.template!=="valid"&&(console.warn(Pwe[e.template](e.vars)),DF=!0),e.template}function Lwe(n){const t=["January","February","March","April","May","June","July","August","September","October","November","December"][n.getMonth()],r=n.getDate(),i=n.getFullYear();return`${t} ${r}, ${i}`}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */var fn;(function(n){class e{constructor(l){this.value=l,this.value=ZO(this.value,r2(me(this.value)))}}n.Number=e;class t{constructor(l){this.value=l}}n.String=t;class r{constructor(l){this.value=l}}n.Boolean=r;class i{static getSingletonInstance(){return i.instance||(i.instance=new i),i.instance}}n.Empty=i;class s{constructor(l){this.formula=l}}n.Formula=s;class o{constructor(l,u){this.value=new E(l,u)}}n.Error=o})(fn||(fn={}));function Hwe(n){return n.startsWith("=")}function Dwe(n){const e=n.toLowerCase();return e==="true"||e==="false"}function Fwe(n,e){const t=n.toUpperCase();return/#[A-Za-z0-9\/]+[?!]?/.test(t)&&Object.prototype.hasOwnProperty.call(e,t)}class kwe{constructor(e,t,r){this.config=e,this.dateHelper=t,this.numberLiteralsHelper=r}parse(e){if(e==null)return fn.Empty.getSingletonInstance();if(typeof e=="number")return n2(e)?new fn.Error(N.NUM,_.ValueLarge):new fn.Number(e);if(typeof e=="boolean")return new fn.Boolean(e);if(e instanceof Date){const t=this.dateHelper.dateToNumber({day:e.getDate(),month:e.getMonth()+1,year:e.getFullYear()}),r=pd({hours:e.getHours(),minutes:e.getMinutes(),seconds:e.getSeconds()+e.getMilliseconds()/1e3}),i=t+r;return i<0?new fn.Error(N.NUM,_.DateBounds):i%1===0?new fn.Number(new JO(i,"Date()")):i<1?new fn.Number(new e_(i,"Date()")):new fn.Number(new t_(i,"Date()"))}else if(typeof e=="string"){if(Dwe(e))return new fn.Boolean(e.toLowerCase()==="true");if(Hwe(e))return new fn.Formula(e);if(Fwe(e,this.config.errorMapping))return new fn.Error(this.config.errorMapping[e.toUpperCase()]);{let t=e.trim(),r=0,i;if(t.endsWith("%"))r=1,t=t.slice(0,t.length-1);else{const a=this.currencyMatcher(t);a!==void 0&&(r=2,[i,t]=a)}const s=this.numberLiteralsHelper.numericStringToMaybeNumber(t);if(s!==void 0){let a;return r===1?a=new Ev(s/100):r===2?a=new ON(s,i):a=s,new fn.Number(a)}const o=this.dateHelper.dateStringToDateNumber(t);return o!==void 0?new fn.Number(o):new fn.String(e.startsWith("'")?e.slice(1):e)}}else throw new jG(e)}currencyMatcher(e){for(const t of this.config.currencySymbol){if(e.startsWith(t))return[t,e.slice(t.length)];if(e.endsWith(t))return[t,e.slice(0,e.length-t.length)]}}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */var lh;(function(n){n[n.COPY=0]="COPY",n[n.CUT=1]="CUT"})(lh||(lh={}));var Er;(function(n){n[n.VALUE=0]="VALUE",n[n.EMPTY=1]="EMPTY",n[n.FORMULA=2]="FORMULA",n[n.PARSING_ERROR=3]="PARSING_ERROR"})(Er||(Er={}));class FF{constructor(e,t,r,i,s){this.sourceLeftCorner=e,this.width=t,this.height=r,this.type=i,this.content=s}*getContent(e){if(this.content!==void 0)for(let t=0;t<this.height;++t)for(let r=0;r<this.width;++r)yield[we(e.sheet,e.col+r,e.row+t),this.content[t][r]]}}class Vwe{constructor(e,t,r){this.dependencyGraph=t,this.operations=r,this.maxRows=e.maxRows,this.maxColumns=e.maxColumns}cut(e,t,r){this.clipboard=new FF(e,t,r,lh.CUT)}copy(e,t,r){const i=[];for(let s=0;s<r;++s){i[s]=[];for(let o=0;o<t;++o){const a=this.operations.getClipboardCell(we(e.sheet,e.col+o,e.row+s));i[s].push(a)}}this.clipboard=new FF(e,t,r,lh.COPY,i)}abortCut(){this.clipboard&&this.clipboard.type===lh.CUT&&this.clear()}clear(){this.clipboard=void 0}ensureItIsPossibleToCopyPaste(e){if(this.clipboard===void 0)return;if(Ri(e)||!this.dependencyGraph.sheetMapping.hasSheetWithId(e.sheet))throw new Kn("a valid target address.");const t=_e.spanFrom(e,this.clipboard.width,this.clipboard.height);if(t.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new Sh;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(t))throw new Error("It is not possible to paste onto an array")}isCutClipboard(){return this.clipboard!==void 0&&this.clipboard.type===lh.CUT}isCopyClipboard(){return this.clipboard!==void 0&&this.clipboard.type===lh.COPY}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class Ky{constructor(e,t,r,i){this.displayName=e,this.address=t,this.added=r,this.options=i}normalizeExpressionName(){return this.displayName.toLowerCase()}copy(){return new Ky(this.displayName,this.address,this.added,this.options)}}class Uwe{constructor(){this.mapping=new Map}has(e){return this.mapping.has(this.normalizeExpressionName(e))}isNameAvailable(e){const t=this.normalizeExpressionName(e),r=this.mapping.get(t);return!(r&&r.added)}add(e){this.mapping.set(e.normalizeExpressionName(),e)}get(e){return this.mapping.get(this.normalizeExpressionName(e))}getExisting(e){const t=this.mapping.get(this.normalizeExpressionName(e));if(t&&t.added)return t}remove(e){const t=this.normalizeExpressionName(e),r=this.mapping.get(t);r&&(r.added=!1)}getAllNamedExpressions(){return Array.from(this.mapping.values()).filter(e=>e.added)}normalizeExpressionName(e){return e.toLowerCase()}}class kF{constructor(){this.mapping=new Map}add(e){this.mapping.set(this.normalizeExpressionName(e.displayName),e)}get(e){return this.mapping.get(this.normalizeExpressionName(e))}has(e){return this.mapping.has(this.normalizeExpressionName(e))}getAllNamedExpressions(){return Array.from(this.mapping.values()).filter(e=>e.added)}isNameAvailable(e){const t=this.normalizeExpressionName(e);return!this.mapping.has(t)}remove(e){const t=this.normalizeExpressionName(e);this.mapping.get(t)&&this.mapping.delete(t)}normalizeExpressionName(e){return e.toLowerCase()}}class Hh{constructor(){this.nextNamedExpressionRow=0,this.workbookStore=new Uwe,this.worksheetStores=new Map,this.addressCache=new Map}isNameAvailable(e,t){var r,i;return t===void 0?this.workbookStore.isNameAvailable(e):(i=(r=this.worksheetStore(t))===null||r===void 0?void 0:r.isNameAvailable(e))!==null&&i!==void 0?i:!0}namedExpressionInAddress(e){const t=this.addressCache.get(e);if(t&&t.added)return t}namedExpressionForScope(e,t){var r;return t===void 0?this.workbookStore.getExisting(e):(r=this.worksheetStore(t))===null||r===void 0?void 0:r.get(e)}nearestNamedExpression(e,t){var r,i;return(i=(r=this.worksheetStore(t))===null||r===void 0?void 0:r.get(e))!==null&&i!==void 0?i:this.workbookStore.getExisting(e)}isExpressionInScope(e,t){var r,i;return(i=(r=this.worksheetStore(t))===null||r===void 0?void 0:r.has(e))!==null&&i!==void 0?i:!1}isNameValid(e){const t=new RegExp(`^${N$}$`),r=new RegExp(`^${M$}$`),i=new RegExp(`^${I$}$`);return t.test(e)||r.test(e)?!1:i.test(e)}addNamedExpression(e,t,r){const i=t===void 0?this.workbookStore:this.worksheetStoreOrCreate(t);let s=i.get(e);return s!==void 0?(s.added=!0,s.displayName=e,s.options=r):(s=new Ky(e,this.nextAddress(),!0,r),i.add(s)),this.addressCache.set(s.address.row,s),s}restoreNamedExpression(e,t){const r=t===void 0?this.workbookStore:this.worksheetStoreOrCreate(t);return e.added=!0,r.add(e),this.addressCache.set(e.address.row,e),e}namedExpressionOrPlaceholder(e,t){var r;return(r=this.worksheetStoreOrCreate(t).get(e))!==null&&r!==void 0?r:this.workbookNamedExpressionOrPlaceholder(e)}workbookNamedExpressionOrPlaceholder(e){let t=this.workbookStore.get(e);return t===void 0&&(t=new Ky(e,this.nextAddress(),!1),this.workbookStore.add(t)),t}remove(e,t){let r;t===void 0?r=this.workbookStore:r=this.worksheetStore(t);const i=r?.get(e);if(r===void 0||i===void 0||!i.added)throw Error("Named expression does not exist");r.remove(e),r instanceof kF&&r.mapping.size===0&&this.worksheetStores.delete(t),this.addressCache.delete(i.address.row)}getAllNamedExpressionsNamesInScope(e){return this.getAllNamedExpressions().filter(({scope:t})=>t===e).map(t=>t.expression.displayName)}getAllNamedExpressionsNames(){return this.getAllNamedExpressions().map(e=>e.expression.displayName)}getAllNamedExpressions(){const e=[];return this.workbookStore.getAllNamedExpressions().forEach(t=>{e.push({expression:t,scope:void 0})}),this.worksheetStores.forEach((t,r)=>{t.getAllNamedExpressions().forEach(i=>{e.push({expression:i,scope:r})})}),e}getAllNamedExpressionsForScope(e){var t,r;return e===void 0?this.workbookStore.getAllNamedExpressions():(r=(t=this.worksheetStores.get(e))===null||t===void 0?void 0:t.getAllNamedExpressions())!==null&&r!==void 0?r:[]}worksheetStoreOrCreate(e){let t=this.worksheetStores.get(e);return t||(t=new kF,this.worksheetStores.set(e,t)),t}worksheetStore(e){return this.worksheetStores.get(e)}nextAddress(){return we(Hh.SHEET_FOR_WORKBOOK_EXPRESSIONS,0,this.nextNamedExpressionRow++)}}Hh.SHEET_FOR_WORKBOOK_EXPRESSIONS=-1;const Pl=n=>{switch(n.type){case M.EMPTY:case M.NUMBER:case M.STRING:case M.ERROR:case M.ERROR_WITH_RAW_INPUT:return!1;case M.CELL_REFERENCE:return!n.reference.isAbsolute();case M.CELL_RANGE:case M.COLUMN_RANGE:case M.ROW_RANGE:return!n.start.isAbsolute();case M.NAMED_EXPRESSION:return!1;case M.PERCENT_OP:case M.PLUS_UNARY_OP:case M.MINUS_UNARY_OP:return Pl(n.value);case M.CONCATENATE_OP:case M.EQUALS_OP:case M.NOT_EQUAL_OP:case M.LESS_THAN_OP:case M.GREATER_THAN_OP:case M.LESS_THAN_OR_EQUAL_OP:case M.GREATER_THAN_OR_EQUAL_OP:case M.MINUS_OP:case M.PLUS_OP:case M.TIMES_OP:case M.DIV_OP:case M.POWER_OP:return Pl(n.left)||Pl(n.right);case M.PARENTHESIS:return Pl(n.expression);case M.FUNCTION_CALL:return n.args.some(e=>Pl(e));case M.ARRAY:return n.args.some(e=>e.some(t=>Pl(t)))}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class mu{performEagerTransformations(e,t){for(const r of e.arrayFormulaNodes()){const[i,s]=this.transformSingleAst(r.getFormula(e.lazilyTransformingAstService),r.getAddress(e.lazilyTransformingAstService)),o=t.rememberNewAst(i);r.setFormula(o),r.setAddress(s)}}transformSingleAst(e,t){const r=this.transformAst(e,t),i=this.fixNodeAddress(t);return[r,i]}transformAst(e,t){switch(e.type){case M.CELL_REFERENCE:return this.transformCellReferenceAst(e,t);case M.CELL_RANGE:return this.transformCellRangeAst(e,t);case M.COLUMN_RANGE:return this.transformColumnRangeAst(e,t);case M.ROW_RANGE:return this.transformRowRangeAst(e,t);case M.EMPTY:case M.ERROR:case M.NUMBER:case M.NAMED_EXPRESSION:case M.ERROR_WITH_RAW_INPUT:case M.STRING:return e;case M.PERCENT_OP:case M.MINUS_UNARY_OP:case M.PLUS_UNARY_OP:return Object.assign(Object.assign({},e),{value:this.transformAst(e.value,t)});case M.FUNCTION_CALL:return Object.assign(Object.assign({},e),{procedureName:e.procedureName,args:e.args.map(r=>this.transformAst(r,t))});case M.PARENTHESIS:return Object.assign(Object.assign({},e),{expression:this.transformAst(e.expression,t)});case M.ARRAY:return Object.assign(Object.assign({},e),{args:e.args.map(r=>r.map(i=>this.transformAst(i,t)))});default:return Object.assign(Object.assign({},e),{left:this.transformAst(e.left,t),right:this.transformAst(e.right,t)})}}transformCellReferenceAst(e,t){const r=this.transformCellAddress(e.reference,t);return r instanceof Xt?Object.assign(Object.assign({},e),{reference:r}):r===N.REF?Go(new E(N.REF)):e}transformCellRangeAst(e,t){const r=this.transformCellRange(e.start,e.end,t);return Array.isArray(r)?Object.assign(Object.assign({},e),{start:r[0],end:r[1]}):r===N.REF?Go(new E(N.REF)):e}transformColumnRangeAst(e,t){const r=this.transformColumnRange(e.start,e.end,t);return Array.isArray(r)?Object.assign(Object.assign({},e),{start:r[0],end:r[1]}):r===N.REF?Go(new E(N.REF)):e}transformRowRangeAst(e,t){const r=this.transformRowRange(e.start,e.end,t);return Array.isArray(r)?Object.assign(Object.assign({},e),{start:r[0],end:r[1]}):r===N.REF?Go(new E(N.REF)):e}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class Bwe extends mu{constructor(e){super(),this.columnsSpan=e}get sheet(){return this.columnsSpan.sheet}isIrreversible(){return!1}transformRowRangeAst(e,t){return e}transformCellRange(e,t,r){return this.transformRange(e,t,r)}transformRowRange(e,t,r){throw Error("Not implemented")}transformColumnRange(e,t,r){return this.transformRange(e,t,r)}transformCellAddress(e,t){const r=no(e,t);if(r!==this.columnsSpan.sheet&&t.sheet!==this.columnsSpan.sheet)return!1;const i=e.toSimpleColumnAddress(t);return r===this.columnsSpan.sheet&&t.sheet!==this.columnsSpan.sheet?this.columnsSpan.columnStart<=i.col?e.shiftedByColumns(this.columnsSpan.numberOfColumns):!1:t.sheet===this.columnsSpan.sheet&&r!==this.columnsSpan.sheet?e.isColumnAbsolute()||t.col<this.columnsSpan.columnStart?!1:e.shiftedByColumns(-this.columnsSpan.numberOfColumns):e.isColumnAbsolute()?e.col<this.columnsSpan.columnStart?!1:e.shiftedByColumns(this.columnsSpan.numberOfColumns):e.toSimpleColumnAddress(t).col<this.columnsSpan.columnStart?t.col<this.columnsSpan.columnStart?!1:e.shiftedByColumns(-this.columnsSpan.numberOfColumns):t.col<this.columnsSpan.columnStart?e.shiftedByColumns(this.columnsSpan.numberOfColumns):!1}fixNodeAddress(e){return this.columnsSpan.sheet===e.sheet&&this.columnsSpan.columnStart<=e.col?Object.assign(Object.assign({},e),{col:e.col+this.columnsSpan.numberOfColumns}):e}transformRange(e,t,r){const i=this.transformCellAddress(e,r),s=this.transformCellAddress(t,r);return i===N.REF||s===N.REF?N.REF:i||s?[i||e,s||t]:!1}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class UN extends mu{constructor(e){super(),this.rowsSpan=e}get sheet(){return this.rowsSpan.sheet}isIrreversible(){return!1}transformColumnRangeAst(e,t){return e}transformCellRange(e,t,r){return this.transformRange(e,t,r)}transformRowRange(e,t,r){return this.transformRange(e,t,r)}transformColumnRange(e,t,r){throw Error("Not implemented")}transformCellAddress(e,t){const r=no(e,t);if(r!==this.rowsSpan.sheet&&t.sheet!==this.rowsSpan.sheet)return!1;const i=e.toSimpleRowAddress(t);return r===this.rowsSpan.sheet&&t.sheet!==this.rowsSpan.sheet?this.rowsSpan.rowStart<=i.row?e.shiftedByRows(this.rowsSpan.numberOfRows):!1:t.sheet===this.rowsSpan.sheet&&r!==this.rowsSpan.sheet?e.isRowAbsolute()||t.row<this.rowsSpan.rowStart?!1:e.shiftedByRows(-this.rowsSpan.numberOfRows):e.isRowAbsolute()?e.row<this.rowsSpan.rowStart?!1:e.shiftedByRows(this.rowsSpan.numberOfRows):i.row<this.rowsSpan.rowStart?t.row<this.rowsSpan.rowStart?!1:e.shiftedByRows(-this.rowsSpan.numberOfRows):t.row<this.rowsSpan.rowStart?e.shiftedByRows(this.rowsSpan.numberOfRows):!1}fixNodeAddress(e){return this.rowsSpan.sheet===e.sheet&&this.rowsSpan.rowStart<=e.row?Object.assign(Object.assign({},e),{row:e.row+this.rowsSpan.numberOfRows}):e}transformRange(e,t,r){const i=this.transformCellAddress(e,r),s=this.transformCellAddress(t,r);return i===N.REF||s===N.REF?N.REF:i||s?[i||e,s||t]:!1}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class Wwe extends mu{constructor(e){super(),this.sheet=e}isIrreversible(){return!0}fixNodeAddress(e){return e}transformCellAddress(e,t){return e.isInvalid(t)?N.REF:!1}transformCellRange(e,t,r){return e.isInvalid(r)||t.isInvalid(r)?N.REF:!1}transformColumnRange(e,t,r){return e.isInvalid(r)||t.isInvalid(r)?N.REF:!1}transformRowRange(e,t,r){return e.isInvalid(r)||t.isInvalid(r)?N.REF:!1}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class $we extends mu{constructor(e,t,r,i){super(),this.sourceRange=e,this.toRight=t,this.toBottom=r,this.toSheet=i,this.dependentFormulaTransformer=new Gwe(e,t,r,i)}get sheet(){return this.sourceRange.sheet}isIrreversible(){return!0}transformSingleAst(e,t){return this.sourceRange.addressInRange(t)?[this.transformAst(e,t),this.fixNodeAddress(t)]:this.dependentFormulaTransformer.transformSingleAst(e,t)}fixNodeAddress(e){return we(this.toSheet,e.col+this.toRight,e.row+this.toBottom)}transformCellAddress(e,t){return this.transformAddress(e,t)}transformCellRange(e,t,r){return this.transformRange(e,t,r)}transformColumnRange(e,t,r){return this.transformRange(e,t,r)}transformRowRange(e,t,r){return this.transformRange(e,t,r)}transformAddress(e,t){const r=this.sourceRange;if(e instanceof Xt){const i=e.toSimpleCellAddress(t);if(r.addressInRange(i))return e.shiftAbsoluteDimensions(this.toRight,this.toBottom)}return e.shiftRelativeDimensions(-this.toRight,-this.toBottom)}transformRange(e,t,r){const i=this.sourceRange;if(e instanceof Xt&&t instanceof Xt){const s=e.toSimpleCellAddress(r),o=t.toSimpleCellAddress(r);if(i.addressInRange(s)&&i.addressInRange(o))return[e.shiftAbsoluteDimensions(this.toRight,this.toBottom),t.shiftAbsoluteDimensions(this.toRight,this.toBottom)]}return[e.shiftRelativeDimensions(-this.toRight,-this.toBottom),t.shiftRelativeDimensions(-this.toRight,-this.toBottom)]}}class Gwe extends mu{constructor(e,t,r,i){super(),this.sourceRange=e,this.toRight=t,this.toBottom=r,this.toSheet=i}get sheet(){return this.sourceRange.sheet}isIrreversible(){return!0}fixNodeAddress(e){return e}transformCellAddress(e,t){return this.shouldMove(e,t)?e.moved(this.toSheet,this.toRight,this.toBottom):!1}transformCellRange(e,t,r){return this.transformRange(e,t,r)}transformColumnRange(e,t,r){return this.transformRange(e,t,r)}transformRowRange(e,t,r){return this.transformRange(e,t,r)}shouldMove(e,t){return e instanceof Xt?this.sourceRange.addressInRange(e.toSimpleCellAddress(t)):e instanceof kr?this.sourceRange.rowInRange(e.toSimpleRowAddress(t))&&!this.sourceRange.isFinite():this.sourceRange.columnInRange(e.toSimpleColumnAddress(t))&&!this.sourceRange.isFinite()}transformRange(e,t,r){const i=this.transformCellAddress(e,r),s=this.transformCellAddress(t,r);return i&&s?[i,s]:!1}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class jwe extends mu{constructor(e){super(),this.columnsSpan=e}get sheet(){return this.columnsSpan.sheet}isIrreversible(){return!0}transformRowRangeAst(e,t){return e}transformCellRange(e,t,r){return this.transformRange(e,t,r)}transformRowRange(e,t,r){throw Error("Not implemented")}transformColumnRange(e,t,r){return this.transformRange(e,t,r)}transformCellAddress(e,t){const r=no(e,t);if(this.columnsSpan.sheet!==t.sheet&&this.columnsSpan.sheet!==r)return!1;if(this.columnsSpan.sheet!==t.sheet&&this.columnsSpan.sheet===r){const i=e.toSimpleColumnAddress(t);if(i.col<this.columnsSpan.columnStart)return!1;if(i.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns)}if(this.columnsSpan.sheet===t.sheet&&this.columnsSpan.sheet!==r){if(e.isColumnAbsolute())return!1;if(t.col<this.columnsSpan.columnStart)return!1;if(t.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(this.columnsSpan.numberOfColumns)}if(this.columnsSpan.sheet===t.sheet&&this.columnsSpan.sheet===r)if(e.isColumnAbsolute()){if(e.col<this.columnsSpan.columnStart)return!1;if(e.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns)}else{const i=e.toSimpleColumnAddress(t);if(i.col<this.columnsSpan.columnStart){if(t.col<this.columnsSpan.columnStart)return!1;if(t.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(this.columnsSpan.numberOfColumns)}else if(i.col>this.columnsSpan.columnEnd){if(t.col<this.columnsSpan.columnStart)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns);if(t.col>this.columnsSpan.columnEnd)return!1}}return N.REF}fixNodeAddress(e){return this.columnsSpan.sheet===e.sheet&&this.columnsSpan.columnStart<=e.col?Object.assign(Object.assign({},e),{col:e.col-this.columnsSpan.numberOfColumns}):e}transformRange(e,t,r){const i=no(e,r);let s=e,o=t;if(this.columnsSpan.sheet===i){const u=e.toSimpleColumnAddress(r),h=t.toSimpleColumnAddress(r);if(this.columnsSpan.columnStart<=u.col&&this.columnsSpan.columnEnd>=h.col)return N.REF;u.col>=this.columnsSpan.columnStart&&u.col<=this.columnsSpan.columnEnd&&(s=e.shiftedByColumns(this.columnsSpan.columnEnd-u.col+1)),h.col>=this.columnsSpan.columnStart&&h.col<=this.columnsSpan.columnEnd&&(o=t.shiftedByColumns(-(h.col-this.columnsSpan.columnStart+1)))}const a=this.transformCellAddress(s,r),l=this.transformCellAddress(o,r);if(a===!1&&l===!1)return[s,o];if(a===N.REF||l===N.REF)throw Error("Cannot happen");return[a||s,l||o]}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class BN extends mu{constructor(e){super(),this.rowsSpan=e}get sheet(){return this.rowsSpan.sheet}isIrreversible(){return!0}transformColumnRangeAst(e,t){return e}transformCellAddress(e,t){const r=no(e,t);if(this.rowsSpan.sheet!==t.sheet&&this.rowsSpan.sheet!==r)return!1;if(this.rowsSpan.sheet!==t.sheet&&this.rowsSpan.sheet===r){const i=e.toSimpleRowAddress(t);if(i.row<this.rowsSpan.rowStart)return!1;if(i.row>this.rowsSpan.rowEnd)return e.shiftedByRows(-this.rowsSpan.numberOfRows)}if(this.rowsSpan.sheet===t.sheet&&this.rowsSpan.sheet!==r){if(e.isRowAbsolute())return!1;if(t.row<this.rowsSpan.rowStart)return!1;if(t.row>this.rowsSpan.rowEnd)return e.shiftedByRows(this.rowsSpan.numberOfRows)}if(this.rowsSpan.sheet===t.sheet&&this.rowsSpan.sheet===r)if(e.isRowAbsolute()){if(e.row<this.rowsSpan.rowStart)return!1;if(e.row>this.rowsSpan.rowEnd)return e.shiftedByRows(-this.rowsSpan.numberOfRows)}else{const i=e.toSimpleRowAddress(t);if(i.row<this.rowsSpan.rowStart){if(t.row<this.rowsSpan.rowStart)return!1;if(t.row>this.rowsSpan.rowEnd)return e.shiftedByRows(this.rowsSpan.numberOfRows)}else if(i.row>this.rowsSpan.rowEnd){if(t.row<this.rowsSpan.rowStart)return e.shiftedByRows(-this.rowsSpan.numberOfRows);if(t.row>this.rowsSpan.rowEnd)return!1}}return N.REF}transformCellRange(e,t,r){return this.transformRange(e,t,r)}transformRowRange(e,t,r){return this.transformRange(e,t,r)}transformColumnRange(e,t,r){throw Error("Not implemented")}fixNodeAddress(e){return this.rowsSpan.sheet===e.sheet&&this.rowsSpan.rowStart<=e.row?Object.assign(Object.assign({},e),{row:e.row-this.rowsSpan.numberOfRows}):e}transformRange(e,t,r){const i=no(e,r);let s=e,o=t;if(this.rowsSpan.sheet===i){const u=e.toSimpleRowAddress(r),h=t.toSimpleRowAddress(r);if(this.rowsSpan.rowStart<=u.row&&this.rowsSpan.rowEnd>=h.row)return N.REF;u.row>=this.rowsSpan.rowStart&&u.row<=this.rowsSpan.rowEnd&&(s=e.shiftedByRows(this.rowsSpan.rowEnd-u.row+1)),h.row>=this.rowsSpan.rowStart&&h.row<=this.rowsSpan.rowEnd&&(o=t.shiftedByRows(-(h.row-this.rowsSpan.rowStart+1)))}const a=this.transformCellAddress(s,r),l=this.transformCellAddress(o,r);return a===!1&&l===!1?[s,o]:a===N.REF||l===N.REF?N.REF:[a||s,l||o]}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class zwe extends mu{constructor(e){super(),this.sheet=e}isIrreversible(){return!0}performEagerTransformations(e,t){for(const r of e.arrayFormulaNodes()){const[i]=this.transformSingleAst(r.getFormula(e.lazilyTransformingAstService),r.getAddress(e.lazilyTransformingAstService));r.setFormula(i)}}fixNodeAddress(e){return e}transformCellAddress(e,t){return this.transformAddress(e)}transformCellRange(e,t,r){return this.transformAddress(e)}transformColumnRange(e,t,r){return this.transformAddress(e)}transformRowRange(e,t,r){return this.transformAddress(e)}transformAddress(e){return e.sheet===this.sheet?N.REF:!1}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */function d2(n){if(!Array.isArray(n))throw new Kn("an array of arrays.");for(let e=0;e<n.length;e++)if(!Array.isArray(n[e]))throw new Kn("an array of arrays.")}function qy(n){let e=0,t=0,r=0;for(let s=0;s<n.length;s++){let o=0;for(let a=0;a<n[s].length;a++){const l=n[s][a];l!=null&&(o=a+1,++r)}e=Math.max(e,o),o>0&&(t=s+1)}const i=e*t;return{height:t,width:e,fill:i===0?0:r/i}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class f2{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return Xy(this.indexes)}rowsSpans(){return this.normalizedIndexes().map(e=>Ei.fromNumberOfRows(this.sheet,e[0],e[1]))}}class m2{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return Qy(this.indexes)}rowsSpans(){return this.normalizedIndexes().map(e=>Ei.fromNumberOfRows(this.sheet,e[0],e[1]))}}class g2{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return Qy(this.indexes)}columnsSpans(){return this.normalizedIndexes().map(e=>Ui.fromNumberOfColumns(this.sheet,e[0],e[1]))}}class p2{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return Xy(this.indexes)}columnsSpans(){return this.normalizedIndexes().map(e=>Ui.fromNumberOfColumns(this.sheet,e[0],e[1]))}}class Ywe{constructor(e,t,r,i,s,o,a,l,u){this.dependencyGraph=t,this.columnSearch=r,this.cellContentParser=i,this.parser=s,this.stats=o,this.lazilyTransformingAstService=a,this.namedExpressions=l,this.arraySizePredictor=u,this.changes=Jl.empty(),this.allocateNamedExpressionAddressSpace(),this.maxColumns=e.maxColumns,this.maxRows=e.maxRows}get sheetMapping(){return this.dependencyGraph.sheetMapping}get addressMapping(){return this.dependencyGraph.addressMapping}removeRows(e){const t=[];for(const r of e.rowsSpans()){const i=this.doRemoveRows(r);i&&t.push(i)}return t}addRows(e){for(const t of e.rowsSpans())this.doAddRows(t)}addColumns(e){for(const t of e.columnsSpans())this.doAddColumns(t)}removeColumns(e){const t=[];for(const r of e.columnsSpans()){const i=this.doRemoveColumns(r);i&&t.push(i)}return t}removeSheet(e){this.dependencyGraph.removeSheet(e);let t=0;this.stats.measure(Ke.TRANSFORM_ASTS,()=>{const i=new zwe(e);i.performEagerTransformations(this.dependencyGraph,this.parser),t=this.lazilyTransformingAstService.addTransformation(i)}),this.sheetMapping.removeSheet(e),this.columnSearch.removeSheet(e);const r=this.namedExpressions.getAllNamedExpressionsForScope(e).map(i=>this.removeNamedExpression(i.normalizeExpressionName(),e));return{version:t,scopedNamedExpressions:r}}removeSheetByName(e){const t=this.sheetMapping.fetch(e);return this.removeSheet(t)}clearSheet(e){this.dependencyGraph.clearSheet(e),this.columnSearch.removeSheet(e)}addSheet(e){const t=this.sheetMapping.addSheet(e),r=[];return this.dependencyGraph.addressMapping.autoAddSheet(t,qy(r)),this.sheetMapping.fetchDisplayName(t)}renameSheet(e,t){return this.sheetMapping.renameSheet(e,t)}moveRows(e,t,r,i){const s=Ei.fromNumberOfRows(e,i,r);this.lazilyTransformingAstService.beginCombinedMode(e),this.doAddRows(s),i<t&&(t+=r);const o=we(e,0,t),a=we(e,0,i);this.moveCells(o,Number.POSITIVE_INFINITY,r,a);const l=Ei.fromNumberOfRows(e,t,r);return this.doRemoveRows(l),this.lazilyTransformingAstService.commitCombinedMode()}moveColumns(e,t,r,i){const s=Ui.fromNumberOfColumns(e,i,r);this.lazilyTransformingAstService.beginCombinedMode(e),this.doAddColumns(s),i<t&&(t+=r);const o=we(e,t,0),a=we(e,i,0);this.moveCells(o,r,Number.POSITIVE_INFINITY,a);const l=Ui.fromNumberOfColumns(e,t,r);return this.doRemoveColumns(l),this.lazilyTransformingAstService.commitCombinedMode()}moveCells(e,t,r,i){this.ensureItIsPossibleToMoveCells(e,t,r,i);const s=_e.spanFrom(e,t,r),o=_e.spanFrom(i,t,r),a=i.col-e.col,l=i.row-e.row,u=i.sheet,h=this.getRangeClipboardCells(o),c=this.dependencyGraph.rawValuesFromRange(o);this.columnSearch.removeValues(c);const d=this.dependencyGraph.rawValuesFromRange(s);this.columnSearch.moveValues(d,a,l,u);let f=0;this.stats.measure(Ke.TRANSFORM_ASTS,()=>{const p=new $we(s,a,l,u);p.performEagerTransformations(this.dependencyGraph,this.parser),f=this.lazilyTransformingAstService.addTransformation(p)}),this.dependencyGraph.moveCells(s,a,l,u);const g=this.updateNamedExpressionsForMovedCells(e,t,r,i);return{version:f,overwrittenCellsData:h,addedGlobalNamedExpressions:g}}setRowOrder(e,t){const r=[];let i=[];for(const[s,o]of t)if(s!==o){const a=_e.spanFrom({sheet:e,col:0,row:s},1/0,1),l=this.getRangeClipboardCells(a);i=i.concat(l),r.push(l.map(([{sheet:u,col:h},c])=>[{sheet:u,col:h,row:o},c]))}return r.forEach(s=>this.restoreClipboardCells(e,s.values())),i}setColumnOrder(e,t){const r=[];let i=[];for(const[s,o]of t)if(s!==o){const a=_e.spanFrom({sheet:e,col:s,row:0},1,1/0),l=this.getRangeClipboardCells(a);i=i.concat(l),r.push(l.map(([{sheet:u,col:h,row:c},d])=>[{sheet:u,col:o,row:c},d]))}return r.forEach(s=>this.restoreClipboardCells(e,s.values())),i}addNamedExpression(e,t,r,i){const s=this.namedExpressions.addNamedExpression(e,r,i);this.storeNamedExpressionInCell(s.address,t),this.adjustNamedExpressionEdges(s,e,r)}restoreNamedExpression(e,t,r){const i=e.displayName;this.restoreCell(e.address,t);const s=this.namedExpressions.restoreNamedExpression(e,r);this.adjustNamedExpressionEdges(s,i,r)}changeNamedExpressionExpression(e,t,r,i){const s=this.namedExpressions.namedExpressionForScope(e,r);if(!s)throw new hg(e);const o=s.copy();s.options=i;const a=this.getClipboardCell(s.address);return this.storeNamedExpressionInCell(s.address,t),[o,a]}removeNamedExpression(e,t){const r=this.namedExpressions.namedExpressionForScope(e,t);if(!r)throw new hg(e);this.namedExpressions.remove(r.displayName,t);const i=this.getClipboardCell(r.address);if(t!==void 0){const s=this.namedExpressions.workbookNamedExpressionOrPlaceholder(e);this.dependencyGraph.exchangeNode(r.address,s.address)}else this.dependencyGraph.setCellEmpty(r.address);return[r,i]}ensureItIsPossibleToMoveCells(e,t,r,i){if(Ri(e)||!(Zy(t)&&Zy(r)||Kwe(e,t,r))||Ri(i)||!this.sheetMapping.hasSheetWithId(e.sheet)||!this.sheetMapping.hasSheetWithId(i.sheet))throw new Kn("a valid range of cells to move.");const s=_e.spanFrom(e,t,r),o=_e.spanFrom(i,t,r);if(o.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new Sh;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(s))throw new nd;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(o))throw new $y}restoreClipboardCells(e,t){const r=[];for(const[i,s]of t)if(this.restoreCell(i,s),s.type===Er.FORMULA){const{dependencies:o}=this.parser.fetchCachedResult(s.hash);r.push(...this.updateNamedExpressionsForTargetAddress(e,i,o))}return r}restoreCell(e,t){switch(t.type){case Er.VALUE:{this.setValueToCell(t,e);break}case Er.FORMULA:{this.setFormulaToCellFromCache(t.hash,e);break}case Er.EMPTY:{this.setCellEmpty(e);break}case Er.PARSING_ERROR:{this.setParsingErrorToCell(t.rawInput,t.errors,e);break}}}getOldContent(e){const t=this.dependencyGraph.getCell(e);if(t===void 0||t instanceof Vl)return[e,{type:Er.EMPTY}];if(t instanceof eu)return[e,Object.assign({type:Er.VALUE},t.getValues())];if(t instanceof Bi)return[t.getAddress(this.lazilyTransformingAstService),{type:Er.FORMULA,hash:this.parser.computeHashFromAst(t.getFormula(this.lazilyTransformingAstService))}];if(t instanceof md)return[e,{type:Er.PARSING_ERROR,rawInput:t.rawInput,errors:t.errors}];throw Error("Trying to copy unsupported type")}getClipboardCell(e){const t=this.dependencyGraph.getCell(e);if(t===void 0||t instanceof Vl)return{type:Er.EMPTY};if(t instanceof eu)return Object.assign({type:Er.VALUE},t.getValues());if(t instanceof Bn){const r=t.getArrayCellValue(e);return r===ht?{type:Er.EMPTY}:{type:Er.VALUE,parsedValue:r,rawValue:t.getArrayCellRawValue(e)}}else{if(t instanceof Zo)return{type:Er.FORMULA,hash:this.parser.computeHashFromAst(t.getFormula(this.lazilyTransformingAstService))};if(t instanceof md)return{type:Er.PARSING_ERROR,rawInput:t.rawInput,errors:t.errors}}throw Error("Trying to copy unsupported type")}getSheetClipboardCells(e){const t=this.dependencyGraph.getSheetHeight(e),r=this.dependencyGraph.getSheetWidth(e),i=new Array(t);for(let s=0;s<t;s++){i[s]=new Array(r);for(let o=0;o<r;o++){const a=we(e,o,s);i[s][o]=this.getClipboardCell(a)}}return i}getRangeClipboardCells(e){const t=[];for(const r of e.addresses(this.dependencyGraph))t.push([r,this.getClipboardCell(r)]);return t}setCellContent(e,t){const r=this.cellContentParser.parse(t),i=this.getOldContent(e);if(r instanceof fn.Formula){const s=this.parser.parse(r.formula,e),{ast:o,errors:a}=s;if(a.length>0)this.setParsingErrorToCell(r.formula,a,e);else try{const l=this.arraySizePredictor.checkArraySize(o,e);if(l.width<=0||l.height<=0)throw Error("Incorrect array size");this.setFormulaToCell(e,l,s)}catch(l){if(!l.message)throw l;const u={type:Pn.InvalidRangeSize,message:"Invalid range size."};this.setParsingErrorToCell(r.formula,[u],e)}}else r instanceof fn.Empty?this.setCellEmpty(e):this.setValueToCell({parsedValue:r.value,rawValue:t},e);return i}setSheetContent(e,t){this.clearSheet(e);for(let r=0;r<t.length;r++)for(let i=0;i<t[r].length;i++){const s=we(e,i,r);this.setCellContent(s,t[r][i])}}setParsingErrorToCell(e,t,r){const i=this.dependencyGraph.getCellValue(r),s=new md(t,e),o=this.dependencyGraph.setParsingErrorToCell(r,s);this.columnSearch.remove(me(i),r),this.columnSearch.applyChanges(o.getChanges()),this.changes.addAll(o),this.changes.addChange(s.getCellValue(),r)}setFormulaToCell(e,t,{ast:r,hasVolatileFunction:i,hasStructuralChangeFunction:s,dependencies:o}){const a=this.dependencyGraph.getCellValue(e),l=this.dependencyGraph.setFormulaToCell(e,r,jo(o,e),t,i,s);this.columnSearch.remove(me(a),e),this.columnSearch.applyChanges(l.getChanges()),this.changes.addAll(l)}setValueToCell(e,t){const r=this.dependencyGraph.getCellValue(t),i=this.dependencyGraph.setValueToCell(t,e);this.columnSearch.change(me(r),me(e.parsedValue),t),this.columnSearch.applyChanges(i.getChanges().filter(s=>!dg(s.address,t))),this.changes.addAll(i),this.changes.addChange(e.parsedValue,t)}setCellEmpty(e){if(this.dependencyGraph.isArrayInternalCell(e))return;const t=this.dependencyGraph.getCellValue(e),r=this.dependencyGraph.setCellEmpty(e);this.columnSearch.remove(me(t),e),this.columnSearch.applyChanges(r.getChanges()),this.changes.addAll(r),this.changes.addChange(ht,e)}setFormulaToCellFromCache(e,t){const{ast:r,hasVolatileFunction:i,hasStructuralChangeFunction:s,dependencies:o}=this.parser.fetchCachedResult(e),a=jo(o,t),[l]=new Wwe(t.sheet).transformSingleAst(r,t);this.parser.rememberNewAst(l);const u=Cpe(a),h=this.arraySizePredictor.checkArraySize(r,t);this.dependencyGraph.setFormulaToCell(t,l,u,h,i,s)}rowEffectivelyNotInSheet(e,t){const r=this.dependencyGraph.addressMapping.getHeight(t);return e>=r}getAndClearContentChanges(){const e=this.changes;return this.changes=Jl.empty(),e}forceApplyPostponedTransformations(){this.dependencyGraph.forceApplyPostponedTransformations()}doRemoveRows(e){if(this.rowEffectivelyNotInSheet(e.rowStart,e.sheet))return;const t=[];for(const[o]of this.dependencyGraph.entriesFromRowsSpan(e))t.push({address:o,cellType:this.getClipboardCell(o)});const{affectedArrays:r,contentChanges:i}=this.dependencyGraph.removeRows(e);this.columnSearch.applyChanges(i.getChanges());let s=0;return this.stats.measure(Ke.TRANSFORM_ASTS,()=>{const o=new BN(e);o.performEagerTransformations(this.dependencyGraph,this.parser),s=this.lazilyTransformingAstService.addTransformation(o)}),this.rewriteAffectedArrays(r),{version:s,removedCells:t,rowFrom:e.rowStart,rowCount:e.numberOfRows}}doRemoveColumns(e){if(this.columnEffectivelyNotInSheet(e.columnStart,e.sheet))return;const t=[];for(const[o]of this.dependencyGraph.entriesFromColumnsSpan(e))t.push({address:o,cellType:this.getClipboardCell(o)});const{affectedArrays:r,contentChanges:i}=this.dependencyGraph.removeColumns(e);this.columnSearch.applyChanges(i.getChanges()),this.columnSearch.removeColumns(e);let s=0;return this.stats.measure(Ke.TRANSFORM_ASTS,()=>{const o=new jwe(e);o.performEagerTransformations(this.dependencyGraph,this.parser),s=this.lazilyTransformingAstService.addTransformation(o)}),this.rewriteAffectedArrays(r),{version:s,removedCells:t,columnFrom:e.columnStart,columnCount:e.numberOfColumns}}doAddRows(e){if(this.rowEffectivelyNotInSheet(e.rowStart,e.sheet))return;const{affectedArrays:t}=this.dependencyGraph.addRows(e);this.stats.measure(Ke.TRANSFORM_ASTS,()=>{const r=new UN(e);r.performEagerTransformations(this.dependencyGraph,this.parser),this.lazilyTransformingAstService.addTransformation(r)}),this.rewriteAffectedArrays(t)}rewriteAffectedArrays(e){for(const t of e.values()){if(t.array.size.isRef)continue;const r=t.getFormula(this.lazilyTransformingAstService),i=t.getAddress(this.lazilyTransformingAstService),s=this.parser.computeHashFromAst(r);this.setFormulaToCellFromCache(s,i)}}doAddColumns(e){if(this.columnEffectivelyNotInSheet(e.columnStart,e.sheet))return;const{affectedArrays:t,contentChanges:r}=this.dependencyGraph.addColumns(e);this.columnSearch.addColumns(e),this.columnSearch.applyChanges(r.getChanges()),this.stats.measure(Ke.TRANSFORM_ASTS,()=>{const i=new Bwe(e);i.performEagerTransformations(this.dependencyGraph,this.parser),this.lazilyTransformingAstService.addTransformation(i)}),this.rewriteAffectedArrays(t)}columnEffectivelyNotInSheet(e,t){const r=this.dependencyGraph.addressMapping.getWidth(t);return e>=r}adjustNamedExpressionEdges(e,t,r){if(r===void 0)return;const{vertex:i,id:s}=this.dependencyGraph.fetchCellOrCreateEmpty(e.address),o=s??this.dependencyGraph.graph.getNodeId(i),a=this.namedExpressions.workbookNamedExpressionOrPlaceholder(t),{vertex:l,id:u}=this.dependencyGraph.fetchCellOrCreateEmpty(a.address),h=u??this.dependencyGraph.graph.getNodeId(l);for(const c of this.dependencyGraph.graph.adjacentNodes(l))if(c instanceof Zo&&c.getAddress(this.lazilyTransformingAstService).sheet===r){const d=c.getFormula(this.lazilyTransformingAstService),f=c.getAddress(this.lazilyTransformingAstService),{dependencies:g}=this.parser.fetchCachedResultForAst(d);for(const p of jo(g,f))p instanceof za&&p.name.toLowerCase()===e.displayName.toLowerCase()&&(this.dependencyGraph.graph.removeEdge(h,c),this.dependencyGraph.graph.addEdge(o,c))}}storeNamedExpressionInCell(e,t){const r=this.cellContentParser.parse(t);if(r instanceof fn.Formula){const i=this.parser.parse(r.formula,we(-1,0,0));if(Pl(i.ast))throw new n_;const{ast:s,hasVolatileFunction:o,hasStructuralChangeFunction:a,dependencies:l}=i;this.dependencyGraph.setFormulaToCell(e,s,jo(l,e),gt.scalar(),o,a)}else r instanceof fn.Empty?this.setCellEmpty(e):this.setValueToCell({parsedValue:r.value,rawValue:t},e)}updateNamedExpressionsForMovedCells(e,t,r,i){if(e.sheet===i.sheet)return[];const s=[],o=_e.spanFrom(i,t,r);for(const a of o.addresses(this.dependencyGraph)){const l=this.addressMapping.fetchCell(a);if(l instanceof Zo&&a.sheet!==e.sheet){const u=l.getFormula(this.lazilyTransformingAstService),{dependencies:h}=this.parser.fetchCachedResultForAst(u);s.push(...this.updateNamedExpressionsForTargetAddress(e.sheet,a,h))}}return s}updateNamedExpressionsForTargetAddress(e,t,r){if(e===t.sheet)return[];const i=[],s=this.addressMapping.fetchCell(t);for(const o of jo(r,t)){if(!(o instanceof za))continue;const a=o.name,l=this.dependencyGraph.fetchNamedExpressionVertex(a,e).vertex,h=this.namedExpressions.isExpressionInScope(a,t.sheet)?this.dependencyGraph.fetchNamedExpressionVertex(a,t.sheet).vertex:this.copyOrFetchGlobalNamedExpressionVertex(a,l,i);h!==l&&(this.dependencyGraph.graph.removeEdgeIfExists(l,s),this.dependencyGraph.graph.addEdge(h,s))}return i}allocateNamedExpressionAddressSpace(){this.dependencyGraph.addressMapping.addSheet(Hh.SHEET_FOR_WORKBOOK_EXPRESSIONS,new Upe(0,0))}copyOrFetchGlobalNamedExpressionVertex(e,t,r){let i=this.namedExpressions.namedExpressionForScope(e);if(i===void 0)if(i=this.namedExpressions.addNamedExpression(e),r.push(i.normalizeExpressionName()),t instanceof Zo){const s=this.parser.fetchCachedResultForAst(t.getFormula(this.lazilyTransformingAstService)),{ast:o,hasVolatileFunction:a,hasStructuralChangeFunction:l,dependencies:u}=s;this.dependencyGraph.setFormulaToCell(i.address,o,jo(u,i.address),gt.scalar(),a,l)}else t instanceof Vl?this.setCellEmpty(i.address):t instanceof eu&&this.setValueToCell(t.getValues(),i.address);return this.dependencyGraph.fetchCellOrCreateEmpty(i.address).vertex}}function Xy(n){if(n.length<=1)return n;const e=[...n].sort(([i],[s])=>i-s),t=e.reduce((i,[s,o])=>{const a=i[i.length-1],l=a[0]+a[1];return s<=l?a[1]+=Math.max(0,o-(l-s)):i.push([s,o]),i},[e[0]]);let r=0;for(let i=0;i<t.length;++i)t[i][0]-=r,r+=t[i][1];return t}function Qy(n){if(n.length<=1)return n;const e=[...n].sort(([i],[s])=>i-s),t=e.reduce((i,[s,o])=>{const a=i[i.length-1];return s===a[0]?a[1]=Math.max(a[1],o):i.push([s,o]),i},[e[0]]);let r=0;for(let i=0;i<t.length;++i)t[i][0]+=r,r+=t[i][1];return t}function Zy(n){return Number.isInteger(n)&&n>0}function Kwe(n,e,t){return n.row===0&&Zy(e)&&t===Number.POSITIVE_INFINITY||n.col===0&&Zy(t)&&e===Number.POSITIVE_INFINITY}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class Xn{}class qwe extends Xn{constructor(e,t){super(),this.command=e,this.rowsRemovals=t}doUndo(e){e.undoRemoveRows(this)}doRedo(e){e.redoRemoveRows(this)}}class Xwe extends Xn{constructor(e,t,r,i,s,o,a){super(),this.sourceLeftCorner=e,this.width=t,this.height=r,this.destinationLeftCorner=i,this.overwrittenCellsData=s,this.addedGlobalNamedExpressions=o,this.version=a}doUndo(e){e.undoMoveCells(this)}doRedo(e){e.redoMoveCells(this)}}class Qwe extends Xn{constructor(e){super(),this.command=e}doUndo(e){e.undoAddRows(this)}doRedo(e){e.redoAddRows(this)}}class Zwe extends Xn{constructor(e,t,r){super(),this.sheetId=e,this.rowMapping=t,this.oldContent=r}doUndo(e){e.undoSetRowOrder(this)}doRedo(e){e.redoSetRowOrder(this)}}class Jwe extends Xn{constructor(e,t,r){super(),this.sheetId=e,this.columnMapping=t,this.oldContent=r}doUndo(e){e.undoSetColumnOrder(this)}doRedo(e){e.redoSetColumnOrder(this)}}class eve extends Xn{constructor(e,t,r){super(),this.sheetId=e,this.oldSheetContent=t,this.newSheetContent=r}doUndo(e){e.undoSetSheetContent(this)}doRedo(e){e.redoSetSheetContent(this)}}class tve extends Xn{constructor(e,t,r,i,s){super(),this.sheet=e,this.startRow=t,this.numberOfRows=r,this.targetRow=i,this.version=s,this.undoStart=this.startRow<this.targetRow?this.targetRow-this.numberOfRows:this.targetRow,this.undoEnd=this.startRow>this.targetRow?this.startRow+this.numberOfRows:this.startRow}doUndo(e){e.undoMoveRows(this)}doRedo(e){e.redoMoveRows(this)}}class nve extends Xn{constructor(e,t,r,i,s){super(),this.sheet=e,this.startColumn=t,this.numberOfColumns=r,this.targetColumn=i,this.version=s,this.undoStart=this.startColumn<this.targetColumn?this.targetColumn-this.numberOfColumns:this.targetColumn,this.undoEnd=this.startColumn>this.targetColumn?this.startColumn+this.numberOfColumns:this.startColumn}doUndo(e){e.undoMoveColumns(this)}doRedo(e){e.redoMoveColumns(this)}}class rve extends Xn{constructor(e){super(),this.command=e}doUndo(e){e.undoAddColumns(this)}doRedo(e){e.redoAddColumns(this)}}class ive extends Xn{constructor(e,t){super(),this.command=e,this.columnsRemovals=t}doUndo(e){e.undoRemoveColumns(this)}doRedo(e){e.redoRemoveColumns(this)}}class sve extends Xn{constructor(e){super(),this.sheetName=e}doUndo(e){e.undoAddSheet(this)}doRedo(e){e.redoAddSheet(this)}}class ove extends Xn{constructor(e,t,r,i,s){super(),this.sheetName=e,this.sheetId=t,this.oldSheetContent=r,this.scopedNamedExpressions=i,this.version=s}doUndo(e){e.undoRemoveSheet(this)}doRedo(e){e.redoRemoveSheet(this)}}class ave extends Xn{constructor(e,t,r){super(),this.sheetId=e,this.oldName=t,this.newName=r}doUndo(e){e.undoRenameSheet(this)}doRedo(e){e.redoRenameSheet(this)}}class lve extends Xn{constructor(e,t){super(),this.sheetId=e,this.oldSheetContent=t}doUndo(e){e.undoClearSheet(this)}doRedo(e){e.redoClearSheet(this)}}class uve extends Xn{constructor(e){super(),this.cellContents=e}doUndo(e){e.undoSetCellContents(this)}doRedo(e){e.redoSetCellContents(this)}}class hve extends Xn{constructor(e,t,r,i){super(),this.targetLeftCorner=e,this.oldContent=t,this.newContent=r,this.addedGlobalNamedExpressions=i}doUndo(e){e.undoPaste(this)}doRedo(e){e.redoPaste(this)}}class cve extends Xn{constructor(e,t,r,i){super(),this.name=e,this.newContent=t,this.scope=r,this.options=i}doUndo(e){e.undoAddNamedExpression(this)}doRedo(e){e.redoAddNamedExpression(this)}}class dve extends Xn{constructor(e,t,r){super(),this.namedExpression=e,this.content=t,this.scope=r}doUndo(e){e.undoRemoveNamedExpression(this)}doRedo(e){e.redoRemoveNamedExpression(this)}}class fve extends Xn{constructor(e,t,r,i,s){super(),this.namedExpression=e,this.newContent=t,this.oldContent=r,this.scope=i,this.options=s}doUndo(e){e.undoChangeNamedExpression(this)}doRedo(e){e.redoChangeNamedExpression(this)}}class mve extends Xn{constructor(){super(...arguments),this.operations=[]}add(e){this.operations.push(e)}*reversedOperations(){for(let e=this.operations.length-1;e>=0;e--)yield this.operations[e]}doUndo(e){e.undoBatch(this)}doRedo(e){e.redoBatch(this)}}class gve{constructor(e,t){this.operations=t,this.oldData=new Map,this.undoStack=[],this.redoStack=[],this.undoLimit=e.undoLimit}saveOperation(e){this.batchUndoEntry!==void 0?this.batchUndoEntry.add(e):this.addUndoEntry(e)}beginBatchMode(){this.batchUndoEntry=new mve}commitBatchMode(){if(this.batchUndoEntry===void 0)throw Error("Batch mode wasn't started");this.addUndoEntry(this.batchUndoEntry),this.batchUndoEntry=void 0}storeDataForVersion(e,t,r){this.oldData.has(e)||this.oldData.set(e,[]),this.oldData.get(e).push([t,r])}clearRedoStack(){this.redoStack=[]}clearUndoStack(){this.undoStack=[]}isUndoStackEmpty(){return this.undoStack.length===0}isRedoStackEmpty(){return this.redoStack.length===0}undo(){const e=this.undoStack.pop();if(!e)throw Error("Attempted to undo without operation on stack");this.undoEntry(e),this.redoStack.push(e)}undoBatch(e){for(const t of e.reversedOperations())this.undoEntry(t)}undoRemoveRows(e){this.operations.forceApplyPostponedTransformations();const{command:{sheet:t},rowsRemovals:r}=e;for(let i=r.length-1;i>=0;--i){const s=r[i];this.operations.addRows(new m2(t,[[s.rowFrom,s.rowCount]]));for(const{address:o,cellType:a}of s.removedCells)this.operations.restoreCell(o,a);this.restoreOldDataFromVersion(s.version-1)}}undoRemoveColumns(e){this.operations.forceApplyPostponedTransformations();const{command:{sheet:t},columnsRemovals:r}=e;for(let i=r.length-1;i>=0;--i){const s=r[i];this.operations.addColumns(new g2(t,[[s.columnFrom,s.columnCount]]));for(const{address:o,cellType:a}of s.removedCells)this.operations.restoreCell(o,a);this.restoreOldDataFromVersion(s.version-1)}}undoAddRows(e){const t=e.command.rowsSpans();for(let r=t.length-1;r>=0;--r){const i=t[r];this.operations.removeRows(new f2(e.command.sheet,[[i.rowStart,i.numberOfRows]]))}}undoAddColumns(e){const t=e.command.columnsSpans();for(let r=t.length-1;r>=0;--r){const i=t[r];this.operations.removeColumns(new p2(e.command.sheet,[[i.columnStart,i.numberOfColumns]]))}}undoSetCellContents(e){for(const t of e.cellContents){const r=t.address,[i,s]=t.oldContent;dg(r,i)||this.operations.setCellEmpty(r),this.operations.restoreCell(i,s)}}undoPaste(e){this.restoreOperationOldContent(e.oldContent);for(const t of e.addedGlobalNamedExpressions)this.operations.removeNamedExpression(t)}undoMoveRows(e){const{sheet:t}=e;this.operations.moveRows(t,e.undoStart,e.numberOfRows,e.undoEnd),this.restoreOldDataFromVersion(e.version-1)}undoMoveColumns(e){const{sheet:t}=e;this.operations.moveColumns(t,e.undoStart,e.numberOfColumns,e.undoEnd),this.restoreOldDataFromVersion(e.version-1)}undoMoveCells(e){this.operations.forceApplyPostponedTransformations(),this.operations.moveCells(e.destinationLeftCorner,e.width,e.height,e.sourceLeftCorner),this.restoreOperationOldContent(e.overwrittenCellsData),this.restoreOldDataFromVersion(e.version-1);for(const t of e.addedGlobalNamedExpressions)this.operations.removeNamedExpression(t)}undoAddSheet(e){const{sheetName:t}=e;this.operations.removeSheetByName(t)}undoRemoveSheet(e){this.operations.forceApplyPostponedTransformations();const{oldSheetContent:t,sheetId:r}=e;this.operations.addSheet(e.sheetName);for(let i=0;i<t.length;i++){const s=t[i];for(let o=0;o<s.length;o++){const a=s[o],l=we(r,o,i);this.operations.restoreCell(l,a)}}for(const[i,s]of e.scopedNamedExpressions)this.operations.restoreNamedExpression(i,s,r);this.restoreOldDataFromVersion(e.version-1)}undoRenameSheet(e){this.operations.renameSheet(e.sheetId,e.oldName)}undoClearSheet(e){const{oldSheetContent:t,sheetId:r}=e;for(let i=0;i<t.length;i++){const s=t[i];for(let o=0;o<s.length;o++){const a=s[o],l=we(r,o,i);this.operations.restoreCell(l,a)}}}undoSetSheetContent(e){const{oldSheetContent:t,sheetId:r}=e;this.operations.clearSheet(r);for(let i=0;i<t.length;i++){const s=t[i];for(let o=0;o<s.length;o++){const a=s[o],l=we(r,o,i);this.operations.restoreCell(l,a)}}}undoAddNamedExpression(e){this.operations.removeNamedExpression(e.name,e.scope)}undoRemoveNamedExpression(e){this.operations.restoreNamedExpression(e.namedExpression,e.content,e.scope)}undoChangeNamedExpression(e){this.operations.restoreNamedExpression(e.namedExpression,e.oldContent,e.scope)}undoSetRowOrder(e){this.restoreOperationOldContent(e.oldContent)}undoSetColumnOrder(e){this.restoreOperationOldContent(e.oldContent)}redo(){const e=this.redoStack.pop();if(!e)throw Error("Attempted to redo without operation on stack");this.redoEntry(e),this.undoStack.push(e)}redoBatch(e){for(const t of e.operations)this.redoEntry(t)}redoRemoveRows(e){this.operations.removeRows(e.command)}redoMoveCells(e){this.operations.moveCells(e.sourceLeftCorner,e.width,e.height,e.destinationLeftCorner)}redoRemoveColumns(e){this.operations.removeColumns(e.command)}redoPaste(e){const{targetLeftCorner:t,newContent:r}=e,i=r.length,s=r[0].length;for(let o=0;o<i;++o)for(let a=0;a<s;++a){const l=we(t.sheet,t.col+a,t.row+o);this.operations.restoreCell(l,r[o][a])}}redoSetCellContents(e){for(const t of e.cellContents)this.operations.setCellContent(t.address,t.newContent)}redoAddRows(e){this.operations.addRows(e.command)}redoAddColumns(e){this.operations.addColumns(e.command)}redoRemoveSheet(e){this.operations.removeSheetByName(e.sheetName)}redoAddSheet(e){this.operations.addSheet(e.sheetName)}redoRenameSheet(e){this.operations.renameSheet(e.sheetId,e.newName)}redoMoveRows(e){this.operations.moveRows(e.sheet,e.startRow,e.numberOfRows,e.targetRow)}redoMoveColumns(e){this.operations.moveColumns(e.sheet,e.startColumn,e.numberOfColumns,e.targetColumn)}redoClearSheet(e){this.operations.clearSheet(e.sheetId)}redoSetSheetContent(e){const{sheetId:t,newSheetContent:r}=e;this.operations.setSheetContent(t,r)}redoAddNamedExpression(e){this.operations.addNamedExpression(e.name,e.newContent,e.scope,e.options)}redoRemoveNamedExpression(e){this.operations.removeNamedExpression(e.namedExpression.displayName,e.scope)}redoChangeNamedExpression(e){this.operations.changeNamedExpressionExpression(e.namedExpression.displayName,e.newContent,e.scope,e.options)}redoSetRowOrder(e){this.operations.setRowOrder(e.sheetId,e.rowMapping)}redoSetColumnOrder(e){this.operations.setColumnOrder(e.sheetId,e.columnMapping)}addUndoEntry(e){this.undoStack.push(e),this.undoStack.splice(0,Math.max(0,this.undoStack.length-this.undoLimit))}undoEntry(e){e.doUndo(this)}restoreOperationOldContent(e){for(const[t,r]of e)this.operations.restoreCell(t,r)}redoEntry(e){e.doRedo(this)}restoreOldDataFromVersion(e){const t=this.oldData.get(e)||[];for(const r of t){const[i,s]=r;this.operations.setFormulaToCellFromCache(s,i)}}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class pve{constructor(e,t,r,i,s,o,a,l,u,h){this.operations=t,this.undoRedo=r,this.clipboardOperations=i,this.dependencyGraph=s,this.columnSearch=o,this.parser=a,this.cellContentParser=l,this.lazilyTransformingAstService=u,this.namedExpressions=h,this.maxRows=e.maxRows,this.maxColumns=e.maxColumns}get sheetMapping(){return this.dependencyGraph.sheetMapping}addRows(e,...t){const r=new m2(e,t);this.ensureItIsPossibleToAddRows(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.operations.addRows(r),this.undoRedo.saveOperation(new Qwe(r))}removeRows(e,...t){const r=new f2(e,t);this.ensureItIsPossibleToRemoveRows(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const i=this.operations.removeRows(r);this.undoRedo.saveOperation(new qwe(r,i))}addColumns(e,...t){const r=new g2(e,t);this.ensureItIsPossibleToAddColumns(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.operations.addColumns(r),this.undoRedo.saveOperation(new rve(r))}removeColumns(e,...t){const r=new p2(e,t);this.ensureItIsPossibleToRemoveColumns(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const i=this.operations.removeColumns(r);this.undoRedo.saveOperation(new ive(r,i))}moveCells(e,t,r,i){this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const{version:s,overwrittenCellsData:o,addedGlobalNamedExpressions:a}=this.operations.moveCells(e,t,r,i);this.undoRedo.saveOperation(new Xwe(e,t,r,i,o,a,s))}moveRows(e,t,r,i){this.ensureItIsPossibleToMoveRows(e,t,r,i),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const s=this.operations.moveRows(e,t,r,i);this.undoRedo.saveOperation(new tve(e,t,r,i,s))}moveColumns(e,t,r,i){this.ensureItIsPossibleToMoveColumns(e,t,r,i),this.undoRedo.clearRedoStack();const s=this.operations.moveColumns(e,t,r,i);this.undoRedo.saveOperation(new nve(e,t,r,i,s))}cut(e,t,r){this.clipboardOperations.cut(e,t,r)}ensureItIsPossibleToCopy(e,t,r){if(!Dc(t))throw new Kn("width to be positive integer.");if(!Dc(r))throw new Kn("height to be positive integer.")}copy(e,t,r){this.ensureItIsPossibleToCopy(e,t,r),this.clipboardOperations.copy(e,t,r)}paste(e){const t=this.clipboardOperations.clipboard;if(t===void 0)throw new GG;if(this.clipboardOperations.isCutClipboard())this.moveCells(t.sourceLeftCorner,t.width,t.height,e);else if(this.clipboardOperations.isCopyClipboard()){this.clipboardOperations.ensureItIsPossibleToCopyPaste(e);const r=_e.spanFrom(e,t.width,t.height),i=this.operations.getRangeClipboardCells(r);this.undoRedo.clearRedoStack();const s=this.operations.restoreClipboardCells(t.sourceLeftCorner.sheet,t.getContent(e));this.undoRedo.saveOperation(new hve(e,i,t.content,s))}}beginUndoRedoBatchMode(){this.undoRedo.beginBatchMode()}commitUndoRedoBatchMode(){this.undoRedo.commitBatchMode()}isClipboardEmpty(){return this.clipboardOperations.clipboard===void 0}clearClipboard(){this.clipboardOperations.clear()}addSheet(e){e!==void 0&&this.ensureItIsPossibleToAddSheet(e),this.undoRedo.clearRedoStack();const t=this.operations.addSheet(e);return this.undoRedo.saveOperation(new sve(t)),t}removeSheet(e){this.ensureScopeIdIsValid(e),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const t=this.sheetMapping.fetchDisplayName(e),r=this.operations.getSheetClipboardCells(e),{version:i,scopedNamedExpressions:s}=this.operations.removeSheet(e);this.undoRedo.saveOperation(new ove(t,e,r,s,i))}renameSheet(e,t){this.ensureItIsPossibleToRenameSheet(e,t);const r=this.operations.renameSheet(e,t);return r!==void 0&&(this.undoRedo.clearRedoStack(),this.undoRedo.saveOperation(new ave(e,r,t))),r}clearSheet(e){this.ensureScopeIdIsValid(e),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const t=this.operations.getSheetClipboardCells(e);this.operations.clearSheet(e),this.undoRedo.saveOperation(new lve(e,t))}setCellContents(e,t){if(!(t instanceof Array))t=[[t]];else for(let i=0;i<t.length;i++)if(!(t[i]instanceof Array))throw new Kn("an array of arrays or a raw cell value.");this.ensureItIsPossibleToChangeCellContents(e,t),this.undoRedo.clearRedoStack();const r=[];for(let i=0;i<t.length;i++)for(let s=0;s<t[i].length;s++){const o={sheet:e.sheet,row:e.row+i,col:e.col+s},a=t[i][s];this.clipboardOperations.abortCut();const l=this.operations.setCellContent(o,a);r.push({address:o,newContent:a,oldContent:l})}this.undoRedo.saveOperation(new uve(r))}setSheetContent(e,t){this.ensureScopeIdIsValid(e),this.ensureItIsPossibleToChangeSheetContents(e,t),d2(t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const r=this.operations.getSheetClipboardCells(e);this.operations.setSheetContent(e,t),this.undoRedo.saveOperation(new eve(e,r,t))}setRowOrder(e,t){this.validateSwapRowIndexes(e,t),this.testRowOrderForArrays(e,t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const r=this.operations.setRowOrder(e,t);this.undoRedo.saveOperation(new Zwe(e,t,r))}validateSwapRowIndexes(e,t){if(!this.sheetMapping.hasSheetWithId(e))throw new Rn(e);this.validateRowOrColumnMapping(e,t,"row")}testColumnOrderForArrays(e,t){for(const[r,i]of t)if(r!==i){const s=_e.spanFrom({sheet:e,col:r,row:0},1,1/0);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(s))throw new nd}}setColumnOrder(e,t){this.validateSwapColumnIndexes(e,t),this.testColumnOrderForArrays(e,t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const r=this.operations.setColumnOrder(e,t);this.undoRedo.saveOperation(new Jwe(e,t,r))}validateSwapColumnIndexes(e,t){if(!this.sheetMapping.hasSheetWithId(e))throw new Rn(e);this.validateRowOrColumnMapping(e,t,"column")}testRowOrderForArrays(e,t){for(const[r,i]of t)if(r!==i){const s=_e.spanFrom({sheet:e,col:0,row:r},1/0,1);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(s))throw new nd}}mappingFromOrder(e,t,r){if(!this.sheetMapping.hasSheetWithId(e))throw new Rn(e);const i=r==="row"?this.dependencyGraph.getSheetHeight(e):this.dependencyGraph.getSheetWidth(e);if(t.length!==i)throw new Kn(`number of ${r}s provided to be sheet ${r==="row"?"height":"width"}.`);const s=[];for(let o=0;o<i;o++)t[o]!==o&&s.push([o,t[o]]);return s}undo(){if(this.undoRedo.isUndoStackEmpty())throw new WG;this.clipboardOperations.abortCut(),this.undoRedo.undo()}redo(){if(this.undoRedo.isRedoStackEmpty())throw new $G;this.clipboardOperations.abortCut(),this.undoRedo.redo()}addNamedExpression(e,t,r,i){this.ensureItIsPossibleToAddNamedExpression(e,t,r),this.operations.addNamedExpression(e,t,r,i),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new cve(e,t,r,i))}changeNamedExpressionExpression(e,t,r,i){this.ensureItIsPossibleToChangeNamedExpression(e,r,t);const[s,o]=this.operations.changeNamedExpressionExpression(e,r,t,i);this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new fve(s,r,o,t,i))}removeNamedExpression(e,t){this.ensureScopeIdIsValid(t);const[r,i]=this.operations.removeNamedExpression(e,t);return this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new dve(r,i,t)),r}ensureItIsPossibleToAddNamedExpression(e,t,r){this.ensureScopeIdIsValid(r),this.ensureNamedExpressionNameIsValid(e,r),this.ensureNamedExpressionIsValid(t)}ensureItIsPossibleToChangeNamedExpression(e,t,r){if(this.ensureScopeIdIsValid(r),this.namedExpressions.namedExpressionForScope(e,r)===void 0)throw new hg(e);this.ensureNamedExpressionIsValid(t)}isItPossibleToRemoveNamedExpression(e,t){if(this.ensureScopeIdIsValid(t),this.namedExpressions.namedExpressionForScope(e,t)===void 0)throw new hg(e)}ensureItIsPossibleToAddRows(e,...t){if(!this.sheetMapping.hasSheetWithId(e))throw new Rn(e);const r=this.dependencyGraph.getSheetHeight(e),i=t.map(s=>s[1]).reduce((s,o)=>s+o,0);if(r+i>this.maxRows)throw new Sh;for(const[s,o]of t)if(!eh(s)||!Dc(o))throw new Kn("row number to be nonnegative and number of rows to add to be positive.")}ensureItIsPossibleToRemoveRows(e,...t){for(const[r,i]of t){const s=r+i-1;if(!eh(r)||!eh(s))throw new Kn("starting and ending row to be nonnegative.");if(s<r)throw new Kn("starting row to be smaller than the ending row.");if(!this.sheetMapping.hasSheetWithId(e))throw new Rn(e)}}ensureItIsPossibleToAddColumns(e,...t){if(!this.sheetMapping.hasSheetWithId(e))throw new Rn(e);const r=this.dependencyGraph.getSheetWidth(e),i=t.map(s=>s[1]).reduce((s,o)=>s+o,0);if(r+i>this.maxColumns)throw new Sh;for(const[s,o]of t)if(!eh(s)||!Dc(o))throw new Kn("column number to be nonnegative and number of columns to add to be positive.")}ensureItIsPossibleToRemoveColumns(e,...t){for(const[r,i]of t){const s=r+i-1;if(!eh(r)||!eh(s))throw new Kn("starting and ending column to be nonnegative.");if(s<r)throw new Kn("starting column to be smaller than the ending column.");if(!this.sheetMapping.hasSheetWithId(e))throw new Rn(e)}}ensureItIsPossibleToMoveRows(e,t,r,i){this.ensureItIsPossibleToAddRows(e,[i,r]);const s=we(e,0,t),o=we(e,0,i);if(!this.sheetMapping.hasSheetWithId(e)||Ri(s)||Ri(o)||!Dc(r)||i<=t+r&&i>=t)throw new Kn("a valid range of rows to move.");const a=this.dependencyGraph.getSheetWidth(e),l=_e.spanFrom(s,a,r);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(l))throw new nd;if(i>0&&this.dependencyGraph.arrayMapping.isFormulaArrayInAllRows(Ei.fromNumberOfRows(e,i-1,2)))throw new $y}ensureItIsPossibleToMoveColumns(e,t,r,i){this.ensureItIsPossibleToAddColumns(e,[i,r]);const s=we(e,t,0),o=we(e,i,0);if(!this.sheetMapping.hasSheetWithId(e)||Ri(s)||Ri(o)||!Dc(r)||i<=t+r&&i>=t)throw new Kn("a valid range of columns to move.");const a=this.dependencyGraph.getSheetHeight(e),l=_e.spanFrom(s,r,a);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(l))throw new nd;if(i>0&&this.dependencyGraph.arrayMapping.isFormulaArrayInAllColumns(Ui.fromNumberOfColumns(e,i-1,2)))throw new $y}ensureItIsPossibleToAddSheet(e){if(this.sheetMapping.hasSheetWithName(e))throw new lg(e)}ensureItIsPossibleToRenameSheet(e,t){if(!this.sheetMapping.hasSheetWithId(e))throw new Rn(e);const r=this.sheetMapping.get(t);if(r!==void 0&&r!==e)throw new lg(t)}ensureItIsPossibleToChangeContent(e){if(Ri(e))throw new VG(e);if(!this.sheetMapping.hasSheetWithId(e.sheet))throw new Rn(e.sheet)}ensureItIsPossibleToChangeCellContents(e,t){const r=qy(t),i=_e.spanFrom(e,r.width,r.height);this.ensureRangeInSizeLimits(i);for(const s of i.addresses(this.dependencyGraph))this.ensureItIsPossibleToChangeContent(s)}ensureItIsPossibleToChangeSheetContents(e,t){const r=qy(t),i=_e.spanFrom(we(e,0,0),r.width,r.height);this.ensureRangeInSizeLimits(i)}ensureRangeInSizeLimits(e){if(e.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new Sh}isThereSomethingToUndo(){return!this.undoRedo.isUndoStackEmpty()}isThereSomethingToRedo(){return!this.undoRedo.isRedoStackEmpty()}getAndClearContentChanges(){return this.operations.getAndClearContentChanges()}ensureScopeIdIsValid(e){if(e!==void 0&&!this.sheetMapping.hasSheetWithId(e))throw new Rn(e)}validateRowOrColumnMapping(e,t,r){const i=r==="row"?this.dependencyGraph.getSheetHeight(e):this.dependencyGraph.getSheetWidth(e),s=t.map(([a,l])=>a).sort((a,l)=>a-l),o=t.map(([a,l])=>l).sort((a,l)=>a-l);for(let a=0;a<s.length;a++){if(!eh(s[a])||s[a]>=i)throw new Kn(`${r} numbers to be nonnegative integers and less than sheet ${r==="row"?"height":"width"}.`);if(s[a]===s[a+1])throw new Kn(`source ${r} numbers to be unique.`);if(s[a]!==o[a])throw new Kn(`target ${r} numbers to be permutation of source ${r} numbers.`)}}ensureNamedExpressionNameIsValid(e,t){if(!this.namedExpressions.isNameValid(e))throw new BG(e);if(!this.namedExpressions.isNameAvailable(e,t))throw new UG(e)}ensureNamedExpressionIsValid(e){const t=this.cellContentParser.parse(e);if(t instanceof fn.Formula){const r=this.parser.parse(t.formula,we(-1,0,0));if(Pl(r.ast))throw new n_}}}function Dc(n){return Number.isInteger(n)&&n>0}function eh(n){return Number.isInteger(n)&&n>=0}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class wve{constructor(e,t,r,i,s,o){this.config=e,this.stats=t,this.interpreter=r,this.lazilyTransformingAstService=i,this.dependencyGraph=s,this.columnSearch=o}run(){this.stats.start(Ke.TOP_SORT);const{sorted:e,cycled:t}=this.dependencyGraph.topSortWithScc();this.stats.end(Ke.TOP_SORT),this.stats.measure(Ke.EVALUATION,()=>{this.recomputeFormulas(t,e)})}partialRun(e){const t=Jl.empty();return this.stats.measure(Ke.EVALUATION,()=>{this.dependencyGraph.graph.getTopSortedWithSccSubgraphFrom(e,r=>{if(r instanceof Bi){const i=r.isComputed()?r.getCellValue():void 0,s=this.recomputeFormulaVertexValue(r);if(s!==i){const o=r.getAddress(this.lazilyTransformingAstService);return t.addChange(s,o),this.columnSearch.change(me(i),me(s),o),!0}return!1}else return r instanceof Fr&&r.clearCache(),!0},r=>{if(r instanceof Fr)r.clearCache();else if(r instanceof Bi){const i=r.getAddress(this.lazilyTransformingAstService);this.columnSearch.remove(me(r.valueOrUndef()),i);const s=new E(N.CYCLE,void 0,r);r.setCellValue(s),t.addChange(s,i)}})}),t}runAndForget(e,t,r){const i=[];for(const o of jo(r,t))if(o instanceof _e){const a=o;if(this.dependencyGraph.getRange(a.start,a.end)===void 0){const l=new Fr(a);this.dependencyGraph.rangeMapping.setRange(l),i.push(l)}}const s=this.evaluateAstToCellValue(e,new ta(t,this.config.useArrayArithmetic));return i.forEach(o=>{this.dependencyGraph.rangeMapping.removeRange(o)}),s}recomputeFormulas(e,t){e.forEach(r=>{r instanceof Bi&&r.setCellValue(new E(N.CYCLE,void 0,r))}),t.forEach(r=>{if(r instanceof Bi){const i=this.recomputeFormulaVertexValue(r),s=r.getAddress(this.lazilyTransformingAstService);this.columnSearch.add(me(i),s)}else r instanceof Fr&&r.clearCache()})}recomputeFormulaVertexValue(e){const t=e.getAddress(this.lazilyTransformingAstService);if(e instanceof Bn&&(e.array.size.isRef||!this.dependencyGraph.isThereSpaceForArray(e)))return e.setNoSpace();{const r=e.getFormula(this.lazilyTransformingAstService),i=this.evaluateAstToCellValue(r,new ta(t,this.config.useArrayArithmetic,e));return e.setCellValue(i)}}evaluateAstToCellValue(e,t){const r=this.interpreter.evaluateAst(e,t);return r instanceof Ae?r:r===ht&&this.config.evaluateNullToZero?0:r}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class WN{constructor(e,t){this.address=e,this.newValue=t}get col(){return this.address.col}get row(){return this.address.row}get sheet(){return this.address.sheet}get value(){return this.newValue}}class w2{constructor(e,t){this.name=e,this.newValue=t}}class vve{constructor(e,t,r,i){this.config=e,this.namedExpressions=t,this.sheetIndexMapping=r,this.lazilyTransformingService=i}exportChange(e){const t=e.value,r=e.address;if(r.sheet===Hh.SHEET_FOR_WORKBOOK_EXPRESSIONS){const i=this.namedExpressions.namedExpressionInAddress(r.row);if(!i)throw new Error("Missing named expression");return new w2(i.displayName,this.exportScalarOrRange(t))}else if(t instanceof Ae){const i=[];for(const[s,o]of t.entriesFromTopLeftCorner(r))i.push(new WN(o,this.exportValue(s)));return i}else return new WN(r,this.exportValue(t))}exportValue(e){return e instanceof Ae?this.detailedError(new E(N.VALUE,_.ScalarExpected)):this.config.smartRounding&&It(e)?this.cellValueRounding(me(e)):e instanceof E?this.detailedError(e):e===ht?null:me(e)}exportScalarOrRange(e){return e instanceof Ae?e.rawData().map(t=>t.map(r=>this.exportValue(r))):this.exportValue(e)}detailedError(e){var t,r;let i;const s=(t=e.root)===null||t===void 0?void 0:t.getAddress(this.lazilyTransformingService);return s!==void 0&&(s.sheet===Hh.SHEET_FOR_WORKBOOK_EXPRESSIONS?i=(r=this.namedExpressions.namedExpressionInAddress(s.row))===null||r===void 0?void 0:r.displayName:i=Oy(this.sheetIndexMapping,s,-1)),new s2(e,this.config.translationPackage.getErrorTranslation(e.type),i)}cellValueRounding(e){if(e===0)return e;const t=Math.floor(Math.log10(Math.abs(e))),r=Math.pow(10,this.config.precisionRounding-t);return e<0?-Math.round(-e*r)/r:Math.round(e*r)/r}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class yve{constructor(e,t,r,i,s,o){this.dependencyGraph=e,this.columnSearch=t,this.parser=r,this.cellContentParser=i,this.stats=s,this.arraySizePredictor=o,this.buildStrategy=new Cve(e,t,r,s,i,o)}buildGraph(e,t){const r=t.measure(Ke.COLLECT_DEPENDENCIES,()=>this.buildStrategy.run(e));this.dependencyGraph.getAndClearContentChanges(),t.measure(Ke.PROCESS_DEPENDENCIES,()=>this.processDependencies(r))}processDependencies(e){e.forEach((t,r)=>{this.dependencyGraph.processCellDependencies(t,r)})}}class Cve{constructor(e,t,r,i,s,o){this.dependencyGraph=e,this.columnIndex=t,this.parser=r,this.stats=i,this.cellContentParser=s,this.arraySizePredictor=o}run(e){const t=new Map;for(const r in e){const i=this.dependencyGraph.getSheetId(r),s=e[r];for(let o=0;o<s.length;++o){const a=s[o];for(let l=0;l<a.length;++l){const u=a[l],h=we(i,l,o),c=this.cellContentParser.parse(u);if(c instanceof fn.Formula){const d=this.stats.measure(Ke.PARSER,()=>this.parser.parse(c.formula,h));if(d.errors.length>0){this.shrinkArrayIfNeeded(h);const f=new md(d.errors,c.formula);this.dependencyGraph.addVertex(h,f)}else{this.shrinkArrayIfNeeded(h);const f=this.arraySizePredictor.checkArraySize(d.ast,h);if(f.isScalar()){const g=new Zo(d.ast,h,0);t.set(g,jo(d.dependencies,h)),this.dependencyGraph.addVertex(h,g),d.hasVolatileFunction&&this.dependencyGraph.markAsVolatile(g),d.hasStructuralChangeFunction&&this.dependencyGraph.markAsDependentOnStructureChange(g)}else{const g=new Bn(d.ast,h,new gt(f.width,f.height));t.set(g,jo(d.dependencies,h)),this.dependencyGraph.addArrayVertex(h,g)}}}else if(!(c instanceof fn.Empty)){this.shrinkArrayIfNeeded(h);const d=new eu(c.value,u);this.columnIndex.add(me(c.value),h),this.dependencyGraph.addVertex(h,d)}}}}return t}shrinkArrayIfNeeded(e){const t=this.dependencyGraph.getCell(e);t instanceof Bn&&this.dependencyGraph.shrinkArrayToCorner(t)}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const Vw=new Map([["gpl-v3",1],["missing",2],["invalid",3],["expired",4]]);class v2 extends et{version(e,t){return this.runFunction(e.args,t,this.metadata("VERSION"),()=>{const{licenseKeyValidityState:r,licenseKey:i}=this.config;let s;return Vw.has(i)?s=Vw.get(i):Vw.has(r)?s=Vw.get(r):r==="valid"&&(s=i.slice(-5)),`HyperFormula v${vr.version}, ${s}`})}}v2.implementedFunctions={VERSION:{method:"version",parameters:[]}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */function aA(n,e){var t;let r=e.implementedFunctions[n];const i=(t=e.aliases)===null||t===void 0?void 0:t[n];if(i!==void 0){if(r!==void 0)throw new Ape(n,e.name);r=e.implementedFunctions[i]}if(r===void 0)throw Td.functionNotDeclaredInPlugin(n,e.name);return r}class rr{constructor(e){if(this.config=e,this.functions=new Map,this.arraySizeFunctions=new Map,this.volatileFunctions=new Set,this.arrayFunctions=new Set,this.structuralChangeFunctions=new Set,this.functionsWhichDoesNotNeedArgumentsToBeComputed=new Set,this.functionsMetadata=new Map,this.doesFunctionNeedArgumentToBeComputed=t=>this.functionsWhichDoesNotNeedArgumentsToBeComputed.has(t),this.isFunctionVolatile=t=>this.volatileFunctions.has(t),this.isArrayFunction=t=>this.arrayFunctions.has(t),this.isFunctionDependentOnSheetStructureChange=t=>this.structuralChangeFunctions.has(t),e.functionPlugins.length>0){this.instancePlugins=new Map;for(const t of e.functionPlugins)rr.loadPluginFunctions(t,this.instancePlugins)}else this.instancePlugins=new Map(rr.plugins);for(const[t,r]of rr.protectedFunctions())rr.loadFunctionUnprotected(r,t,this.instancePlugins);for(const[t,r]of this.instancePlugins.entries())this.categorizeFunction(t,aA(t,r))}static registerFunctionPlugin(e,t){this.loadPluginFunctions(e,this.plugins),t!==void 0&&this.loadTranslations(t)}static registerFunction(e,t,r){this.loadPluginFunction(t,e,this.plugins),r!==void 0&&this.loadTranslations(r)}static unregisterFunction(e){if(this.functionIsProtected(e))throw Rh.cannotUnregisterFunctionWithId(e);this.plugins.delete(e)}static unregisterFunctionPlugin(e){for(const t of this.protectedPlugins())if(t===e)throw Rh.cannotUnregisterProtectedPlugin();for(const[t,r]of this.plugins.entries())r===e&&this.plugins.delete(t)}static unregisterAll(){this.plugins.clear()}static getRegisteredFunctionIds(){return[...Array.from(this.plugins.keys()),...Array.from(this._protectedPlugins.keys())]}static getPlugins(){return Array.from(new Set(this.plugins.values()).values())}static getFunctionPlugin(e){if(!this.functionIsProtected(e))return this.plugins.get(e)}static functionIsProtected(e){return this._protectedPlugins.has(e)}static loadTranslations(e){const t=new Set(vr.getRegisteredLanguagesCodes());Object.keys(e).forEach(r=>{t.has(r)&&vr.getLanguage(r).extendFunctions(e[r])})}static loadPluginFunctions(e,t){Object.keys(e.implementedFunctions).forEach(r=>{this.loadPluginFunction(e,r,t)}),e.aliases!==void 0&&Object.keys(e.aliases).forEach(r=>{this.loadPluginFunction(e,r,t)})}static loadPluginFunction(e,t,r){if(this.functionIsProtected(t))throw Rh.cannotRegisterFunctionWithId(t);this.loadFunctionUnprotected(e,t,r)}static loadFunctionUnprotected(e,t,r){const i=aA(t,e).method;if(Object.prototype.hasOwnProperty.call(e.prototype,i))r.set(t,e);else throw Td.functionMethodNotFound(i,e.name)}static*protectedFunctions(){for(const[e,t]of this._protectedPlugins)t!==void 0&&(yield[e,t])}static*protectedPlugins(){for(const[,e]of this._protectedPlugins)e!==void 0&&(yield e)}initializePlugins(e){const t=[];for(const[r,i]of this.instancePlugins.entries()){let s=t.find(u=>u instanceof i);s===void 0&&(s=new i(e),t.push(s));const o=aA(r,i),a=o.method;this.functions.set(r,[a,s]);const l=o.arraySizeMethod;l!==void 0&&this.arraySizeFunctions.set(r,[l,s])}}getFunctionPlugin(e){if(!rr.functionIsProtected(e))return this.instancePlugins.get(e)}getFunction(e){const t=this.functions.get(e);if(t!==void 0&&this.config.translationPackage.isFunctionTranslated(e)){const[r,i]=t;return(s,o)=>i[r](s,o)}else return}getArraySizeFunction(e){const t=this.arraySizeFunctions.get(e);if(t!==void 0&&this.config.translationPackage.isFunctionTranslated(e)){const[r,i]=t;return(s,o)=>i[r](s,o)}else return}getMetadata(e){return this.functionsMetadata.get(e)}getPlugins(){const e=new Set;for(const[t,r]of this.instancePlugins)rr.functionIsProtected(t)||e.add(r);return Array.from(e)}getRegisteredFunctionIds(){return Array.from(this.functions.keys())}categorizeFunction(e,t){t.isVolatile&&this.volatileFunctions.add(e),t.arrayFunction&&this.arrayFunctions.add(e),t.doesNotNeedArgumentsToBeComputed&&this.functionsWhichDoesNotNeedArgumentsToBeComputed.add(e),t.isDependentOnSheetStructureChange&&this.structuralChangeFunctions.add(e),this.functionsMetadata.set(e,t)}}rr.plugins=new Map;rr._protectedPlugins=new Map([["VERSION",v2],["OFFSET",void 0]]);/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */var gr;(function(n){n.GREATER_THAN="GREATER_THAN",n.GREATER_THAN_OR_EQUAL="GREATER_THAN_OR_EQUAL",n.LESS_THAN="LESS_THAN",n.LESS_THAN_OR_EQUAL="LESS_THAN_OR_EQUAL",n.NOT_EQUAL="NOT_EQUAL",n.EQUAL="EQUAL"})(gr||(gr={}));const Uw=(n,e)=>({operator:n,value:e});class Sve{constructor(e){var t,r,i,s;this.trueString=(r=(t=e.translationPackage.getMaybeFunctionTranslation("TRUE"))===null||t===void 0?void 0:t.toLowerCase())!==null&&r!==void 0?r:"true",this.falseString=(s=(i=e.translationPackage.getMaybeFunctionTranslation("FALSE"))===null||i===void 0?void 0:i.toLowerCase())!==null&&s!==void 0?s:"false"}fromCellValue(e,t){if(typeof e!="string"&&typeof e!="boolean"&&typeof e!="number")return;const r=this.parseCriterion(e,t);if(r!==void 0)return{raw:e,lambda:bve(r,t)}}parseCriterion(e,t){if(typeof e=="number"||typeof e=="boolean")return Uw(gr.EQUAL,e);if(typeof e=="string"){const r=Rve.exec(e);let i,s;r?(s=Eve(r[1]),i=r[2]):(s=gr.EQUAL,i=e);const o=t.coerceToMaybeNumber(i),a=i.toLowerCase()===this.trueString?!0:i.toLowerCase()===this.falseString?!1:void 0;if(s===void 0)return;if(i==="")return Uw(s,null);if(o===void 0){if(s===gr.EQUAL||s===gr.NOT_EQUAL)return Uw(s,a??i)}else return Uw(s,me(o))}}}const Rve=/([<>=]+)(.*)/;function Eve(n){switch(n){case">":return gr.GREATER_THAN;case">=":return gr.GREATER_THAN_OR_EQUAL;case"<":return gr.LESS_THAN;case"<=":return gr.LESS_THAN_OR_EQUAL;case"<>":return gr.NOT_EQUAL;case"=":return gr.EQUAL;default:return}}const bve=(n,e)=>{switch(n.operator){case gr.GREATER_THAN:return typeof n.value=="number"?t=>typeof t=="number"&&e.floatCmp(t,n.value)>0:t=>!1;case gr.GREATER_THAN_OR_EQUAL:return typeof n.value=="number"?t=>typeof t=="number"&&e.floatCmp(t,n.value)>=0:t=>!1;case gr.LESS_THAN:return typeof n.value=="number"?t=>typeof t=="number"&&e.floatCmp(t,n.value)<0:t=>!1;case gr.LESS_THAN_OR_EQUAL:return typeof n.value=="number"?t=>typeof t=="number"&&e.floatCmp(t,n.value)<=0:t=>!1;case gr.EQUAL:return typeof n.value=="number"?t=>{if(typeof t=="number")return e.floatCmp(t,n.value)===0;if(typeof t=="string"){if(t==="")return!1;const r=e.coerceToMaybeNumber(t);return r===void 0?!1:e.floatCmp(r,n.value)===0}else return!1}:typeof n.value=="string"?e.eqMatcherFunction(n.value):typeof n.value=="boolean"?t=>typeof t=="boolean"&&t===n.value:t=>t===ht;case gr.NOT_EQUAL:return typeof n.value=="number"?t=>{if(typeof t=="number")return e.floatCmp(t,n.value)!==0;if(typeof t=="string"){if(t==="")return!0;const r=e.coerceToMaybeNumber(t);return r===void 0?!0:e.floatCmp(r,n.value)!==0}else return!0}:typeof n.value=="string"?e.neqMatcherFunction(n.value):typeof n.value=="boolean"?t=>typeof t!="boolean"||t!==n.value:t=>t!==ht}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class Tve{constructor(e,t,r,i,s,o,a,l,u,h){this.config=e,this.dependencyGraph=t,this.columnSearch=r,this.stats=i,this.arithmeticHelper=s,this.functionRegistry=o,this.namedExpressions=a,this.serialization=l,this.arraySizePredictor=u,this.dateTimeHelper=h,this.equalOp=(c,d)=>es(this.arithmeticHelper.eq,c,d),this.notEqualOp=(c,d)=>es(this.arithmeticHelper.neq,c,d),this.greaterThanOp=(c,d)=>es(this.arithmeticHelper.gt,c,d),this.lessThanOp=(c,d)=>es(this.arithmeticHelper.lt,c,d),this.greaterThanOrEqualOp=(c,d)=>es(this.arithmeticHelper.geq,c,d),this.lessThanOrEqualOp=(c,d)=>es(this.arithmeticHelper.leq,c,d),this.concatOp=(c,d)=>es(this.arithmeticHelper.concat,HN(c),HN(d)),this.plusOp=(c,d)=>es(this.arithmeticHelper.addWithEpsilon,this.arithmeticHelper.coerceScalarToNumberOrError(c),this.arithmeticHelper.coerceScalarToNumberOrError(d)),this.minusOp=(c,d)=>es(this.arithmeticHelper.subtract,this.arithmeticHelper.coerceScalarToNumberOrError(c),this.arithmeticHelper.coerceScalarToNumberOrError(d)),this.timesOp=(c,d)=>es(this.arithmeticHelper.multiply,this.arithmeticHelper.coerceScalarToNumberOrError(c),this.arithmeticHelper.coerceScalarToNumberOrError(d)),this.powerOp=(c,d)=>es(this.arithmeticHelper.pow,this.arithmeticHelper.coerceScalarToNumberOrError(c),this.arithmeticHelper.coerceScalarToNumberOrError(d)),this.divOp=(c,d)=>es(this.arithmeticHelper.divide,this.arithmeticHelper.coerceScalarToNumberOrError(c),this.arithmeticHelper.coerceScalarToNumberOrError(d)),this.unaryMinusOp=c=>VF(this.arithmeticHelper.unaryMinus,this.arithmeticHelper.coerceScalarToNumberOrError(c)),this.percentOp=c=>VF(this.arithmeticHelper.unaryPercent,this.arithmeticHelper.coerceScalarToNumberOrError(c)),this.unaryPlusOp=c=>this.arithmeticHelper.unaryPlus(c),this.functionRegistry.initializePlugins(this),this.criterionBuilder=new Sve(e)}evaluateAst(e,t){let r=this.evaluateAstWithoutPostprocessing(e,t);if(It(r)){if(n2(me(r)))return new E(N.NUM,_.NaN);r=ZO(r,r2(me(r)))}return r instanceof Ae&&r.height()===1&&r.width()===1&&([[r]]=r.data),Ave(r,t.formulaVertex)}evaluateAstWithoutPostprocessing(e,t){switch(e.type){case M.EMPTY:return ht;case M.CELL_REFERENCE:{const r=e.reference.toSimpleCellAddress(t.formulaAddress);return Ri(r)?new E(N.REF,_.BadRef):this.dependencyGraph.getCellValue(r)}case M.NUMBER:case M.STRING:return e.value;case M.CONCATENATE_OP:{const r=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.concatOp,r,i,t)}case M.EQUALS_OP:{const r=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.equalOp,r,i,t)}case M.NOT_EQUAL_OP:{const r=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.notEqualOp,r,i,t)}case M.GREATER_THAN_OP:{const r=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.greaterThanOp,r,i,t)}case M.LESS_THAN_OP:{const r=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.lessThanOp,r,i,t)}case M.GREATER_THAN_OR_EQUAL_OP:{const r=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.greaterThanOrEqualOp,r,i,t)}case M.LESS_THAN_OR_EQUAL_OP:{const r=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.lessThanOrEqualOp,r,i,t)}case M.PLUS_OP:{const r=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.plusOp,r,i,t)}case M.MINUS_OP:{const r=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.minusOp,r,i,t)}case M.TIMES_OP:{const r=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.timesOp,r,i,t)}case M.POWER_OP:{const r=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.powerOp,r,i,t)}case M.DIV_OP:{const r=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.divOp,r,i,t)}case M.PLUS_UNARY_OP:{const r=this.evaluateAst(e.value,t);return this.unaryRangeWrapper(this.unaryPlusOp,r,t)}case M.MINUS_UNARY_OP:{const r=this.evaluateAst(e.value,t);return this.unaryRangeWrapper(this.unaryMinusOp,r,t)}case M.PERCENT_OP:{const r=this.evaluateAst(e.value,t);return this.unaryRangeWrapper(this.percentOp,r,t)}case M.FUNCTION_CALL:{if(this.config.licenseKeyValidityState!=="valid"&&!rr.functionIsProtected(e.procedureName))return new E(N.LIC,_.LicenseKey(this.config.licenseKeyValidityState));const r=this.functionRegistry.getFunction(e.procedureName);return r!==void 0?r(e,new ta(t.formulaAddress,t.arraysFlag||this.functionRegistry.isArrayFunction(e.procedureName),t.formulaVertex)):new E(N.NAME,_.FunctionName(e.procedureName))}case M.NAMED_EXPRESSION:{const r=this.namedExpressions.nearestNamedExpression(e.expressionName,t.formulaAddress.sheet);return r?this.dependencyGraph.getCellValue(r.address):new E(N.NAME,_.NamedExpressionName(e.expressionName))}case M.CELL_RANGE:{if(!this.rangeSpansOneSheet(e))return new E(N.REF,_.RangeManySheets);const r=_e.fromCellRange(e,t.formulaAddress),i=this.dependencyGraph.getArray(r);if(i){const s=i.array;if(s instanceof tm)throw new Error("Array should be already computed");if(s instanceof E)return s;if(s instanceof Ad)return Ae.fromRange(s.raw(),r,this.dependencyGraph);throw new Error("Unknown array")}else return Ae.onlyRange(r,this.dependencyGraph)}case M.COLUMN_RANGE:{if(!this.rangeSpansOneSheet(e))return new E(N.REF,_.RangeManySheets);const r=qa.fromColumnRange(e,t.formulaAddress);return Ae.onlyRange(r,this.dependencyGraph)}case M.ROW_RANGE:{if(!this.rangeSpansOneSheet(e))return new E(N.REF,_.RangeManySheets);const r=Xa.fromRowRangeAst(e,t.formulaAddress);return Ae.onlyRange(r,this.dependencyGraph)}case M.PARENTHESIS:return this.evaluateAst(e.expression,t);case M.ARRAY:{let r;const i=[];for(const s of e.args){let o;const a=[];for(const u of s){const h=e2(this.evaluateAst(u,t)),c=h.height();if(o===void 0)o=c,a.push(...h.data);else if(o===c)for(let d=0;d<c;d++)a[d].push(...h.data[d]);else return new E(N.REF,_.SizeMismatch)}const l=a[0].length;if(r===void 0)r=l,i.push(...a);else if(r===l)i.push(...a);else return new E(N.REF,_.SizeMismatch)}return Ae.onlyValues(i)}case M.ERROR_WITH_RAW_INPUT:case M.ERROR:return e.error}}rangeSpansOneSheet(e){return e.start.sheet===e.end.sheet}unaryRangeWrapper(e,t,r){var i;if(t instanceof Ae&&!r.arraysFlag&&(t=(i=Av(t,r))!==null&&i!==void 0?i:new E(N.VALUE,_.ScalarExpected)),t instanceof E)return t;if(t instanceof Ae){const s=t.data.map(o=>o.map(e));return Ae.onlyValues(s)}return e(t)}binaryRangeWrapper(e,t,r,i){var s,o;if(t instanceof Ae&&!i.arraysFlag&&(t=(s=Av(t,i))!==null&&s!==void 0?s:new E(N.VALUE,_.ScalarExpected)),t instanceof E)return t;if(r instanceof Ae&&!i.arraysFlag&&(r=(o=Av(r,i))!==null&&o!==void 0?o:new E(N.VALUE,_.ScalarExpected)),r instanceof E)return r;if(t instanceof Ae||r instanceof Ae){if(!(t instanceof Ae))if(r.isAdHoc()){const h=r.data;for(let c=0;c<h.length;c++)for(let d=0;d<h[0].length;d++)h[c][d]=e(t,h[c][d]);return Ae.onlyValues(h)}else t=Ae.fromScalar(t);if(!(r instanceof Ae))if(t.isAdHoc()){const h=t.data;for(let c=0;c<h.length;c++)for(let d=0;d<h[0].length;d++)h[c][d]=e(h[c][d],r);return Ae.onlyValues(h)}else r=Ae.fromScalar(r);if(t.width()===r.width()&&t.height()===r.height()){if(t.isAdHoc()){const h=t.data,c=r.data;for(let d=0;d<h.length;d++)for(let f=0;f<h[0].length;f++)h[d][f]=e(h[d][f],c[d][f]);return Ae.onlyValues(h)}if(r.isAdHoc()){const h=t.data,c=r.data;for(let d=0;d<h.length;d++)for(let f=0;f<h[0].length;f++)c[d][f]=e(h[d][f],c[d][f]);return Ae.onlyValues(c)}}const a=Math.max(t.width(),r.width()),l=Math.max(t.height(),r.height()),u=Array(l);for(let h=0;h<l;h++)u[h]=Array(a);for(let h=0;h<l;h++){const c=t.height()!==1?h:0,d=r.height()!==1?h:0;for(let f=0;f<a;f++){const g=t.width()!==1?f:0,p=r.width()!==1?f:0;c<t.height()&&d<r.height()&&g<t.width()&&p<r.width()?u[h][f]=e(t.data[c][g],r.data[d][p]):u[h][f]=new E(N.NA)}}return Ae.onlyValues(u)}return e(t,r)}}function VF(n,e){return e instanceof E?e:n(e)}function es(n,e,t){return e instanceof E?e:t instanceof E?t:n(e,t)}function Ave(n,e){return n instanceof E&&e!==void 0?n.attachRootVertex(e):n}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class Nve{constructor(e){this.sheet=e,this.transformations=[]}add(e){this.transformations.push(e)}performEagerTransformations(e,t){this.transformations.forEach(r=>r.performEagerTransformations(e,t))}transformSingleAst(e,t){let[r,i]=[e,t];return this.transformations.forEach(s=>{[r,i]=s.transformSingleAst(r,i)}),[r,i]}isIrreversible(){return!0}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class Mve{constructor(e){this.stats=e,this.transformations=[]}version(){return this.transformations.length}addTransformation(e){return this.combinedTransformer!==void 0?this.combinedTransformer.add(e):this.transformations.push(e),this.version()}beginCombinedMode(e){this.combinedTransformer=new Nve(e)}commitCombinedMode(){if(this.combinedTransformer===void 0)throw Error("Combined mode wasn't started");return this.transformations.push(this.combinedTransformer),this.combinedTransformer=void 0,this.version()}applyTransformations(e,t,r){this.stats.start(Ke.TRANSFORM_ASTS_POSTPONED);for(let s=r;s<this.transformations.length;s++){const o=this.transformations[s];o.isIrreversible()&&(this.undoRedo.storeDataForVersion(s,t,this.parser.computeHashFromAst(e)),this.parser.rememberNewAst(e));const[a,l]=o.transformSingleAst(e,t);e=a,t=l}const i=this.parser.rememberNewAst(e);return this.stats.end(Ke.TRANSFORM_ASTS_POSTPONED),[i,t,this.transformations.length]}*getTransformationsFrom(e,t){for(let r=e;r<this.transformations.length;r++){const i=this.transformations[r];(!t||t(i))&&(yield i)}}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const Nv=-1;function Ive(n,e,{searchCoordinate:t,orderingDirection:r,matchExactly:i},s){const o=e.start[t],a=t==="col"?e.effectiveEndColumn(s):e.effectiveEndRow(s),l=t==="col"?d=>me(s.getCellValue(we(e.sheet,d,e.start.row))):d=>me(s.getCellValue(we(e.sheet,e.start.col,d))),u=r==="asc"?(d,f)=>UF(d,f):(d,f)=>-UF(d,f),h=Ove(d=>u(n,l(d))>=0,o,a),c=l(h);return h===Nv||typeof c!=typeof n||i&&c!==n?Nv:h-o}function Ove(n,e,t){let r=e,i=t;for(;r<i;){const s=Math.ceil((r+i)/2);n(s)?r=s:i=s-1}return r===i&&n(r)?r:Nv}function UF(n,e){return typeof n==typeof e?n===ht?0:n<e?-1:n>e?1:0:n===ht?-1:e===ht?1:e instanceof E||typeof n=="number"&&typeof e=="string"||typeof n=="number"&&typeof e=="boolean"?-1:typeof n=="string"&&typeof e=="number"?1:typeof n=="string"&&typeof e=="boolean"?-1:1}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class y2{constructor(e){this.dependencyGraph=e}advancedFind(e,t){let r;const i=t.range;i===void 0?r=t.valuesFromTopLeftCorner():r=this.dependencyGraph.computeListOfValuesInRange(i);for(let s=0;s<r.length;s++)if(e(me(r[s])))return s;return-1}basicFind(e,t,r,{ordering:i,matchExactly:s}){const o=typeof e=="string"?Hm(e):e,a=t.range;return a===void 0?this.findNormalizedValue(o,t.valuesFromTopLeftCorner()):i==="none"?this.findNormalizedValue(o,this.dependencyGraph.computeListOfValuesInRange(a)):Ive(o,a,{searchCoordinate:r,orderingDirection:i,matchExactly:s},this.dependencyGraph)}findNormalizedValue(e,t){return t.map(me).map(r=>typeof r=="string"?Hm(r):r).indexOf(e)}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class C2 extends y2{constructor(e){super(e),this.dependencyGraph=e}add(e,t){}remove(e,t){}change(e,t,r){}applyChanges(e){}addColumns(e){}removeColumns(e){}removeSheet(e){}moveValues(e,t,r,i){}removeValues(e){}find(e,t,r){return this.basicFind(e,t,"row",r)}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class uh{constructor(e,t,r){this.dependencyGraph=e,this.config=t,this.stats=r,this.index=new Map,this.transformingService=this.dependencyGraph.lazilyTransformingAstService,this.binarySearchStrategy=new C2(e)}add(e,t){if(!(e===ht||e instanceof E))if(e instanceof Ae)for(const[r,i]of e.entriesFromTopLeftCorner(t))this.addSingleCellValue(me(r),i);else this.addSingleCellValue(e,t)}remove(e,t){if(e!==void 0)if(e instanceof Ae)for(const[r,i]of e.entriesFromTopLeftCorner(t))this.removeSingleValue(me(r),i);else this.removeSingleValue(e,t)}change(e,t,r){e!==t&&(this.remove(e,r),this.add(t,r))}applyChanges(e){for(const t of e)t.oldValue!==void 0&&this.change(me(t.oldValue),me(t.value),t.address)}moveValues(e,t,r,i){for(const[s,o]of e){const a=Kpe(o,i,t,r);this.remove(s,o),this.add(s,a)}}removeValues(e){for(const[t,r]of e)this.remove(t,r)}find(e,t,{ordering:r,matchExactly:i}){const s=i===!0?"findFirst":"findLast",o=this.findUsingColumnIndex(e,t,s);return o!==void 0?o:this.binarySearchStrategy.find(e,t,{ordering:r,matchExactly:i})}findUsingColumnIndex(e,t,r){const i=t.range;if(i===void 0)return;this.ensureRecentData(i.sheet,i.start.col,e);const s=this.getColumnMap(i.sheet,i.start.col);if(!s)return-1;const o=typeof e=="string"?Hm(e):e,a=s.get(o);if(!a||!a.index||a.index.length===0)return;const l=uh.findRowBelongingToRange(a,i,r);return l!==void 0?l-i.start.row:void 0}static findRowBelongingToRange(e,t,r){const i=t.start.row,s=t.end.row,o=r==="findFirst"?th(i,e.index,"upperBound"):th(s,e.index,"lowerBound");if(o===-1)return;const a=e.index[o];return a>=i&&a<=s?a:void 0}advancedFind(e,t){return this.binarySearchStrategy.advancedFind(e,t)}addColumns(e){const t=this.index.get(e.sheet);t&&t.splice(e.columnStart,0,...Array(e.numberOfColumns))}removeColumns(e){const t=this.index.get(e.sheet);t&&t.splice(e.columnStart,e.numberOfColumns)}removeSheet(e){this.index.delete(e)}getColumnMap(e,t){this.index.has(e)||this.index.set(e,[]);const r=this.index.get(e);let i=r[t];return i||(i=new Map,r[t]=i),i}getValueIndex(e,t,r){const i=this.getColumnMap(e,t);let s=this.getColumnMap(e,t).get(r);return s||(s={version:this.transformingService.version(),index:[]},i.set(r,s)),s}ensureRecentData(e,t,r){const i=this.getValueIndex(e,t,r),s=this.transformingService.version();if(i.version===s)return;const o=this.transformingService.getTransformationsFrom(i.version,a=>a.sheet===e&&(a instanceof UN||a instanceof BN));for(const a of o)a instanceof UN?this.addRows(t,a.rowsSpan,r):a instanceof BN&&this.removeRows(t,a.rowsSpan,r);i.version=s}addSingleCellValue(e,t){this.stats.measure(Ke.BUILD_COLUMN_INDEX,()=>{this.ensureRecentData(t.sheet,t.col,e),typeof e=="string"&&(e=Hm(e));const r=this.getValueIndex(t.sheet,t.col,e);uh.addValue(r,t.row)})}removeSingleValue(e,t){this.stats.measure(Ke.BUILD_COLUMN_INDEX,()=>{this.ensureRecentData(t.sheet,t.col,e);const r=this.getColumnMap(t.sheet,t.col);typeof e=="string"&&(e=Hm(e));const i=r.get(e);if(!i)return;const s=th(t.row,i.index);s>-1&&i.index.splice(s,1),i.index.length===0&&r.delete(e),r.size===0&&delete this.index.get(t.sheet)[t.col]})}addRows(e,t,r){const i=this.getValueIndex(t.sheet,e,r);uh.shiftRows(i,t.rowStart,t.numberOfRows)}removeRows(e,t,r){const i=this.getValueIndex(t.sheet,e,r);uh.removeRowsFromValues(i,t),uh.shiftRows(i,t.rowEnd+1,-t.numberOfRows)}static addValue(e,t){const r=th(t,e.index,"lowerBound");e.index[r]===t||e.index.splice(r+1,0,t)}static removeRowsFromValues(e,t){const r=th(t.rowStart,e.index,"upperBound"),i=th(t.rowEnd,e.index,"lowerBound");r>-1&&i>-1&&r<=i&&e.index[r]<=t.rowEnd&&e.index.splice(r,i-r+1)}static shiftRows(e,t,r){const i=th(t,e.index,"upperBound");if(i!==-1)for(let s=i;s<e.index.length;++s)e.index[s]+=r}}function th(n,e,t="upperBound"){let r=0,i=e.length-1;for(;r<=i;){const a=Math.floor((r+i)/2);if(n>e[a])r=a+1;else if(n<e[a])i=a-1;else return a}const s=t==="lowerBound"?i:r;return s>=0&&s<=e.length?s:-1}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */function _ve(n,e,t){return e.useColumnIndex?new uh(n,e,t):new C2(n)}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class Pve{constructor(e){this.config=e;const t=this.config.thousandSeparator==="."?`\\${this.config.thousandSeparator}`:this.config.thousandSeparator,r=this.config.decimalSeparator==="."?`\\${this.config.decimalSeparator}`:this.config.decimalSeparator;this.numberPattern=new RegExp(`^([+-]?((${r}\\d+)|(\\d+(${t}\\d{3,})*(${r}\\d*)?)))(e[+-]?\\d+)?$`),this.allThousandSeparatorsRegex=new RegExp(`${t}`,"g")}numericStringToMaybeNumber(e){if(this.numberPattern.test(e)){const t=this.numericStringToNumber(e);return isNaN(t)?void 0:t}}numericStringToNumber(e){const t=e.replace(this.allThousandSeparatorsRegex,"").replace(this.config.decimalSeparator,".");return Number(t)}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class s_{constructor(e,t,r){this.dependencyGraph=e,this.unparser=t,this.exporter=r}getCellHyperlink(e){const t=this.dependencyGraph.getCell(e);if(t instanceof Zo){const r=t.getFormula(this.dependencyGraph.lazilyTransformingAstService);if(r.procedureName==="HYPERLINK")return r.hyperlink}}getCellFormula(e,t){const r=this.dependencyGraph.getCell(e);if(r instanceof Zo){const i=r.getFormula(this.dependencyGraph.lazilyTransformingAstService);return t=t??e,this.unparser.unparse(i,t)}else if(r instanceof Bn){const i=r.getAddress(this.dependencyGraph.lazilyTransformingAstService);if(i.row!==e.row||i.col!==e.col||i.sheet!==e.sheet)return;t=t??e;const s=r.getFormula(this.dependencyGraph.lazilyTransformingAstService);if(s!==void 0)return this.unparser.unparse(s,t)}else if(r instanceof md)return r.getFormula()}getCellSerialized(e,t){var r;return(r=this.getCellFormula(e,t))!==null&&r!==void 0?r:this.getRawValue(e)}getCellValue(e){return this.exporter.exportValue(this.dependencyGraph.getScalarValue(e))}getRawValue(e){return this.dependencyGraph.getRawValue(e)}getSheetValues(e){return this.genericSheetGetter(e,t=>this.getCellValue(t))}getSheetFormulas(e){return this.genericSheetGetter(e,t=>this.getCellFormula(t))}genericSheetGetter(e,t){const r=this.dependencyGraph.getSheetHeight(e),i=this.dependencyGraph.getSheetWidth(e),s=new Array(r);for(let o=0;o<r;o++){s[o]=new Array(i);for(let a=0;a<i;a++){const l=we(e,a,o);s[o][a]=t(l)}for(let a=i-1;a>=0&&(s[o][a]===null||s[o][a]===void 0);a--)s[o].pop()}for(let o=r-1;o>=0&&s[o].length===0;o--)s.pop();return s}genericAllSheetsGetter(e){const t={};for(const r of this.dependencyGraph.sheetMapping.displayNames()){const i=this.dependencyGraph.sheetMapping.fetch(r);t[r]=e(i)}return t}getSheetSerialized(e){return this.genericSheetGetter(e,t=>this.getCellSerialized(t))}getAllSheetsValues(){return this.genericAllSheetsGetter(e=>this.getSheetValues(e))}getAllSheetsFormulas(){return this.genericAllSheetsGetter(e=>this.getSheetFormulas(e))}getAllSheetsSerialized(){return this.genericAllSheetsGetter(e=>this.getSheetSerialized(e))}getAllNamedExpressionsSerialized(){const e=[];let t=0;for(const r of this.dependencyGraph.sheetMapping.displayNames()){const i=this.dependencyGraph.sheetMapping.fetch(r);e[i]=t,t++}return this.dependencyGraph.namedExpressions.getAllNamedExpressions().map(r=>({name:r.expression.displayName,expression:this.getCellSerialized(r.expression.address),scope:r.scope!==void 0?e[r.scope]:void 0,options:r.expression.options}))}withNewConfig(e,t){const r=new LG(e,QO(e),this.dependencyGraph.sheetMapping.fetchDisplayName,t);return new s_(this.dependencyGraph,r,this.exporter)}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class Bw{static buildFromSheets(e,t={},r=[]){const i=new Tr(t);return this.buildEngine(i,e,r)}static buildFromSheet(e,t={},r=[]){const i=new Tr(t),s=i.translationPackage.getUITranslation(cg.NEW_SHEET_PREFIX)+"1";return this.buildEngine(i,{[s]:e},r)}static buildEmpty(e={},t=[]){return this.buildEngine(new Tr(e),{},t)}static rebuildWithConfig(e,t,r,i){return this.buildEngine(e,t,r,i)}static buildEngine(e,t={},r=[],i=e.useStats?new FG:new Epe){i.start(Ke.BUILD_ENGINE_TOTAL);const s=new Hh,o=new rr(e),a=new Mve(i),l=r_.buildEmpty(a,e,o,s,i),u=_ve(l,e,i),h=l.sheetMapping,c=l.addressMapping;for(const Z in t)if(Object.prototype.hasOwnProperty.call(t,Z)){const ee=t[Z];d2(ee);const ne=qy(ee);if(ne.height>e.maxRows||ne.width>e.maxColumns)throw new Sh;const re=h.addSheet(Z);c.autoAddSheet(re,ne)}const d=new xm(e,o,h.get);a.parser=d;const f=new LG(e,QO(e),h.fetchDisplayName,s),g=new wwe(e),p=new Pve(e),v=new Jpe(e,g,p),y=new kwe(e,g,p),S=new owe(e,o),R=new Ywe(e,l,u,y,d,i,a,s,S),A=new gve(e,R);a.undoRedo=A;const O=new Vwe(e,l,R),V=new pve(e,R,A,O,l,u,d,y,a,s);r.forEach(Z=>{V.ensureItIsPossibleToAddNamedExpression(Z.name,Z.expression,Z.scope),V.operations.addNamedExpression(Z.name,Z.expression,Z.scope,Z.options)});const B=new vve(e,s,h.fetchDisplayName,a),Y=new s_(l,f,B),q=new Tve(e,l,u,i,v,o,s,Y,S,g);i.measure(Ke.GRAPH_BUILD,()=>{new yve(l,u,d,y,i,S).buildGraph(t,i)});const G=new wve(e,i,q,a,l,u);return G.run(),i.end(Ke.BUILD_ENGINE_TOTAL),{config:e,stats:i,dependencyGraph:l,columnSearch:u,parser:d,unparser:f,cellContentParser:y,evaluator:G,lazilyTransformingAstService:a,crudOperations:V,exporter:B,namedExpressions:s,serialization:Y,functionRegistry:o}}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */function xve(n){for(const[e,t]of Object.entries(n))t instanceof Function?n[e]=Lve(t):delete n[e]}function Lve(n){return()=>{throw new Error(`The "${n}" method cannot be called because this HyperFormula instance has been destroyed`)}}var Ww={exports:{}},BF;function Hve(){if(BF)return Ww.exports;BF=1;function n(){}return n.prototype={on:function(e,t,r){var i=this.e||(this.e={});return(i[e]||(i[e]=[])).push({fn:t,ctx:r}),this},once:function(e,t,r){var i=this;function s(){i.off(e,s),t.apply(r,arguments)}return s._=t,this.on(e,s,r)},emit:function(e){var t=[].slice.call(arguments,1),r=((this.e||(this.e={}))[e]||[]).slice(),i=0,s=r.length;for(i;i<s;i++)r[i].fn.apply(r[i].ctx,t);return this},off:function(e,t){var r=this.e||(this.e={}),i=r[e],s=[];if(i&&t)for(var o=0,a=i.length;o<a;o++)i[o].fn!==t&&i[o].fn._!==t&&s.push(i[o]);return s.length?r[e]=s:delete r[e],this}},Ww.exports=n,Ww.exports.TinyEmitter=n,Ww.exports}var Dve=Hve();/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */var Uo;(function(n){n.SheetAdded="sheetAdded",n.SheetRemoved="sheetRemoved",n.SheetRenamed="sheetRenamed",n.NamedExpressionAdded="namedExpressionAdded",n.NamedExpressionRemoved="namedExpressionRemoved",n.ValuesUpdated="valuesUpdated",n.EvaluationSuspended="evaluationSuspended",n.EvaluationResumed="evaluationResumed"})(Uo||(Uo={}));class Fve extends Dve.TinyEmitter{emit(e,...t){return super.emit(e,...t),this}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class vr{constructor(e,t,r,i,s,o,a,l,u,h,c,d,f,g){this._config=e,this._stats=t,this._dependencyGraph=r,this._columnSearch=i,this._parser=s,this._unparser=o,this._cellContentParser=a,this._evaluator=l,this._lazilyTransformingAstService=u,this._crudOperations=h,this._exporter=c,this._namedExpressions=d,this._serialization=f,this._functionRegistry=g,this._emitter=new Fve,this._evaluationSuspended=!1}static get defaultConfig(){return kve()}get graph(){return this.dependencyGraph.graph}get rangeMapping(){return this.dependencyGraph.rangeMapping}get arrayMapping(){return this.dependencyGraph.arrayMapping}get sheetMapping(){return this.dependencyGraph.sheetMapping}get addressMapping(){return this.dependencyGraph.addressMapping}get dependencyGraph(){return this._dependencyGraph}get evaluator(){return this._evaluator}get columnSearch(){return this._columnSearch}get lazilyTransformingAstService(){return this._lazilyTransformingAstService}get licenseKeyValidityState(){return this._config.licenseKeyValidityState}static buildFromArray(e,t={},r=[]){return this.buildFromEngineState(Bw.buildFromSheet(e,t,r))}static buildFromSheets(e,t={},r=[]){return this.buildFromEngineState(Bw.buildFromSheets(e,t,r))}static buildEmpty(e={},t=[]){return this.buildFromEngineState(Bw.buildEmpty(e,t))}static getLanguage(e){le(e,"string","languageCode");const t=this.registeredLanguages.get(e);if(t===void 0)throw new _N;return t}static registerLanguage(e,t){if(le(e,"string","languageCode"),this.registeredLanguages.has(e))throw new QG;this.registeredLanguages.set(e,Fpe(t))}static unregisterLanguage(e){if(le(e,"string","languageCode"),this.registeredLanguages.has(e))this.registeredLanguages.delete(e);else throw new _N}static getRegisteredLanguagesCodes(){return Array.from(this.registeredLanguages.keys())}static registerFunctionPlugin(e,t){rr.registerFunctionPlugin(e,t)}static unregisterFunctionPlugin(e){rr.unregisterFunctionPlugin(e)}static registerFunction(e,t,r){le(e,"string","functionId"),rr.registerFunction(e,t,r)}static unregisterFunction(e){le(e,"string","functionId"),rr.unregisterFunction(e)}static unregisterAllFunctions(){rr.unregisterAll()}static getRegisteredFunctionNames(e){le(e,"string","code");const t=rr.getRegisteredFunctionIds();return this.getLanguage(e).getFunctionTranslations(t)}static getFunctionPlugin(e){return le(e,"string","functionId"),rr.getFunctionPlugin(e)}static getAllFunctionPlugins(){return rr.getPlugins()}static buildFromEngineState(e){return new vr(e.config,e.stats,e.dependencyGraph,e.columnSearch,e.parser,e.unparser,e.cellContentParser,e.evaluator,e.lazilyTransformingAstService,e.crudOperations,e.exporter,e.namedExpressions,e.serialization,e.functionRegistry)}getCellValue(e){if(!_n(e))throw new Nt("SimpleCellAddress","cellAddress");return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellValue(e)}getCellFormula(e){if(!_n(e))throw new Nt("SimpleCellAddress","cellAddress");return this._serialization.getCellFormula(e)}getCellHyperlink(e){if(!_n(e))throw new Nt("SimpleCellAddress","cellAddress");return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellHyperlink(e)}getCellSerialized(e){if(!_n(e))throw new Nt("SimpleCellAddress","cellAddress");return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellSerialized(e)}getSheetValues(e){return le(e,"number","sheetId"),this.ensureEvaluationIsNotSuspended(),this._serialization.getSheetValues(e)}getSheetFormulas(e){return le(e,"number","sheetId"),this._serialization.getSheetFormulas(e)}getSheetSerialized(e){return le(e,"number","sheetId"),this.ensureEvaluationIsNotSuspended(),this._serialization.getSheetSerialized(e)}getAllSheetsDimensions(){return this._serialization.genericAllSheetsGetter(e=>this.getSheetDimensions(e))}getSheetDimensions(e){return le(e,"number","sheetId"),{width:this.dependencyGraph.getSheetWidth(e),height:this.dependencyGraph.getSheetHeight(e)}}getAllSheetsValues(){return this.ensureEvaluationIsNotSuspended(),this._serialization.getAllSheetsValues()}getAllSheetsFormulas(){return this._serialization.getAllSheetsFormulas()}getAllSheetsSerialized(){return this.ensureEvaluationIsNotSuspended(),this._serialization.getAllSheetsSerialized()}updateConfig(e){Object.entries(e).every(([r,i])=>this._config[r]===i)||this.rebuildWithConfig(e)}getConfig(){return this._config.getConfig()}rebuildAndRecalculate(){this.rebuildWithConfig({})}getStats(){return this._stats.snapshot()}undo(){return this._crudOperations.undo(),this.recomputeIfDependencyGraphNeedsIt()}redo(){return this._crudOperations.redo(),this.recomputeIfDependencyGraphNeedsIt()}isThereSomethingToUndo(){return this._crudOperations.isThereSomethingToUndo()}isThereSomethingToRedo(){return this._crudOperations.isThereSomethingToRedo()}isItPossibleToSetCellContents(e){let t;if(_n(e))t=new _e(e,e);else if(Oi(e))t=new _e(e.start,e.end);else throw new Nt("SimpleCellAddress | SimpleCellRange","address");try{this._crudOperations.ensureRangeInSizeLimits(t);for(const r of t.addresses(this._dependencyGraph))this._crudOperations.ensureItIsPossibleToChangeContent(r)}catch{return!1}return!0}setCellContents(e,t){return this._crudOperations.setCellContents(e,t),this.recomputeIfDependencyGraphNeedsIt()}swapRowIndexes(e,t){return le(e,"number","sheetId"),this._crudOperations.setRowOrder(e,t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToSwapRowIndexes(e,t){le(e,"number","sheetId");try{return this._crudOperations.validateSwapRowIndexes(e,t),this._crudOperations.testRowOrderForArrays(e,t),!0}catch{return!1}}setRowOrder(e,t){le(e,"number","sheetId");const r=this._crudOperations.mappingFromOrder(e,t,"row");return this.swapRowIndexes(e,r)}isItPossibleToSetRowOrder(e,t){le(e,"number","sheetId");try{const r=this._crudOperations.mappingFromOrder(e,t,"row");return this._crudOperations.validateSwapRowIndexes(e,r),this._crudOperations.testRowOrderForArrays(e,r),!0}catch{return!1}}swapColumnIndexes(e,t){return le(e,"number","sheetId"),this._crudOperations.setColumnOrder(e,t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToSwapColumnIndexes(e,t){le(e,"number","sheetId");try{return this._crudOperations.validateSwapColumnIndexes(e,t),this._crudOperations.testColumnOrderForArrays(e,t),!0}catch{return!1}}setColumnOrder(e,t){le(e,"number","sheetId");const r=this._crudOperations.mappingFromOrder(e,t,"column");return this.swapColumnIndexes(e,r)}isItPossibleToSetColumnOrder(e,t){le(e,"number","sheetId");try{const r=this._crudOperations.mappingFromOrder(e,t,"column");return this._crudOperations.validateSwapColumnIndexes(e,r),this._crudOperations.testColumnOrderForArrays(e,r),!0}catch{return!1}}isItPossibleToAddRows(e,...t){le(e,"number","sheetId");const r=Qy(t);try{return this._crudOperations.ensureItIsPossibleToAddRows(e,...r),!0}catch{return!1}}addRows(e,...t){return le(e,"number","sheetId"),this._crudOperations.addRows(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToRemoveRows(e,...t){le(e,"number","sheetId");const r=Xy(t);try{return this._crudOperations.ensureItIsPossibleToRemoveRows(e,...r),!0}catch{return!1}}removeRows(e,...t){return le(e,"number","sheetId"),this._crudOperations.removeRows(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToAddColumns(e,...t){le(e,"number","sheetId");const r=Qy(t);try{return this._crudOperations.ensureItIsPossibleToAddColumns(e,...r),!0}catch{return!1}}addColumns(e,...t){return le(e,"number","sheetId"),this._crudOperations.addColumns(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToRemoveColumns(e,...t){le(e,"number","sheetId");const r=Xy(t);try{return this._crudOperations.ensureItIsPossibleToRemoveColumns(e,...r),!0}catch{return!1}}removeColumns(e,...t){return le(e,"number","sheetId"),this._crudOperations.removeColumns(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToMoveCells(e,t){if(!_n(t))throw new Nt("SimpleCellAddress","destinationLeftCorner");if(!Oi(e))throw new Nt("SimpleCellRange","source");try{const r=new _e(e.start,e.end);return this._crudOperations.operations.ensureItIsPossibleToMoveCells(r.start,r.width(),r.height(),t),!0}catch{return!1}}moveCells(e,t){if(!_n(t))throw new Nt("SimpleCellAddress","destinationLeftCorner");if(!Oi(e))throw new Nt("SimpleCellRange","source");const r=new _e(e.start,e.end);return this._crudOperations.moveCells(r.start,r.width(),r.height(),t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToMoveRows(e,t,r,i){le(e,"number","sheetId"),le(t,"number","startRow"),le(r,"number","numberOfRows"),le(i,"number","targetRow");try{return this._crudOperations.ensureItIsPossibleToMoveRows(e,t,r,i),!0}catch{return!1}}moveRows(e,t,r,i){return le(e,"number","sheetId"),le(t,"number","startRow"),le(r,"number","numberOfRows"),le(i,"number","targetRow"),this._crudOperations.moveRows(e,t,r,i),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToMoveColumns(e,t,r,i){le(e,"number","sheetId"),le(t,"number","startColumn"),le(r,"number","numberOfColumns"),le(i,"number","targetColumn");try{return this._crudOperations.ensureItIsPossibleToMoveColumns(e,t,r,i),!0}catch{return!1}}moveColumns(e,t,r,i){return le(e,"number","sheetId"),le(t,"number","startColumn"),le(r,"number","numberOfColumns"),le(i,"number","targetColumn"),this._crudOperations.moveColumns(e,t,r,i),this.recomputeIfDependencyGraphNeedsIt()}copy(e){if(!Oi(e))throw new Nt("SimpleCellRange","source");const t=new _e(e.start,e.end);return this._crudOperations.copy(t.start,t.width(),t.height()),this.getRangeValues(e)}cut(e){if(!Oi(e))throw new Nt("SimpleCellRange","source");const t=new _e(e.start,e.end);return this._crudOperations.cut(t.start,t.width(),t.height()),this.getRangeValues(e)}paste(e){if(!_n(e))throw new Nt("SimpleCellAddress","targetLeftCorner");return this.ensureEvaluationIsNotSuspended(),this._crudOperations.paste(e),this.recomputeIfDependencyGraphNeedsIt()}isClipboardEmpty(){return this._crudOperations.isClipboardEmpty()}clearClipboard(){this._crudOperations.clearClipboard()}clearRedoStack(){this._crudOperations.undoRedo.clearRedoStack()}clearUndoStack(){this._crudOperations.undoRedo.clearUndoStack()}getRangeValues(e){if(!Oi(e))throw new Nt("SimpleCellRange","source");return new _e(e.start,e.end).arrayOfAddressesInRange().map(r=>r.map(i=>this.getCellValue(i)))}getRangeFormulas(e){if(!Oi(e))throw new Nt("SimpleCellRange","source");return new _e(e.start,e.end).arrayOfAddressesInRange().map(r=>r.map(i=>this.getCellFormula(i)))}getRangeSerialized(e){if(!Oi(e))throw new Nt("SimpleCellRange","source");return new _e(e.start,e.end).arrayOfAddressesInRange().map(r=>r.map(i=>this.getCellSerialized(i)))}getFillRangeData(e,t,r=!1){if(!Oi(e))throw new Nt("SimpleCellRange","source");if(!Oi(t))throw new Nt("SimpleCellRange","target");const i=new _e(e.start,e.end),s=new _e(t.start,t.end);return this.ensureEvaluationIsNotSuspended(),s.arrayOfAddressesInRange().map(o=>o.map(a=>{const l=((a.row-(r?t:e).start.row)%i.height()+i.height())%i.height()+e.start.row,u=((a.col-(r?t:e).start.col)%i.width()+i.width())%i.width()+e.start.col;return this._serialization.getCellSerialized({row:l,col:u,sheet:i.sheet},a)}))}isItPossibleToAddSheet(e){le(e,"string","sheetName");try{return this._crudOperations.ensureItIsPossibleToAddSheet(e),!0}catch{return!1}}addSheet(e){e!==void 0&&le(e,"string","sheetName");const t=this._crudOperations.addSheet(e);return this._emitter.emit(Uo.SheetAdded,t),t}isItPossibleToRemoveSheet(e){le(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),!0}catch{return!1}}removeSheet(e){le(e,"number","sheetId");const t=this.sheetMapping.getDisplayName(e);this._crudOperations.removeSheet(e);const r=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(Uo.SheetRemoved,t,r),r}isItPossibleToClearSheet(e){le(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),!0}catch{return!1}}clearSheet(e){return le(e,"number","sheetId"),this._crudOperations.clearSheet(e),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToReplaceSheetContent(e,t){le(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),this._crudOperations.ensureItIsPossibleToChangeSheetContents(e,t),!0}catch{return!1}}setSheetContent(e,t){return le(e,"number","sheetId"),this._crudOperations.setSheetContent(e,t),this.recomputeIfDependencyGraphNeedsIt()}simpleCellAddressFromString(e,t){return le(e,"string","cellAddress"),le(t,"number","sheetId"),vN(this.sheetMapping.get,e,t)}simpleCellRangeFromString(e,t){return le(e,"string","cellRange"),le(t,"number","sheetId"),Sfe(this.sheetMapping.get,e,t)}simpleCellAddressToString(e,t){if(!_n(e))throw new Nt("SimpleCellAddress","cellAddress");return le(t,"number","sheetId"),Oy(this.sheetMapping.fetchDisplayName,e,t)}simpleCellRangeToString(e,t){if(!Oi(e))throw new Nt("SimpleCellRange","cellRange");return le(t,"number","sheetId"),Rfe(this.sheetMapping.fetchDisplayName,e,t)}getCellDependents(e){let t;if(_n(e))t=this._dependencyGraph.addressMapping.getCell(e);else if(Oi(e))t=this._dependencyGraph.rangeMapping.getRange(e.start,e.end);else throw new Nt("SimpleCellAddress | SimpleCellRange",e);return t===void 0?[]:this._dependencyGraph.getAdjacentNodesAddresses(t)}getCellPrecedents(e){let t;if(_n(e))t=this._dependencyGraph.addressMapping.getCell(e);else if(Oi(e))t=this._dependencyGraph.rangeMapping.getRange(e.start,e.end);else throw new Nt("SimpleCellAddress | SimpleCellRange",e);return t===void 0?[]:this._dependencyGraph.dependencyQueryAddresses(t)}getSheetName(e){return le(e,"number","sheetId"),this.sheetMapping.getDisplayName(e)}getSheetNames(){return this.sheetMapping.sheetNames()}getSheetId(e){return le(e,"string","sheetName"),this.sheetMapping.get(e)}doesSheetExist(e){return le(e,"string","sheetName"),this.sheetMapping.hasSheetWithName(e)}getCellType(e){if(!_n(e))throw new Nt("SimpleCellAddress","cellAddress");const t=this.dependencyGraph.getCell(e);return Wpe(t,e)}doesCellHaveSimpleValue(e){if(!_n(e))throw new Nt("SimpleCellAddress","cellAddress");return this.getCellType(e)===yi.VALUE}doesCellHaveFormula(e){if(!_n(e))throw new Nt("SimpleCellAddress","cellAddress");const t=this.getCellType(e);return t===yi.FORMULA||t===yi.ARRAYFORMULA}isCellEmpty(e){if(!_n(e))throw new Nt("SimpleCellAddress","cellAddress");return this.getCellType(e)===yi.EMPTY}isCellPartOfArray(e){if(!_n(e))throw new Nt("SimpleCellAddress","cellAddress");const t=this.getCellType(e);return t===yi.ARRAY||t===yi.ARRAYFORMULA}getCellValueType(e){if(!_n(e))throw new Nt("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();const t=this.dependencyGraph.getCellValue(e);return jy(t)}getCellValueDetailedType(e){if(!_n(e))throw new Nt("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();const t=this.dependencyGraph.getCellValue(e);return Gpe(t)}getCellValueFormat(e){if(!_n(e))throw new Nt("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();const t=this.dependencyGraph.getCellValue(e);return jpe(t)}countSheets(){return this.sheetMapping.numberOfSheets()}isItPossibleToRenameSheet(e,t){le(e,"number","sheetId"),le(t,"string","newName");try{return this._crudOperations.ensureItIsPossibleToRenameSheet(e,t),!0}catch{return!1}}renameSheet(e,t){le(e,"number","sheetId"),le(t,"string","newName");const r=this._crudOperations.renameSheet(e,t);r!==void 0&&this._emitter.emit(Uo.SheetRenamed,r,t)}batch(e){this.suspendEvaluation(),this._crudOperations.beginUndoRedoBatchMode();try{e()}catch(t){throw this._crudOperations.commitUndoRedoBatchMode(),this.resumeEvaluation(),t}return this._crudOperations.commitUndoRedoBatchMode(),this.resumeEvaluation()}suspendEvaluation(){this._evaluationSuspended=!0,this._emitter.emit(Uo.EvaluationSuspended)}resumeEvaluation(){this._evaluationSuspended=!1;const e=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(Uo.EvaluationResumed,e),e}isEvaluationSuspended(){return this._evaluationSuspended}isItPossibleToAddNamedExpression(e,t,r){le(e,"string","expressionName"),r!==void 0&&le(r,"number","scope");try{return this._crudOperations.ensureItIsPossibleToAddNamedExpression(e,t,r),!0}catch{return!1}}addNamedExpression(e,t,r,i){le(e,"string","expressionName"),r!==void 0&&le(r,"number","scope"),this._crudOperations.addNamedExpression(e,t,r,i);const s=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(Uo.NamedExpressionAdded,e,s),s}getNamedExpressionValue(e,t){le(e,"string","expressionName"),t!==void 0&&le(t,"number","scope"),this.ensureEvaluationIsNotSuspended(),this._crudOperations.ensureScopeIdIsValid(t);const r=this._namedExpressions.namedExpressionForScope(e,t);if(r)return this._serialization.getCellValue(r.address)}getNamedExpressionFormula(e,t){le(e,"string","expressionName"),t!==void 0&&le(t,"number","scope"),this._crudOperations.ensureScopeIdIsValid(t);const r=this._namedExpressions.namedExpressionForScope(e,t);if(r!==void 0)return this._serialization.getCellFormula(r.address)}getNamedExpression(e,t){le(e,"string","expressionName"),t!==void 0&&le(t,"number","scope");const r=this._namedExpressions.namedExpressionForScope(e,t);if(r===void 0)return;const i=this._serialization.getCellFormula(r.address);return{name:e,scope:t,expression:i,options:r.options}}isItPossibleToChangeNamedExpression(e,t,r){le(e,"string","expressionName"),r!==void 0&&le(r,"number","scope");try{return this._crudOperations.ensureItIsPossibleToChangeNamedExpression(e,t,r),!0}catch{return!1}}changeNamedExpression(e,t,r,i){return le(e,"string","expressionName"),r!==void 0&&le(r,"number","scope"),this._crudOperations.changeNamedExpressionExpression(e,r,t,i),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToRemoveNamedExpression(e,t){le(e,"string","expressionName"),t!==void 0&&le(t,"number","scope");try{return this._crudOperations.isItPossibleToRemoveNamedExpression(e,t),!0}catch{return!1}}removeNamedExpression(e,t){le(e,"string","expressionName"),t!==void 0&&le(t,"number","scope");const r=this._crudOperations.removeNamedExpression(e,t);if(r){const i=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(Uo.NamedExpressionRemoved,r.displayName,i),i}else return[]}listNamedExpressions(e){return e!==void 0&&le(e,"number","scope"),this._crudOperations.ensureScopeIdIsValid(e),this._namedExpressions.getAllNamedExpressionsNamesInScope(e)}getAllNamedExpressionsSerialized(){return this._serialization.getAllNamedExpressionsSerialized()}normalizeFormula(e){le(e,"string","formulaString");const{ast:t,address:r}=this.extractTemporaryFormula(e);if(t===void 0)throw new bv;return this._unparser.unparse(t,r)}calculateFormula(e,t){le(e,"string","formulaString"),le(t,"number","sheetId"),this._crudOperations.ensureScopeIdIsValid(t);const{ast:r,address:i,dependencies:s}=this.extractTemporaryFormula(e,t);if(r===void 0)throw new bv;const o=this.evaluator.runAndForget(r,i,s);return this._exporter.exportScalarOrRange(o)}getNamedExpressionsFromFormula(e){le(e,"string","formulaString");const{ast:t,dependencies:r}=this.extractTemporaryFormula(e);if(t===void 0)throw new bv;const i=r.filter(o=>o instanceof za).map(o=>o.name);return[...new Set(i)]}validateFormula(e){le(e,"string","formulaString");const{ast:t}=this.extractTemporaryFormula(e);return t!==void 0}getRegisteredFunctionNames(){return vr.getLanguage(this._config.language).getFunctionTranslations(this._functionRegistry.getRegisteredFunctionIds())}getFunctionPlugin(e){return le(e,"string","functionId"),this._functionRegistry.getFunctionPlugin(e)}getAllFunctionPlugins(){return this._functionRegistry.getPlugins()}numberToDateTime(e){return le(e,"number","val"),this._evaluator.interpreter.dateTimeHelper.numberToSimpleDateTime(e)}numberToDate(e){return le(e,"number","val"),this._evaluator.interpreter.dateTimeHelper.numberToSimpleDate(e)}numberToTime(e){return le(e,"number","val"),gd(e)}on(e,t){this._emitter.on(e,t)}once(e,t){this._emitter.once(e,t)}off(e,t){this._emitter.off(e,t)}destroy(){xve(this)}ensureEvaluationIsNotSuspended(){if(this._evaluationSuspended)throw new qG}extractTemporaryFormula(e,t=1){const r=this._cellContentParser.parse(e),i={sheet:t,col:0,row:0};if(!(r instanceof fn.Formula))return{address:i,dependencies:[]};const{ast:s,errors:o,dependencies:a}=this._parser.parse(r.formula,i);return o.length>0?{address:i,dependencies:[]}:{ast:s,address:i,dependencies:a}}rebuildWithConfig(e){const t=this._config.mergeConfig(e),r=this._config.mergeConfig({language:e.language}),i=this._serialization.withNewConfig(r,this._namedExpressions).getAllSheetsSerialized(),s=this._serialization.getAllNamedExpressionsSerialized(),o=Bw.rebuildWithConfig(t,i,s,this._stats);this._config=o.config,this._stats=o.stats,this._dependencyGraph=o.dependencyGraph,this._columnSearch=o.columnSearch,this._parser=o.parser,this._unparser=o.unparser,this._cellContentParser=o.cellContentParser,this._evaluator=o.evaluator,this._lazilyTransformingAstService=o.lazilyTransformingAstService,this._crudOperations=o.crudOperations,this._exporter=o.exporter,this._namedExpressions=o.namedExpressions,this._serialization=o.serialization,this._functionRegistry=o.functionRegistry}recomputeIfDependencyGraphNeedsIt(){if(this._evaluationSuspended)return[];{const e=this._crudOperations.getAndClearContentChanges(),t=this.dependencyGraph.verticesToRecompute();this.dependencyGraph.clearDirtyVertices(),t.length>0&&e.addAll(this.evaluator.partialRun(t));const r=e.exportChanges(this._exporter);return e.isEmpty()||this._emitter.emit(Uo.ValuesUpdated,r),r}}}vr.version="2.7.1";vr.buildDate="18/07/2024 11:23:17";vr.releaseDate="18/07/2024";vr.languages={};vr.registeredLanguages=new Map;/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const WF=new WeakMap;class Tr{constructor(e={},t=!0){const{accentSensitive:r,binarySearchThreshold:i,caseSensitive:s,caseFirst:o,chooseAddressMappingPolicy:a,context:l,currencySymbol:u,dateFormats:h,decimalSeparator:c,evaluateNullToZero:d,functionArgSeparator:f,functionPlugins:g,ignorePunctuation:p,leapYear1900:v,localeLang:y,language:S,ignoreWhiteSpace:R,licenseKey:A,matchWholeCell:O,arrayColumnSeparator:V,arrayRowSeparator:B,maxRows:Y,maxColumns:q,nullYear:G,nullDate:Z,parseDateTime:ee,precisionEpsilon:ne,precisionRounding:re,stringifyDateTime:ae,stringifyDuration:ze,smartRounding:Le,timeFormats:Se,thousandSeparator:ye,useArrayArithmetic:We,useStats:w,undoLimit:C,useColumnIndex:b,useRegularExpressions:P,useWildcards:H}=e;t&&Tr.warnDeprecatedOptions(e),this.useArrayArithmetic=Ht(We,"boolean","useArrayArithmetic"),this.accentSensitive=Ht(r,"boolean","accentSensitive"),this.caseSensitive=Ht(s,"boolean","caseSensitive"),this.caseFirst=Ht(o,["upper","lower","false"],"caseFirst"),this.ignorePunctuation=Ht(p,"boolean","ignorePunctuation"),this.chooseAddressMappingPolicy=a??Tr.defaultConfig.chooseAddressMappingPolicy,this.dateFormats=[...Hw(h,Array.isArray,"array","dateFormats")],this.timeFormats=[...Hw(Se,Array.isArray,"array","timeFormats")],this.functionArgSeparator=Ht(f,"string","functionArgSeparator"),this.decimalSeparator=Ht(c,[".",","],"decimalSeparator"),this.language=Ht(S,"string","language"),this.ignoreWhiteSpace=Ht(R,["standard","any"],"ignoreWhiteSpace"),this.licenseKey=Ht(A,"string","licenseKey"),this.thousandSeparator=Ht(ye,["",","," ","."],"thousandSeparator"),this.arrayColumnSeparator=Ht(V,[",",";"],"arrayColumnSeparator"),this.arrayRowSeparator=Ht(B,[";","|"],"arrayRowSeparator"),this.localeLang=Ht(y,"string","localeLang"),this.functionPlugins=[...g??Tr.defaultConfig.functionPlugins],this.smartRounding=Ht(Le,"boolean","smartRounding"),this.evaluateNullToZero=Ht(d,"boolean","evaluateNullToZero"),this.nullYear=Ht(G,"number","nullYear"),Hc(this.nullYear,"nullYear",0),awe(this.nullYear,"nullYear",100),this.precisionRounding=Ht(re,"number","precisionRounding"),Hc(this.precisionRounding,"precisionRounding",0),this.precisionEpsilon=Ht(ne,"number","precisionEpsilon"),Hc(this.precisionEpsilon,"precisionEpsilon",0),this.useColumnIndex=Ht(b,"boolean","useColumnIndex"),this.useStats=Ht(w,"boolean","useStats"),this.binarySearchThreshold=i??Tr.defaultConfig.binarySearchThreshold,this.parseDateTime=Ht(ee,"function","parseDateTime"),this.stringifyDateTime=Ht(ae,"function","stringifyDateTime"),this.stringifyDuration=Ht(ze,"function","stringifyDuration"),this.translationPackage=vr.getLanguage(this.language),this.errorMapping=this.translationPackage.buildErrorMapping(),this.nullDate=Hw(Z,Dm,"IDate","nullDate"),this.leapYear1900=Ht(v,"boolean","leapYear1900"),this.undoLimit=Ht(C,"number","undoLimit"),this.useRegularExpressions=Ht(P,"boolean","useRegularExpressions"),this.useWildcards=Ht(H,"boolean","useWildcards"),this.matchWholeCell=Ht(O,"boolean","matchWholeCell"),Hc(this.undoLimit,"undoLimit",0),this.maxRows=Ht(Y,"number","maxRows"),Hc(this.maxRows,"maxRows",1),this.maxColumns=Ht(q,"number","maxColumns"),this.currencySymbol=this.setupCurrencySymbol(u),Hc(this.maxColumns,"maxColumns",1),this.context=l,WF.set(this,{licenseKeyValidityState:xwe(this.licenseKey)}),AF({value:this.decimalSeparator,name:"decimalSeparator"},{value:this.functionArgSeparator,name:"functionArgSeparator"},{value:this.thousandSeparator,name:"thousandSeparator"}),AF({value:this.arrayRowSeparator,name:"arrayRowSeparator"},{value:this.arrayColumnSeparator,name:"arrayColumnSeparator"})}setupCurrencySymbol(e){const t=[...Hw(e,Array.isArray,"array","currencySymbol")];return t.forEach(r=>{if(typeof r!="string")throw new Nt("string[]","currencySymbol");if(r==="")throw new Tpe("currencySymbol")}),t}get licenseKeyValidityState(){return WF.get(this).licenseKeyValidityState}getConfig(){return S2(this)}mergeConfig(e){const t=Object.assign({},this.getConfig(),e);return Tr.warnDeprecatedOptions(e),new Tr(t,!1)}static warnDeprecatedOptions(e){Tr.warnDeprecatedIfUsed(e.binarySearchThreshold,"binarySearchThreshold","1.1")}static warnDeprecatedIfUsed(e,t,r,i){e!==void 0&&console.warn(i===void 0?`${t} option is deprecated since ${r}`:`${t} option is deprecated since ${r}, please use ${i}`)}}Tr.defaultConfig={accentSensitive:!1,binarySearchThreshold:20,currencySymbol:["$"],caseSensitive:!1,caseFirst:"lower",context:void 0,chooseAddressMappingPolicy:new Swe,dateFormats:["DD/MM/YYYY","DD/MM/YY"],decimalSeparator:".",evaluateNullToZero:!1,functionArgSeparator:",",functionPlugins:[],ignorePunctuation:!1,language:"enGB",ignoreWhiteSpace:"standard",licenseKey:"",leapYear1900:!1,localeLang:"en",matchWholeCell:!0,arrayColumnSeparator:",",arrayRowSeparator:";",maxRows:4e4,maxColumns:18278,nullYear:30,nullDate:{year:1899,month:12,day:30},parseDateTime:dwe,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,stringifyDateTime:Iwe,stringifyDuration:Mwe,timeFormats:["hh:mm","hh:mm:ss.sss"],thousandSeparator:"",undoLimit:20,useRegularExpressions:!1,useWildcards:!0,useColumnIndex:!1,useStats:!1,useArrayArithmetic:!1};function S2(n){var e;const t={};for(const r in Tr.defaultConfig){const i=(e=n[r])!==null&&e!==void 0?e:Tr.defaultConfig[r];Array.isArray(i)?t[r]=[...i]:t[r]=i}return t}function kve(){return S2({})}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const $N={errors:{CYCLE:"#CYCLE!",DIV_BY_ZERO:"#DIV/0!",ERROR:"#ERROR!",NA:"#N/A",NAME:"#NAME?",NUM:"#NUM!",REF:"#REF!",SPILL:"#SPILL!",VALUE:"#VALUE!"},functions:{FILTER:"FILTER",ADDRESS:"ADDRESS",ARRAY_CONSTRAIN:"ARRAY_CONSTRAIN",ARRAYFORMULA:"ARRAYFORMULA",ABS:"ABS",ACOS:"ACOS",ACOSH:"ACOSH",ACOT:"ACOT",ACOTH:"ACOTH",AND:"AND",ARABIC:"ARABIC",ASIN:"ASIN",ASINH:"ASINH",ATAN2:"ATAN2",ATAN:"ATAN",ATANH:"ATANH",AVERAGE:"AVERAGE",AVERAGEA:"AVERAGEA",AVERAGEIF:"AVERAGEIF",BASE:"BASE",BIN2DEC:"BIN2DEC",BIN2HEX:"BIN2HEX",BIN2OCT:"BIN2OCT",BITAND:"BITAND",BITLSHIFT:"BITLSHIFT",BITOR:"BITOR",BITRSHIFT:"BITRSHIFT",BITXOR:"BITXOR",CEILING:"CEILING",CHAR:"CHAR",CHOOSE:"CHOOSE",CLEAN:"CLEAN",CODE:"CODE",COLUMN:"COLUMN",COLUMNS:"COLUMNS",CONCATENATE:"CONCATENATE",CORREL:"CORREL",COS:"COS",COSH:"COSH",COT:"COT",COTH:"COTH",COUNT:"COUNT",COUNTA:"COUNTA",COUNTBLANK:"COUNTBLANK",COUNTIF:"COUNTIF",COUNTIFS:"COUNTIFS",COUNTUNIQUE:"COUNTUNIQUE",CSC:"CSC",CSCH:"CSCH",CUMIPMT:"CUMIPMT",CUMPRINC:"CUMPRINC",DATE:"DATE",DATEDIF:"DATEDIF",DATEVALUE:"DATEVALUE",DAY:"DAY",DAYS360:"DAYS360",DAYS:"DAYS",DB:"DB",DDB:"DDB",DEC2BIN:"DEC2BIN",DEC2HEX:"DEC2HEX",DEC2OCT:"DEC2OCT",DECIMAL:"DECIMAL",DEGREES:"DEGREES",DELTA:"DELTA",DOLLARDE:"DOLLARDE",DOLLARFR:"DOLLARFR",EDATE:"EDATE",EFFECT:"EFFECT",EOMONTH:"EOMONTH",ERF:"ERF",ERFC:"ERFC",EVEN:"EVEN",EXACT:"EXACT",EXP:"EXP",FALSE:"FALSE",FIND:"FIND",FORMULATEXT:"FORMULATEXT",FV:"FV",FVSCHEDULE:"FVSCHEDULE",HEX2BIN:"HEX2BIN",HEX2DEC:"HEX2DEC",HEX2OCT:"HEX2OCT",HLOOKUP:"HLOOKUP",HOUR:"HOUR",HYPERLINK:"HYPERLINK",IF:"IF",IFERROR:"IFERROR",IFNA:"IFNA",IFS:"IFS",INDEX:"INDEX",INT:"INT",INTERVAL:"INTERVAL",IPMT:"IPMT",ISBINARY:"ISBINARY",ISBLANK:"ISBLANK",ISERR:"ISERR",ISERROR:"ISERROR",ISEVEN:"ISEVEN",ISFORMULA:"ISFORMULA",ISLOGICAL:"ISLOGICAL",ISNA:"ISNA",ISNONTEXT:"ISNONTEXT",ISNUMBER:"ISNUMBER",ISODD:"ISODD",ISOWEEKNUM:"ISOWEEKNUM",ISPMT:"ISPMT",ISREF:"ISREF",ISTEXT:"ISTEXT",LEFT:"LEFT",LEN:"LEN",LN:"LN",LOG10:"LOG10",LOG:"LOG",LOWER:"LOWER",MATCH:"MATCH",MAX:"MAX",MAXA:"MAXA",MAXIFS:"MAXIFS",MAXPOOL:"MAXPOOL",MEDIAN:"MEDIAN",MEDIANPOOL:"MEDIANPOOL",MID:"MID",MIN:"MIN",MINA:"MINA",MINIFS:"MINIFS",MINUTE:"MINUTE",MIRR:"MIRR",MMULT:"MMULT",MOD:"MOD",MONTH:"MONTH",NA:"NA",NETWORKDAYS:"NETWORKDAYS","NETWORKDAYS.INTL":"NETWORKDAYS.INTL",NOMINAL:"NOMINAL",NOT:"NOT",NOW:"NOW",NPER:"NPER",NPV:"NPV",OCT2BIN:"OCT2BIN",OCT2DEC:"OCT2DEC",OCT2HEX:"OCT2HEX",ODD:"ODD",OFFSET:"OFFSET",OR:"OR",PI:"PI",PMT:"PMT",PDURATION:"PDURATION",PRODUCT:"PRODUCT",POWER:"POWER",PPMT:"PPMT",PROPER:"PROPER",PV:"PV",RADIANS:"RADIANS",RAND:"RAND",RATE:"RATE",REPLACE:"REPLACE",REPT:"REPT",RIGHT:"RIGHT",ROMAN:"ROMAN",ROUND:"ROUND",ROUNDDOWN:"ROUNDDOWN",ROUNDUP:"ROUNDUP",ROW:"ROW",ROWS:"ROWS",RRI:"RRI",SEARCH:"SEARCH",SEC:"SEC",SECH:"SECH",SECOND:"SECOND",SHEET:"SHEET",SHEETS:"SHEETS",SIN:"SIN",SINH:"SINH",SLN:"SLN",SPLIT:"SPLIT",SQRT:"SQRT",STDEVA:"STDEVA","STDEV.P":"STDEV.P",STDEVPA:"STDEVPA","STDEV.S":"STDEV.S",SUBSTITUTE:"SUBSTITUTE",SUBTOTAL:"SUBTOTAL",SUM:"SUM",SUMIF:"SUMIF",SUMIFS:"SUMIFS",SUMPRODUCT:"SUMPRODUCT",SUMSQ:"SUMSQ",SWITCH:"SWITCH",SYD:"SYD",T:"T",TAN:"TAN",TANH:"TANH",TBILLEQ:"TBILLEQ",TBILLPRICE:"TBILLPRICE",TBILLYIELD:"TBILLYIELD",TEXT:"TEXT",TIME:"TIME",TIMEVALUE:"TIMEVALUE",TODAY:"TODAY",TRANSPOSE:"TRANSPOSE",TRIM:"TRIM",TRUE:"TRUE",TRUNC:"TRUNC",UNICHAR:"UNICHAR",UNICODE:"UNICODE",UPPER:"UPPER",VARA:"VARA","VAR.P":"VAR.P",VARPA:"VARPA","VAR.S":"VAR.S",VLOOKUP:"VLOOKUP",WEEKDAY:"WEEKDAY",WEEKNUM:"WEEKNUM",WORKDAY:"WORKDAY","WORKDAY.INTL":"WORKDAY.INTL",XNPV:"XNPV",XOR:"XOR",YEAR:"YEAR",YEARFRAC:"YEARFRAC","HF.ADD":"HF.ADD","HF.CONCAT":"HF.CONCAT","HF.DIVIDE":"HF.DIVIDE","HF.EQ":"HF.EQ","HF.GT":"HF.GT","HF.GTE":"HF.GTE","HF.LT":"HF.LT","HF.LTE":"HF.LTE","HF.MINUS":"HF.MINUS","HF.MULTIPLY":"HF.MULTIPLY","HF.NE":"HF.NE","HF.POW":"HF.POW","HF.UMINUS":"HF.UMINUS","HF.UNARY_PERCENT":"HF.UNARY_PERCENT","HF.UPLUS":"HF.UPLUS",VARP:"VARP",VAR:"VAR",STDEVP:"STDEVP",STDEV:"STDEV","EXPON.DIST":"EXPON.DIST",FISHER:"FISHER",FISHERINV:"FISHERINV",GAMMA:"GAMMA","GAMMA.DIST":"GAMMA.DIST",GAMMALN:"GAMMALN","GAMMALN.PRECISE":"GAMMALN.PRECISE","GAMMA.INV":"GAMMA.INV",GAUSS:"GAUSS",FACT:"FACT",FACTDOUBLE:"FACTDOUBLE",COMBIN:"COMBIN",COMBINA:"COMBINA",GCD:"GCD",LCM:"LCM",MROUND:"MROUND",MULTINOMIAL:"MULTINOMIAL",QUOTIENT:"QUOTIENT",RANDBETWEEN:"RANDBETWEEN",SERIESSUM:"SERIESSUM",SIGN:"SIGN",SQRTPI:"SQRTPI",SUMX2MY2:"SUMX2MY2",SUMX2PY2:"SUMX2PY2",SUMXMY2:"SUMXMY2",EXPONDIST:"EXPONDIST",GAMMADIST:"GAMMADIST",GAMMAINV:"GAMMAINV","BETA.DIST":"BETA.DIST",BETADIST:"BETADIST","BETA.INV":"BETA.INV",BETAINV:"BETAINV","BINOM.DIST":"BINOM.DIST",BINOMDIST:"BINOMDIST","BINOM.INV":"BINOM.INV",BESSELI:"BESSELI",BESSELJ:"BESSELJ",BESSELK:"BESSELK",BESSELY:"BESSELY","CHISQ.DIST":"CHISQ.DIST","CHISQ.DIST.RT":"CHISQ.DIST.RT","CHISQ.INV":"CHISQ.INV","CHISQ.INV.RT":"CHISQ.INV.RT",CHIDIST:"CHIDIST",CHIINV:"CHIINV","F.DIST":"F.DIST","F.DIST.RT":"F.DIST.RT","F.INV":"F.INV","F.INV.RT":"F.INV.RT",FDIST:"FDIST",FINV:"FINV",WEIBULL:"WEIBULL","WEIBULL.DIST":"WEIBULL.DIST",POISSON:"POISSON","POISSON.DIST":"POISSON.DIST","HYPGEOM.DIST":"HYPGEOM.DIST",HYPGEOMDIST:"HYPGEOMDIST","T.DIST":"T.DIST","T.DIST.2T":"T.DIST.2T","T.DIST.RT":"T.DIST.RT","T.INV":"T.INV","T.INV.2T":"T.INV.2T",TDIST:"TDIST",TINV:"TINV",LOGINV:"LOGINV","LOGNORM.DIST":"LOGNORM.DIST","LOGNORM.INV":"LOGNORM.INV",LOGNORMDIST:"LOGNORMDIST","NORM.DIST":"NORM.DIST","NORM.INV":"NORM.INV","NORM.S.DIST":"NORM.S.DIST","NORM.S.INV":"NORM.S.INV",NORMDIST:"NORMDIST",NORMINV:"NORMINV",NORMSDIST:"NORMSDIST",NORMSINV:"NORMSINV",PHI:"PHI","NEGBINOM.DIST":"NEGBINOM.DIST",NEGBINOMDIST:"NEGBINOMDIST",COMPLEX:"COMPLEX",IMABS:"IMABS",IMAGINARY:"IMAGINARY",IMARGUMENT:"IMARGUMENT",IMCONJUGATE:"IMCONJUGATE",IMCOS:"IMCOS",IMCOSH:"IMCOSH",IMCOT:"IMCOT",IMCSC:"IMCSC",IMCSCH:"IMCSCH",IMDIV:"IMDIV",IMEXP:"IMEXP",IMLN:"IMLN",IMLOG10:"IMLOG10",IMLOG2:"IMLOG2",IMPOWER:"IMPOWER",IMPRODUCT:"IMPRODUCT",IMREAL:"IMREAL",IMSEC:"IMSEC",IMSECH:"IMSECH",IMSIN:"IMSIN",IMSINH:"IMSINH",IMSQRT:"IMSQRT",IMSUB:"IMSUB",IMSUM:"IMSUM",IMTAN:"IMTAN",LARGE:"LARGE",SMALL:"SMALL",AVEDEV:"AVEDEV",CONFIDENCE:"CONFIDENCE","CONFIDENCE.NORM":"CONFIDENCE.NORM","CONFIDENCE.T":"CONFIDENCE.T",DEVSQ:"DEVSQ",GEOMEAN:"GEOMEAN",HARMEAN:"HARMEAN",CRITBINOM:"CRITBINOM","COVARIANCE.P":"COVARIANCE.P","COVARIANCE.S":"COVARIANCE.S",COVAR:"COVAR",PEARSON:"PEARSON",RSQ:"RSQ",STANDARDIZE:"STANDARDIZE","Z.TEST":"Z.TEST",ZTEST:"ZTEST","F.TEST":"F.TEST",FTEST:"FTEST",STEYX:"STEYX",SLOPE:"SLOPE","CHISQ.TEST":"CHISQ.TEST",CHITEST:"CHITEST","T.TEST":"T.TEST",TTEST:"TTEST",SKEW:"SKEW","SKEW.P":"SKEW.P",WEIBULLDIST:"WEIBULLDIST",VARS:"VARS",TINV2T:"TINV2T",TDISTRT:"TDISTRT",TDIST2T:"TDIST2T",STDEVS:"STDEVS",FINVRT:"FINVRT",FDISTRT:"FDISTRT",CHIDISTRT:"CHIDISTRT",CHIINVRT:"CHIINVRT",COVARIANCEP:"COVARIANCEP",COVARIANCES:"COVARIANCES",LOGNORMINV:"LOGNORMINV",POISSONDIST:"POISSONDIST",SKEWP:"SKEWP","CEILING.MATH":"CEILING.MATH",FLOOR:"FLOOR","FLOOR.MATH":"FLOOR.MATH","CEILING.PRECISE":"CEILING.PRECISE","FLOOR.PRECISE":"FLOOR.PRECISE","ISO.CEILING":"ISO.CEILING"},langCode:"enGB",ui:{NEW_SHEET_PREFIX:"Sheet"}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */var xl;(function(n){n[n.FullyAbsolute=1]="FullyAbsolute",n[n.RowAbsoluteColRelative=2]="RowAbsoluteColRelative",n[n.RowRelativeColAbsolute=3]="RowRelativeColAbsolute",n[n.FullyRelative=4]="FullyRelative"})(xl||(xl={}));class R2 extends et{verifyAddressArguments(e,t,r,i){if(i){if(e<1||t<1)return new E(N.VALUE,_.LessThanOne)}else if(xl.FullyAbsolute==r){if(e<1||t<1)return new E(N.VALUE,_.LessThanOne)}else if(xl.RowAbsoluteColRelative==r){if(e<1)return new E(N.VALUE,_.LessThanOne)}else if(xl.RowRelativeColAbsolute==r&&t<1)return new E(N.VALUE,_.LessThanOne)}address(e,t){return this.runFunction(e.args,t,this.metadata("ADDRESS"),(r,i,s,o,a)=>{const l=this.verifyAddressArguments(r,i,s,o);if(l!==void 0)return l;const u=oS(i-1);let h="";a!=null&&(h=`${a}!`);const c=i==0?"C":`C[${i}]`,d=r==0?"R":`R[${r}]`;return xl.FullyRelative==s?o?`${h}${u}${r}`:`${h}${d}${c}`:xl.RowRelativeColAbsolute==s?o?`${h}$${u}${r}`:`${h}${d}C${i}`:xl.RowAbsoluteColRelative==s?o?`${h}${u}$${r}`:`${h}R${r}${c}`:o?`${h}$${u}$${r}`:`${h}R${r}C${i}`})}}R2.implementedFunctions={ADDRESS:{method:"address",parameters:[{argumentType:m.NUMBER},{argumentType:m.NUMBER},{argumentType:m.NUMBER,optionalArg:!0,defaultValue:1,minValue:1,maxValue:4},{argumentType:m.BOOLEAN,optionalArg:!0,defaultValue:!0},{argumentType:m.STRING,optionalArg:!0}]}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class E2 extends et{arrayformula(e,t){return this.runFunction(e.args,t,this.metadata("ARRAYFORMULA"),r=>r)}arrayformulaArraySize(e,t){if(e.args.length!==1)return gt.error();const r=this.metadata("ARRAYFORMULA");return e.args.map(s=>{var o;return this.arraySizeForAst(s,new ta(t.formulaAddress,t.arraysFlag||((o=r?.arrayFunction)!==null&&o!==void 0?o:!1)))})[0]}arrayconstrain(e,t){return this.runFunction(e.args,t,this.metadata("ARRAY_CONSTRAIN"),(r,i,s)=>{i=Math.min(i,r.height()),s=Math.min(s,r.width());const o=r.data,a=[];for(let l=0;l<i;l++)a.push(o[l].slice(0,s));return Ae.onlyValues(a)})}arrayconstrainArraySize(e,t){if(e.args.length!==3)return gt.error();const r=this.metadata("ARRAY_CONSTRAIN"),i=e.args.map(a=>{var l;return this.arraySizeForAst(a,new ta(t.formulaAddress,t.arraysFlag||((l=r?.arrayFunction)!==null&&l!==void 0?l:!1)))});let{height:s,width:o}=i[0];return e.args[1].type===M.NUMBER&&(s=Math.min(s,e.args[1].value)),e.args[2].type===M.NUMBER&&(o=Math.min(o,e.args[2].value)),s<1||o<1||!Number.isInteger(s)||!Number.isInteger(o)?gt.error():new gt(o,s)}filter(e,t){return this.runFunction(e.args,t,this.metadata("FILTER"),(r,...i)=>{for(const a of i)if(r.width()!==a.width()||r.height()!==a.height())return new E(N.NA,_.EqualLength);if(r.width()>1&&r.height()>1)return new E(N.NA,_.WrongDimension);const s=r.data,o=[];for(let a=0;a<r.height();a++){const l=[];for(let u=0;u<r.width();u++){let h=!0;for(const c of i)if(t2(c.data[a][u])!==!0){h=!1;break}h&&l.push(s[a][u])}l.length>0&&o.push(l)}return o.length>0?Ae.onlyValues(o):new E(N.NA,_.EmptyRange)})}filterArraySize(e,t){if(e.args.length<=1)return gt.error();const r=this.metadata("FILTER"),i=e.args.map(a=>{var l;return this.arraySizeForAst(a,new ta(t.formulaAddress,t.arraysFlag||((l=r?.arrayFunction)!==null&&l!==void 0?l:!1)))}),s=Math.max(...i.map(a=>a.width)),o=Math.max(...i.map(a=>a.height));return new gt(s,o)}}E2.implementedFunctions={ARRAYFORMULA:{method:"arrayformula",arraySizeMethod:"arrayformulaArraySize",arrayFunction:!0,parameters:[{argumentType:m.ANY}]},ARRAY_CONSTRAIN:{method:"arrayconstrain",arraySizeMethod:"arrayconstrainArraySize",parameters:[{argumentType:m.RANGE},{argumentType:m.INTEGER,minValue:1},{argumentType:m.INTEGER,minValue:1}],vectorizationForbidden:!0},FILTER:{method:"filter",arraySizeMethod:"filterArraySize",arrayFunction:!0,parameters:[{argumentType:m.RANGE},{argumentType:m.RANGE}],repeatLastArgs:1}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class b2 extends et{abs(e,t){return this.runFunction(e.args,t,this.metadata("ABS"),Math.abs)}}b2.implementedFunctions={ABS:{method:"abs",parameters:[{argumentType:m.NUMBER}]}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const Vve=0xffffffffffff,$F=-53,GF=53;class T2 extends et{bitlshift(e,t){return this.runFunction(e.args,t,this.metadata("BITLSHIFT"),A2)}bitrshift(e,t){return this.runFunction(e.args,t,this.metadata("BITRSHIFT"),N2)}}T2.implementedFunctions={BITLSHIFT:{method:"bitlshift",parameters:[{argumentType:m.INTEGER,minValue:0},{argumentType:m.INTEGER,minValue:$F,maxValue:GF}]},BITRSHIFT:{method:"bitrshift",parameters:[{argumentType:m.INTEGER,minValue:0},{argumentType:m.INTEGER,minValue:$F,maxValue:GF}]}};function A2(n,e){return e<0?N2(n,-e):M2(n*Math.pow(2,e))}function N2(n,e){return e<0?A2(n,-e):M2(Math.floor(n/Math.pow(2,e)))}function M2(n){return n>Vve?new E(N.NUM,_.BitshiftLong):n}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class I2 extends et{bitand(e,t){return this.runFunction(e.args,t,this.metadata("BITAND"),(r,i)=>r&i)}bitor(e,t){return this.runFunction(e.args,t,this.metadata("BITOR"),(r,i)=>r|i)}bitxor(e,t){return this.runFunction(e.args,t,this.metadata("BITXOR"),(r,i)=>r^i)}}I2.implementedFunctions={BITAND:{method:"bitand",parameters:[{argumentType:m.INTEGER,minValue:0},{argumentType:m.INTEGER,minValue:0}]},BITOR:{method:"bitor",parameters:[{argumentType:m.INTEGER,minValue:0},{argumentType:m.INTEGER,minValue:0}]},BITXOR:{method:"bitxor",parameters:[{argumentType:m.INTEGER,minValue:0},{argumentType:m.INTEGER,minValue:0}]}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class O2 extends et{literalTrue(e,t){return this.runFunction(e.args,t,this.metadata("TRUE"),()=>!0)}literalFalse(e,t){return this.runFunction(e.args,t,this.metadata("FALSE"),()=>!1)}conditionalIf(e,t){return this.runFunction(e.args,t,this.metadata("IF"),(r,i,s)=>r?i:s)}ifs(e,t){return this.runFunction(e.args,t,this.metadata("IFS"),(...r)=>{for(let i=0;i<r.length;i+=2)if(r[i])return r[i+1];return new E(N.NA,_.NoConditionMet)})}and(e,t){return this.runFunction(e.args,t,this.metadata("AND"),(...r)=>r.filter(i=>i!==void 0).every(i=>!!i))}or(e,t){return this.runFunction(e.args,t,this.metadata("OR"),(...r)=>r.filter(i=>i!==void 0).some(i=>i))}not(e,t){return this.runFunction(e.args,t,this.metadata("NOT"),r=>!r)}xor(e,t){return this.runFunction(e.args,t,this.metadata("XOR"),(...r)=>{let i=0;return r.filter(s=>s!==void 0).forEach(s=>{s&&i++}),i%2===1})}switch(e,t){return this.runFunction(e.args,t,this.metadata("SWITCH"),(r,...i)=>{const s=i.length;let o=0;for(;o+1<s;o+=2)if(!(i[o]instanceof E)&&this.arithmeticHelper.eq(r,i[o]))return i[o+1];return o<s?i[o]:new E(N.NA,_.NoDefault)})}iferror(e,t){return this.runFunction(e.args,t,this.metadata("IFERROR"),(r,i)=>r instanceof E?i:r)}ifna(e,t){return this.runFunction(e.args,t,this.metadata("IFNA"),(r,i)=>r instanceof E&&r.type===N.NA?i:r)}choose(e,t){return this.runFunction(e.args,t,this.metadata("CHOOSE"),(r,...i)=>r>i.length?new E(N.NUM,_.Selector):i[r-1])}}O2.implementedFunctions={TRUE:{method:"literalTrue",parameters:[]},FALSE:{method:"literalFalse",parameters:[]},IF:{method:"conditionalIf",parameters:[{argumentType:m.BOOLEAN},{argumentType:m.SCALAR,passSubtype:!0},{argumentType:m.SCALAR,defaultValue:!1,passSubtype:!0}]},IFS:{method:"ifs",parameters:[{argumentType:m.BOOLEAN},{argumentType:m.SCALAR,passSubtype:!0}],repeatLastArgs:2},AND:{method:"and",parameters:[{argumentType:m.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},OR:{method:"or",parameters:[{argumentType:m.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},XOR:{method:"xor",parameters:[{argumentType:m.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},NOT:{method:"not",parameters:[{argumentType:m.BOOLEAN}]},SWITCH:{method:"switch",parameters:[{argumentType:m.NOERROR},{argumentType:m.SCALAR,passSubtype:!0},{argumentType:m.SCALAR,passSubtype:!0}],repeatLastArgs:1},IFERROR:{method:"iferror",parameters:[{argumentType:m.SCALAR,passSubtype:!0},{argumentType:m.SCALAR,passSubtype:!0}]},IFNA:{method:"ifna",parameters:[{argumentType:m.SCALAR,passSubtype:!0},{argumentType:m.SCALAR,passSubtype:!0}]},CHOOSE:{method:"choose",parameters:[{argumentType:m.INTEGER,minValue:1},{argumentType:m.SCALAR,passSubtype:!0}],repeatLastArgs:1}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class _2 extends et{char(e,t){return this.runFunction(e.args,t,this.metadata("CHAR"),r=>r<1||r>=256?new E(N.VALUE,_.CharacterCodeBounds):String.fromCharCode(Math.trunc(r)))}unichar(e,t){return this.runFunction(e.args,t,this.metadata("CHAR"),r=>r<1||r>=1114112?new E(N.VALUE,_.CharacterCodeBounds):String.fromCodePoint(Math.trunc(r)))}}_2.implementedFunctions={CHAR:{method:"char",parameters:[{argumentType:m.NUMBER}]},UNICHAR:{method:"unichar",parameters:[{argumentType:m.NUMBER}]}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class P2 extends et{code(e,t){return this.runFunction(e.args,t,this.metadata("CODE"),r=>r.length===0?new E(N.VALUE,_.EmptyString):r.charCodeAt(0))}unicode(e,t){return this.runFunction(e.args,t,this.metadata("UNICODE"),r=>{var i;return(i=r.codePointAt(0))!==null&&i!==void 0?i:new E(N.VALUE,_.EmptyString)})}}P2.implementedFunctions={CODE:{method:"code",parameters:[{argumentType:m.STRING}]},UNICODE:{method:"unicode",parameters:[{argumentType:m.STRING}]}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class x2 extends et{countblank(e,t){return this.runFunction(e.args,t,this.metadata("COUNTBLANK"),(...r)=>{let i=0;return r.forEach(s=>{s===ht&&i++}),i})}}x2.implementedFunctions={COUNTBLANK:{method:"countblank",parameters:[{argumentType:m.SCALAR}],repeatLastArgs:1,expandRanges:!0}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class L2 extends et{countunique(e,t){return this.runFunction(e.args,t,this.metadata("COUNTUNIQUE"),(...r)=>{const i=new Set,s=new Set;for(const o of r)o instanceof E?s.add(o.type):o!==""&&i.add(o);return i.size+s.size})}}L2.implementedFunctions={COUNTUNIQUE:{method:"countunique",parameters:[{argumentType:m.SCALAR}],repeatLastArgs:1,expandRanges:!0}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class H2 extends et{constructor(){super(...arguments),this.isoweeknumCore=e=>{const t=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(e)),r=this.dateTimeHelper.numberToSimpleDate(e),i=this.dateTimeHelper.dateToNumber({year:r.year,month:1,day:1}),s=this.dateTimeHelper.relativeNumberToAbsoluteNumber(i),o=s+((4-s)%7+7)%7,a=Math.floor((t-1)/7)-Math.floor((o-1)/7)+1;return a===0?this.isoweeknumCore(e-7)+1:a},this.days360Core=(e,t,r)=>{const i=this.dateTimeHelper.numberToSimpleDate(e),s=this.dateTimeHelper.numberToSimpleDate(t);let o,a;return r?(o=_F(i),a=_F(s)):[o,a]=this.dateTimeHelper.toBasisUS(i,s),360*(a.year-o.year)+30*(a.month-o.month)+a.day-o.day}}date(e,t){return this.runFunction(e.args,t,this.metadata("DATE"),(r,i,s)=>{const o=Math.trunc(s);let a=Math.trunc(i),l=Math.trunc(r);l<this.dateTimeHelper.getEpochYearZero()&&(l+=this.dateTimeHelper.getEpochYearZero());const u=Math.floor((a-1)/12);l+=u,a-=u*12;const h={year:l,month:a,day:1};if(this.dateTimeHelper.isValidDate(h)){let c=this.dateTimeHelper.dateToNumber(h)+(o-1);return c=this.dateTimeHelper.getWithinBounds(c),c===void 0?new E(N.NUM,_.DateBounds):c}return new E(N.VALUE,_.InvalidDate)})}time(e,t){return this.runFunction(e.args,t,this.metadata("TIME"),(r,i,s)=>{const o=pd({hours:Math.trunc(r),minutes:Math.trunc(i),seconds:Math.trunc(s)});return o<0?new E(N.NUM,_.NegativeTime):o%1})}eomonth(e,t){return this.runFunction(e.args,t,this.metadata("EOMONTH"),(r,i)=>{const s=this.dateTimeHelper.numberToSimpleDate(r);let o=this.dateTimeHelper.dateToNumber(this.dateTimeHelper.endOfMonth(OF(s,i)));return o=this.dateTimeHelper.getWithinBounds(o),o===void 0?new E(N.NUM,_.DateBounds):o})}day(e,t){return this.runFunction(e.args,t,this.metadata("DAY"),r=>this.dateTimeHelper.numberToSimpleDate(r).day)}days(e,t){return this.runFunction(e.args,t,this.metadata("DAYS"),(r,i)=>Math.trunc(r)-Math.trunc(i))}month(e,t){return this.runFunction(e.args,t,this.metadata("MONTH"),r=>this.dateTimeHelper.numberToSimpleDate(r).month)}year(e,t){return this.runFunction(e.args,t,this.metadata("YEAR"),r=>this.dateTimeHelper.numberToSimpleDate(r).year)}hour(e,t){return this.runFunction(e.args,t,this.metadata("HOUR"),r=>gd(sA(r)%1).hours)}minute(e,t){return this.runFunction(e.args,t,this.metadata("MINUTE"),r=>gd(sA(r)%1).minutes)}second(e,t){return this.runFunction(e.args,t,this.metadata("SECOND"),r=>gd(sA(r)%1).seconds)}text(e,t){return this.runFunction(e.args,t,this.metadata("TEXT"),(r,i)=>Twe(r,i,this.config,this.dateTimeHelper))}weekday(e,t){return this.runFunction(e.args,t,this.metadata("WEEKDAY"),(r,i)=>{const s=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(r));if(i===3)return(s-1)%7;const o=YF.get(i);return o===void 0?new E(N.NUM,_.BadMode):(s-o)%7+1})}weeknum(e,t){return this.runFunction(e.args,t,this.metadata("WEEKNUM"),(r,i)=>{const s=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(r)),o=this.dateTimeHelper.numberToSimpleDate(r),a=this.dateTimeHelper.dateToNumber({year:o.year,month:1,day:1}),l=this.dateTimeHelper.relativeNumberToAbsoluteNumber(a);if(i===21)return this.isoweeknumCore(r);const u=YF.get(i);return u===void 0?new E(N.NUM,_.BadMode):Math.floor((s-u)/7)-Math.floor((l-u)/7)+1})}isoweeknum(e,t){return this.runFunction(e.args,t,this.metadata("ISOWEEKNUM"),this.isoweeknumCore)}datevalue(e,t){return this.runFunction(e.args,t,this.metadata("DATEVALUE"),r=>{const{dateTime:i}=this.dateTimeHelper.parseDateTimeFromConfigFormats(r);return i===void 0?new E(N.VALUE,_.IncorrectDateTime):Dm(i)?(l2(i)?Math.trunc(pd(i)):0)+this.dateTimeHelper.dateToNumber(i):0})}timevalue(e,t){return this.runFunction(e.args,t,this.metadata("TIMEVALUE"),r=>{const i=this.dateTimeHelper.dateStringToDateNumber(r);return i===void 0?new E(N.VALUE,_.IncorrectDateTime):me(i)%1})}now(e,t){return this.runFunction(e.args,t,this.metadata("NOW"),()=>{const r=new Date(Date.now());return pd({hours:r.getHours(),minutes:r.getMinutes(),seconds:r.getSeconds()})+this.dateTimeHelper.dateToNumber({year:r.getFullYear(),month:r.getMonth()+1,day:r.getDate()})})}today(e,t){return this.runFunction(e.args,t,this.metadata("TODAY"),()=>{const r=new Date(Date.now());return this.dateTimeHelper.dateToNumber({year:r.getFullYear(),month:r.getMonth()+1,day:r.getDate()})})}edate(e,t){return this.runFunction(e.args,t,this.metadata("EDATE"),(r,i)=>{const s=this.dateTimeHelper.numberToSimpleDate(r),o=ywe(OF(s,i));let a=this.dateTimeHelper.dateToNumber(o);return a=this.dateTimeHelper.getWithinBounds(a),a===void 0?new E(N.NUM,_.DateBounds):a})}datedif(e,t){return this.runFunction(e.args,t,this.metadata("DATEDIF"),(r,i,s)=>{if(r>i)return new E(N.NUM,_.StartEndDate);if(s==="D")return Math.floor(i)-Math.floor(r);const o=this.dateTimeHelper.numberToSimpleDate(r),a=this.dateTimeHelper.numberToSimpleDate(i);switch(s){case"M":return(a.year-o.year)*12+(a.month-o.month)-(a.day<o.day?1:0);case"YM":return(12+(a.month-o.month)-(a.day<o.day?1:0))%12;case"Y":return a.month>o.month||a.month===o.month&&a.day>=o.day?a.year-o.year:a.year-o.year-1;case"MD":if(a.day>=o.day)return a.day-o.day;{const l=a.month===1?12:a.month-1,u=a.month===1?a.year-1:a.year;return this.dateTimeHelper.daysInMonth(u,l)+a.day-o.day}case"YD":return a.month>o.month||a.month===o.month&&a.day>=o.day?Math.floor(i)-this.dateTimeHelper.dateToNumber({year:a.year,month:o.month,day:o.day}):Math.floor(i)-Math.floor(r)-365*(a.year-o.year-1)-this.dateTimeHelper.leapYearsCount(a.year-1)+this.dateTimeHelper.leapYearsCount(o.year);default:return new E(N.NUM,_.BadMode)}})}days360(e,t){return this.runFunction(e.args,t,this.metadata("DAYS360"),this.days360Core)}yearfrac(e,t){return this.runFunction(e.args,t,this.metadata("YEARFRAC"),(r,i,s)=>{switch(r=Math.trunc(r),i=Math.trunc(i),r>i&&([r,i]=[i,r]),s){case 0:return this.days360Core(r,i,!1)/360;case 1:return(i-r)/this.dateTimeHelper.yearLengthForBasis(this.dateTimeHelper.numberToSimpleDate(r),this.dateTimeHelper.numberToSimpleDate(i));case 2:return(i-r)/360;case 3:return(i-r)/365;case 4:return this.days360Core(r,i,!0)/360}throw new Error("Should not be reachable.")})}interval(e,t){return this.runFunction(e.args,t,this.metadata("INTERVAL"),r=>{r=Math.trunc(r);const i=r%60;r=Math.trunc(r/60);const s=r%60;r=Math.trunc(r/60);const o=r%24;r=Math.trunc(r/24);const a=r%30;r=Math.trunc(r/30);const l=r%12,u=Math.trunc(r/12);return"P"+(u>0?`${u}Y`:"")+(l>0?`${l}M`:"")+(a>0?`${a}D`:"")+"T"+(o>0?`${o}H`:"")+(s>0?`${s}M`:"")+(i>0?`${i}S`:"")})}networkdays(e,t){return this.runFunction(e.args,t,this.metadata("NETWORKDAYS"),(r,i,s)=>this.networkdayscore(r,i,1,s))}networkdaysintl(e,t){return this.runFunction(e.args,t,this.metadata("NETWORKDAYS.INTL"),(r,i,s,o)=>this.networkdayscore(r,i,s,o))}workday(e,t){return this.runFunction(e.args,t,this.metadata("WORKDAY"),(r,i,s)=>this.workdaycore(r,i,1,s))}workdayintl(e,t){return this.runFunction(e.args,t,this.metadata("WORKDAY.INTL"),(r,i,s,o)=>this.workdaycore(r,i,s,o))}networkdayscore(e,t,r,i){e=Math.trunc(e),t=Math.trunc(t);let s=1;e>t&&([e,t]=[t,e],s=-1);const o=zF(r);if(o instanceof E)return o;const a=this.simpleRangeToFilteredHolidays(o,i);return a instanceof E?a:s*this.countWorkdays(e,t,o,a)}workdaycore(e,t,r,i){e=Math.trunc(e),t=Math.trunc(t);const s=zF(r);if(s instanceof E)return s;const o=this.simpleRangeToFilteredHolidays(s,i);if(o instanceof E)return o;if(t>0){let a=1;for(;this.countWorkdays(e+1,e+a,s,o)<t;)a*=2;let l=1;for(;l+1<a;){const u=Math.trunc((l+a)/2);this.countWorkdays(e+1,e+u,s,o)<t?l=u:a=u}return e+a}else if(t<0){t*=-1;let a=1;for(;this.countWorkdays(e-a,e-1,s,o)<t;)a*=2;let l=1;for(;l+1<a;){const u=Math.trunc((l+a)/2);this.countWorkdays(e-u,e-1,s,o)<t?l=u:a=u}return e-a}else return e}countWorkdays(e,t,r,i){const s=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(t)),o=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(e));let a=0;for(let l=0;l<7;l++)r.charAt(l)==="0"&&(a+=Math.floor((s+6-l)/7),a-=Math.floor((o-1+6-l)/7));return a-=jF(t+1,i)-jF(e,i),a}simpleRangeToFilteredHolidays(e,t){var r;const i=(r=t?.valuesFromTopLeftCorner())!==null&&r!==void 0?r:[];for(const o of i)if(o instanceof E)return o;const s=[];for(const o of i)if(o!==ht)if(It(o))s.push(Math.trunc(me(o)));else return new E(N.VALUE,_.WrongType);return[...new Set(s)].sort((o,a)=>o-a).filter(o=>{const l=(this.dateTimeHelper.relativeNumberToAbsoluteNumber(o)-1)%7;return e.charAt(l)==="0"})}}H2.implementedFunctions={DATE:{method:"date",parameters:[{argumentType:m.NUMBER},{argumentType:m.NUMBER},{argumentType:m.NUMBER}],returnNumberType:Te.NUMBER_DATE},TIME:{method:"time",parameters:[{argumentType:m.NUMBER},{argumentType:m.NUMBER},{argumentType:m.NUMBER}],returnNumberType:Te.NUMBER_TIME},MONTH:{method:"month",parameters:[{argumentType:m.NUMBER,minValue:0}]},YEAR:{method:"year",parameters:[{argumentType:m.NUMBER,minValue:0}]},HOUR:{method:"hour",parameters:[{argumentType:m.NUMBER,minValue:0}]},MINUTE:{method:"minute",parameters:[{argumentType:m.NUMBER,minValue:0}]},SECOND:{method:"second",parameters:[{argumentType:m.NUMBER,minValue:0}]},TEXT:{method:"text",parameters:[{argumentType:m.NUMBER},{argumentType:m.STRING}]},EOMONTH:{method:"eomonth",parameters:[{argumentType:m.NUMBER,minValue:0},{argumentType:m.NUMBER}],returnNumberType:Te.NUMBER_DATE},DAY:{method:"day",parameters:[{argumentType:m.NUMBER,minValue:0}]},DAYS:{method:"days",parameters:[{argumentType:m.NUMBER,minValue:0},{argumentType:m.NUMBER,minValue:0}]},WEEKDAY:{method:"weekday",parameters:[{argumentType:m.NUMBER,minValue:0},{argumentType:m.NUMBER,defaultValue:1}]},WEEKNUM:{method:"weeknum",parameters:[{argumentType:m.NUMBER,minValue:0},{argumentType:m.NUMBER,defaultValue:1}]},ISOWEEKNUM:{method:"isoweeknum",parameters:[{argumentType:m.NUMBER,minValue:0}]},DATEVALUE:{method:"datevalue",parameters:[{argumentType:m.STRING}],returnNumberType:Te.NUMBER_DATE},TIMEVALUE:{method:"timevalue",parameters:[{argumentType:m.STRING}],returnNumberType:Te.NUMBER_TIME},NOW:{method:"now",parameters:[],isVolatile:!0,returnNumberType:Te.NUMBER_DATETIME},TODAY:{method:"today",parameters:[],isVolatile:!0,returnNumberType:Te.NUMBER_DATE},EDATE:{method:"edate",parameters:[{argumentType:m.NUMBER,minValue:0},{argumentType:m.NUMBER}],returnNumberType:Te.NUMBER_DATE},DAYS360:{method:"days360",parameters:[{argumentType:m.NUMBER,minValue:0},{argumentType:m.NUMBER,minValue:0},{argumentType:m.BOOLEAN,defaultValue:!1}]},DATEDIF:{method:"datedif",parameters:[{argumentType:m.NUMBER,minValue:0},{argumentType:m.NUMBER,minValue:0},{argumentType:m.STRING}]},YEARFRAC:{method:"yearfrac",parameters:[{argumentType:m.NUMBER,minValue:0},{argumentType:m.NUMBER,minValue:0},{argumentType:m.INTEGER,defaultValue:0,minValue:0,maxValue:4}]},INTERVAL:{method:"interval",parameters:[{argumentType:m.NUMBER,minValue:0}]},NETWORKDAYS:{method:"networkdays",parameters:[{argumentType:m.NUMBER,minValue:0},{argumentType:m.NUMBER,minValue:0},{argumentType:m.RANGE,optionalArg:!0}]},"NETWORKDAYS.INTL":{method:"networkdaysintl",parameters:[{argumentType:m.NUMBER,minValue:0},{argumentType:m.NUMBER,minValue:0},{argumentType:m.NOERROR,defaultValue:1},{argumentType:m.RANGE,optionalArg:!0}]},WORKDAY:{method:"workday",parameters:[{argumentType:m.NUMBER,minValue:0},{argumentType:m.NUMBER},{argumentType:m.RANGE,optionalArg:!0}]},"WORKDAY.INTL":{method:"workdayintl",parameters:[{argumentType:m.NUMBER,minValue:0},{argumentType:m.NUMBER},{argumentType:m.NOERROR,defaultValue:1},{argumentType:m.RANGE,optionalArg:!0}]}};function jF(n,e){if(e.length===0||n<=e[0])return 0;if(e[e.length-1]<n)return e.length;let t=0,r=e.length-1;for(;t+1<r;){const i=Math.floor((r+t)/2);e[i]>=n?r=i:t=i}return r}function zF(n){var e;return typeof n!="number"&&typeof n!="string"?new E(N.VALUE,_.WrongType):typeof n=="string"?n.length!==7||!/^(0|1)*$/.test(n)||n==="1111111"?new E(N.NUM,_.WeekendString):n:(e=Uve.get(n))!==null&&e!==void 0?e:new E(N.NUM,_.BadMode)}const YF=new Map([[1,0],[2,1],[11,1],[12,2],[13,3],[14,4],[15,5],[16,6],[17,0]]),Uve=new Map([[1,"0000011"],[2,"1000001"],[3,"1100000"],[4,"0110000"],[5,"0011000"],[6,"0001100"],[7,"0000110"],[11,"0000001"],[12,"1000000"],[13,"0100000"],[14,"0010000"],[15,"0001000"],[16,"0000100"],[17,"0000010"]]);/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class D2 extends et{degrees(e,t){return this.runFunction(e.args,t,this.metadata("DEGREES"),r=>r*(180/Math.PI))}}D2.implementedFunctions={DEGREES:{method:"degrees",parameters:[{argumentType:m.NUMBER}]}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class F2 extends et{delta(e,t){return this.runFunction(e.args,t,this.metadata("DELTA"),(r,i)=>r===i?1:0)}}F2.implementedFunctions={DELTA:{method:"delta",parameters:[{argumentType:m.NUMBER},{argumentType:m.NUMBER,defaultValue:0}]}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class k2 extends et{exp(e,t){return this.runFunction(e.args,t,this.metadata("EXP"),Math.exp)}}k2.implementedFunctions={EXP:{method:"exp",parameters:[{argumentType:m.NUMBER}]}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class V2 extends et{pmt(e,t){return this.runFunction(e.args,t,this.metadata("PMT"),o_)}ipmt(e,t){return this.runFunction(e.args,t,this.metadata("IPMT"),GN)}ppmt(e,t){return this.runFunction(e.args,t,this.metadata("PPMT"),KF)}fv(e,t){return this.runFunction(e.args,t,this.metadata("FV"),jN)}cumipmt(e,t){return this.runFunction(e.args,t,this.metadata("CUMIPMT"),(r,i,s,o,a,l)=>{if(o>a)return new E(N.NUM,_.EndStartPeriod);let u=0;for(let h=o;h<=a;h++)u+=GN(r,h,i,s,0,l);return u})}cumprinc(e,t){return this.runFunction(e.args,t,this.metadata("CUMPRINC"),(r,i,s,o,a,l)=>{if(o>a)return new E(N.NUM,_.EndStartPeriod);let u=0;for(let h=o;h<=a;h++)u+=KF(r,h,i,s,0,l);return u})}db(e,t){return this.runFunction(e.args,t,this.metadata("DB"),(r,i,s,o,a)=>{if(a===12&&o>s||o>s+1)return new E(N.NUM,_.PeriodLong);if(i>=r)return 0;const l=Math.round((1-Math.pow(i/r,1/s))*1e3)/1e3,u=r*l*a/12;if(o===1)return u;let h=u;for(let c=0;c<o-2;c++)h+=(r-h)*l;return o===s+1?(r-h)*l*(12-a)/12:(r-h)*l})}ddb(e,t){return this.runFunction(e.args,t,this.metadata("DDB"),(r,i,s,o,a)=>{if(o>s)return new E(N.NUM);let l=a/s,u;l>=1?(l=1,o===1?u=r:u=0):u=r*Math.pow(1-l,o-1);const h=r*Math.pow(1-l,o);return Math.max(u-Math.max(i,h),0)})}dollarde(e,t){return this.runFunction(e.args,t,this.metadata("DOLLARDE"),(r,i)=>{if(i<1)return new E(N.DIV_BY_ZERO);for(i=Math.trunc(i);i>10;)i/=10;return Math.trunc(r)+(r-Math.trunc(r))*10/i})}dollarfr(e,t){return this.runFunction(e.args,t,this.metadata("DOLLARFR"),(r,i)=>{if(i<1)return new E(N.DIV_BY_ZERO);for(i=Math.trunc(i);i>10;)i/=10;return Math.trunc(r)+(r-Math.trunc(r))*i/10})}effect(e,t){return this.runFunction(e.args,t,this.metadata("EFFECT"),(r,i)=>(i=Math.trunc(i),Math.pow(1+r/i,i)-1))}ispmt(e,t){return this.runFunction(e.args,t,this.metadata("ISPMT"),(r,i,s,o)=>s===0?new E(N.DIV_BY_ZERO):o*r*(i/s-1))}nominal(e,t){return this.runFunction(e.args,t,this.metadata("NOMINAL"),(r,i)=>(i=Math.trunc(i),(Math.pow(r+1,1/i)-1)*i))}nper(e,t){return this.runFunction(e.args,t,this.metadata("NPER"),(r,i,s,o,a)=>r===0?i===0?new E(N.DIV_BY_ZERO):(-s-o)/i:(a&&(i*=1+r),Math.log((i-o*r)/(s*r+i))/Math.log(1+r)))}rate(e,t){return this.runFunction(e.args,t,this.metadata("RATE"),(r,i,s,o,a,l)=>{if(l<=-1)return new E(N.VALUE);const u=1e-7,h=50;let c=l;a=a?1:0;for(let d=0;d<h;d++){if(c<=-1)return new E(N.NUM);let f;if(Math.abs(c)<u)f=s*(1+r*c)+i*(1+c*a)*r+o;else{const p=Math.pow(1+c,r);f=s*p+i*(1/c+a)*(p-1)+o}if(Math.abs(f)<u)return c;let g;if(Math.abs(c)<u)g=s*r+i*a*r;else{const p=Math.pow(1+c,r),v=r*Math.pow(1+c,r-1);g=s*v+i*(1/c+a)*v+i*(-1/(c*c))*(p-1)}c-=f/g}return new E(N.NUM)})}pv(e,t){return this.runFunction(e.args,t,this.metadata("PV"),(r,i,s,o,a)=>(a=a?1:0,r===-1?i===0?new E(N.NUM):new E(N.DIV_BY_ZERO):r===0?-s*i-o:((1-Math.pow(1+r,i))*s*(1+r*a)/r-o)/Math.pow(1+r,i)))}rri(e,t){return this.runFunction(e.args,t,this.metadata("RRI"),(r,i,s)=>i===0||s<0&&i>0||s>0&&i<0?new E(N.NUM):Math.pow(s/i,1/r)-1)}sln(e,t){return this.runFunction(e.args,t,this.metadata("SLN"),(r,i,s)=>s===0?new E(N.DIV_BY_ZERO):(r-i)/s)}syd(e,t){return this.runFunction(e.args,t,this.metadata("SYD"),(r,i,s,o)=>o>s?new E(N.NUM):(r-i)*(s-o+1)*2/(s*(s+1)))}tbilleq(e,t){return this.runFunction(e.args,t,this.metadata("TBILLEQ"),(r,i,s)=>{if(r=Math.round(r),i=Math.round(i),r>=i)return new E(N.NUM);const o=this.dateTimeHelper.numberToSimpleDate(r),a=this.dateTimeHelper.numberToSimpleDate(i);if(a.year>o.year+1||a.year===o.year+1&&(a.month>o.month||a.month===o.month&&a.day>o.day))return new E(N.NUM);const l=360-s*(i-r);return l===0?0:l<0?new E(N.NUM):365*s/l})}tbillprice(e,t){return this.runFunction(e.args,t,this.metadata("TBILLPRICE"),(r,i,s)=>{if(r=Math.round(r),i=Math.round(i),r>=i)return new E(N.NUM);const o=this.dateTimeHelper.numberToSimpleDate(r),a=this.dateTimeHelper.numberToSimpleDate(i);if(a.year>o.year+1||a.year===o.year+1&&(a.month>o.month||a.month===o.month&&a.day>o.day))return new E(N.NUM);const l=360-s*(i-r);return l===0?0:l<0?new E(N.NUM):100*(1-s*(i-r)/360)})}tbillyield(e,t){return this.runFunction(e.args,t,this.metadata("TBILLYIELD"),(r,i,s)=>{if(r=Math.round(r),i=Math.round(i),r>=i)return new E(N.NUM);const o=this.dateTimeHelper.numberToSimpleDate(r),a=this.dateTimeHelper.numberToSimpleDate(i);return a.year>o.year+1||a.year===o.year+1&&(a.month>o.month||a.month===o.month&&a.day>o.day)?new E(N.NUM):(100-s)*360/(s*(i-r))})}fvschedule(e,t){return this.runFunction(e.args,t,this.metadata("FVSCHEDULE"),(r,i)=>{const s=i.valuesFromTopLeftCorner();for(const o of s)if(o instanceof E)return o;for(const o of s)if(It(o))r*=1+me(o);else if(o!==ht)return new E(N.VALUE,_.NumberExpected);return r})}npv(e,t){return this.runFunction(e.args,t,this.metadata("NPV"),(r,...i)=>{const s=this.arithmeticHelper.coerceNumbersExactRanges(i);return s instanceof E?s:lA(r,s)})}mirr(e,t){return this.runFunction(e.args,t,this.metadata("MIRR"),(r,i,s)=>{const o=this.arithmeticHelper.manyToExactNumbers(r.valuesFromTopLeftCorner());if(o instanceof E)return o;let a=!1,l=!1;const u=[],h=[];for(const g of o)g>0?(a=!0,u.push(g),h.push(0)):g<0?(l=!0,h.push(g),u.push(0)):(h.push(0),u.push(0));if(!a||!l)return new E(N.DIV_BY_ZERO);const c=o.length,d=lA(s,u);if(d instanceof E)return d;const f=lA(i,h);return f instanceof E?f:Math.pow(-d*Math.pow(1+s,c)/f/(1+i),1/(c-1))-1})}pduration(e,t){return this.runFunction(e.args,t,this.metadata("PDURATION"),(r,i,s)=>(Math.log(s)-Math.log(i))/Math.log(1+r))}xnpv(e,t){return this.runFunction(e.args,t,this.metadata("XNPV"),(r,i,s)=>{const o=i.valuesFromTopLeftCorner();for(const d of o)if(typeof d!="number")return new E(N.VALUE,_.NumberExpected);const a=o,l=s.valuesFromTopLeftCorner();for(const d of l)if(typeof d!="number")return new E(N.VALUE,_.NumberExpected);const u=l;if(u.length!==a.length)return new E(N.NUM,_.EqualLength);const h=u.length;let c=0;if(u[0]<0)return new E(N.NUM,_.ValueSmall);for(let d=0;d<h;d++){if(u[d]=Math.floor(u[d]),u[d]<u[0])return new E(N.NUM,_.ValueSmall);c+=a[d]/Math.pow(1+r,(u[d]-u[0])/365)}return c})}}V2.implementedFunctions={PMT:{method:"pmt",parameters:[{argumentType:m.NUMBER},{argumentType:m.NUMBER},{argumentType:m.NUMBER},{argumentType:m.NUMBER,defaultValue:0},{argumentType:m.NUMBER,defaultValue:0}],returnNumberType:Te.NUMBER_CURRENCY},IPMT:{method:"ipmt",parameters:[{argumentType:m.NUMBER},{argumentType:m.NUMBER},{argumentType:m.NUMBER},{argumentType:m.NUMBER},{argumentType:m.NUMBER,defaultValue:0},{argumentType:m.NUMBER,defaultValue:0}],returnNumberType:Te.NUMBER_CURRENCY},PPMT:{method:"ppmt",parameters:[{argumentType:m.NUMBER},{argumentType:m.NUMBER},{argumentType:m.NUMBER},{argumentType:m.NUMBER},{argumentType:m.NUMBER,defaultValue:0},{argumentType:m.NUMBER,defaultValue:0}],returnNumberType:Te.NUMBER_CURRENCY},FV:{method:"fv",parameters:[{argumentType:m.NUMBER},{argumentType:m.NUMBER},{argumentType:m.NUMBER},{argumentType:m.NUMBER,defaultValue:0},{argumentType:m.NUMBER,defaultValue:0}],returnNumberType:Te.NUMBER_CURRENCY},CUMIPMT:{method:"cumipmt",parameters:[{argumentType:m.NUMBER,greaterThan:0},{argumentType:m.NUMBER,greaterThan:0},{argumentType:m.NUMBER,greaterThan:0},{argumentType:m.INTEGER,minValue:1},{argumentType:m.INTEGER,minValue:1},{argumentType:m.INTEGER,minValue:0,maxValue:1}],returnNumberType:Te.NUMBER_CURRENCY},CUMPRINC:{method:"cumprinc",parameters:[{argumentType:m.NUMBER,greaterThan:0},{argumentType:m.NUMBER,greaterThan:0},{argumentType:m.NUMBER,greaterThan:0},{argumentType:m.INTEGER,minValue:1},{argumentType:m.INTEGER,minValue:1},{argumentType:m.INTEGER,minValue:0,maxValue:1}],returnNumberType:Te.NUMBER_CURRENCY},DB:{method:"db",parameters:[{argumentType:m.NUMBER,minValue:0},{argumentType:m.NUMBER,minValue:0},{argumentType:m.INTEGER,minValue:0},{argumentType:m.INTEGER,minValue:0},{argumentType:m.INTEGER,minValue:1,maxValue:12,defaultValue:12}],returnNumberType:Te.NUMBER_CURRENCY},DDB:{method:"ddb",parameters:[{argumentType:m.NUMBER,minValue:0},{argumentType:m.NUMBER,minValue:0},{argumentType:m.INTEGER,minValue:0},{argumentType:m.NUMBER,minValue:0},{argumentType:m.NUMBER,greaterThan:0,defaultValue:2}],returnNumberType:Te.NUMBER_CURRENCY},DOLLARDE:{method:"dollarde",parameters:[{argumentType:m.NUMBER},{argumentType:m.NUMBER,minValue:0}]},DOLLARFR:{method:"dollarfr",parameters:[{argumentType:m.NUMBER},{argumentType:m.NUMBER,minValue:0}]},EFFECT:{method:"effect",parameters:[{argumentType:m.NUMBER,minValue:0},{argumentType:m.NUMBER,minValue:1}],returnNumberType:Te.NUMBER_PERCENT},ISPMT:{method:"ispmt",parameters:[{argumentType:m.NUMBER},{argumentType:m.NUMBER},{argumentType:m.NUMBER},{argumentType:m.NUMBER}]},NOMINAL:{method:"nominal",parameters:[{argumentType:m.NUMBER,minValue:0},{argumentType:m.NUMBER,minValue:1}],returnNumberType:Te.NUMBER_PERCENT},NPER:{method:"nper",parameters:[{argumentType:m.NUMBER},{argumentType:m.NUMBER},{argumentType:m.NUMBER},{argumentType:m.NUMBER,defaultValue:0},{argumentType:m.NUMBER,defaultValue:0}]},PV:{method:"pv",parameters:[{argumentType:m.NUMBER},{argumentType:m.NUMBER},{argumentType:m.NUMBER},{argumentType:m.NUMBER,defaultValue:0},{argumentType:m.NUMBER,defaultValue:0}],returnNumberType:Te.NUMBER_CURRENCY},RATE:{method:"rate",parameters:[{argumentType:m.NUMBER,greaterThan:0},{argumentType:m.NUMBER},{argumentType:m.NUMBER},{argumentType:m.NUMBER,defaultValue:0},{argumentType:m.NUMBER,defaultValue:0},{argumentType:m.NUMBER,defaultValue:.1}],returnNumberType:Te.NUMBER_PERCENT},RRI:{method:"rri",parameters:[{argumentType:m.NUMBER,greaterThan:0},{argumentType:m.NUMBER},{argumentType:m.NUMBER}],returnNumberType:Te.NUMBER_PERCENT},SLN:{method:"sln",parameters:[{argumentType:m.NUMBER},{argumentType:m.NUMBER},{argumentType:m.NUMBER}],returnNumberType:Te.NUMBER_CURRENCY},SYD:{method:"syd",parameters:[{argumentType:m.NUMBER},{argumentType:m.NUMBER},{argumentType:m.NUMBER,greaterThan:0},{argumentType:m.NUMBER,greaterThan:0}],returnNumberType:Te.NUMBER_CURRENCY},TBILLEQ:{method:"tbilleq",parameters:[{argumentType:m.NUMBER,minValue:0},{argumentType:m.NUMBER,minValue:0},{argumentType:m.NUMBER,greaterThan:0}],returnNumberType:Te.NUMBER_PERCENT},TBILLPRICE:{method:"tbillprice",parameters:[{argumentType:m.NUMBER,minValue:0},{argumentType:m.NUMBER,minValue:0},{argumentType:m.NUMBER,greaterThan:0}],returnNumberType:Te.NUMBER_CURRENCY},TBILLYIELD:{method:"tbillyield",parameters:[{argumentType:m.NUMBER,minValue:0},{argumentType:m.NUMBER,minValue:0},{argumentType:m.NUMBER,greaterThan:0}],returnNumberType:Te.NUMBER_PERCENT},FVSCHEDULE:{method:"fvschedule",parameters:[{argumentType:m.NUMBER},{argumentType:m.RANGE}],returnNumberType:Te.NUMBER_CURRENCY},NPV:{method:"npv",parameters:[{argumentType:m.NUMBER},{argumentType:m.ANY}],repeatLastArgs:1,returnNumberType:Te.NUMBER_CURRENCY},MIRR:{method:"mirr",parameters:[{argumentType:m.RANGE},{argumentType:m.NUMBER},{argumentType:m.NUMBER}],returnNumberType:Te.NUMBER_PERCENT},PDURATION:{method:"pduration",parameters:[{argumentType:m.NUMBER,greaterThan:0},{argumentType:m.NUMBER,greaterThan:0},{argumentType:m.NUMBER,greaterThan:0}]},XNPV:{method:"xnpv",parameters:[{argumentType:m.NUMBER,greaterThan:-1},{argumentType:m.RANGE},{argumentType:m.RANGE}]}};function o_(n,e,t,r,i){if(n===0)return(-t-r)/e;{const s=Math.pow(1+n,e);return(r*n+t*n*s)*(i?1/(1+n):1)/(1-s)}}function GN(n,e,t,r,i,s){const o=o_(n,t,r,i,s);return e===1?n*(s?0:-r):n*(s?jN(n,e-2,o,r,s)-o:jN(n,e-1,o,r,s))}function jN(n,e,t,r,i){if(n===0)return-r-t*e;{const s=Math.pow(1+n,e);return t*(i?1+n:1)*(1-s)/n-r*s}}function KF(n,e,t,r,i,s){return o_(n,t,r,i,s)-GN(n,e,t,r,i,s)}function lA(n,e){let t=0;for(let r=e.length-1;r>=0;r--){if(t+=e[r],n===-1){if(t===0)continue;return new E(N.DIV_BY_ZERO)}t/=1+n}return t}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class U2 extends et{formulatext(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("FORMULATEXT"),()=>new E(N.NA,_.WrongArgNumber),r=>{var i;return(i=this.serialization.getCellFormula(r))!==null&&i!==void 0?i:new E(N.NA,_.Formula)})}}U2.implementedFunctions={FORMULATEXT:{method:"formulatext",parameters:[{argumentType:m.NOERROR}],doesNotNeedArgumentsToBeComputed:!0,isDependentOnSheetStructureChange:!0,vectorizationForbidden:!0}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class B2 extends et{hyperlink(e,t){return this.runFunction(e.args,t,this.metadata("HYPERLINK"),(r,i)=>(e.hyperlink=r,i??r))}}B2.implementedFunctions={HYPERLINK:{method:"hyperlink",parameters:[{argumentType:m.STRING},{argumentType:m.STRING,optionalArg:!0}]}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class W2 extends et{isbinary(e,t){return this.runFunction(e.args,t,this.metadata("ISBINARY"),r=>/^[01]{1,10}$/.test(r))}iserr(e,t){return this.runFunction(e.args,t,this.metadata("ISERR"),r=>r instanceof E&&r.type!==N.NA)}iserror(e,t){return this.runFunction(e.args,t,this.metadata("ISERROR"),r=>r instanceof E)}isformula(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("ISFORMULA"),()=>new E(N.NA,_.WrongArgNumber),r=>this.dependencyGraph.addressMapping.getCell(r)instanceof Bi)}isblank(e,t){return this.runFunction(e.args,t,this.metadata("ISBLANK"),r=>r===ht)}isna(e,t){return this.runFunction(e.args,t,this.metadata("ISNA"),r=>r instanceof E&&r.type==N.NA)}isnumber(e,t){return this.runFunction(e.args,t,this.metadata("ISNUMBER"),It)}islogical(e,t){return this.runFunction(e.args,t,this.metadata("ISLOGICAL"),r=>typeof r=="boolean")}isref(e,t){return this.runFunction(e.args,t,this.metadata("ISREF"),r=>r instanceof E&&(r.type==N.REF||r.type==N.CYCLE))}istext(e,t){return this.runFunction(e.args,t,this.metadata("ISTEXT"),r=>typeof r=="string")}isnontext(e,t){return this.runFunction(e.args,t,this.metadata("ISNONTEXT"),r=>typeof r!="string")}column(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("COLUMN"),()=>t.formulaAddress.col+1,r=>r.col+1)}columns(e,t){if(e.args.length!==1)return new E(N.NA,_.WrongArgNumber);if(e.args.some(i=>i.type===M.EMPTY))return new E(N.NUM,_.EmptyArg);let r=e.args[0];for(;r.type===M.PARENTHESIS;)r=r.expression;if(r.type===M.CELL_RANGE||r.type===M.COLUMN_RANGE)return r.end.col-r.start.col+1;if(r.type===M.CELL_REFERENCE)return 1;if(r.type===M.ROW_RANGE)return this.config.maxColumns;{const i=this.evaluateAst(r,t);return i instanceof Ae?i.width():i instanceof E?i:1}}row(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("ROW"),()=>t.formulaAddress.row+1,r=>r.row+1)}rows(e,t){if(e.args.length!==1)return new E(N.NA,_.WrongArgNumber);if(e.args.some(i=>i.type===M.EMPTY))return new E(N.NUM,_.EmptyArg);let r=e.args[0];for(;r.type===M.PARENTHESIS;)r=r.expression;if(r.type===M.CELL_RANGE||r.type===M.ROW_RANGE)return r.end.row-r.start.row+1;if(r.type===M.CELL_REFERENCE)return 1;if(r.type===M.COLUMN_RANGE)return this.config.maxRows;{const i=this.evaluateAst(r,t);return i instanceof Ae?i.height():i instanceof E?i:1}}index(e,t){return this.runFunction(e.args,t,this.metadata("INDEX"),(r,i,s)=>{var o,a,l,u,h,c;return s<1||i<1?new E(N.VALUE,_.LessThanOne):s>r.width()||i>r.height()?new E(N.NUM,_.ValueLarge):(c=(l=(a=(o=r?.data)===null||o===void 0?void 0:o[i-1])===null||a===void 0?void 0:a[s-1])!==null&&l!==void 0?l:(h=(u=r?.data)===null||u===void 0?void 0:u[0])===null||h===void 0?void 0:h[0])!==null&&c!==void 0?c:new E(N.VALUE,_.CellRangeExpected)})}na(e,t){return new E(N.NA)}sheet(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("SHEET"),()=>t.formulaAddress.sheet+1,r=>r.sheet+1,r=>{const i=this.dependencyGraph.sheetMapping.get(r);return i!==void 0?i+1:new E(N.NA,_.SheetRef)})}sheets(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("SHEETS"),()=>this.dependencyGraph.sheetMapping.numberOfSheets(),()=>1,()=>new E(N.VALUE,_.CellRefExpected))}}W2.implementedFunctions={COLUMN:{method:"column",parameters:[{argumentType:m.NOERROR,optionalArg:!0}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},COLUMNS:{method:"columns",parameters:[{argumentType:m.RANGE}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ISBINARY:{method:"isbinary",parameters:[{argumentType:m.STRING}]},ISERR:{method:"iserr",parameters:[{argumentType:m.SCALAR}]},ISFORMULA:{method:"isformula",parameters:[{argumentType:m.NOERROR}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ISNA:{method:"isna",parameters:[{argumentType:m.SCALAR}]},ISREF:{method:"isref",parameters:[{argumentType:m.SCALAR}],vectorizationForbidden:!0},ISERROR:{method:"iserror",parameters:[{argumentType:m.SCALAR}]},ISBLANK:{method:"isblank",parameters:[{argumentType:m.SCALAR}]},ISNUMBER:{method:"isnumber",parameters:[{argumentType:m.SCALAR}]},ISLOGICAL:{method:"islogical",parameters:[{argumentType:m.SCALAR}]},ISTEXT:{method:"istext",parameters:[{argumentType:m.SCALAR}]},ISNONTEXT:{method:"isnontext",parameters:[{argumentType:m.SCALAR}]},INDEX:{method:"index",parameters:[{argumentType:m.RANGE},{argumentType:m.NUMBER},{argumentType:m.NUMBER,defaultValue:1}]},NA:{method:"na",parameters:[]},ROW:{method:"row",parameters:[{argumentType:m.NOERROR,optionalArg:!0}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ROWS:{method:"rows",parameters:[{argumentType:m.RANGE}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},SHEET:{method:"sheet",parameters:[{argumentType:m.STRING}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},SHEETS:{method:"sheets",parameters:[{argumentType:m.STRING}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class $2 extends et{iseven(e,t){return this.runFunction(e.args,t,this.metadata("ISEVEN"),r=>r%2===0)}}$2.implementedFunctions={ISEVEN:{method:"iseven",parameters:[{argumentType:m.NUMBER}]}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class G2 extends et{isodd(e,t){return this.runFunction(e.args,t,this.metadata("ISODD"),r=>r%2===1)}}G2.implementedFunctions={ISODD:{method:"isodd",parameters:[{argumentType:m.NUMBER}]}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class j2 extends et{log10(e,t){return this.runFunction(e.args,t,this.metadata("LOG10"),Math.log10)}log(e,t){return this.runFunction(e.args,t,this.metadata("LOG"),(r,i)=>Math.log(r)/Math.log(i))}ln(e,t){return this.runFunction(e.args,t,this.metadata("LN"),Math.log)}}j2.implementedFunctions={LOG10:{method:"log10",parameters:[{argumentType:m.NUMBER}]},LOG:{method:"log",parameters:[{argumentType:m.NUMBER,greaterThan:0},{argumentType:m.NUMBER,defaultValue:10,greaterThan:0}]},LN:{method:"ln",parameters:[{argumentType:m.NUMBER}]}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const zN=parseFloat(Math.PI.toFixed(14));class z2 extends et{pi(e,t){return this.runFunction(e.args,t,this.metadata("PI"),()=>zN)}sqrtpi(e,t){return this.runFunction(e.args,t,this.metadata("SQRTPI"),r=>Math.sqrt(zN*r))}}z2.implementedFunctions={PI:{method:"pi",parameters:[]},SQRTPI:{method:"sqrtpi",parameters:[{argumentType:m.NUMBER,minValue:0}]}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */function qF(n,e){return new gt(e.width,n.height)}function uA(n,e,t){return new gt(1+(n.width-e)/t,1+(n.height-e)/t)}class Y2 extends et{mmult(e,t){return this.runFunction(e.args,t,this.metadata("MMULT"),(r,i)=>{if(!r.hasOnlyNumbers()||!i.hasOnlyNumbers())return new E(N.VALUE,_.NumberRange);if(i.height()!==r.width())return new E(N.VALUE,_.ArrayDimensions);const s=qF(r.size,i.size),o=this.createKernel(function(a,l,u){let h=0;for(let c=0;c<u;++c)h+=a[this.thread.y][c]*l[c][this.thread.x];return h},s)(r.rawNumbers(),i.rawNumbers(),r.width());return Ae.onlyNumbers(o)})}mmultArraySize(e,t){if(e.args.length!==2)return gt.error();const r=this.metadata("MMULT"),i=e.args.map(a=>{var l;return this.arraySizeForAst(a,new ta(t.formulaAddress,t.arraysFlag||((l=r?.arrayFunction)!==null&&l!==void 0?l:!1)))}),[s,o]=i;return qF(s,o)}maxpool(e,t){return this.runFunction(e.args,t,this.metadata("MAXPOOL"),(r,i,s=i)=>{if(!r.hasOnlyNumbers())return new E(N.VALUE,_.NumberRange);const o=uA(r.size,i,s),a=this.createKernel(function(l,u,h){const c=this.thread.x*h,d=this.thread.y*h;let f=l[d][c];for(let g=0;g<u;g++)for(let p=0;p<u;p++)f=Math.max(f,l[d+g][c+p]);return f},o)(r.rawNumbers(),i,s);return Ae.onlyNumbers(a)})}medianpool(e,t){return this.runFunction(e.args,t,this.metadata("MEDIANPOOL"),(r,i,s=i)=>{if(!r.hasOnlyNumbers())return new E(N.VALUE,_.NumberRange);const o=uA(r.size,i,s),a=this.createKernel(function(l,u,h){const c=this.thread.x*h,d=this.thread.y*h;let f=l[d][c];for(let R=0;R<u;R++)for(let A=0;A<u;A++)f=Math.max(f,l[d+R][c+A]);let g=l[d][c];for(let R=0;R<u;R++)for(let A=0;A<u;A++)g=Math.min(g,l[d+R][c+A]);const p=u*u;let v=g,y=f,S=42;for(let R=0;R<32;R++){const A=(v+y)/2;let O=0;for(let V=0;V<u;V++)for(let B=0;B<u;B++)l[d+V][c+B]>A&&O++;if(u%2===0)if(O===p/2){S=A;break}else O>p/2?v=A:y=A;else if(O===(p-1)/2){S=A;break}else O>(p-1)/2?v=A:y=A}return S},o)(r.rawNumbers(),i,s);return Ae.onlyNumbers(a)})}maxpoolArraySize(e,t){if(e.args.length<2||e.args.length>3)return gt.error();const r=this.metadata("MAXPOOL"),s=e.args.map(u=>{var h;return this.arraySizeForAst(u,new ta(t.formulaAddress,t.arraysFlag||((h=r?.arrayFunction)!==null&&h!==void 0?h:!1)))})[0],o=e.args[1];let a;o.type===M.NUMBER?a=o.value:a=1;let l=a;if(e.args.length===3){const u=e.args[2];u.type===M.NUMBER?l=u.value:l=1}return a>s.width||a>s.height||l>a||(s.width-a)%l!==0||(s.height-a)%l!==0?gt.error():uA(s,a,l)}medianpoolArraySize(e,t){return this.maxpoolArraySize(e,t)}transpose(e,t){return this.runFunction(e.args,t,this.metadata("TRANSPOSE"),r=>{const i=r.rawData(),s=r.size,o=[];for(let a=0;a<s.width;++a){o[a]=[];for(let l=0;l<s.height;++l)o[a][l]=i[l][a]}return Ae.onlyValues(o)})}transposeArraySize(e,t){if(e.args.length!==1)return gt.error();const r=this.metadata("TRANSPOSE"),i=e.args.map(o=>{var a;return this.arraySizeForAst(o,new ta(t.formulaAddress,t.arraysFlag||((a=r?.arrayFunction)!==null&&a!==void 0?a:!1)))}),[s]=i;return new gt(s.height,s.width)}createKernel(e,t){return function(...r){const i=[];for(let s=0;s<t.height;++s){i.push([]);for(let o=0;o<t.width;++o)i[s][o]=e.apply({thread:{x:o,y:s}},r)}return i}}}Y2.implementedFunctions={MMULT:{method:"mmult",arraySizeMethod:"mmultArraySize",parameters:[{argumentType:m.RANGE},{argumentType:m.RANGE}],vectorizationForbidden:!0},TRANSPOSE:{method:"transpose",arraySizeMethod:"transposeArraySize",parameters:[{argumentType:m.RANGE}],vectorizationForbidden:!0},MAXPOOL:{method:"maxpool",arraySizeMethod:"maxpoolArraySize",parameters:[{argumentType:m.RANGE},{argumentType:m.NUMBER},{argumentType:m.NUMBER,optionalArg:!0}],vectorizationForbidden:!0},MEDIANPOOL:{method:"medianpool",arraySizeMethod:"medianpoolArraySize",parameters:[{argumentType:m.RANGE},{argumentType:m.NUMBER},{argumentType:m.NUMBER,optionalArg:!0}],vectorizationForbidden:!0}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class K2 extends et{median(e,t){return this.runFunction(e.args,t,this.metadata("MEDIAN"),(...r)=>{const i=this.arithmeticHelper.coerceNumbersExactRanges(r);return i instanceof E?i:i.length===0?new E(N.NUM,_.OneValue):(i.sort((s,o)=>s-o),i.length%2===0?(i[i.length/2-1]+i[i.length/2])/2:i[Math.floor(i.length/2)])})}large(e,t){return this.runFunction(e.args,t,this.metadata("LARGE"),(r,i)=>{const s=this.arithmeticHelper.manyToExactNumbers(r.valuesFromTopLeftCorner());return s instanceof E?s:(s.sort((o,a)=>o-a),i=Math.trunc(i),i>s.length?new E(N.NUM,_.ValueLarge):s[s.length-i])})}small(e,t){return this.runFunction(e.args,t,this.metadata("SMALL"),(r,i)=>{const s=this.arithmeticHelper.manyToExactNumbers(r.valuesFromTopLeftCorner());return s instanceof E?s:(s.sort((o,a)=>o-a),i=Math.trunc(i),i>s.length?new E(N.NUM,_.ValueLarge):s[i-1])})}}K2.implementedFunctions={MEDIAN:{method:"median",parameters:[{argumentType:m.ANY}],repeatLastArgs:1},LARGE:{method:"large",parameters:[{argumentType:m.RANGE},{argumentType:m.NUMBER,minValue:1}]},SMALL:{method:"small",parameters:[{argumentType:m.RANGE},{argumentType:m.NUMBER,minValue:1}]}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class q2 extends et{mod(e,t){return this.runFunction(e.args,t,this.metadata("MOD"),(r,i)=>i===0?new E(N.DIV_BY_ZERO):r%i)}}q2.implementedFunctions={MOD:{method:"mod",parameters:[{argumentType:m.NUMBER},{argumentType:m.NUMBER}]}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */function $w(n){return It(n)&&!Number.isFinite(me(n))?0:n}class Xs{constructor(e,t,r){this.sumsq=e,this.sum=t,this.count=r}static single(e){return new Xs(e*e,e,1)}compose(e){return new Xs(this.sumsq+e.sumsq,this.sum+e.sum,this.count+e.count)}averageValue(){if(this.count>0)return this.sum/this.count}varSValue(){if(this.count>1)return(this.sumsq-this.sum*this.sum/this.count)/(this.count-1)}varPValue(){if(this.count>0)return(this.sumsq-this.sum*this.sum/this.count)/this.count}}Xs.empty=new Xs(0,0,0);class a_ extends et{constructor(){super(...arguments),this.addWithEpsilonRaw=(e,t)=>this.arithmeticHelper.addWithEpsilonRaw(e,t)}sum(e,t){return this.doSum(e.args,t)}sumsq(e,t){return this.reduce(e.args,t,0,"SUMSQ",this.addWithEpsilonRaw,r=>Math.pow(me(r),2),Fc)}max(e,t){return this.doMax(e.args,t)}maxa(e,t){const r=this.reduce(e.args,t,Number.NEGATIVE_INFINITY,"MAXA",(i,s)=>Math.max(i,s),me,Gw);return $w(r)}min(e,t){return this.doMin(e.args,t)}mina(e,t){const r=this.reduce(e.args,t,Number.POSITIVE_INFINITY,"MINA",(i,s)=>Math.min(i,s),me,Gw);return $w(r)}count(e,t){return this.doCount(e.args,t)}counta(e,t){return this.doCounta(e.args,t)}average(e,t){return this.doAverage(e.args,t)}averagea(e,t){var r;const i=this.reduce(e.args,t,Xs.empty,"_AGGREGATE_A",(s,o)=>s.compose(o),s=>Xs.single(me(s)),Gw);return i instanceof E?i:(r=i.averageValue())!==null&&r!==void 0?r:new E(N.DIV_BY_ZERO)}vars(e,t){return this.doVarS(e.args,t)}varp(e,t){return this.doVarP(e.args,t)}vara(e,t){var r;const i=this.reduceAggregateA(e.args,t);return i instanceof E?i:(r=i.varSValue())!==null&&r!==void 0?r:new E(N.DIV_BY_ZERO)}varpa(e,t){var r;const i=this.reduceAggregateA(e.args,t);return i instanceof E?i:(r=i.varPValue())!==null&&r!==void 0?r:new E(N.DIV_BY_ZERO)}stdevs(e,t){return this.doStdevS(e.args,t)}stdevp(e,t){return this.doStdevP(e.args,t)}stdeva(e,t){const r=this.reduceAggregateA(e.args,t);if(r instanceof E)return r;{const i=r.varSValue();return i===void 0?new E(N.DIV_BY_ZERO):Math.sqrt(i)}}stdevpa(e,t){const r=this.reduceAggregateA(e.args,t);if(r instanceof E)return r;{const i=r.varPValue();return i===void 0?new E(N.DIV_BY_ZERO):Math.sqrt(i)}}product(e,t){return this.doProduct(e.args,t)}subtotal(e,t){if(e.args.length<2)return new E(N.NA,_.WrongArgNumber);const r=this.coerceToType(this.evaluateAst(e.args[0],t),{argumentType:m.NUMBER},t),i=e.args.slice(1);switch(r){case 1:case 101:return this.doAverage(i,t);case 2:case 102:return this.doCount(i,t);case 3:case 103:return this.doCounta(i,t);case 4:case 104:return this.doMax(i,t);case 5:case 105:return this.doMin(i,t);case 6:case 106:return this.doProduct(i,t);case 7:case 107:return this.doStdevS(i,t);case 8:case 108:return this.doStdevP(i,t);case 9:case 109:return this.doSum(i,t);case 10:case 110:return this.doVarS(i,t);case 11:case 111:return this.doVarP(i,t);default:return new E(N.VALUE,_.BadMode)}}reduceAggregate(e,t){return this.reduce(e,t,Xs.empty,"_AGGREGATE",(r,i)=>r.compose(i),r=>Xs.single(me(r)),Fc)}reduceAggregateA(e,t){return this.reduce(e,t,Xs.empty,"_AGGREGATE_A",(r,i)=>r.compose(i),r=>Xs.single(me(r)),Gw)}doAverage(e,t){var r;const i=this.reduceAggregate(e,t);return i instanceof E?i:(r=i.averageValue())!==null&&r!==void 0?r:new E(N.DIV_BY_ZERO)}doVarS(e,t){var r;const i=this.reduceAggregate(e,t);return i instanceof E?i:(r=i.varSValue())!==null&&r!==void 0?r:new E(N.DIV_BY_ZERO)}doVarP(e,t){var r;const i=this.reduceAggregate(e,t);return i instanceof E?i:(r=i.varPValue())!==null&&r!==void 0?r:new E(N.DIV_BY_ZERO)}doStdevS(e,t){const r=this.reduceAggregate(e,t);if(r instanceof E)return r;{const i=r.varSValue();return i===void 0?new E(N.DIV_BY_ZERO):Math.sqrt(i)}}doStdevP(e,t){const r=this.reduceAggregate(e,t);if(r instanceof E)return r;{const i=r.varPValue();return i===void 0?new E(N.DIV_BY_ZERO):Math.sqrt(i)}}doCount(e,t){return this.reduce(e,t,0,"COUNT",(r,i)=>r+i,me,r=>It(r)?1:0)}doCounta(e,t){return this.reduce(e,t,0,"COUNTA",(r,i)=>r+i,me,r=>r===ht?0:1)}doMax(e,t){const r=this.reduce(e,t,Number.NEGATIVE_INFINITY,"MAX",(i,s)=>Math.max(i,s),me,Fc);return $w(r)}doMin(e,t){const r=this.reduce(e,t,Number.POSITIVE_INFINITY,"MIN",(i,s)=>Math.min(i,s),me,Fc);return $w(r)}doSum(e,t){return this.reduce(e,t,0,"SUM",this.addWithEpsilonRaw,me,Fc)}doProduct(e,t){return this.reduce(e,t,1,"PRODUCT",(r,i)=>r*i,me,Fc)}reduce(e,t,r,i,s,o,a){return e.length<1?new E(N.NA,_.WrongArgNumber):e.reduce((l,u)=>{if(l instanceof E)return l;if(u.type===M.CELL_RANGE||u.type===M.COLUMN_RANGE||u.type===M.ROW_RANGE){const c=this.evaluateRange(u,t,r,i,s,o,a);return c instanceof E?c:s(c,l)}let h;if(h=this.evaluateAst(u,t),h instanceof Ae)return Array.from(h.valuesFromTopLeftCorner()).map(a).filter(d=>d!==void 0).map(d=>d instanceof E?d:o(d)).reduce((d,f)=>d instanceof E?d:f instanceof E?f:s(d,f),l);if(u.type===M.CELL_REFERENCE){if(h=a(h),h===void 0)return l}else if(h=this.coerceScalarToNumberOrError(h),h=a(h),h===void 0)return l;return h instanceof E?h:s(l,o(h))},r)}evaluateRange(e,t,r,i,s,o,a){let l;try{l=_e.fromAst(e,t.formulaAddress)}catch(c){if(c instanceof ug)return new E(N.REF,_.RangeManySheets);throw c}const u=this.dependencyGraph.getRange(l.start,l.end);if(u===void 0)throw new Error("Range does not exists in graph");let h=u.getFunctionValue(i);return h===void 0&&(h=this.getRangeValues(i,l,u,o,a).reduce((d,f)=>d instanceof E?d:f instanceof E?f:s(d,f),r),u.setFunctionValue(i,h)),h}getRangeValues(e,t,r,i,s){const o=[],{smallerRangeVertex:a,restRange:l}=this.dependencyGraph.rangeMapping.findSmallerRange(t);let u;if(a!==void 0&&this.dependencyGraph.existsEdge(a,r)){const h=a.getFunctionValue(e);if(h!==void 0)o.push(h);else for(const c of a.range.addresses(this.dependencyGraph)){const d=s(this.dependencyGraph.getScalarValue(c));d instanceof E?o.push(d):d!==void 0&&o.push(i(d))}u=l}else u=t;for(const h of u.addresses(this.dependencyGraph)){const c=s(this.dependencyGraph.getScalarValue(h));c instanceof E?o.push(c):c!==void 0&&o.push(i(c))}return o}}a_.implementedFunctions={SUM:{method:"sum",parameters:[{argumentType:m.ANY}],repeatLastArgs:1},SUMSQ:{method:"sumsq",parameters:[{argumentType:m.ANY}],repeatLastArgs:1},MAX:{method:"max",parameters:[{argumentType:m.ANY}],repeatLastArgs:1},MIN:{method:"min",parameters:[{argumentType:m.ANY}],repeatLastArgs:1},MAXA:{method:"maxa",parameters:[{argumentType:m.ANY}],repeatLastArgs:1},MINA:{method:"mina",parameters:[{argumentType:m.ANY}],repeatLastArgs:1},COUNT:{method:"count",parameters:[{argumentType:m.ANY}],repeatLastArgs:1},COUNTA:{method:"counta",parameters:[{argumentType:m.ANY}],repeatLastArgs:1},AVERAGE:{method:"average",parameters:[{argumentType:m.ANY}],repeatLastArgs:1},AVERAGEA:{method:"averagea",parameters:[{argumentType:m.ANY}],repeatLastArgs:1},PRODUCT:{method:"product",parameters:[{argumentType:m.ANY}],repeatLastArgs:1},"VAR.S":{method:"vars",parameters:[{argumentType:m.ANY}],repeatLastArgs:1},"VAR.P":{method:"varp",parameters:[{argumentType:m.ANY}],repeatLastArgs:1},VARA:{method:"vara",parameters:[{argumentType:m.ANY}],repeatLastArgs:1},VARPA:{method:"varpa",parameters:[{argumentType:m.ANY}],repeatLastArgs:1},"STDEV.S":{method:"stdevs",parameters:[{argumentType:m.ANY}],repeatLastArgs:1},"STDEV.P":{method:"stdevp",parameters:[{argumentType:m.ANY}],repeatLastArgs:1},STDEVA:{method:"stdeva",parameters:[{argumentType:m.ANY}],repeatLastArgs:1},STDEVPA:{method:"stdevpa",parameters:[{argumentType:m.ANY}],repeatLastArgs:1},SUBTOTAL:{method:"subtotal",parameters:[{argumentType:m.NUMBER},{argumentType:m.ANY}],repeatLastArgs:1}};a_.aliases={VAR:"VAR.S",VARP:"VAR.P",STDEV:"STDEV.S",STDEVP:"STDEV.P",VARS:"VAR.S",STDEVS:"STDEV.S"};function Fc(n){if(It(n)||n instanceof E)return n}function Gw(n){return typeof n=="boolean"?LN(n):It(n)||n instanceof E?n:typeof n=="string"?0:void 0}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class X2 extends et{power(e,t){return this.runFunction(e.args,t,this.metadata("POWER"),Math.pow)}}X2.implementedFunctions={POWER:{method:"power",parameters:[{argumentType:m.NUMBER},{argumentType:m.NUMBER}]}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class Q2 extends et{radians(e,t){return this.runFunction(e.args,t,this.metadata("RADIANS"),r=>r*(Math.PI/180))}}Q2.implementedFunctions={RADIANS:{method:"radians",parameters:[{argumentType:m.NUMBER}]}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const fr=10,Z2=255,XF=2,QF=36,Bve="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ";class J2 extends et{dec2bin(e,t){return this.runFunction(e.args,t,this.metadata("DEC2BIN"),(r,i)=>Aa(r,2,i))}dec2oct(e,t){return this.runFunction(e.args,t,this.metadata("DEC2OCT"),(r,i)=>Aa(r,8,i))}dec2hex(e,t){return this.runFunction(e.args,t,this.metadata("DEC2HEX"),(r,i)=>Aa(r,16,i))}bin2dec(e,t){return this.runFunction(e.args,t,this.metadata("BIN2DEC"),r=>{const i=xo(r,2,fr);return i===void 0?new E(N.NUM,_.NotBinary):Na(i,2)})}bin2oct(e,t){return this.runFunction(e.args,t,this.metadata("BIN2OCT"),(r,i)=>{const s=xo(r,2,fr);return s===void 0?new E(N.NUM,_.NotBinary):Aa(Na(s,2),8,i)})}bin2hex(e,t){return this.runFunction(e.args,t,this.metadata("BIN2HEX"),(r,i)=>{const s=xo(r,2,fr);return s===void 0?new E(N.NUM,_.NotBinary):Aa(Na(s,2),16,i)})}oct2dec(e,t){return this.runFunction(e.args,t,this.metadata("OCT2DEC"),r=>{const i=xo(r,8,fr);return i===void 0?new E(N.NUM,_.NotOctal):Na(i,8)})}oct2bin(e,t){return this.runFunction(e.args,t,this.metadata("OCT2BIN"),(r,i)=>{const s=xo(r,8,fr);return s===void 0?new E(N.NUM,_.NotOctal):Aa(Na(s,8),2,i)})}oct2hex(e,t){return this.runFunction(e.args,t,this.metadata("OCT2HEX"),(r,i)=>{const s=xo(r,8,fr);return s===void 0?new E(N.NUM,_.NotOctal):Aa(Na(s,8),16,i)})}hex2dec(e,t){return this.runFunction(e.args,t,this.metadata("HEX2DEC"),r=>{const i=xo(r,16,fr);return i===void 0?new E(N.NUM,_.NotHex):Na(i,16)})}hex2bin(e,t){return this.runFunction(e.args,t,this.metadata("HEX2BIN"),(r,i)=>{const s=xo(r,16,fr);return s===void 0?new E(N.NUM,_.NotHex):Aa(Na(s,16),2,i)})}hex2oct(e,t){return this.runFunction(e.args,t,this.metadata("HEX2OCT"),(r,i)=>{const s=xo(r,16,fr);return s===void 0?new E(N.NUM,_.NotHex):Aa(Na(s,16),8,i)})}base(e,t){return this.runFunction(e.args,t,this.metadata("BASE"),$ve)}decimal(e,t){return this.runFunction(e.args,t,this.metadata("DECIMAL"),(r,i)=>{const s=xo(r,i,Z2);return s===void 0?new E(N.NUM,_.NotHex):parseInt(s,i)})}}J2.implementedFunctions={DEC2BIN:{method:"dec2bin",parameters:[{argumentType:m.NUMBER},{argumentType:m.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},DEC2OCT:{method:"dec2oct",parameters:[{argumentType:m.NUMBER},{argumentType:m.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},DEC2HEX:{method:"dec2hex",parameters:[{argumentType:m.NUMBER},{argumentType:m.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},BIN2DEC:{method:"bin2dec",parameters:[{argumentType:m.STRING}]},BIN2OCT:{method:"bin2oct",parameters:[{argumentType:m.STRING},{argumentType:m.NUMBER,optionalArg:!0,minValue:0,maxValue:fr}]},BIN2HEX:{method:"bin2hex",parameters:[{argumentType:m.STRING},{argumentType:m.NUMBER,optionalArg:!0,minValue:0,maxValue:fr}]},OCT2DEC:{method:"oct2dec",parameters:[{argumentType:m.STRING}]},OCT2BIN:{method:"oct2bin",parameters:[{argumentType:m.STRING},{argumentType:m.NUMBER,optionalArg:!0,minValue:0,maxValue:fr}]},OCT2HEX:{method:"oct2hex",parameters:[{argumentType:m.STRING},{argumentType:m.NUMBER,optionalArg:!0,minValue:0,maxValue:fr}]},HEX2DEC:{method:"hex2dec",parameters:[{argumentType:m.STRING}]},HEX2BIN:{method:"hex2bin",parameters:[{argumentType:m.STRING},{argumentType:m.NUMBER,optionalArg:!0,minValue:0,maxValue:fr}]},HEX2OCT:{method:"hex2oct",parameters:[{argumentType:m.STRING},{argumentType:m.NUMBER,optionalArg:!0,minValue:0,maxValue:fr}]},DECIMAL:{method:"decimal",parameters:[{argumentType:m.STRING},{argumentType:m.NUMBER,minValue:XF,maxValue:QF}]},BASE:{method:"base",parameters:[{argumentType:m.NUMBER,minValue:0},{argumentType:m.NUMBER,minValue:XF,maxValue:QF},{argumentType:m.NUMBER,optionalArg:!0,minValue:0,maxValue:Z2}]}};function xo(n,e,t){const r=Bve.substr(0,e),i=new RegExp(`^[${r}]+$`);if(!(n.length>t||!i.test(n)))return n}function Aa(n,e,t){if(n>Wve(e))return new E(N.NUM,_.ValueBaseLarge);if(n<ej(e))return new E(N.NUM,_.ValueBaseSmall);const r=tj(n,e);return t===void 0||n<0?r:r.length>t?new E(N.NUM,_.ValueBaseLong):Ci(r,t)}function ej(n){return-Math.pow(n,fr)/2}function Wve(n){return-ej(n)-1}function $ve(n,e,t){const r=tj(n,e);return t!==void 0&&t>r.length?Ci(r,t):r}function tj(n,e){const t=n<0?Math.pow(e,fr):0;return(n+t).toString(e).toUpperCase()}function Na(n,e){const t=parseInt(n,e),r=Math.pow(e,fr);return t>=r/2?t-r:t}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class nj extends et{rand(e,t){return this.runFunction(e.args,t,this.metadata("RAND"),Math.random)}randbetween(e,t){return this.runFunction(e.args,t,this.metadata("RANDBETWEEN"),(r,i)=>i<r?new E(N.NUM,_.WrongOrder):(r=Math.ceil(r),i=Math.floor(i)+1,r===i&&(i+=1),r+Math.floor(Math.random()*(i-r))))}}nj.implementedFunctions={RAND:{method:"rand",parameters:[],isVolatile:!0},RANDBETWEEN:{method:"randbetween",parameters:[{argumentType:m.NUMBER},{argumentType:m.NUMBER}],isVolatile:!0}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */function ZF(n){const e=Math.ceil(n);return e%2===1?e:e+1}function JF(n){const e=Math.ceil(n);return e%2===0?e:e+1}class l_ extends et{roundup(e,t){return this.runFunction(e.args,t,this.metadata("ROUNDDOWN"),(r,i)=>{const s=Math.pow(10,i);return r<0?-Math.ceil(-r*s)/s:Math.ceil(r*s)/s})}rounddown(e,t){return this.runFunction(e.args,t,this.metadata("ROUNDDOWN"),(r,i)=>{const s=Math.pow(10,i);return r<0?-Math.floor(-r*s)/s:Math.floor(r*s)/s})}round(e,t){return this.runFunction(e.args,t,this.metadata("ROUND"),(r,i)=>{const s=Math.pow(10,i);return r<0?-Math.round(-r*s)/s:Math.round(r*s)/s})}intFunc(e,t){return this.runFunction(e.args,t,this.metadata("INT"),r=>r<0?-Math.floor(-r):Math.floor(r))}even(e,t){return this.runFunction(e.args,t,this.metadata("EVEN"),r=>r<0?-JF(-r):JF(r))}odd(e,t){return this.runFunction(e.args,t,this.metadata("ODD"),r=>r<0?-ZF(-r):ZF(r))}ceilingmath(e,t){return this.runFunction(e.args,t,this.metadata("CEILING.MATH"),(r,i,s)=>i===0||r===0?0:(i=Math.abs(i),s===1&&r<0&&(i=-i),Math.ceil(r/i)*i))}ceiling(e,t){return this.runFunction(e.args,t,this.metadata("CEILING"),(r,i)=>r===0?0:i===0?new E(N.DIV_BY_ZERO):r>0&&i<0?new E(N.NUM,_.DistinctSigns):Math.ceil(r/i)*i)}ceilingprecise(e,t){return this.runFunction(e.args,t,this.metadata("CEILING.PRECISE"),(r,i)=>i===0||r===0?0:(i=Math.abs(i),Math.ceil(r/i)*i))}floormath(e,t){return this.runFunction(e.args,t,this.metadata("FLOOR.MATH"),(r,i,s)=>i===0||r===0?0:(i=Math.abs(i),s===1&&r<0&&(i*=-1),Math.floor(r/i)*i))}floor(e,t){return this.runFunction(e.args,t,this.metadata("FLOOR"),(r,i)=>r===0?0:i===0?new E(N.DIV_BY_ZERO):r>0&&i<0?new E(N.NUM,_.DistinctSigns):Math.floor(r/i)*i)}floorprecise(e,t){return this.runFunction(e.args,t,this.metadata("FLOOR.PRECISE"),(r,i)=>i===0||r===0?0:(i=Math.abs(i),Math.floor(r/i)*i))}}l_.implementedFunctions={ROUNDUP:{method:"roundup",parameters:[{argumentType:m.NUMBER},{argumentType:m.NUMBER,defaultValue:0}]},ROUNDDOWN:{method:"rounddown",parameters:[{argumentType:m.NUMBER},{argumentType:m.NUMBER,defaultValue:0}]},ROUND:{method:"round",parameters:[{argumentType:m.NUMBER},{argumentType:m.NUMBER,defaultValue:0}]},INT:{method:"intFunc",parameters:[{argumentType:m.NUMBER}]},EVEN:{method:"even",parameters:[{argumentType:m.NUMBER}]},ODD:{method:"odd",parameters:[{argumentType:m.NUMBER}]},"CEILING.MATH":{method:"ceilingmath",parameters:[{argumentType:m.NUMBER},{argumentType:m.NUMBER,defaultValue:1},{argumentType:m.NUMBER,defaultValue:0}]},CEILING:{method:"ceiling",parameters:[{argumentType:m.NUMBER},{argumentType:m.NUMBER}]},"CEILING.PRECISE":{method:"ceilingprecise",parameters:[{argumentType:m.NUMBER},{argumentType:m.NUMBER,defaultValue:1}]},"FLOOR.MATH":{method:"floormath",parameters:[{argumentType:m.NUMBER},{argumentType:m.NUMBER,defaultValue:1},{argumentType:m.NUMBER,defaultValue:0}]},FLOOR:{method:"floor",parameters:[{argumentType:m.NUMBER},{argumentType:m.NUMBER}]},"FLOOR.PRECISE":{method:"floorprecise",parameters:[{argumentType:m.NUMBER},{argumentType:m.NUMBER,defaultValue:1}]}};l_.aliases={"ISO.CEILING":"CEILING.PRECISE",TRUNC:"ROUNDDOWN"};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class rj extends et{sqrt(e,t){return this.runFunction(e.args,t,this.metadata("SQRT"),Math.sqrt)}}rj.implementedFunctions={SQRT:{method:"sqrt",parameters:[{argumentType:m.NUMBER}]}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */function*Gve(){}function jve(n){const e=n[Symbol.iterator](),{done:t,value:r}=e.next();return t?{rest:Gve()}:{value:r,rest:e}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const zve=(n,e,t)=>{if(t.end.row>t.start.row){const r=we(t.end.sheet,t.end.col,t.end.row-1),i=n.getRange(t.start,r);if(i!==void 0)return{smallerRangeVertex:i,restValuesRange:t.withStart(we(t.start.sheet,t.start.col,t.end.row)),restConditionRanges:e.map(s=>s.withStart(we(s.start.sheet,s.start.col,s.end.row)))}}return{restValuesRange:t,restConditionRanges:e}};class Yve{constructor(e,t,r,i,s){this.interpreter=e,this.cacheKey=t,this.reduceInitialValue=r,this.composeFunction=i,this.mapFunction=s,this.dependencyGraph=this.interpreter.dependencyGraph}compute(e,t){for(const s of t)if(!s.conditionRange.sameDimensionsAs(e))return new E(N.VALUE,_.EqualLength);const r=this.tryToGetRangeVertexForRangeValue(e),i=t.map(s=>this.tryToGetRangeVertexForRangeValue(s.conditionRange));if(r&&i.every(s=>s!==void 0)){const s=t.map(l=>l.criterionPackage.raw).join(","),o=this.findAlreadyComputedValueInCache(r,this.cacheKey(t),s);if(o!==void 0)return this.interpreter.stats.incrementCriterionFunctionFullCacheUsed(),o;const a=this.buildNewCriterionCache(this.cacheKey(t),t.map(l=>l.conditionRange.range),e.range);return a.has(s)||a.set(s,[this.evaluateRangeValue(e,t),t.map(l=>l.criterionPackage.lambda)]),r.setCriterionFunctionValues(this.cacheKey(t),a),i.forEach(l=>{l!==void 0&&l.addDependentCacheRange(r)}),a.get(s)[0]}else return this.evaluateRangeValue(e,t)}tryToGetRangeVertexForRangeValue(e){const t=e.range;if(t!==void 0)return this.dependencyGraph.getRange(t.start,t.end)}reduceFunction(e){let t=this.reduceInitialValue;for(const r of e)t=this.composeFunction(t,r);return t}findAlreadyComputedValueInCache(e,t,r){return e.getCriterionFunctionValue(t,r)}evaluateRangeValue(e,t){const r=t.map(a=>a.criterionPackage.lambda),i=Array.from(e.valuesFromTopLeftCorner()).map(this.mapFunction)[Symbol.iterator](),s=t.map(a=>a.conditionRange.iterateValuesFromTopLeftCorner()),o=tk(r,s,i);return this.reduceFunction(o)}buildNewCriterionCache(e,t,r){const i=this.dependencyGraph.getRange(r.start,r.end),{smallerRangeVertex:s,restConditionRanges:o,restValuesRange:a}=zve(this.dependencyGraph,t,r);let l;s!==void 0&&this.dependencyGraph.existsEdge(s,i)?l=s.getCriterionFunctionValues(e):l=new Map;const u=new Map;return l.forEach(([h,c],d)=>{const f=tk(c,o.map(p=>ek(this.dependencyGraph,p)),Array.from(ek(this.dependencyGraph,a)).map(this.mapFunction)[Symbol.iterator]()),g=this.composeFunction(h,this.reduceFunction(f));this.interpreter.stats.incrementCriterionFunctionPartialCacheUsed(),u.set(d,[g,c])}),u}}class Kve{constructor(e,t){this.conditionRange=e,this.criterionPackage=t}}function*ek(n,e){for(const t of e.addresses(n))yield me(n.getScalarValue(t))}function*tk(n,e,t){for(const r of t){const i=e.map(o=>jve(o));if(!i.every(o=>Object.prototype.hasOwnProperty.call(o,"value")))return;const s=i.map(o=>me(o.value));qve(s,n).every(([o,a])=>a(o))&&(yield r),e=i.map(o=>o.rest)}}function qve(n,e){const t=[];for(let r=0;r<Math.min(n.length,e.length);r++)t.push([n[r],e[r]]);return t}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class tu{constructor(e,t){this.sum=e,this.count=t}static single(e){return new tu(e,1)}compose(e){return new tu(this.sum+e.sum,this.count+e.count)}averageValue(){if(this.count>0)return this.sum/this.count}}tu.empty=new tu(0,0);function Xve(n){return e=>{const t=e.map(r=>`${r.conditionRange.range.sheet},${r.conditionRange.range.start.col},${r.conditionRange.range.start.row}`);return[n,...t].join(",")}}function nk(n){return It(n)&&!Number.isFinite(me(n))?0:n}function jw(n){if(n instanceof E)return n;if(It(n))return me(n)}class ij extends et{sumif(e,t){const r="SUMIF",i=(s,o,a)=>this.computeConditionalAggregationFunction(a??s,[s,o],r,0,(l,u)=>this.arithmeticHelper.nonstrictadd(l,u),jw);return this.runFunction(e.args,t,this.metadata(r),i)}sumifs(e,t){const r="SUMIFS",i=(s,...o)=>this.computeConditionalAggregationFunction(s,o,r,0,(a,l)=>this.arithmeticHelper.nonstrictadd(a,l),jw);return this.runFunction(e.args,t,this.metadata(r),i)}averageif(e,t){const r="AVERAGEIF",i=(s,o,a)=>{const l=this.computeConditionalAggregationFunction(a??s,[s,o],r,tu.empty,(u,h)=>u.compose(h),u=>It(u)?tu.single(me(u)):tu.empty);return l instanceof E?l:l.averageValue()||new E(N.DIV_BY_ZERO)};return this.runFunction(e.args,t,this.metadata(r),i)}countif(e,t){const r="COUNTIF",i=(s,o)=>this.computeConditionalAggregationFunction(s,[s,o],r,0,(a,l)=>a+l,()=>1);return this.runFunction(e.args,t,this.metadata(r),i)}countifs(e,t){const r="COUNTIFS",i=(...s)=>this.computeConditionalAggregationFunction(s[0],s,r,0,(o,a)=>o+a,()=>1);return this.runFunction(e.args,t,this.metadata(r),i)}minifs(e,t){const r="MINIFS",i=(o,a)=>a===void 0||o===void 0?a===void 0?o:a:Math.min(o,a),s=(o,...a)=>{const l=this.computeConditionalAggregationFunction(o,a,r,Number.POSITIVE_INFINITY,i,jw);return nk(l)};return this.runFunction(e.args,t,this.metadata(r),s)}maxifs(e,t){const r="MAXIFS",i=(o,a)=>a===void 0||o===void 0?a===void 0?o:a:Math.max(o,a),s=(o,...a)=>{const l=this.computeConditionalAggregationFunction(o,a,r,Number.NEGATIVE_INFINITY,i,jw);return nk(l)};return this.runFunction(e.args,t,this.metadata(r),s)}computeConditionalAggregationFunction(e,t,r,i,s,o){const a=[];for(let l=0;l<t.length;l+=2){const u=t[l],h=this.interpreter.criterionBuilder.fromCellValue(t[l+1],this.arithmeticHelper);if(h===void 0)return new E(N.VALUE,_.BadCriterion);a.push(new Kve(u,h))}return new Yve(this.interpreter,Xve(r),i,s,o).compute(e,a)}}ij.implementedFunctions={SUMIF:{method:"sumif",parameters:[{argumentType:m.RANGE},{argumentType:m.NOERROR},{argumentType:m.RANGE,optionalArg:!0}]},COUNTIF:{method:"countif",parameters:[{argumentType:m.RANGE},{argumentType:m.NOERROR}]},AVERAGEIF:{method:"averageif",parameters:[{argumentType:m.RANGE},{argumentType:m.NOERROR},{argumentType:m.RANGE,optionalArg:!0}]},SUMIFS:{method:"sumifs",parameters:[{argumentType:m.RANGE},{argumentType:m.RANGE},{argumentType:m.NOERROR}],repeatLastArgs:2},COUNTIFS:{method:"countifs",parameters:[{argumentType:m.RANGE},{argumentType:m.NOERROR}],repeatLastArgs:2},MINIFS:{method:"minifs",parameters:[{argumentType:m.RANGE},{argumentType:m.RANGE},{argumentType:m.NOERROR}],repeatLastArgs:2},MAXIFS:{method:"maxifs",parameters:[{argumentType:m.RANGE},{argumentType:m.RANGE},{argumentType:m.NOERROR}],repeatLastArgs:2}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class sj extends et{sumproduct(e,t){return this.runFunction(e.args,t,this.metadata("SUMPRODUCT"),(...r)=>{const i=r[0].width(),s=r[0].height();for(const l of r)if(l.width()!==i||l.height()!==s)return new E(N.VALUE,_.EqualLength);let o=0;const a=r.map(l=>l.iterateValuesFromTopLeftCorner());for(let l=0;l<i*s;l++){let u=1;for(const h of a){const c=h.next().value;if(c instanceof E)return c;const d=this.coerceScalarToNumberOrError(c);It(d)?u*=me(d):u=0}o+=u}return o})}}sj.implementedFunctions={SUMPRODUCT:{method:"sumproduct",parameters:[{argumentType:m.RANGE}],repeatLastArgs:1}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class oj extends et{concatenate(e,t){return this.runFunction(e.args,t,this.metadata("CONCATENATE"),(...r)=>"".concat(...r))}split(e,t){return this.runFunction(e.args,t,this.metadata("SPLIT"),(r,i)=>{const s=r.split(" ");return i>=s.length||i<0?new E(N.VALUE,_.IndexBounds):s[i]})}len(e,t){return this.runFunction(e.args,t,this.metadata("LEN"),r=>r.length)}lower(e,t){return this.runFunction(e.args,t,this.metadata("LOWER"),r=>r.toLowerCase())}trim(e,t){return this.runFunction(e.args,t,this.metadata("TRIM"),r=>r.replace(/^ +| +$/g,"").replace(/ +/g," "))}proper(e,t){return this.runFunction(e.args,t,this.metadata("PROPER"),r=>r.replace(/\p{L}+/gu,i=>i.charAt(0).toUpperCase()+i.substring(1).toLowerCase()))}clean(e,t){return this.runFunction(e.args,t,this.metadata("CLEAN"),r=>r.replace(/[\u0000-\u001F]/g,""))}exact(e,t){return this.runFunction(e.args,t,this.metadata("EXACT"),(r,i)=>r===i)}rept(e,t){return this.runFunction(e.args,t,this.metadata("REPT"),(r,i)=>i<0?new E(N.VALUE,_.NegativeCount):r.repeat(i))}right(e,t){return this.runFunction(e.args,t,this.metadata("RIGHT"),(r,i)=>i<0?new E(N.VALUE,_.NegativeLength):i===0?"":r.slice(-i))}left(e,t){return this.runFunction(e.args,t,this.metadata("LEFT"),(r,i)=>i<0?new E(N.VALUE,_.NegativeLength):r.slice(0,i))}mid(e,t){return this.runFunction(e.args,t,this.metadata("MID"),(r,i,s)=>i<1?new E(N.VALUE,_.LessThanOne):s<0?new E(N.VALUE,_.NegativeLength):r.substring(i-1,i+s-1))}replace(e,t){return this.runFunction(e.args,t,this.metadata("REPLACE"),(r,i,s,o)=>i<1?new E(N.VALUE,_.LessThanOne):s<0?new E(N.VALUE,_.NegativeLength):r.substring(0,i-1)+o+r.substring(i+s-1))}search(e,t){return this.runFunction(e.args,t,this.metadata("SEARCH"),(r,i,s)=>{if(s<1||s>i.length)return new E(N.VALUE,_.LengthBounds);const o=r.toLowerCase(),a=i.substring(s-1).toLowerCase(),l=this.arithmeticHelper.requiresRegex(o)?this.arithmeticHelper.searchString(o,a):a.indexOf(o);return l>-1?l+s:new E(N.VALUE,_.PatternNotFound)})}substitute(e,t){return this.runFunction(e.args,t,this.metadata("SUBSTITUTE"),(r,i,s,o)=>{const a=this.escapeRegExpSpecialCharacters(i),l=new RegExp(a,"g");if(o===void 0)return r.replace(l,s);if(o<1)return new E(N.VALUE,_.LessThanOne);let u,h=0;for(;(u=l.exec(r))!==null;)if(o===++h)return r.substring(0,u.index)+s+r.substring(l.lastIndex);return r})}find(e,t){return this.runFunction(e.args,t,this.metadata("FIND"),(r,i,s)=>{if(s<1||s>i.length)return new E(N.VALUE,_.IndexBounds);const a=i.substring(s-1).indexOf(r)+s;return a>0?a:new E(N.VALUE,_.PatternNotFound)})}t(e,t){return this.runFunction(e.args,t,this.metadata("T"),r=>r instanceof E||typeof r=="string"?r:"")}upper(e,t){return this.runFunction(e.args,t,this.metadata("UPPER"),r=>r.toUpperCase())}escapeRegExpSpecialCharacters(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}}oj.implementedFunctions={CONCATENATE:{method:"concatenate",parameters:[{argumentType:m.STRING}],repeatLastArgs:1,expandRanges:!0},EXACT:{method:"exact",parameters:[{argumentType:m.STRING},{argumentType:m.STRING}]},SPLIT:{method:"split",parameters:[{argumentType:m.STRING},{argumentType:m.NUMBER}]},LEN:{method:"len",parameters:[{argumentType:m.STRING}]},LOWER:{method:"lower",parameters:[{argumentType:m.STRING}]},MID:{method:"mid",parameters:[{argumentType:m.STRING},{argumentType:m.NUMBER},{argumentType:m.NUMBER}]},TRIM:{method:"trim",parameters:[{argumentType:m.STRING}]},T:{method:"t",parameters:[{argumentType:m.SCALAR}]},PROPER:{method:"proper",parameters:[{argumentType:m.STRING}]},CLEAN:{method:"clean",parameters:[{argumentType:m.STRING}]},REPT:{method:"rept",parameters:[{argumentType:m.STRING},{argumentType:m.NUMBER}]},RIGHT:{method:"right",parameters:[{argumentType:m.STRING},{argumentType:m.NUMBER,defaultValue:1}]},LEFT:{method:"left",parameters:[{argumentType:m.STRING},{argumentType:m.NUMBER,defaultValue:1}]},REPLACE:{method:"replace",parameters:[{argumentType:m.STRING},{argumentType:m.NUMBER},{argumentType:m.NUMBER},{argumentType:m.STRING}]},SEARCH:{method:"search",parameters:[{argumentType:m.STRING},{argumentType:m.STRING},{argumentType:m.NUMBER,defaultValue:1}]},SUBSTITUTE:{method:"substitute",parameters:[{argumentType:m.STRING},{argumentType:m.STRING},{argumentType:m.STRING},{argumentType:m.NUMBER,optionalArg:!0}]},FIND:{method:"find",parameters:[{argumentType:m.STRING},{argumentType:m.STRING},{argumentType:m.NUMBER,defaultValue:1}]},UPPER:{method:"upper",parameters:[{argumentType:m.STRING}]}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class aj extends et{acos(e,t){return this.runFunction(e.args,t,this.metadata("ACOS"),Math.acos)}asin(e,t){return this.runFunction(e.args,t,this.metadata("ASIN"),Math.asin)}cos(e,t){return this.runFunction(e.args,t,this.metadata("COS"),Math.cos)}sin(e,t){return this.runFunction(e.args,t,this.metadata("SIN"),Math.sin)}tan(e,t){return this.runFunction(e.args,t,this.metadata("TAN"),Math.tan)}atan(e,t){return this.runFunction(e.args,t,this.metadata("ATAN"),Math.atan)}atan2(e,t){return this.runFunction(e.args,t,this.metadata("ATAN2"),(r,i)=>r===0&&i===0?new E(N.DIV_BY_ZERO):Math.atan2(i,r))}cot(e,t){return this.runFunction(e.args,t,this.metadata("COT"),r=>r===0?new E(N.DIV_BY_ZERO):1/Math.tan(r))}acot(e,t){return this.runFunction(e.args,t,this.metadata("ACOT"),r=>r===0?zN/2:Math.atan(1/r))}sec(e,t){return this.runFunction(e.args,t,this.metadata("SEC"),r=>1/Math.cos(r))}csc(e,t){return this.runFunction(e.args,t,this.metadata("CSC"),r=>r===0?new E(N.DIV_BY_ZERO):1/Math.sin(r))}sinh(e,t){return this.runFunction(e.args,t,this.metadata("SINH"),Math.sinh)}asinh(e,t){return this.runFunction(e.args,t,this.metadata("ASINH"),Math.asinh)}cosh(e,t){return this.runFunction(e.args,t,this.metadata("COSH"),Math.cosh)}acosh(e,t){return this.runFunction(e.args,t,this.metadata("ACOSH"),Math.acosh)}tanh(e,t){return this.runFunction(e.args,t,this.metadata("TANH"),Math.tanh)}atanh(e,t){return this.runFunction(e.args,t,this.metadata("ATANH"),Math.atanh)}coth(e,t){return this.runFunction(e.args,t,this.metadata("COTH"),r=>r===0?new E(N.DIV_BY_ZERO):1/Math.tanh(r))}acoth(e,t){return this.runFunction(e.args,t,this.metadata("ACOTH"),r=>r===0?new E(N.NUM,_.NonZero):Math.atanh(1/r))}sech(e,t){return this.runFunction(e.args,t,this.metadata("SECH"),r=>1/Math.cosh(r))}csch(e,t){return this.runFunction(e.args,t,this.metadata("CSCH"),r=>r===0?new E(N.DIV_BY_ZERO):1/Math.sinh(r))}}aj.implementedFunctions={ACOS:{method:"acos",parameters:[{argumentType:m.NUMBER}]},ASIN:{method:"asin",parameters:[{argumentType:m.NUMBER}]},COS:{method:"cos",parameters:[{argumentType:m.NUMBER}]},SIN:{method:"sin",parameters:[{argumentType:m.NUMBER}]},TAN:{method:"tan",parameters:[{argumentType:m.NUMBER}]},ATAN:{method:"atan",parameters:[{argumentType:m.NUMBER}]},ATAN2:{method:"atan2",parameters:[{argumentType:m.NUMBER},{argumentType:m.NUMBER}]},COT:{method:"cot",parameters:[{argumentType:m.NUMBER}]},SEC:{method:"sec",parameters:[{argumentType:m.NUMBER}]},CSC:{method:"csc",parameters:[{argumentType:m.NUMBER}]},SINH:{method:"sinh",parameters:[{argumentType:m.NUMBER}]},COSH:{method:"cosh",parameters:[{argumentType:m.NUMBER}]},TANH:{method:"tanh",parameters:[{argumentType:m.NUMBER}]},COTH:{method:"coth",parameters:[{argumentType:m.NUMBER}]},SECH:{method:"sech",parameters:[{argumentType:m.NUMBER}]},CSCH:{method:"csch",parameters:[{argumentType:m.NUMBER}]},ACOT:{method:"acot",parameters:[{argumentType:m.NUMBER}]},ASINH:{method:"asinh",parameters:[{argumentType:m.NUMBER}]},ACOSH:{method:"acosh",parameters:[{argumentType:m.NUMBER}]},ATANH:{method:"atanh",parameters:[{argumentType:m.NUMBER}]},ACOTH:{method:"acoth",parameters:[{argumentType:m.NUMBER}]}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class Qve extends y2{constructor(e){super(e),this.dependencyGraph=e}find(e,t,r){return this.basicFind(e,t,"col",r)}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class lj extends et{constructor(){super(...arguments),this.rowSearch=new Qve(this.dependencyGraph)}vlookup(e,t){return this.runFunction(e.args,t,this.metadata("VLOOKUP"),(r,i,s,o)=>{const a=i.range;return a===void 0?new E(N.VALUE,_.WrongType):s<1?new E(N.VALUE,_.LessThanOne):s>a.width()?new E(N.REF,_.IndexLarge):this.doVlookup(iA(r),i,s-1,o)})}hlookup(e,t){return this.runFunction(e.args,t,this.metadata("HLOOKUP"),(r,i,s,o)=>{const a=i.range;return a===void 0?new E(N.VALUE,_.WrongType):s<1?new E(N.VALUE,_.LessThanOne):s>a.height()?new E(N.REF,_.IndexLarge):this.doHlookup(iA(r),i,s-1,o)})}match(e,t){return this.runFunction(e.args,t,this.metadata("MATCH"),(r,i,s)=>this.doMatch(iA(r),i,s))}searchInRange(e,t,r,i){if(!r&&typeof e=="string"&&this.arithmeticHelper.requiresRegex(e))return i.advancedFind(this.arithmeticHelper.eqMatcherFunction(e),t);{const s=r?{ordering:"asc"}:{ordering:"none",matchExactly:!0};return i.find(e,t,s)}}doVlookup(e,t,r,i){this.dependencyGraph.stats.start(Ke.VLOOKUP);const s=t.range;let o;s===void 0?o=Ae.onlyValues(t.data.map(u=>[u[0]])):o=Ae.onlyRange(_e.spanFrom(s.start,1,s.height()),this.dependencyGraph);const a=this.searchInRange(e,o,i,this.columnSearch);if(this.dependencyGraph.stats.end(Ke.VLOOKUP),a===-1)return new E(N.NA,_.ValueNotFound);let l;if(s===void 0)l=t.data[a][r];else{const u=we(s.sheet,s.start.col+r,s.start.row+a);l=this.dependencyGraph.getCellValue(u)}return l instanceof Ae?new E(N.VALUE,_.WrongType):l}doHlookup(e,t,r,i){const s=t.range;let o;s===void 0?o=Ae.onlyValues([t.data[0]]):o=Ae.onlyRange(_e.spanFrom(s.start,s.width(),1),this.dependencyGraph);const a=this.searchInRange(e,o,i,this.rowSearch);if(a===-1)return new E(N.NA,_.ValueNotFound);let l;if(s===void 0)l=t.data[r][a];else{const u=we(s.sheet,s.start.col+a,s.start.row+r);l=this.dependencyGraph.getCellValue(u)}return l instanceof Ae?new E(N.VALUE,_.WrongType):l}doMatch(e,t,r){if(![-1,0,1].includes(r))return new E(N.VALUE,_.BadMode);if(t.width()>1&&t.height()>1)return new E(N.NA);const i=t.width()===1?this.columnSearch:this.rowSearch,s=r===0?{ordering:"none",matchExactly:!0}:{ordering:r===-1?"desc":"asc"},o=i.find(e,t,s);return o===-1?new E(N.NA,_.ValueNotFound):o+1}}lj.implementedFunctions={VLOOKUP:{method:"vlookup",parameters:[{argumentType:m.NOERROR},{argumentType:m.RANGE},{argumentType:m.NUMBER},{argumentType:m.BOOLEAN,defaultValue:!0}]},HLOOKUP:{method:"hlookup",parameters:[{argumentType:m.NOERROR},{argumentType:m.RANGE},{argumentType:m.NUMBER},{argumentType:m.BOOLEAN,defaultValue:!0}]},MATCH:{method:"match",parameters:[{argumentType:m.NOERROR},{argumentType:m.RANGE},{argumentType:m.NUMBER,defaultValue:1}]}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class uj extends et{roman(e,t){return this.runFunction(e.args,t,this.metadata("ROMAN"),(r,i)=>(r=Math.trunc(r),i===!1?i=4:i===!0&&(i=0),i=me(this.coerceScalarToNumberOrError(i)),i instanceof E?i:(i=Math.trunc(i),i<0?new E(N.VALUE,_.ValueSmall):i>4?new E(N.VALUE,_.ValueLarge):Zve(r,i))))}arabic(e,t){return this.runFunction(e.args,t,this.metadata("ARABIC"),r=>{r=r.trim().toUpperCase();let i=!1;if(r.startsWith("-")&&(r=r.slice(1),i=!0,r===""))return new E(N.VALUE,_.InvalidRoman);const s={input:r,acc:0};return Lo(s,{token:"MMM",val:3e3},{token:"MM",val:2e3},{token:"M",val:1e3}),Lo(s,{token:"IM",val:999},{token:"VM",val:995},{token:"XM",val:990},{token:"LM",val:950},{token:"CM",val:900}),Lo(s,{token:"D",val:500},{token:"ID",val:499},{token:"VD",val:495},{token:"XD",val:490},{token:"LD",val:450},{token:"CD",val:400}),Lo(s,{token:"CCC",val:300},{token:"CC",val:200},{token:"C",val:100}),Lo(s,{token:"IC",val:99},{token:"VC",val:95},{token:"XC",val:90}),Lo(s,{token:"L",val:50},{token:"IL",val:49},{token:"VL",val:45},{token:"XL",val:40}),Lo(s,{token:"XXX",val:30},{token:"XX",val:20},{token:"X",val:10}),Lo(s,{token:"IX",val:9}),Lo(s,{token:"V",val:5},{token:"IV",val:4}),Lo(s,{token:"III",val:3},{token:"II",val:2},{token:"I",val:1}),s.input!==""?new E(N.VALUE,_.InvalidRoman):i?-s.acc:s.acc})}}uj.implementedFunctions={ROMAN:{method:"roman",parameters:[{argumentType:m.NUMBER,minValue:1,lessThan:4e3},{argumentType:m.NOERROR,optionalArg:!0,defaultValue:0}]},ARABIC:{method:"arabic",parameters:[{argumentType:m.STRING}]}};function Lo(n,...e){for(const t of e)if(n.input.startsWith(t.token)){n.input=n.input.slice(t.token.length),n.acc+=t.val;break}}function Zve(n,e){const t={val:n%1e3,acc:"M".repeat(Math.floor(n/1e3))};return e===4&&(Fn(t,"IM",999,1e3),Fn(t,"ID",499,500)),e>=3&&(Fn(t,"VM",995,1e3),Fn(t,"VD",495,500)),e>=2&&(Fn(t,"XM",990,1e3),Fn(t,"XD",490,500)),e>=1&&(Fn(t,"LM",950,1e3),Fn(t,"LD",450,500)),Fn(t,"CM",900,1e3),Fn(t,"CD",400,500),Fn(t,"D",500,900),t.acc+="C".repeat(Math.floor(t.val/100)),t.val%=100,e>=2&&(Fn(t,"IC",99,100),Fn(t,"IL",49,50)),e>=1&&(Fn(t,"VC",95,100),Fn(t,"VL",45,50)),Fn(t,"XC",90,100),Fn(t,"XL",40,50),Fn(t,"L",50,90),t.acc+="X".repeat(Math.floor(t.val/10)),t.val%=10,Fn(t,"IX",9,10),Fn(t,"IV",4,5),Fn(t,"V",5,9),t.acc+="I".repeat(t.val),t.acc}function Fn(n,e,t,r){n.val>=t&&n.val<r&&(n.val-=t,n.acc+=e)}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class hj extends et{add(e,t){return this.runFunction(e.args,t,this.metadata("HF.ADD"),this.arithmeticHelper.addWithEpsilon)}concat(e,t){return this.runFunction(e.args,t,this.metadata("HF.CONCAT"),this.arithmeticHelper.concat)}divide(e,t){return this.runFunction(e.args,t,this.metadata("HF.DIVIDE"),this.arithmeticHelper.divide)}eq(e,t){return this.runFunction(e.args,t,this.metadata("HF.EQ"),this.arithmeticHelper.eq)}gt(e,t){return this.runFunction(e.args,t,this.metadata("HF.GT"),this.arithmeticHelper.gt)}gte(e,t){return this.runFunction(e.args,t,this.metadata("HF.GTE"),this.arithmeticHelper.geq)}lt(e,t){return this.runFunction(e.args,t,this.metadata("HF.LT"),this.arithmeticHelper.lt)}lte(e,t){return this.runFunction(e.args,t,this.metadata("HF.LTE"),this.arithmeticHelper.leq)}minus(e,t){return this.runFunction(e.args,t,this.metadata("HF.MINUS"),this.arithmeticHelper.subtract)}multiply(e,t){return this.runFunction(e.args,t,this.metadata("HF.MULTIPLY"),this.arithmeticHelper.multiply)}ne(e,t){return this.runFunction(e.args,t,this.metadata("HF.NE"),this.arithmeticHelper.neq)}pow(e,t){return this.runFunction(e.args,t,this.metadata("HF.POW"),this.arithmeticHelper.pow)}uminus(e,t){return this.runFunction(e.args,t,this.metadata("HF.UMINUS"),this.arithmeticHelper.unaryMinus)}upercent(e,t){return this.runFunction(e.args,t,this.metadata("HF.UNARY_PERCENT"),this.arithmeticHelper.unaryPercent)}uplus(e,t){return this.runFunction(e.args,t,this.metadata("HF.UPLUS"),this.arithmeticHelper.unaryPlus)}}hj.implementedFunctions={"HF.ADD":{method:"add",parameters:[{argumentType:m.NUMBER,passSubtype:!0},{argumentType:m.NUMBER,passSubtype:!0}]},"HF.CONCAT":{method:"concat",parameters:[{argumentType:m.STRING,passSubtype:!0},{argumentType:m.STRING,passSubtype:!0}]},"HF.DIVIDE":{method:"divide",parameters:[{argumentType:m.NUMBER,passSubtype:!0},{argumentType:m.NUMBER,passSubtype:!0}]},"HF.EQ":{method:"eq",parameters:[{argumentType:m.NOERROR,passSubtype:!0},{argumentType:m.NOERROR,passSubtype:!0}]},"HF.GT":{method:"gt",parameters:[{argumentType:m.NOERROR,passSubtype:!0},{argumentType:m.NOERROR,passSubtype:!0}]},"HF.GTE":{method:"gte",parameters:[{argumentType:m.NOERROR,passSubtype:!0},{argumentType:m.NOERROR,passSubtype:!0}]},"HF.LT":{method:"lt",parameters:[{argumentType:m.NOERROR,passSubtype:!0},{argumentType:m.NOERROR,passSubtype:!0}]},"HF.LTE":{method:"lte",parameters:[{argumentType:m.NOERROR,passSubtype:!0},{argumentType:m.NOERROR,passSubtype:!0}]},"HF.MINUS":{method:"minus",parameters:[{argumentType:m.NUMBER,passSubtype:!0},{argumentType:m.NUMBER,passSubtype:!0}]},"HF.MULTIPLY":{method:"multiply",parameters:[{argumentType:m.NUMBER,passSubtype:!0},{argumentType:m.NUMBER,passSubtype:!0}]},"HF.NE":{method:"ne",parameters:[{argumentType:m.NOERROR,passSubtype:!0},{argumentType:m.NOERROR,passSubtype:!0}]},"HF.POW":{method:"pow",parameters:[{argumentType:m.NUMBER,passSubtype:!0},{argumentType:m.NUMBER,passSubtype:!0}]},"HF.UMINUS":{method:"uminus",parameters:[{argumentType:m.NUMBER,passSubtype:!0}]},"HF.UNARY_PERCENT":{method:"upercent",parameters:[{argumentType:m.NUMBER,passSubtype:!0}]},"HF.UPLUS":{method:"uplus",parameters:[{argumentType:m.NUMBER,passSubtype:!0}]}};/**
 * @license
 bessel.js (C) 2013-present SheetJS -- http://sheetjs.com

 Apache License
 Version 2.0, January 2004
 http://www.apache.org/licenses/

 TERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION

 1. Definitions.

 "License" shall mean the terms and conditions for use, reproduction,
 and distribution as defined by Sections 1 through 9 of this document.

 "Licensor" shall mean the copyright owner or entity authorized by
 the copyright owner that is granting the License.

 "Legal Entity" shall mean the union of the acting entity and all
 other entities that control, are controlled by, or are under common
 control with that entity. For the purposes of this definition,
 "control" means (i) the power, direct or indirect, to cause the
 direction or management of such entity, whether by contract or
 otherwise, or (ii) ownership of fifty percent (50%) or more of the
 outstanding shares, or (iii) beneficial ownership of such entity.

 "You" (or "Your") shall mean an individual or Legal Entity
 exercising permissions granted by this License.

 "Source" form shall mean the preferred form for making modifications,
 including but not limited to software source code, documentation
 source, and configuration files.

 "Object" form shall mean any form resulting from mechanical
 transformation or translation of a Source form, including but
 not limited to compiled object code, generated documentation,
 and conversions to other media types.

 "Work" shall mean the work of authorship, whether in Source or
 Object form, made available under the License, as indicated by a
 copyright notice that is included in or attached to the work
 (an example is provided in the Appendix below).

 "Derivative Works" shall mean any work, whether in Source or Object
 form, that is based on (or derived from) the Work and for which the
 editorial revisions, annotations, elaborations, or other modifications
 represent, as a whole, an original work of authorship. For the purposes
 of this License, Derivative Works shall not include works that remain
 separable from, or merely link (or bind by name) to the interfaces of,
 the Work and Derivative Works thereof.

 "Contribution" shall mean any work of authorship, including
 the original version of the Work and any modifications or additions
 to that Work or Derivative Works thereof, that is intentionally
 submitted to Licensor for inclusion in the Work by the copyright owner
 or by an individual or Legal Entity authorized to submit on behalf of
 the copyright owner. For the purposes of this definition, "submitted"
 means any form of electronic, verbal, or written communication sent
 to the Licensor or its representatives, including but not limited to
 communication on electronic mailing lists, source code control systems,
 and issue tracking systems that are managed by, or on behalf of, the
 Licensor for the purpose of discussing and improving the Work, but
 excluding communication that is conspicuously marked or otherwise
 designated in writing by the copyright owner as "Not a Contribution."

 "Contributor" shall mean Licensor and any individual or Legal Entity
 on behalf of whom a Contribution has been received by Licensor and
 subsequently incorporated within the Work.

 2. Grant of Copyright License. Subject to the terms and conditions of
 this License, each Contributor hereby grants to You a perpetual,
 worldwide, non-exclusive, no-charge, royalty-free, irrevocable
 copyright license to reproduce, prepare Derivative Works of,
 publicly display, publicly perform, sublicense, and distribute the
 Work and such Derivative Works in Source or Object form.

 3. Grant of Patent License. Subject to the terms and conditions of
 this License, each Contributor hereby grants to You a perpetual,
 worldwide, non-exclusive, no-charge, royalty-free, irrevocable
 (except as stated in this section) patent license to make, have made,
 use, offer to sell, sell, import, and otherwise transfer the Work,
 where such license applies only to those patent claims licensable
 by such Contributor that are necessarily infringed by their
 Contribution(s) alone or by combination of their Contribution(s)
 with the Work to which such Contribution(s) was submitted. If You
 institute patent litigation against any entity (including a
 cross-claim or counterclaim in a lawsuit) alleging that the Work
 or a Contribution incorporated within the Work constitutes direct
 or contributory patent infringement, then any patent licenses
 granted to You under this License for that Work shall terminate
 as of the date such litigation is filed.

 4. Redistribution. You may reproduce and distribute copies of the
 Work or Derivative Works thereof in any medium, with or without
 modifications, and in Source or Object form, provided that You
 meet the following conditions:

 (a) You must give any other recipients of the Work or
 Derivative Works a copy of this License; and

 (b) You must cause any modified files to carry prominent notices
 stating that You changed the files; and

 (c) You must retain, in the Source form of any Derivative Works
 that You distribute, all copyright, patent, trademark, and
 attribution notices from the Source form of the Work,
 excluding those notices that do not pertain to any part of
 the Derivative Works; and

 (d) If the Work includes a "NOTICE" text file as part of its
 distribution, then any Derivative Works that You distribute must
 include a readable copy of the attribution notices contained
 within such NOTICE file, excluding those notices that do not
 pertain to any part of the Derivative Works, in at least one
 of the following places: within a NOTICE text file distributed
 as part of the Derivative Works; within the Source form or
 documentation, if provided along with the Derivative Works; or,
 within a display generated by the Derivative Works, if and
 wherever such third-party notices normally appear. The contents
 of the NOTICE file are for informational purposes only and
 do not modify the License. You may add Your own attribution
 notices within Derivative Works that You distribute, alongside
 or as an addendum to the NOTICE text from the Work, provided
 that such additional attribution notices cannot be construed
 as modifying the License.

 You may add Your own copyright statement to Your modifications and
 may provide additional or different license terms and conditions
 for use, reproduction, or distribution of Your modifications, or
 for any such Derivative Works as a whole, provided Your use,
 reproduction, and distribution of the Work otherwise complies with
 the conditions stated in this License.

 5. Submission of Contributions. Unless You explicitly state otherwise,
 any Contribution intentionally submitted for inclusion in the Work
 by You to the Licensor shall be under the terms and conditions of
 this License, without any additional terms or conditions.
 Notwithstanding the above, nothing herein shall supersede or modify
 the terms of any separate license agreement you may have executed
 with Licensor regarding such Contributions.

 6. Trademarks. This License does not grant permission to use the trade
 names, trademarks, service marks, or product names of the Licensor,
 except as required for reasonable and customary use in describing the
 origin of the Work and reproducing the content of the NOTICE file.

 7. Disclaimer of Warranty. Unless required by applicable law or
 agreed to in writing, Licensor provides the Work (and each
 Contributor provides its Contributions) on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
 implied, including, without limitation, any warranties or conditions
 of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A
 PARTICULAR PURPOSE. You are solely responsible for determining the
 appropriateness of using or redistributing the Work and assume any
 risks associated with Your exercise of permissions under this License.

 8. Limitation of Liability. In no event and under no legal theory,
 whether in tort (including negligence), contract, or otherwise,
 unless required by applicable law (such as deliberate and grossly
 negligent acts) or agreed to in writing, shall any Contributor be
 liable to You for damages, including any direct, indirect, special,
 incidental, or consequential damages of any character arising as a
 result of this License or out of the use or inability to use the
 Work (including but not limited to damages for loss of goodwill,
 work stoppage, computer failure or malfunction, or any and all
 other commercial damages or losses), even if such Contributor
 has been advised of the possibility of such damages.

 9. Accepting Warranty or Additional Liability. While redistributing
 the Work or Derivative Works thereof, You may choose to offer,
 and charge a fee for, acceptance of support, warranty, indemnity,
 or other liability obligations and/or rights consistent with this
 License. However, in accepting such obligations, You may act only
 on Your own behalf and on Your sole responsibility, not on behalf
 of any other Contributor, and only if You agree to indemnify,
 defend, and hold each Contributor harmless for any liability
 incurred by, or claims asserted against, such Contributor by reason
 of your accepting any such warranty or additional liability.

 END OF TERMS AND CONDITIONS

 APPENDIX: How to apply the Apache License to your work.

 To apply the Apache License to your work, attach the following
 boilerplate notice, with the fields enclosed by brackets "{}"
 replaced with your own identifying information. (Don't include
 the brackets!)  The text should be enclosed in the appropriate
 comment syntax for the file format. We also recommend that a
 file or class name and description of purpose be included on the
 same "printed page" as the copyright notice for easier
 identification within third-party archives.

 Copyright (C) 2013-present   SheetJS LLC

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

 http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 */var rt=Math;function gn(n,e){for(var t=0,r=0;t<n.length;++t)r=e*r+n[t];return r}function cj(n,e,t,r,i){if(e===0)return t;if(e===1)return r;for(var s=2/n,o=r,a=1;a<e;++a)o=r*a*s+i*t,t=r,r=o;return o}function dj(n,e,t,r,i){return function(o,a){if(r){if(o===0)return r==1?-1/0:1/0;if(o<0)return NaN}if(a===0)return n(o);if(a===1)return e(o);if(a<0)return NaN;a|=0;var l=n(o),u=e(o);return cj(o,a,l,u,i)}}var YN=(function(){var n=.636619772,e=[57568490574,-13362590354,6516196407e-1,-1121442418e-2,77392.33017,-184.9052456].reverse(),t=[57568490411,1029532985,9494680718e-3,59272.64853,267.8532712,1].reverse(),r=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),i=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934935152e-16].reverse();function s(c){var d=0,f=0,g=0,p=c*c;if(c<8)f=gn(e,p),g=gn(t,p),d=f/g;else{var v=c-.785398164;p=64/p,f=gn(r,p),g=gn(i,p),d=rt.sqrt(n/c)*(rt.cos(v)*f-rt.sin(v)*g*8/c)}return d}var o=[72362614232,-7895059235,2423968531e-1,-2972611439e-3,15704.4826,-30.16036606].reverse(),a=[144725228442,2300535178,1858330474e-2,99447.43394,376.9991397,1].reverse(),l=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),u=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function h(c){var d=0,f=0,g=0,p=c*c,v=rt.abs(c)-2.356194491;return Math.abs(c)<8?(f=c*gn(o,p),g=gn(a,p),d=f/g):(p=64/p,f=gn(l,p),g=gn(u,p),d=rt.sqrt(n/rt.abs(c))*(rt.cos(v)*f-rt.sin(v)*g*8/rt.abs(c)),c<0&&(d=-d)),d}return function c(d,f){if(f=Math.round(f),!isFinite(d))return isNaN(d)?d:0;if(f<0)return(f%2?-1:1)*c(d,-f);if(d<0)return(f%2?-1:1)*c(-d,f);if(f===0)return s(d);if(f===1)return h(d);if(d===0)return 0;var g=0;if(d>f)g=cj(d,f,s(d),h(d),-1);else{for(var p=2*rt.floor((f+rt.floor(rt.sqrt(40*f)))/2),v=!1,y=0,S=0,R=1,A=0,O=2/d,V=p;V>0;V--)A=V*O*R-y,y=R,R=A,rt.abs(R)>1e10&&(R*=1e-10,y*=1e-10,g*=1e-10,S*=1e-10),v&&(S+=R),v=!v,V==f&&(g=y);S=2*S-R,g/=S}return g}})(),Jve=(function(){var n=.636619772,e=[-2957821389,7062834065,-5123598036e-1,1087988129e-2,-86327.92757,228.4622733].reverse(),t=[40076544269,7452499648e-1,7189466438e-3,47447.2647,226.1030244,1].reverse(),r=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),i=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934945152e-16].reverse();function s(c){var d=0,f=0,g=0,p=c*c,v=c-.785398164;return c<8?(f=gn(e,p),g=gn(t,p),d=f/g+n*YN(c,0)*rt.log(c)):(p=64/p,f=gn(r,p),g=gn(i,p),d=rt.sqrt(n/c)*(rt.sin(v)*f+rt.cos(v)*g*8/c)),d}var o=[-4900604943e3,127527439e4,-51534381390,7349264551e-1,-4237922726e-3,8511.937935].reverse(),a=[249958057e5,424441966400,3733650367,2245904002e-2,102042.605,354.9632885,1].reverse(),l=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),u=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function h(c){var d=0,f=0,g=0,p=c*c,v=c-2.356194491;return c<8?(f=c*gn(o,p),g=gn(a,p),d=f/g+n*(YN(c,1)*rt.log(c)-1/c)):(p=64/p,f=gn(l,p),g=gn(u,p),d=rt.sqrt(n/c)*(rt.sin(v)*f+rt.cos(v)*g*8/c)),d}return dj(s,h,"BESSELY",1,-1)})(),KN=(function(){var n=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),e=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse();function t(o){return o<=3.75?gn(n,o*o/(3.75*3.75)):rt.exp(rt.abs(o))/rt.sqrt(rt.abs(o))*gn(e,3.75/rt.abs(o))}var r=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),i=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse();function s(o){return o<3.75?o*gn(r,o*o/(3.75*3.75)):(o<0?-1:1)*rt.exp(rt.abs(o))/rt.sqrt(rt.abs(o))*gn(i,3.75/rt.abs(o))}return function o(a,l){if(l=Math.round(l),l===0)return t(a);if(l===1)return s(a);if(l<0)return NaN;if(rt.abs(a)===0)return 0;if(a==1/0)return 1/0;var u=0,h,c=2/rt.abs(a),d=0,f=1,g=0,p=2*rt.round((l+rt.round(rt.sqrt(40*l)))/2);for(h=p;h>0;h--)g=h*c*f+d,d=f,f=g,rt.abs(f)>1e10&&(f*=1e-10,d*=1e-10,u*=1e-10),h==l&&(u=d);return u*=o(a,0)/f,a<0&&l%2?-u:u}})(),eye=(function(){var n=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),e=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse();function t(o){return o<=2?-rt.log(o/2)*KN(o,0)+gn(n,o*o/4):rt.exp(-o)/rt.sqrt(o)*gn(e,2/o)}var r=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),i=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();function s(o){return o<=2?rt.log(o/2)*KN(o,1)+1/o*gn(r,o*o/4):rt.exp(-o)/rt.sqrt(o)*gn(i,2/o)}return dj(t,s,"BESSELK",2,1)})();/**
 * @license
 Copyright (c) 2013 jStat

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to deal
 in the Software without restriction, including without limitation the rights
 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice and this permission notice shall be included in
 all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 THE SOFTWARE.
 */function wd(n){const e=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,15626441722e-18,-85238095915e-18,6529054439e-18,5059343495e-18,-991364156e-18,-227365122e-18,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18];let t=e.length-1,r=!1,i=0,s=0,o,a,l,u;if(n===0)return 0;for(n<0&&(n=-n,r=!0),o=2/(2+n),a=4*o-2;t>0;t--)l=i,i=a*i-s+e[t],s=l;return u=o*Math.exp(-n*n+.5*(e[0]+a*i)-s),r?u-1:1-u}function fj(n){return 1-wd(n)}function mj(n){let e=0,t,r,i,s;if(n>=2)return-100;if(n<=0)return 100;for(s=n<1?n:2-n,i=Math.sqrt(-2*Math.log(s/2)),t=-.70711*((2.30753+i*.27061)/(1+i*(.99229+i*.04481))-i);e<2;e++)r=fj(t)-s,t+=r/(1.1283791670955126*Math.exp(-t*t)-t*r);return n<1?t:-t}const rk={pdf:(n,e)=>n<0?0:e*Math.exp(-e*n),cdf:(n,e)=>n<0?0:1-Math.exp(-e*n)};function km(n){const e=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],t=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535];let r=!1,i=0,s=0,o=0,a=n,l,u,h,c;if(n>171.6243769536076)return 1/0;if(a<=0)if(c=a%1,c)r=(a&1?-1:1)*Math.PI/Math.sin(Math.PI*c),a=1-a;else return 1/0;for(h=a,a<1?u=a++:u=(a-=i=(a|0)-1)-1,l=0;l<8;++l)o=(o+e[l])*u,s=s*u+t[l];if(c=o/s+1,h<a)c/=h;else if(h>a)for(l=0;l<i;++l)c*=a,a++;return r&&(c=r/c),c}const hA={pdf:function(e,t,r){return e<0?0:e===0&&t===1?1/r:Math.exp((t-1)*Math.log(e)-e/r-pr(t)-t*Math.log(r))},cdf:function(e,t,r){return e<0?0:u_(t,e/r)},inv:function(n,e,t){return gj(n,e)*t}};function pr(n){let e=0;const t=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18];let r=1.000000000190015,i,s,o;for(o=(s=i=n)+5.5,o-=(i+.5)*Math.log(o);e<6;e++)r+=t[e]/++s;return Math.log(2.5066282746310007*r/i)-o}function u_(n,e){const t=pr(n);let r=n,i=1/n,s=i,o=e+1-n,a=1/1e-30,l=1/o,u=l,h=1;const c=-~(Math.log(n>=1?n:1/n)*8.5+n*.4+17);let d;if(e<0||n<=0)return NaN;if(e<n+1){for(;h<=c;h++)i+=s*=e/++r;return i*Math.exp(-e+n*Math.log(e)-t)}for(;h<=c;h++)d=-h*(h-n),o+=2,l=d*l+o,a=o+d/a,l=1/l,u*=l*a;return 1-u*Math.exp(-e+n*Math.log(e)-t)}function gj(n,e){let t=0;const r=e-1,i=1e-8,s=pr(e);let o,a,l,u,h,c,d;if(n>=1)return Math.max(100,e+100*Math.sqrt(e));if(n<=0)return 0;for(e>1?(c=Math.log(r),d=Math.exp(r*(c-1)-s),h=n<.5?n:1-n,l=Math.sqrt(-2*Math.log(h)),o=(2.30753+l*.27061)/(1+l*(.99229+l*.04481))-l,n<.5&&(o=-o),o=Math.max(.001,e*Math.pow(1-1/(9*e)-o/(3*Math.sqrt(e)),3))):(l=1-e*(.253+e*.12),n<l?o=Math.pow(n/l,1/e):o=1-Math.log(1-(n-l)/(1-l)));t<12;t++){if(o<=0)return 0;if(a=u_(e,o)-n,e>1?l=d*Math.exp(-(o-r)+r*(Math.log(o)-c)):l=Math.exp(-o+r*Math.log(o)-s),u=a/l,o-=l=u/(1-.5*Math.min(1,u*((e-1)/o-1))),o<=0&&(o=.5*(o+l)),Math.abs(l)<i*o)break}return o}const Ys={pdf:function(e,t,r){return Math.exp(-.5*Math.log(2*Math.PI)-Math.log(r)-Math.pow(e-t,2)/(2*r*r))},cdf:function(e,t,r){return .5*(1+wd((e-t)/Math.sqrt(2*r*r)))},inv:function(n,e,t){return-1.4142135623730951*t*mj(2*n)+e}},cA={pdf:function(e,t,r){return e>1||e<0?0:t==1&&r==1?1:t<512&&r<512?Math.pow(e,t-1)*Math.pow(1-e,r-1)/h_(t,r):Math.exp((t-1)*Math.log(e)+(r-1)*Math.log(1-e)-pj(t,r))},cdf:function(e,t,r){return e>1||e<0?+(e>1):vS(e,t,r)},inv:function(e,t,r){return c_(e,t,r)}};function h_(n,e){if(!(n<=0||e<=0))return n+e>170?Math.exp(pj(n,e)):km(n)*km(e)/km(n+e)}function pj(n,e){return pr(n)+pr(e)-pr(n+e)}function c_(n,e,t){var r=1e-8,i=e-1,s=t-1,o=0,a,l,u,h,c,d,f,g,p,v,y;if(n<=0)return 0;if(n>=1)return 1;for(e>=1&&t>=1?(u=n<.5?n:1-n,h=Math.sqrt(-2*Math.log(u)),f=(2.30753+h*.27061)/(1+h*(.99229+h*.04481))-h,n<.5&&(f=-f),g=(f*f-3)/6,p=2/(1/(2*e-1)+1/(2*t-1)),v=f*Math.sqrt(g+p)/p-(1/(2*t-1)-1/(2*e-1))*(g+5/6-2/(3*p)),f=e/(e+t*Math.exp(2*v))):(a=Math.log(e/(e+t)),l=Math.log(t/(e+t)),h=Math.exp(e*a)/e,c=Math.exp(t*l)/t,v=h+c,n<h/v?f=Math.pow(e*v*n,1/e):f=1-Math.pow(t*v*(1-n),1/t)),y=-pr(e)-pr(t)+pr(e+t);o<10;o++){if(f===0||f===1)return f;if(d=vS(f,e,t)-n,h=Math.exp(i*Math.log(f)+s*Math.log(1-f)+y),c=d/h,f-=h=c/(1-.5*Math.min(1,c*(i/f-s/(1-f)))),f<=0&&(f=.5*(f+h)),f>=1&&(f=.5*(f+h+1)),Math.abs(h)<r*f&&o>0)break}return f}function vS(n,e,t){var r=n===0||n===1?0:Math.exp(pr(e+t)-pr(e)-pr(t)+e*Math.log(n)+t*Math.log(1-n));return n<0||n>1?!1:n<(e+1)/(e+t+2)?r*ik(n,e,t)/e:1-r*ik(1-n,t,e)/t}function ik(n,e,t){var r=1e-30,i=1,s=e+t,o=e+1,a=e-1,l=1,u=1-s*n/o,h,c,d,f;for(Math.abs(u)<r&&(u=r),u=1/u,f=u;i<=100&&(h=2*i,c=i*(t-i)*n/((a+h)*(e+h)),u=1+c*u,Math.abs(u)<r&&(u=r),l=1+c/l,Math.abs(l)<r&&(l=r),u=1/u,f*=u*l,c=-(e+i)*(s+i)*n/((e+h)*(o+h)),u=1+c*u,Math.abs(u)<r&&(u=r),l=1+c/l,Math.abs(l)<r&&(l=r),u=1/u,d=u*l,f*=d,!(Math.abs(d-1)<3e-7));i++);return f}const Mv={pdf:function(n,e,t){return t===0||t===1?e*t===n?1:0:wj(e,n)*Math.pow(t,n)*Math.pow(1-t,e-n)},cdf:function(n,e,t){var r,i=1e-10;if(n<0)return 0;if(n>=e)return 1;if(t<0||t>1||e<=0)return NaN;n=Math.floor(n);var s=t,o=n+1,a=e-n,l=o+a,u=Math.exp(pr(l)-pr(a)-pr(o)+o*Math.log(s)+a*Math.log(1-s));return s<(o+1)/(l+2)?r=u*sk(s,o,a,i):r=1-u*sk(1-s,a,o,i),Math.round((1-r)*(1/i))/(1/i)}};function sk(n,e,t,r){for(var i=0,s=1,o=1,a=1,l=0,u=0,h;Math.abs((o-u)/o)>r;)u=o,h=-(e+l)*(e+t+l)*n/(e+2*l)/(e+2*l+1),i=o+h*i,s=a+h*s,l=l+1,h=l*(t-l)*n/(e+2*l-1)/(e+2*l),o=i+h*o,a=s+h*a,i=i/a,s=s/a,o=o/a,a=1;return o/e}function wj(n,e){return n>170||e>170?Math.exp(tye(n,e)):Iv(n)/Iv(e)/Iv(n-e)}function tye(n,e){return dA(n)-dA(e)-dA(n-e)}function dA(n){return n<0?NaN:pr(n+1)}function Iv(n){return n<0?NaN:km(n+1)}const Yc={pdf:function(e,t){return e<0?0:e===0&&t===2?.5:Math.exp((t/2-1)*Math.log(e)-e/2-t/2*Math.log(2)-pr(t/2))},cdf:function(e,t){return e<0?0:u_(t/2,e/2)},inv:function(n,e){return 2*gj(n,.5*e)}},Kc={pdf:function(e,t,r){var i,s,o;return e<0?0:t<=2?e===0&&t<2?1/0:e===0&&t===2?1:1/h_(t/2,r/2)*Math.pow(t/r,t/2)*Math.pow(e,t/2-1)*Math.pow(1+t/r*e,-(t+r)/2):(i=t*e/(r+e*t),s=r/(r+e*t),o=t*s/2,o*Mv.pdf((t-2)/2,(t+r-2)/2,i))},cdf:function(e,t,r){return e<0?0:vS(t*e/(t*e+r),t/2,r/2)},inv:function(e,t,r){return r/(t*(1/c_(e,t/2,r/2)-1))}},ok={pdf:function(e,t,r){return e<0||t<0||r<0?0:r/t*Math.pow(e/t,r-1)*Math.exp(-Math.pow(e/t,r))},cdf:function(e,t,r){return e<0?0:1-Math.exp(-Math.pow(e/t,r))}},qN={pdf:function(e,t){return t<0||e%1!==0||e<0?0:Math.pow(t,e)*Math.exp(-t)/Iv(e)},cdf:function(e,t){var r=0;if(e<0)return 0;for(var i=0;r<=e;r++)i+=qN.pdf(r,t);return i}},Fa={pdf:function(e,t,r,i){if(e<0||e<r-(t-i))return 0;if(e>i||e>r)return 0;if(r*2>t)return i*2>t?Fa.pdf(t-r-i+e,t,t-r,t-i):Fa.pdf(i-e,t,t-r,i);if(i*2>t)return Fa.pdf(r-e,t,r,t-i);if(r<i)return Fa.pdf(e,t,i,r);for(var s=1,o=0,a=0;a<e;a++){for(;s>1&&o<i;)s*=1-r/(t-o),o++;s*=(i-a)*(r-a)/((a+1)*(t-r-i+a+1))}for(;o<i;o++)s*=1-r/(t-o);return Math.min(1,Math.max(0,s))},cdf:function n(e,t,r,i){if(e<0||e<r-(t-i))return 0;if(e>=i||e>=r)return 1;if(r*2>t)return i*2>t?n(t-r-i+e,t,t-r,t-i):1-Fa.cdf(i-e-1,t,t-r,i);if(i*2>t)return 1-Fa.cdf(r-e-1,t,r,t-i);if(r<i)return Fa.cdf(e,t,i,r);for(var s=1,o=1,a=0,l=0;l<e;l++){for(;s>1&&a<i;){var u=1-r/(t-a);o*=u,s*=u,a++}o*=(i-l)*(r-l)/((l+1)*(t-r-i+l+1)),s+=o}for(;a<i;a++)s*=1-r/(t-a);return Math.min(1,Math.max(0,s))}},us={pdf:function(e,t){return t=t>1e100?1e100:t,1/(Math.sqrt(t)*h_(.5,t/2))*Math.pow(1+e*e/t,-((t+1)/2))},cdf:function(e,t){var r=t/2;return vS((e+Math.sqrt(e*e+t))/(2*Math.sqrt(e*e+t)),r,r)},inv:function(n,e){var t=c_(2*Math.min(n,1-n),.5*e,.5);return t=Math.sqrt(e*(1-t)/t),n>.5?t:-t}},fA={pdf:function(e,t,r){return e<=0?0:Math.exp(-Math.log(e)-.5*Math.log(2*Math.PI)-Math.log(r)-Math.pow(Math.log(e)-t,2)/(2*r*r))},cdf:function(e,t,r){return e<0?0:.5+.5*wd((Math.log(e)-t)/Math.sqrt(2*r*r))},inv:function(n,e,t){return Math.exp(-1.4142135623730951*t*mj(2*n)+e)}},XN={pdf:function(e,t,r){return e!==e>>>0?!1:e<0?0:wj(e+t-1,t-1)*Math.pow(1-r,e)*Math.pow(r,t)},cdf:function(e,t,r){var i=0,s=0;if(e<0)return 0;for(;s<=e;s++)i+=XN.pdf(s,t,r);return i}};function vj(n){for(var e=0,t=n.length;--t>=0;)e+=n[t];return e}function rs(n){return vj(n)/n.length}function oh(n){for(var e=rs(n),t=0,r=n.length,i;--r>=0;)i=n[r]-e,t+=i*i;return t}function nm(n,e){return oh(n)/(n.length-(e?1:0))}function Yl(n,e){return Math.sqrt(nm(n,e))}function nye(){var n=[].slice.call(arguments),e=new Array(2),t;return n.length===4?t=Math.abs(Ys.inv(n[1]/2,0,1)*n[2]/Math.sqrt(n[3])):t=Math.abs(Ys.inv(n[1]/2,0,1)*Yl(n[2])/Math.sqrt(n[2].length)),e[0]=n[0]-t,e[1]=n[0]+t,e}function rye(){var n=[].slice.call(arguments),e=new Array(2),t;return n.length===4?t=Math.abs(us.inv(n[1]/2,n[3]-1)*n[2]/Math.sqrt(n[3])):t=Math.abs(us.inv(n[1]/2,n[2].length-1)*Yl(n[2],!0)/Math.sqrt(n[2].length)),e[0]=n[0]-t,e[1]=n[0]+t,e}function iye(n){for(var e=1,t=n.length;--t>=0;)e*=n[t];return e}function sye(n){return Math.pow(iye(n),1/n.length)}function rm(n,e){var t=rs(n),r=rs(e),i=n.length,s=new Array(i),o;for(o=0;o<i;o++)s[o]=(n[o]-t)*(e[o]-r);return vj(s)/(i-1)}function ak(n,e){return rm(n,e)/Yl(n,1)/Yl(e,1)}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class d_ extends et{erf(e,t){return this.runFunction(e.args,t,this.metadata("ERF"),(r,i)=>i===void 0?wd(r):wd(i)-wd(r))}erfc(e,t){return this.runFunction(e.args,t,this.metadata("ERFC"),fj)}expondist(e,t){return this.runFunction(e.args,t,this.metadata("EXPON.DIST"),(r,i,s)=>s?rk.cdf(r,i):rk.pdf(r,i))}fisher(e,t){return this.runFunction(e.args,t,this.metadata("FISHER"),r=>Math.log((1+r)/(1-r))/2)}fisherinv(e,t){return this.runFunction(e.args,t,this.metadata("FISHERINV"),r=>1-2/(Math.exp(2*r)+1))}gamma(e,t){return this.runFunction(e.args,t,this.metadata("GAMMA"),km)}gammadist(e,t){return this.runFunction(e.args,t,this.metadata("GAMMA.DIST"),(r,i,s,o)=>o?hA.cdf(r,i,s):hA.pdf(r,i,s))}gammaln(e,t){return this.runFunction(e.args,t,this.metadata("GAMMALN"),pr)}gammainv(e,t){return this.runFunction(e.args,t,this.metadata("GAMMA.INV"),hA.inv)}gauss(e,t){return this.runFunction(e.args,t,this.metadata("GAUSS"),r=>Ys.cdf(r,0,1)-.5)}betadist(e,t){return this.runFunction(e.args,t,this.metadata("BETA.DIST"),(r,i,s,o,a,l)=>r<=a?new E(N.NUM,_.ValueSmall):r>=l?new E(N.NUM,_.ValueLarge):(r=(r-a)/(l-a),o?cA.cdf(r,i,s):cA.pdf(r,i,s)))}betainv(e,t){return this.runFunction(e.args,t,this.metadata("BETA.INV"),(r,i,s,o,a)=>o>=a?new E(N.NUM,_.WrongOrder):cA.inv(r,i,s)*(a-o)+o)}binomialdist(e,t){return this.runFunction(e.args,t,this.metadata("BINOM.DIST"),(r,i,s,o)=>r>i?new E(N.NUM,_.WrongOrder):(r=Math.trunc(r),i=Math.trunc(i),o?Mv.cdf(r,i,s):Mv.pdf(r,i,s)))}binomialinv(e,t){return this.runFunction(e.args,t,this.metadata("BINOM.INV"),(r,i,s)=>{r=Math.trunc(r);let o=-1,a=r;for(;a>o+1;){const l=Math.trunc((o+a)/2);Mv.cdf(l,r,i)>=s?a=l:o=l}return a})}besselifn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELI"),(r,i)=>KN(r,Math.trunc(i)))}besseljfn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELJ"),(r,i)=>YN(r,Math.trunc(i)))}besselkfn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELK"),(r,i)=>eye(r,Math.trunc(i)))}besselyfn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELY"),(r,i)=>Jve(r,Math.trunc(i)))}chisqdist(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.DIST"),(r,i,s)=>(i=Math.trunc(i),s?Yc.cdf(r,i):Yc.pdf(r,i)))}chisqdistrt(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.DIST.RT"),(r,i)=>1-Yc.cdf(r,Math.trunc(i)))}chisqinv(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.INV"),(r,i)=>Yc.inv(r,Math.trunc(i)))}chisqinvrt(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.INV.RT"),(r,i)=>Yc.inv(1-r,Math.trunc(i)))}fdist(e,t){return this.runFunction(e.args,t,this.metadata("F.DIST"),(r,i,s,o)=>(i=Math.trunc(i),s=Math.trunc(s),o?Kc.cdf(r,i,s):Kc.pdf(r,i,s)))}fdistrt(e,t){return this.runFunction(e.args,t,this.metadata("F.DIST.RT"),(r,i,s)=>1-Kc.cdf(r,Math.trunc(i),Math.trunc(s)))}finv(e,t){return this.runFunction(e.args,t,this.metadata("F.INV"),(r,i,s)=>Kc.inv(r,Math.trunc(i),Math.trunc(s)))}finvrt(e,t){return this.runFunction(e.args,t,this.metadata("F.INV.RT"),(r,i,s)=>Kc.inv(1-r,Math.trunc(i),Math.trunc(s)))}weibulldist(e,t){return this.runFunction(e.args,t,this.metadata("WEIBULL.DIST"),(r,i,s,o)=>o?ok.cdf(r,s,i):ok.pdf(r,s,i))}poissondist(e,t){return this.runFunction(e.args,t,this.metadata("POISSON.DIST"),(r,i,s)=>(r=Math.trunc(r),s?qN.cdf(r,i):qN.pdf(r,i)))}hypgeomdist(e,t){return this.runFunction(e.args,t,this.metadata("HYPGEOM.DIST"),(r,i,s,o,a)=>r>i||r>s||i>o||s>o?new E(N.NUM,_.ValueLarge):r+o<s+i?new E(N.NUM,_.ValueLarge):(r=Math.trunc(r),i=Math.trunc(i),s=Math.trunc(s),o=Math.trunc(o),a?Fa.cdf(r,o,s,i):Fa.pdf(r,o,s,i)))}tdist(e,t){return this.runFunction(e.args,t,this.metadata("T.DIST"),(r,i,s)=>(i=Math.trunc(i),s?us.cdf(r,i):us.pdf(r,i)))}tdist2t(e,t){return this.runFunction(e.args,t,this.metadata("T.DIST.2T"),(r,i)=>(1-us.cdf(r,Math.trunc(i)))*2)}tdistrt(e,t){return this.runFunction(e.args,t,this.metadata("T.DIST.RT"),(r,i)=>1-us.cdf(r,Math.trunc(i)))}tdistold(e,t){return this.runFunction(e.args,t,this.metadata("TDIST"),(r,i,s)=>s*(1-us.cdf(r,Math.trunc(i))))}tinv(e,t){return this.runFunction(e.args,t,this.metadata("T.INV"),(r,i)=>us.inv(r,Math.trunc(i)))}tinv2t(e,t){return this.runFunction(e.args,t,this.metadata("T.INV.2T"),(r,i)=>us.inv(1-r/2,Math.trunc(i)))}lognormdist(e,t){return this.runFunction(e.args,t,this.metadata("LOGNORM.DIST"),(r,i,s,o)=>o?fA.cdf(r,i,s):fA.pdf(r,i,s))}lognorminv(e,t){return this.runFunction(e.args,t,this.metadata("LOGNORM.INV"),(r,i,s)=>fA.inv(r,i,s))}normdist(e,t){return this.runFunction(e.args,t,this.metadata("NORM.DIST"),(r,i,s,o)=>o?Ys.cdf(r,i,s):Ys.pdf(r,i,s))}norminv(e,t){return this.runFunction(e.args,t,this.metadata("NORM.INV"),(r,i,s)=>Ys.inv(r,i,s))}normsdist(e,t){return this.runFunction(e.args,t,this.metadata("NORM.S.DIST"),(r,i)=>i?Ys.cdf(r,0,1):Ys.pdf(r,0,1))}normsinv(e,t){return this.runFunction(e.args,t,this.metadata("NORM.S.INV"),r=>Ys.inv(r,0,1))}phi(e,t){return this.runFunction(e.args,t,this.metadata("PHI"),r=>Ys.pdf(r,0,1))}negbinomdist(e,t){return this.runFunction(e.args,t,this.metadata("NEGBINOM.DIST"),(r,i,s,o)=>(r=Math.trunc(r),i=Math.trunc(i),o?XN.cdf(r,i,s):XN.pdf(r,i,s)))}confidencenorm(e,t){return this.runFunction(e.args,t,this.metadata("CONFIDENCE.NORM"),(r,i,s)=>nye(1,r,i,Math.trunc(s))[1]-1)}confidencet(e,t){return this.runFunction(e.args,t,this.metadata("CONFIDENCE.T"),(r,i,s)=>(s=Math.trunc(s),s===1?new E(N.DIV_BY_ZERO):rye(1,r,i,s)[1]-1))}standardize(e,t){return this.runFunction(e.args,t,this.metadata("STANDARDIZE"),(r,i,s)=>(r-i)/s)}}d_.implementedFunctions={ERF:{method:"erf",parameters:[{argumentType:m.NUMBER},{argumentType:m.NUMBER,optionalArg:!0}]},ERFC:{method:"erfc",parameters:[{argumentType:m.NUMBER}]},"EXPON.DIST":{method:"expondist",parameters:[{argumentType:m.NUMBER,minValue:0},{argumentType:m.NUMBER,greaterThan:0},{argumentType:m.BOOLEAN}]},FISHER:{method:"fisher",parameters:[{argumentType:m.NUMBER,greaterThan:-1,lessThan:1}]},FISHERINV:{method:"fisherinv",parameters:[{argumentType:m.NUMBER}]},GAMMA:{method:"gamma",parameters:[{argumentType:m.NUMBER}]},"GAMMA.DIST":{method:"gammadist",parameters:[{argumentType:m.NUMBER,minValue:0},{argumentType:m.NUMBER,greaterThan:0},{argumentType:m.NUMBER,greaterThan:0},{argumentType:m.BOOLEAN}]},GAMMALN:{method:"gammaln",parameters:[{argumentType:m.NUMBER,greaterThan:0}]},"GAMMA.INV":{method:"gammainv",parameters:[{argumentType:m.NUMBER,minValue:0,lessThan:1},{argumentType:m.NUMBER,greaterThan:0},{argumentType:m.NUMBER,greaterThan:0}]},GAUSS:{method:"gauss",parameters:[{argumentType:m.NUMBER}]},"BETA.DIST":{method:"betadist",parameters:[{argumentType:m.NUMBER},{argumentType:m.NUMBER,greaterThan:0},{argumentType:m.NUMBER,greaterThan:0},{argumentType:m.BOOLEAN},{argumentType:m.NUMBER,defaultValue:0},{argumentType:m.NUMBER,defaultValue:1}]},"BETA.INV":{method:"betainv",parameters:[{argumentType:m.NUMBER,greaterThan:0,maxValue:1},{argumentType:m.NUMBER,greaterThan:0},{argumentType:m.NUMBER,greaterThan:0},{argumentType:m.NUMBER,defaultValue:0},{argumentType:m.NUMBER,defaultValue:1}]},"BINOM.DIST":{method:"binomialdist",parameters:[{argumentType:m.NUMBER,minValue:0},{argumentType:m.NUMBER,minValue:0},{argumentType:m.NUMBER,minValue:0,maxValue:1},{argumentType:m.BOOLEAN}]},"BINOM.INV":{method:"binomialinv",parameters:[{argumentType:m.NUMBER,minValue:0},{argumentType:m.NUMBER,minValue:0,maxValue:1},{argumentType:m.NUMBER,greaterThan:0,lessThan:1}]},BESSELI:{method:"besselifn",parameters:[{argumentType:m.NUMBER},{argumentType:m.NUMBER,minValue:0}]},BESSELJ:{method:"besseljfn",parameters:[{argumentType:m.NUMBER},{argumentType:m.NUMBER,minValue:0}]},BESSELK:{method:"besselkfn",parameters:[{argumentType:m.NUMBER},{argumentType:m.NUMBER,minValue:0}]},BESSELY:{method:"besselyfn",parameters:[{argumentType:m.NUMBER},{argumentType:m.NUMBER,minValue:0}]},"CHISQ.DIST":{method:"chisqdist",parameters:[{argumentType:m.NUMBER},{argumentType:m.NUMBER,minValue:1,maxValue:1e10},{argumentType:m.BOOLEAN}]},"CHISQ.DIST.RT":{method:"chisqdistrt",parameters:[{argumentType:m.NUMBER},{argumentType:m.NUMBER,minValue:1,maxValue:1e10}]},"CHISQ.INV":{method:"chisqinv",parameters:[{argumentType:m.NUMBER,minValue:0,maxValue:1},{argumentType:m.NUMBER,minValue:1,maxValue:1e10}]},"CHISQ.INV.RT":{method:"chisqinvrt",parameters:[{argumentType:m.NUMBER,minValue:0,maxValue:1},{argumentType:m.NUMBER,minValue:1}]},"F.DIST":{method:"fdist",parameters:[{argumentType:m.NUMBER,minValue:0},{argumentType:m.NUMBER,minValue:1},{argumentType:m.NUMBER,minValue:1},{argumentType:m.BOOLEAN}]},"F.DIST.RT":{method:"fdistrt",parameters:[{argumentType:m.NUMBER,minValue:0},{argumentType:m.NUMBER,minValue:1},{argumentType:m.NUMBER,minValue:1}]},"F.INV":{method:"finv",parameters:[{argumentType:m.NUMBER,minValue:0,maxValue:1},{argumentType:m.NUMBER,minValue:1},{argumentType:m.NUMBER,minValue:1}]},"F.INV.RT":{method:"finvrt",parameters:[{argumentType:m.NUMBER,minValue:0,maxValue:1},{argumentType:m.NUMBER,minValue:1},{argumentType:m.NUMBER,minValue:1}]},"WEIBULL.DIST":{method:"weibulldist",parameters:[{argumentType:m.NUMBER,minValue:0},{argumentType:m.NUMBER,greaterThan:0},{argumentType:m.NUMBER,greaterThan:0},{argumentType:m.BOOLEAN}]},"POISSON.DIST":{method:"poissondist",parameters:[{argumentType:m.NUMBER,minValue:0},{argumentType:m.NUMBER,minValue:0},{argumentType:m.BOOLEAN}]},"HYPGEOM.DIST":{method:"hypgeomdist",parameters:[{argumentType:m.NUMBER,minValue:0},{argumentType:m.NUMBER,greaterThan:0},{argumentType:m.NUMBER,greaterThan:0},{argumentType:m.NUMBER,greaterThan:0},{argumentType:m.BOOLEAN}]},"T.DIST":{method:"tdist",parameters:[{argumentType:m.NUMBER},{argumentType:m.NUMBER,minValue:1},{argumentType:m.BOOLEAN}]},"T.DIST.2T":{method:"tdist2t",parameters:[{argumentType:m.NUMBER,minValue:0},{argumentType:m.NUMBER,minValue:1}]},"T.DIST.RT":{method:"tdistrt",parameters:[{argumentType:m.NUMBER},{argumentType:m.NUMBER,minValue:1}]},TDIST:{method:"tdistold",parameters:[{argumentType:m.NUMBER,minValue:0},{argumentType:m.NUMBER,minValue:1},{argumentType:m.INTEGER,minValue:1,maxValue:2}]},"T.INV":{method:"tinv",parameters:[{argumentType:m.NUMBER,greaterThan:0,lessThan:1},{argumentType:m.NUMBER,minValue:1}]},"T.INV.2T":{method:"tinv2t",parameters:[{argumentType:m.NUMBER,greaterThan:0,maxValue:1},{argumentType:m.NUMBER,minValue:1}]},"LOGNORM.DIST":{method:"lognormdist",parameters:[{argumentType:m.NUMBER,greaterThan:0},{argumentType:m.NUMBER},{argumentType:m.NUMBER,greaterThan:0},{argumentType:m.BOOLEAN}]},"LOGNORM.INV":{method:"lognorminv",parameters:[{argumentType:m.NUMBER,greaterThan:0,lessThan:1},{argumentType:m.NUMBER},{argumentType:m.NUMBER,greaterThan:0}]},"NORM.DIST":{method:"normdist",parameters:[{argumentType:m.NUMBER},{argumentType:m.NUMBER},{argumentType:m.NUMBER,greaterThan:0},{argumentType:m.BOOLEAN}]},"NORM.INV":{method:"norminv",parameters:[{argumentType:m.NUMBER,greaterThan:0,lessThan:1},{argumentType:m.NUMBER},{argumentType:m.NUMBER,greaterThan:0}]},"NORM.S.DIST":{method:"normsdist",parameters:[{argumentType:m.NUMBER},{argumentType:m.BOOLEAN}]},"NORM.S.INV":{method:"normsinv",parameters:[{argumentType:m.NUMBER,greaterThan:0,lessThan:1}]},PHI:{method:"phi",parameters:[{argumentType:m.NUMBER}]},"NEGBINOM.DIST":{method:"negbinomdist",parameters:[{argumentType:m.NUMBER,minValue:0},{argumentType:m.NUMBER,minValue:1},{argumentType:m.NUMBER,minValue:0,maxValue:1},{argumentType:m.BOOLEAN}]},"CONFIDENCE.NORM":{method:"confidencenorm",parameters:[{argumentType:m.NUMBER,greaterThan:0,lessThan:1},{argumentType:m.NUMBER,greaterThan:0},{argumentType:m.NUMBER,minValue:1}]},"CONFIDENCE.T":{method:"confidencet",parameters:[{argumentType:m.NUMBER,greaterThan:0,lessThan:1},{argumentType:m.NUMBER,greaterThan:0},{argumentType:m.NUMBER,minValue:1}]},STANDARDIZE:{method:"standardize",parameters:[{argumentType:m.NUMBER},{argumentType:m.NUMBER},{argumentType:m.NUMBER,greaterThan:0}]}};d_.aliases={NEGBINOMDIST:"NEGBINOM.DIST",EXPONDIST:"EXPON.DIST",BETADIST:"BETA.DIST",NORMDIST:"NORM.DIST",NORMINV:"NORM.INV",NORMSDIST:"NORM.S.DIST",NORMSINV:"NORM.S.INV",LOGNORMDIST:"LOGNORM.DIST",LOGINV:"LOGNORM.INV",TINV:"T.INV.2T",HYPGEOMDIST:"HYPGEOM.DIST",POISSON:"POISSON.DIST",WEIBULL:"WEIBULL.DIST",FINV:"F.INV.RT",FDIST:"F.DIST.RT",CHIDIST:"CHISQ.DIST.RT",CHIINV:"CHISQ.INV.RT",GAMMADIST:"GAMMA.DIST","GAMMALN.PRECISE":"GAMMALN",GAMMAINV:"GAMMA.INV",BETAINV:"BETA.INV",BINOMDIST:"BINOM.DIST",CONFIDENCE:"CONFIDENCE.NORM",CRITBINOM:"BINOM.INV",WEIBULLDIST:"WEIBULL.DIST",TINV2T:"T.INV.2T",TDISTRT:"T.DIST.RT",TDIST2T:"T.DIST.2T",FINVRT:"F.INV.RT",FDISTRT:"F.DIST.RT",CHIDISTRT:"CHISQ.DIST.RT",CHIINVRT:"CHISQ.INV.RT",LOGNORMINV:"LOGNORM.INV",POISSONDIST:"POISSON.DIST"};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class yj extends et{fact(e,t){return this.runFunction(e.args,t,this.metadata("FACT"),r=>{r=Math.trunc(r);let i=1;for(let s=1;s<=r;s++)i*=s;return i})}factdouble(e,t){return this.runFunction(e.args,t,this.metadata("FACTDOUBLE"),r=>{r=Math.trunc(r);let i=1;for(let s=r;s>=1;s-=2)i*=s;return i})}combin(e,t){return this.runFunction(e.args,t,this.metadata("COMBIN"),(r,i)=>i>r?new E(N.NUM,_.WrongOrder):(r=Math.trunc(r),i=Math.trunc(i),lk(r,i)))}combina(e,t){return this.runFunction(e.args,t,this.metadata("COMBINA"),(r,i)=>(r=Math.trunc(r),i=Math.trunc(i),r+i-1>=1030?new E(N.NUM,_.ValueLarge):r===0&&i===0?1:lk(r+i-1,i)))}gcd(e,t){return this.runFunction(e.args,t,this.metadata("GCD"),(...r)=>{const i=this.arithmeticHelper.coerceNumbersCoerceRangesDropNulls(r);if(i instanceof E)return i;let s=0;for(const o of i){if(o<0)return new E(N.NUM,_.ValueSmall);s=Cj(s,Math.trunc(o))}return s>Number.MAX_SAFE_INTEGER?new E(N.NUM,_.ValueLarge):s})}lcm(e,t){return this.runFunction(e.args,t,this.metadata("LCM"),(...r)=>{const i=this.arithmeticHelper.coerceNumbersCoerceRangesDropNulls(r);if(i instanceof E)return i;let s=1;for(const o of i){if(o<0)return new E(N.NUM,_.ValueSmall);s=oye(s,Math.trunc(o))}return s>Number.MAX_SAFE_INTEGER?new E(N.NUM,_.ValueLarge):s})}mround(e,t){return this.runFunction(e.args,t,this.metadata("MROUND"),(r,i)=>i===0?0:r>0&&i<0||r<0&&i>0?new E(N.NUM,_.DistinctSigns):Math.round(r/i)*i)}multinomial(e,t){return this.runFunction(e.args,t,this.metadata("MULTINOMIAL"),(...r)=>{let i=0,s=1;for(let o of r){if(o<0)return new E(N.NUM,_.ValueSmall);o=Math.trunc(o);for(let a=1;a<=o;a++)s*=(i+a)/a;i+=o}return Math.round(s)})}quotient(e,t){return this.runFunction(e.args,t,this.metadata("QUOTIENT"),(r,i)=>i===0?new E(N.DIV_BY_ZERO):Math.trunc(r/i))}seriessum(e,t){return this.runFunction(e.args,t,this.metadata("SERIESSUM"),(r,i,s,o)=>{const a=this.arithmeticHelper.manyToOnlyNumbersDropNulls(o.valuesFromTopLeftCorner());if(a instanceof E)return a;let l=0;a.reverse();for(const u of a)l*=Math.pow(r,s),l+=u;return l*Math.pow(r,i)})}sign(e,t){return this.runFunction(e.args,t,this.metadata("SIGN"),r=>r>0?1:r<0?-1:0)}sumx2my2(e,t){return this.runFunction(e.args,t,this.metadata("SUMX2MY2"),(r,i)=>{const s=r.valuesFromTopLeftCorner(),o=i.valuesFromTopLeftCorner();if(s.length!==o.length)return new E(N.NA,_.EqualLength);const a=s.length;let l=0;for(let u=0;u<a;u++){const h=s[u],c=o[u];if(h instanceof E)return h;if(c instanceof E)return c;typeof h=="number"&&typeof c=="number"&&(l+=Math.pow(h,2)-Math.pow(c,2))}return l})}sumx2py2(e,t){return this.runFunction(e.args,t,this.metadata("SUMX2PY2"),(r,i)=>{const s=r.valuesFromTopLeftCorner(),o=i.valuesFromTopLeftCorner();if(s.length!==o.length)return new E(N.NA,_.EqualLength);const a=s.length;let l=0;for(let u=0;u<a;u++){const h=s[u],c=o[u];if(h instanceof E)return h;if(c instanceof E)return c;typeof h=="number"&&typeof c=="number"&&(l+=Math.pow(h,2)+Math.pow(c,2))}return l})}sumxmy2(e,t){return this.runFunction(e.args,t,this.metadata("SUMXMY2"),(r,i)=>{const s=r.valuesFromTopLeftCorner(),o=i.valuesFromTopLeftCorner();if(s.length!==o.length)return new E(N.NA,_.EqualLength);const a=s.length;let l=0;for(let u=0;u<a;u++){const h=s[u],c=o[u];if(h instanceof E)return h;if(c instanceof E)return c;typeof h=="number"&&typeof c=="number"&&(l+=Math.pow(h-c,2))}return l})}}yj.implementedFunctions={FACT:{method:"fact",parameters:[{argumentType:m.NUMBER,minValue:0,maxValue:170}]},FACTDOUBLE:{method:"factdouble",parameters:[{argumentType:m.NUMBER,minValue:0,maxValue:288}]},COMBIN:{method:"combin",parameters:[{argumentType:m.NUMBER,minValue:0,lessThan:1030},{argumentType:m.NUMBER,minValue:0}]},COMBINA:{method:"combina",parameters:[{argumentType:m.NUMBER,minValue:0},{argumentType:m.NUMBER,minValue:0}]},GCD:{method:"gcd",parameters:[{argumentType:m.ANY}],repeatLastArgs:1},LCM:{method:"lcm",parameters:[{argumentType:m.ANY}],repeatLastArgs:1},MROUND:{method:"mround",parameters:[{argumentType:m.NUMBER},{argumentType:m.NUMBER}]},MULTINOMIAL:{method:"multinomial",parameters:[{argumentType:m.NUMBER}],repeatLastArgs:1,expandRanges:!0},QUOTIENT:{method:"quotient",parameters:[{argumentType:m.NUMBER},{argumentType:m.NUMBER}]},SERIESSUM:{method:"seriessum",parameters:[{argumentType:m.NUMBER},{argumentType:m.NUMBER},{argumentType:m.NUMBER},{argumentType:m.RANGE}]},SIGN:{method:"sign",parameters:[{argumentType:m.NUMBER}]},SUMX2MY2:{method:"sumx2my2",parameters:[{argumentType:m.RANGE},{argumentType:m.RANGE}]},SUMX2PY2:{method:"sumx2py2",parameters:[{argumentType:m.RANGE},{argumentType:m.RANGE}]},SUMXMY2:{method:"sumxmy2",parameters:[{argumentType:m.RANGE},{argumentType:m.RANGE}]}};function lk(n,e){2*e>n&&(e=n-e);let t=1;for(let r=1;r<=e;r++)t*=(n-e+r)/r;return Math.round(t)}function Cj(n,e){for(n<e&&([n,e]=[e,n]);e>0;)[n,e]=[e,n%e];return n}function oye(n,e){return n===0||e===0?0:n*(e/Cj(n,e))}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class Sj extends et{complex(e,t){return this.runFunction(e.args,t,this.metadata("COMPLEX"),(r,i,s)=>s!=="i"&&s!=="j"?new E(N.VALUE,_.ShouldBeIorJ):On([r,i],s))}imabs(e,t){return this.runFunction(e.args,t,this.metadata("IMABS"),bj)}imaginary(e,t){return this.runFunction(e.args,t,this.metadata("IMAGINARY"),([r,i])=>i)}imreal(e,t){return this.runFunction(e.args,t,this.metadata("IMREAL"),([r,i])=>r)}imargument(e,t){return this.runFunction(e.args,t,this.metadata("IMARGUMENT"),([r,i])=>r===0&&i===0?new E(N.DIV_BY_ZERO):Math.atan2(i,r))}imconjugate(e,t){return this.runFunction(e.args,t,this.metadata("IMCONJUGATE"),([r,i])=>On([r,-i]))}imcos(e,t){return this.runFunction(e.args,t,this.metadata("IMCOS"),r=>On(zw(r)))}imcosh(e,t){return this.runFunction(e.args,t,this.metadata("IMCOSH"),r=>On(uk(r)))}imcot(e,t){return this.runFunction(e.args,t,this.metadata("IMCOT"),r=>On(nh(zw(r),Yw(r))))}imcsc(e,t){return this.runFunction(e.args,t,this.metadata("IMCSC"),r=>On(nh([1,0],Yw(r))))}imcsch(e,t){return this.runFunction(e.args,t,this.metadata("IMCSCH"),r=>On(nh([1,0],hk(r))))}imsec(e,t){return this.runFunction(e.args,t,this.metadata("IMSEC"),r=>On(nh([1,0],zw(r))))}imsech(e,t){return this.runFunction(e.args,t,this.metadata("IMSECH"),r=>On(nh([1,0],uk(r))))}imsin(e,t){return this.runFunction(e.args,t,this.metadata("IMSIN"),r=>On(Yw(r)))}imsinh(e,t){return this.runFunction(e.args,t,this.metadata("IMSINH"),r=>On(hk(r)))}imtan(e,t){return this.runFunction(e.args,t,this.metadata("IMTAN"),r=>On(nh(Yw(r),zw(r))))}imdiv(e,t){return this.runFunction(e.args,t,this.metadata("IMDIV"),(r,i)=>On(nh(r,i)))}improduct(e,t){return this.runFunction(e.args,t,this.metadata("IMPRODUCT"),(...r)=>{const i=this.arithmeticHelper.coerceComplexExactRanges(r);if(i instanceof E)return i;let s=[1,0];for(const o of i)s=Rj(s,o);return On(s)})}imsum(e,t){return this.runFunction(e.args,t,this.metadata("IMSUM"),(...r)=>{const i=this.arithmeticHelper.coerceComplexExactRanges(r);if(i instanceof E)return i;let s=[0,0];for(const o of i)s=aye(s,o);return On(s)})}imsub(e,t){return this.runFunction(e.args,t,this.metadata("IMSUB"),(r,i)=>On(lye(r,i)))}imexp(e,t){return this.runFunction(e.args,t,this.metadata("IMEXP"),r=>On(Ej(r)))}imln(e,t){return this.runFunction(e.args,t,this.metadata("IMLN"),r=>On(Ov(r)))}imlog10(e,t){return this.runFunction(e.args,t,this.metadata("IMLOG10"),r=>{const[i,s]=Ov(r),o=Math.log(10);return On([i/o,s/o])})}imlog2(e,t){return this.runFunction(e.args,t,this.metadata("IMLOG2"),r=>{const[i,s]=Ov(r),o=Math.log(2);return On([i/o,s/o])})}impower(e,t){return this.runFunction(e.args,t,this.metadata("IMPOWER"),(r,i)=>On(ck(r,i)))}imsqrt(e,t){return this.runFunction(e.args,t,this.metadata("IMSQRT"),r=>On(ck(r,.5)))}}Sj.implementedFunctions={COMPLEX:{method:"complex",parameters:[{argumentType:m.NUMBER},{argumentType:m.NUMBER},{argumentType:m.STRING,defaultValue:"i"}]},IMABS:{method:"imabs",parameters:[{argumentType:m.COMPLEX}]},IMAGINARY:{method:"imaginary",parameters:[{argumentType:m.COMPLEX}]},IMREAL:{method:"imreal",parameters:[{argumentType:m.COMPLEX}]},IMARGUMENT:{method:"imargument",parameters:[{argumentType:m.COMPLEX}]},IMCONJUGATE:{method:"imconjugate",parameters:[{argumentType:m.COMPLEX}]},IMCOS:{method:"imcos",parameters:[{argumentType:m.COMPLEX}]},IMCOSH:{method:"imcosh",parameters:[{argumentType:m.COMPLEX}]},IMCOT:{method:"imcot",parameters:[{argumentType:m.COMPLEX}]},IMCSC:{method:"imcsc",parameters:[{argumentType:m.COMPLEX}]},IMCSCH:{method:"imcsch",parameters:[{argumentType:m.COMPLEX}]},IMSEC:{method:"imsec",parameters:[{argumentType:m.COMPLEX}]},IMSECH:{method:"imsech",parameters:[{argumentType:m.COMPLEX}]},IMSIN:{method:"imsin",parameters:[{argumentType:m.COMPLEX}]},IMSINH:{method:"imsinh",parameters:[{argumentType:m.COMPLEX}]},IMTAN:{method:"imtan",parameters:[{argumentType:m.COMPLEX}]},IMDIV:{method:"imdiv",parameters:[{argumentType:m.COMPLEX},{argumentType:m.COMPLEX}]},IMPRODUCT:{method:"improduct",parameters:[{argumentType:m.ANY}],repeatLastArgs:1},IMSUM:{method:"imsum",parameters:[{argumentType:m.ANY}],repeatLastArgs:1},IMSUB:{method:"imsub",parameters:[{argumentType:m.COMPLEX},{argumentType:m.COMPLEX}]},IMEXP:{method:"imexp",parameters:[{argumentType:m.COMPLEX}]},IMLN:{method:"imln",parameters:[{argumentType:m.COMPLEX}]},IMLOG10:{method:"imlog10",parameters:[{argumentType:m.COMPLEX}]},IMLOG2:{method:"imlog2",parameters:[{argumentType:m.COMPLEX}]},IMPOWER:{method:"impower",parameters:[{argumentType:m.COMPLEX},{argumentType:m.NUMBER}]},IMSQRT:{method:"imsqrt",parameters:[{argumentType:m.COMPLEX}]}};function aye([n,e],[t,r]){return[n+t,e+r]}function lye([n,e],[t,r]){return[n-t,e-r]}function Rj([n,e],[t,r]){return[n*t-e*r,n*r+t*e]}function nh([n,e],[t,r]){const i=Math.pow(t,2)+Math.pow(r,2),[s,o]=Rj([n,e],[t,-r]);return[s/i,o/i]}function zw([n,e]){return[Math.cos(n)*Math.cosh(e),-Math.sin(n)*Math.sinh(e)]}function uk([n,e]){return[Math.cosh(n)*Math.cos(e),Math.sinh(n)*Math.sin(e)]}function Yw([n,e]){return[Math.sin(n)*Math.cosh(e),Math.cos(n)*Math.sinh(e)]}function hk([n,e]){return[Math.sinh(n)*Math.cos(e),Math.cosh(n)*Math.sin(e)]}function Ej([n,e]){return[Math.exp(n)*Math.cos(e),Math.exp(n)*Math.sin(e)]}function bj([n,e]){return Math.sqrt(n*n+e*e)}function Ov([n,e]){return[Math.log(bj([n,e])),Math.atan2(e,n)]}function ck(n,e){const[t,r]=Ov(n);return Ej([e*t,e*r])}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class f_ extends et{avedev(e,t){return this.runFunction(e.args,t,this.metadata("AVEDEV"),(...r)=>{const i=this.arithmeticHelper.coerceNumbersExactRanges(r);if(i instanceof E)return i;if(i.length===0)return new E(N.DIV_BY_ZERO);const s=rs(i);return i.reduce((o,a)=>o+Math.abs(a-s),0)/i.length})}devsq(e,t){return this.runFunction(e.args,t,this.metadata("DEVSQ"),(...r)=>{const i=this.arithmeticHelper.coerceNumbersExactRanges(r);return i instanceof E?i:i.length===0?0:oh(i)})}geomean(e,t){return this.runFunction(e.args,t,this.metadata("GEOMEAN"),(...r)=>{const i=this.arithmeticHelper.coerceNumbersExactRanges(r);if(i instanceof E)return i;if(i.length===0)return new E(N.NUM,_.OneValue);for(const s of i)if(s<=0)return new E(N.NUM,_.ValueSmall);return sye(i)})}harmean(e,t){return this.runFunction(e.args,t,this.metadata("HARMEAN"),(...r)=>{const i=this.arithmeticHelper.coerceNumbersExactRanges(r);if(i instanceof E)return i;if(i.length===0)return new E(N.NUM,_.OneValue);for(const s of i)if(s<=0)return new E(N.NUM,_.ValueSmall);return i.length/i.reduce((s,o)=>s+1/o,0)})}correl(e,t){return this.runFunction(e.args,t,this.metadata("CORREL"),(r,i)=>{if(r.numberOfElements()!==i.numberOfElements())return new E(N.NA,_.EqualLength);const s=rh(r,i);return s instanceof E?s:s[0].length<=1?new E(N.DIV_BY_ZERO,_.TwoValues):ak(s[0],s[1])})}rsq(e,t){return this.runFunction(e.args,t,this.metadata("RSQ"),(r,i)=>{if(r.numberOfElements()!==i.numberOfElements())return new E(N.NA,_.EqualLength);const s=rh(r,i);return s instanceof E?s:s[0].length<=1?new E(N.DIV_BY_ZERO,_.TwoValues):Math.pow(ak(s[0],s[1]),2)})}covariancep(e,t){return this.runFunction(e.args,t,this.metadata("COVARIANCE.P"),(r,i)=>{if(r.numberOfElements()!==i.numberOfElements())return new E(N.NA,_.EqualLength);const s=rh(r,i);if(s instanceof E)return s;const o=s[0].length;return o<1?new E(N.DIV_BY_ZERO,_.OneValue):o===1?0:rm(s[0],s[1])*(o-1)/o})}covariances(e,t){return this.runFunction(e.args,t,this.metadata("COVARIANCE.S"),(r,i)=>{if(r.numberOfElements()!==i.numberOfElements())return new E(N.NA,_.EqualLength);const s=rh(r,i);return s instanceof E?s:s[0].length<=1?new E(N.DIV_BY_ZERO,_.TwoValues):rm(s[0],s[1])})}ztest(e,t){return this.runFunction(e.args,t,this.metadata("Z.TEST"),(r,i,s)=>{const o=this.arithmeticHelper.manyToExactNumbers(r.valuesFromTopLeftCorner());if(o instanceof E)return o;const a=o.length;if(s===void 0){if(a<2)return new E(N.DIV_BY_ZERO,_.TwoValues);s=Yl(o,!0)}return a<1?new E(N.NA,_.OneValue):s===0?new E(N.DIV_BY_ZERO):1-Ys.cdf((rs(o)-i)/(s/Math.sqrt(a)),0,1)})}ftest(e,t){return this.runFunction(e.args,t,this.metadata("F.TEST"),(r,i)=>{const s=this.arithmeticHelper.manyToExactNumbers(r.valuesFromTopLeftCorner()),o=this.arithmeticHelper.manyToExactNumbers(i.valuesFromTopLeftCorner());if(s instanceof E)return s;if(o instanceof E)return o;if(s.length<=1||o.length<=1)return new E(N.DIV_BY_ZERO);const a=nm(s,!0),l=nm(o,!0);if(a===0||l===0)return new E(N.DIV_BY_ZERO);const u=a/l,h=Kc.cdf(u,s.length-1,o.length-1);return 2*Math.min(h,1-h)})}steyx(e,t){return this.runFunction(e.args,t,this.metadata("STEYX"),(r,i)=>{if(r.numberOfElements()!==i.numberOfElements())return new E(N.NA,_.EqualLength);const s=rh(r,i);if(s instanceof E)return s;const o=s[0].length;return o<=2?new E(N.DIV_BY_ZERO,_.ThreeValues):Math.sqrt((oh(s[0])-Math.pow(rm(s[0],s[1])*(o-1),2)/oh(s[1]))/(o-2))})}slope(e,t){return this.runFunction(e.args,t,this.metadata("SLOPE"),(r,i)=>{if(r.numberOfElements()!==i.numberOfElements())return new E(N.NA,_.EqualLength);const s=rh(r,i);if(s instanceof E)return s;const o=s[0].length;return o<=1?new E(N.DIV_BY_ZERO,_.TwoValues):rm(s[0],s[1])*(o-1)/oh(s[1])})}chisqtest(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.TEST"),(r,i)=>{const s=r.height(),o=r.width();if(i.height()!==s||i.width()!==o)return new E(N.NA,_.EqualLength);const a=rh(r,i);if(a instanceof E)return a;if(a[0].length<=1)return new E(N.DIV_BY_ZERO,_.TwoValues);let l=0;for(let u=0;u<a[0].length;u++){if(a[1][u]===0)return new E(N.DIV_BY_ZERO);l+=Math.pow(a[0][u]-a[1][u],2)/a[1][u]}return l<0?new E(N.NUM,_.NaN):1-Yc.cdf(l,s>1&&o>1?(s-1)*(o-1):s*o-1)})}ttest(e,t){return this.runFunction(e.args,t,this.metadata("T.TEST"),(r,i,s,o)=>{const a=this.arithmeticHelper.manyToExactNumbers(r.valuesFromTopLeftCorner()),l=this.arithmeticHelper.manyToExactNumbers(i.valuesFromTopLeftCorner());if(a instanceof E)return a;if(l instanceof E)return l;const u=a.length,h=l.length;if(o===1){if(h!==u)return new E(N.NA,_.EqualLength);if(u<=1)return new E(N.DIV_BY_ZERO,_.TwoValues);const c=Array(u);for(let g=0;g<u;g++)c[g]=a[g]-l[g];const d=Yl(c,!0);if(d===0)return new E(N.DIV_BY_ZERO);const f=Math.abs(Math.sqrt(u)*rs(c)/d);return s*(1-us.cdf(f,u-1))}else if(o===2){if(u<=1||h<=1)return new E(N.DIV_BY_ZERO,_.TwoValues);const c=(oh(a)+oh(l))/(u+h-2);if(c===0)return new E(N.DIV_BY_ZERO);const d=Math.abs((rs(a)-rs(l))/Math.sqrt(c*(1/u+1/h)));return s*(1-us.cdf(d,u+h-2))}else{if(u<=1||h<=1)return new E(N.DIV_BY_ZERO,_.TwoValues);const c=nm(a,!0),d=nm(l,!0);if(c===0&&d===0)return new E(N.DIV_BY_ZERO);const f=Math.abs((rs(a)-rs(l))/Math.sqrt(c/u+d/h)),g=Math.pow(c/u+d/h,2)/(Math.pow(c/u,2)/(u-1)+Math.pow(d/h,2)/(h-1));return s*(1-us.cdf(f,g))}})}skew(e,t){return this.runFunction(e.args,t,this.metadata("SKEW"),(...r)=>{const i=this.arithmeticHelper.coerceNumbersExactRanges(r);if(i instanceof E)return i;const s=i.length;if(s<3)return new E(N.DIV_BY_ZERO,_.ThreeValues);const o=rs(i),a=Yl(i,!0);return a===0?new E(N.DIV_BY_ZERO):i.reduce((l,u)=>l+Math.pow((u-o)/a,3),0)*s/(s-1)/(s-2)})}skewp(e,t){return this.runFunction(e.args,t,this.metadata("SKEW.P"),(...r)=>{const i=this.arithmeticHelper.coerceNumbersExactRanges(r);if(i instanceof E)return i;const s=i.length;if(s<3)return new E(N.DIV_BY_ZERO,_.ThreeValues);const o=rs(i),a=Yl(i,!1);return a===0?new E(N.DIV_BY_ZERO):i.reduce((l,u)=>l+Math.pow((u-o)/a,3),0)/s})}}f_.implementedFunctions={AVEDEV:{method:"avedev",parameters:[{argumentType:m.ANY}],repeatLastArgs:1},DEVSQ:{method:"devsq",parameters:[{argumentType:m.ANY}],repeatLastArgs:1},GEOMEAN:{method:"geomean",parameters:[{argumentType:m.ANY}],repeatLastArgs:1},HARMEAN:{method:"harmean",parameters:[{argumentType:m.ANY}],repeatLastArgs:1},CORREL:{method:"correl",parameters:[{argumentType:m.RANGE},{argumentType:m.RANGE}]},RSQ:{method:"rsq",parameters:[{argumentType:m.RANGE},{argumentType:m.RANGE}]},"COVARIANCE.P":{method:"covariancep",parameters:[{argumentType:m.RANGE},{argumentType:m.RANGE}]},"COVARIANCE.S":{method:"covariances",parameters:[{argumentType:m.RANGE},{argumentType:m.RANGE}]},"Z.TEST":{method:"ztest",parameters:[{argumentType:m.RANGE},{argumentType:m.NUMBER},{argumentType:m.NUMBER,optionalArg:!0}]},"F.TEST":{method:"ftest",parameters:[{argumentType:m.RANGE},{argumentType:m.RANGE}]},STEYX:{method:"steyx",parameters:[{argumentType:m.RANGE},{argumentType:m.RANGE}]},SLOPE:{method:"slope",parameters:[{argumentType:m.RANGE},{argumentType:m.RANGE}]},"CHISQ.TEST":{method:"chisqtest",parameters:[{argumentType:m.RANGE},{argumentType:m.RANGE}]},"T.TEST":{method:"ttest",parameters:[{argumentType:m.RANGE},{argumentType:m.RANGE},{argumentType:m.INTEGER,minValue:1,maxValue:2},{argumentType:m.INTEGER,minValue:1,maxValue:3}]},SKEW:{method:"skew",parameters:[{argumentType:m.ANY}],repeatLastArgs:1},"SKEW.P":{method:"skewp",parameters:[{argumentType:m.ANY}],repeatLastArgs:1}};f_.aliases={COVAR:"COVARIANCE.P",FTEST:"F.TEST",PEARSON:"CORREL",ZTEST:"Z.TEST",CHITEST:"CHISQ.TEST",TTEST:"T.TEST",COVARIANCEP:"COVARIANCE.P",COVARIANCES:"COVARIANCE.S",SKEWP:"SKEW.P"};function rh(n,e){const t=n.iterateValuesFromTopLeftCorner(),r=e.iterateValuesFromTopLeftCorner();let i,s;const o=[],a=[];for(;i=t.next(),s=r.next(),!i.done&&!s.done;){const l=i.value,u=s.value;if(l instanceof E)return l;if(u instanceof E)return u;It(l)&&It(u)&&(o.push(me(l)),a.push(me(u)))}return[o,a]}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const dk=Object.freeze(Object.defineProperty({__proto__:null,AbsPlugin:b2,AddressPlugin:R2,ArrayPlugin:E2,BitShiftPlugin:T2,BitwiseLogicOperationsPlugin:I2,BooleanPlugin:O2,CharPlugin:_2,CodePlugin:P2,ComplexPlugin:Sj,ConditionalAggregationPlugin:ij,CountBlankPlugin:x2,CountUniquePlugin:L2,DateTimePlugin:H2,DegreesPlugin:D2,DeltaPlugin:F2,ExpPlugin:k2,FinancialPlugin:V2,FormulaTextPlugin:U2,HyperlinkPlugin:B2,InformationPlugin:W2,IsEvenPlugin:$2,IsOddPlugin:G2,LogarithmPlugin:j2,LookupPlugin:lj,MathConstantsPlugin:z2,MathPlugin:yj,MatrixPlugin:Y2,MedianPlugin:K2,ModuloPlugin:q2,NumericAggregationPlugin:a_,PowerPlugin:X2,RadiansPlugin:Q2,RadixConversionPlugin:J2,RandomPlugin:nj,RomanPlugin:uj,RoundingPlugin:l_,SimpleArithmerticPlugin:hj,SqrtPlugin:rj,StatisticalAggregationPlugin:f_,StatisticalPlugin:d_,SumprodPlugin:sj,TextPlugin:oj,TrigonometryPlugin:aj},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class ct extends vr{}ct.HyperFormula=vr;ct.ErrorType=N;ct.CellError=E;ct.CellType=yi;ct.CellValueType=Qs;ct.CellValueDetailedType=$pe;ct.DetailedCellError=s2;ct.ExportedCellChange=WN;ct.ExportedNamedExpressionChange=w2;ct.ConfigValueTooBigError=YG;ct.ConfigValueTooSmallError=zG;ct.EvaluationSuspendedError=qG;ct.ExpectedOneOfValuesError=KG;ct.ExpectedValueOfTypeError=Nt;ct.ArraySize=gt;ct.SimpleRangeValue=Ae;ct.EmptyValue=ht;ct.FunctionPlugin=et;ct.FunctionArgumentType=m;ct.FunctionPluginValidationError=Td;ct.InvalidAddressError=VG;ct.InvalidArgumentsError=Kn;ct.LanguageNotRegisteredError=_N;ct.LanguageAlreadyRegisteredError=QG;ct.MissingTranslationError=jc;ct.NamedExpressionDoesNotExistError=hg;ct.NamedExpressionNameIsAlreadyTakenError=UG;ct.NamedExpressionNameIsInvalidError=BG;ct.NoOperationToRedoError=$G;ct.NoOperationToUndoError=WG;ct.NoRelativeAddressesAllowedError=n_;ct.NoSheetWithIdError=Rn;ct.NoSheetWithNameError=kG;ct.NotAFormulaError=bv;ct.NothingToPasteError=GG;ct.ProtectedFunctionTranslationError=XG;ct.SheetNameAlreadyTakenError=lg;ct.SheetSizeLimitExceededError=Sh;ct.SourceLocationHasArrayError=nd;ct.TargetLocationHasArrayError=$y;ct.UnableToParseError=jG;const uye=Tr.defaultConfig.language;vr.registerLanguage(uye,$N);vr.languages[$N.langCode]=$N;for(const n of Object.getOwnPropertyNames(dk))n.startsWith("_")||vr.registerFunctionPlugin(dk[n]);function Aye(){const n=ES.useRef(null),e=ES.useRef(null);return ES.useEffect(()=>{if(!n.current)return;const t=vr.buildEmpty({licenseKey:"gpl-v3"}),r=[];for(let s=0;s<20;s++)r.push(new Array(10).fill(""));const i=new Qe(n.current,{data:r,rowHeaders:!0,colHeaders:!0,width:"100%",height:"100vh",licenseKey:"non-commercial-and-evaluation",stretchH:"all",contextMenu:["row_above","row_below","remove_row","col_left","col_right","remove_col","---------","copy","cut","---------","undo","redo"],manualColumnResize:!0,manualRowResize:!0,filters:!0,dropdownMenu:!0,columnSorting:!0,mergeCells:!0,formulas:{engine:t,sheetName:"Sheet1"},cells:function(s,o){return{}},afterChange:function(s,o){}});return e.current=i,()=>{e.current&&e.current.destroy()}},[]),Pj.jsx("div",{id:"spreadsheet-container",ref:n})}export{Aye as default};
